var app=function(){"use strict";function e(){}function t(e){return e()}function n(){return Object.create(null)}function i(e){e.forEach(t)}function A(e){return"function"==typeof e}function o(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}let s;function a(e,t){return s||(s=document.createElement("a")),s.href=t,e===s.href}function l(t,r,n){t.$$.on_destroy.push(function(t,...r){if(null==t)return e;const n=t.subscribe(...r);return n.unsubscribe?()=>n.unsubscribe():n}(r,n))}function c(e,t,r,n){if(e){const i=u(e,t,r,n);return e[0](i)}}function u(e,t,r,n){return e[1]&&n?function(e,t){for(const r in t)e[r]=t[r];return e}(r.ctx.slice(),e[1](n(t))):r.ctx}function h(e,t,r,n){if(e[2]&&n){const i=e[2](n(r));if(void 0===t.dirty)return i;if("object"==typeof i){const e=[],r=Math.max(t.dirty.length,i.length);for(let n=0;n<r;n+=1)e[n]=t.dirty[n]|i[n];return e}return t.dirty|i}return t.dirty}function d(e,t,r,n,i,A){if(i){const o=u(t,r,n,A);e.p(o,i)}}function p(e){if(e.ctx.length>32){const t=[],r=e.ctx.length/32;for(let e=0;e<r;e++)t[e]=-1;return t}return-1}const f="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;function m(e,t){e.appendChild(t)}function y(e,t,r){e.insertBefore(t,r||null)}function _(e){e.parentNode&&e.parentNode.removeChild(e)}function w(e){return document.createElement(e)}function x(e){return document.createTextNode(e)}function B(){return x(" ")}function v(){return x("")}function C(e,t,r,n){return e.addEventListener(t,r,n),()=>e.removeEventListener(t,r,n)}function F(e,t,r){null==r?e.removeAttribute(t):e.getAttribute(t)!==r&&e.setAttribute(t,r)}function E(e,t,r){t in e?e[t]="boolean"==typeof e[t]&&""===r||r:F(e,t,r)}function U(e,t){t=""+t,e.data!==t&&(e.data=t)}function Q(e,t){e.value=null==t?"":t}function I(e,t,r,n){null==r?e.style.removeProperty(t):e.style.setProperty(t,r,n?"important":"")}function T(e,t,r){for(let r=0;r<e.options.length;r+=1){const n=e.options[r];if(n.__value===t)return void(n.selected=!0)}r&&void 0===t||(e.selectedIndex=-1)}function S(e,t,r){e.classList[r?"add":"remove"](t)}let M;function k(e){M=e}function D(){if(!M)throw new Error("Function called outside component initialization");return M}function L(e){D().$$.on_mount.push(e)}function P(e){D().$$.on_destroy.push(e)}function H(){const e=D();return(t,r,{cancelable:n=!1}={})=>{const i=e.$$.callbacks[t];if(i){const A=function(e,t,{bubbles:r=!1,cancelable:n=!1}={}){const i=document.createEvent("CustomEvent");return i.initCustomEvent(e,r,n,t),i}(t,r,{cancelable:n});return i.slice().forEach((t=>{t.call(e,A)})),!A.defaultPrevented}return!0}}function z(e,t){return D().$$.context.set(e,t),t}function R(e){return D().$$.context.get(e)}const O=[],K=[];let V=[];const $=[],N=Promise.resolve();let G=!1;function q(e){V.push(e)}function X(e){$.push(e)}const j=new Set;let Z=0;function J(){if(0!==Z)return;const e=M;do{try{for(;Z<O.length;){const e=O[Z];Z++,k(e),W(e.$$)}}catch(e){throw O.length=0,Z=0,e}for(k(null),O.length=0,Z=0;K.length;)K.pop()();for(let e=0;e<V.length;e+=1){const t=V[e];j.has(t)||(j.add(t),t())}V.length=0}while(O.length);for(;$.length;)$.pop()();G=!1,j.clear(),k(e)}function W(e){if(null!==e.fragment){e.update(),i(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(q)}}const Y=new Set;let ee;function te(){ee={r:0,c:[],p:ee}}function re(){ee.r||i(ee.c),ee=ee.p}function ne(e,t){e&&e.i&&(Y.delete(e),e.i(t))}function ie(e,t,r,n){if(e&&e.o){if(Y.has(e))return;Y.add(e),ee.c.push((()=>{Y.delete(e),n&&(r&&e.d(1),n())})),e.o(t)}else n&&n()}function Ae(e,t,r){const n=e.$$.props[t];void 0!==n&&(e.$$.bound[n]=r,r(e.$$.ctx[n]))}function oe(e){e&&e.c()}function se(e,r,n,o){const{fragment:s,after_update:a}=e.$$;s&&s.m(r,n),o||q((()=>{const r=e.$$.on_mount.map(t).filter(A);e.$$.on_destroy?e.$$.on_destroy.push(...r):i(r),e.$$.on_mount=[]})),a.forEach(q)}function ae(e,t){const r=e.$$;null!==r.fragment&&(!function(e){const t=[],r=[];V.forEach((n=>-1===e.indexOf(n)?t.push(n):r.push(n))),r.forEach((e=>e())),V=t}(r.after_update),i(r.on_destroy),r.fragment&&r.fragment.d(t),r.on_destroy=r.fragment=null,r.ctx=[])}function le(e,t){-1===e.$$.dirty[0]&&(O.push(e),G||(G=!0,N.then(J)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function ce(t,r,A,o,s,a,l,c=[-1]){const u=M;k(t);const h=t.$$={fragment:null,ctx:[],props:a,update:e,not_equal:s,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(r.context||(u?u.$$.context:[])),callbacks:n(),dirty:c,skip_bound:!1,root:r.target||u.$$.root};l&&l(h.root);let d=!1;if(h.ctx=A?A(t,r.props||{},((e,r,...n)=>{const i=n.length?n[0]:r;return h.ctx&&s(h.ctx[e],h.ctx[e]=i)&&(!h.skip_bound&&h.bound[e]&&h.bound[e](i),d&&le(t,e)),r})):[],h.update(),d=!0,i(h.before_update),h.fragment=!!o&&o(h.ctx),r.target){if(r.hydrate){const e=function(e){return Array.from(e.childNodes)}(r.target);h.fragment&&h.fragment.l(e),e.forEach(_)}else h.fragment&&h.fragment.c();r.intro&&ne(t.$$.fragment),se(t,r.target,r.anchor,r.customElement),J()}k(u)}class ue{$destroy(){ae(this,1),this.$destroy=e}$on(t,r){if(!A(r))return e;const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(r),()=>{const e=n.indexOf(r);-1!==e&&n.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function he(e,t){return function(){return e.apply(t,arguments)}}const{toString:de}=Object.prototype,{getPrototypeOf:pe}=Object,fe=(me=Object.create(null),e=>{const t=de.call(e);return me[t]||(me[t]=t.slice(8,-1).toLowerCase())});var me;const ge=e=>(e=e.toLowerCase(),t=>fe(t)===e),ye=e=>t=>typeof t===e,{isArray:_e}=Array,we=ye("undefined");const xe=ge("ArrayBuffer");const Be=ye("string"),ve=ye("function"),be=ye("number"),Ce=e=>null!==e&&"object"==typeof e,Fe=e=>{if("object"!==fe(e))return!1;const t=pe(e);return!(null!==t&&t!==Object.prototype&&null!==Object.getPrototypeOf(t)||Symbol.toStringTag in e||Symbol.iterator in e)},Ee=ge("Date"),Ue=ge("File"),Qe=ge("Blob"),Ie=ge("FileList"),Te=ge("URLSearchParams");function Se(e,t,{allOwnKeys:r=!1}={}){if(null==e)return;let n,i;if("object"!=typeof e&&(e=[e]),_e(e))for(n=0,i=e.length;n<i;n++)t.call(null,e[n],n,e);else{const i=r?Object.getOwnPropertyNames(e):Object.keys(e),A=i.length;let o;for(n=0;n<A;n++)o=i[n],t.call(null,e[o],o,e)}}function Me(e,t){t=t.toLowerCase();const r=Object.keys(e);let n,i=r.length;for(;i-- >0;)if(n=r[i],t===n.toLowerCase())return n;return null}const ke="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:global,De=e=>!we(e)&&e!==ke;const Le=(Pe="undefined"!=typeof Uint8Array&&pe(Uint8Array),e=>Pe&&e instanceof Pe);var Pe;const He=ge("HTMLFormElement"),ze=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),Re=ge("RegExp"),Oe=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),n={};Se(r,((r,i)=>{!1!==t(r,i,e)&&(n[i]=r)})),Object.defineProperties(e,n)},Ke="abcdefghijklmnopqrstuvwxyz",Ve="0123456789",$e={DIGIT:Ve,ALPHA:Ke,ALPHA_DIGIT:Ke+Ke.toUpperCase()+Ve};const Ne=ge("AsyncFunction");var Ge={isArray:_e,isArrayBuffer:xe,isBuffer:function(e){return null!==e&&!we(e)&&null!==e.constructor&&!we(e.constructor)&&ve(e.constructor.isBuffer)&&e.constructor.isBuffer(e)},isFormData:e=>{let t;return e&&("function"==typeof FormData&&e instanceof FormData||ve(e.append)&&("formdata"===(t=fe(e))||"object"===t&&ve(e.toString)&&"[object FormData]"===e.toString()))},isArrayBufferView:function(e){let t;return t="undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&xe(e.buffer),t},isString:Be,isNumber:be,isBoolean:e=>!0===e||!1===e,isObject:Ce,isPlainObject:Fe,isUndefined:we,isDate:Ee,isFile:Ue,isBlob:Qe,isRegExp:Re,isFunction:ve,isStream:e=>Ce(e)&&ve(e.pipe),isURLSearchParams:Te,isTypedArray:Le,isFileList:Ie,forEach:Se,merge:function e(){const{caseless:t}=De(this)&&this||{},r={},n=(n,i)=>{const A=t&&Me(r,i)||i;Fe(r[A])&&Fe(n)?r[A]=e(r[A],n):Fe(n)?r[A]=e({},n):_e(n)?r[A]=n.slice():r[A]=n};for(let e=0,t=arguments.length;e<t;e++)arguments[e]&&Se(arguments[e],n);return r},extend:(e,t,r,{allOwnKeys:n}={})=>(Se(t,((t,n)=>{r&&ve(t)?e[n]=he(t,r):e[n]=t}),{allOwnKeys:n}),e),trim:e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:e=>(65279===e.charCodeAt(0)&&(e=e.slice(1)),e),inherits:(e,t,r,n)=>{e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},toFlatObject:(e,t,r,n)=>{let i,A,o;const s={};if(t=t||{},null==e)return t;do{for(i=Object.getOwnPropertyNames(e),A=i.length;A-- >0;)o=i[A],n&&!n(o,e,t)||s[o]||(t[o]=e[o],s[o]=!0);e=!1!==r&&pe(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},kindOf:fe,kindOfTest:ge,endsWith:(e,t,r)=>{e=String(e),(void 0===r||r>e.length)&&(r=e.length),r-=t.length;const n=e.indexOf(t,r);return-1!==n&&n===r},toArray:e=>{if(!e)return null;if(_e(e))return e;let t=e.length;if(!be(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},forEachEntry:(e,t)=>{const r=(e&&e[Symbol.iterator]).call(e);let n;for(;(n=r.next())&&!n.done;){const r=n.value;t.call(e,r[0],r[1])}},matchAll:(e,t)=>{let r;const n=[];for(;null!==(r=e.exec(t));)n.push(r);return n},isHTMLForm:He,hasOwnProperty:ze,hasOwnProp:ze,reduceDescriptors:Oe,freezeMethods:e=>{Oe(e,((t,r)=>{if(ve(e)&&-1!==["arguments","caller","callee"].indexOf(r))return!1;const n=e[r];ve(n)&&(t.enumerable=!1,"writable"in t?t.writable=!1:t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")}))}))},toObjectSet:(e,t)=>{const r={},n=e=>{e.forEach((e=>{r[e]=!0}))};return _e(e)?n(e):n(String(e).split(t)),r},toCamelCase:e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,(function(e,t,r){return t.toUpperCase()+r})),noop:()=>{},toFiniteNumber:(e,t)=>(e=+e,Number.isFinite(e)?e:t),findKey:Me,global:ke,isContextDefined:De,ALPHABET:$e,generateString:(e=16,t=$e.ALPHA_DIGIT)=>{let r="";const{length:n}=t;for(;e--;)r+=t[Math.random()*n|0];return r},isSpecCompliantForm:function(e){return!!(e&&ve(e.append)&&"FormData"===e[Symbol.toStringTag]&&e[Symbol.iterator])},toJSONObject:e=>{const t=new Array(10),r=(e,n)=>{if(Ce(e)){if(t.indexOf(e)>=0)return;if(!("toJSON"in e)){t[n]=e;const i=_e(e)?[]:{};return Se(e,((e,t)=>{const A=r(e,n+1);!we(A)&&(i[t]=A)})),t[n]=void 0,i}}return e};return r(e,0)},isAsyncFn:Ne,isThenable:e=>e&&(Ce(e)||ve(e))&&ve(e.then)&&ve(e.catch)};function qe(e,t,r,n,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),n&&(this.request=n),i&&(this.response=i)}Ge.inherits(qe,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Ge.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const Xe=qe.prototype,je={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach((e=>{je[e]={value:e}})),Object.defineProperties(qe,je),Object.defineProperty(Xe,"isAxiosError",{value:!0}),qe.from=(e,t,r,n,i,A)=>{const o=Object.create(Xe);return Ge.toFlatObject(e,o,(function(e){return e!==Error.prototype}),(e=>"isAxiosError"!==e)),qe.call(o,e.message,t,r,n,i),o.cause=e,o.name=e.name,A&&Object.assign(o,A),o};function Ze(e){return Ge.isPlainObject(e)||Ge.isArray(e)}function Je(e){return Ge.endsWith(e,"[]")?e.slice(0,-2):e}function We(e,t,r){return e?e.concat(t).map((function(e,t){return e=Je(e),!r&&t?"["+e+"]":e})).join(r?".":""):t}const Ye=Ge.toFlatObject(Ge,{},null,(function(e){return/^is[A-Z]/.test(e)}));function et(e,t,r){if(!Ge.isObject(e))throw new TypeError("target must be an object");t=t||new FormData;const n=(r=Ge.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,(function(e,t){return!Ge.isUndefined(t[e])}))).metaTokens,i=r.visitor||l,A=r.dots,o=r.indexes,s=(r.Blob||"undefined"!=typeof Blob&&Blob)&&Ge.isSpecCompliantForm(t);if(!Ge.isFunction(i))throw new TypeError("visitor must be a function");function a(e){if(null===e)return"";if(Ge.isDate(e))return e.toISOString();if(!s&&Ge.isBlob(e))throw new qe("Blob is not supported. Use a Buffer instead.");return Ge.isArrayBuffer(e)||Ge.isTypedArray(e)?s&&"function"==typeof Blob?new Blob([e]):Buffer.from(e):e}function l(e,r,i){let s=e;if(e&&!i&&"object"==typeof e)if(Ge.endsWith(r,"{}"))r=n?r:r.slice(0,-2),e=JSON.stringify(e);else if(Ge.isArray(e)&&function(e){return Ge.isArray(e)&&!e.some(Ze)}(e)||(Ge.isFileList(e)||Ge.endsWith(r,"[]"))&&(s=Ge.toArray(e)))return r=Je(r),s.forEach((function(e,n){!Ge.isUndefined(e)&&null!==e&&t.append(!0===o?We([r],n,A):null===o?r:r+"[]",a(e))})),!1;return!!Ze(e)||(t.append(We(i,r,A),a(e)),!1)}const c=[],u=Object.assign(Ye,{defaultVisitor:l,convertValue:a,isVisitable:Ze});if(!Ge.isObject(e))throw new TypeError("data must be an object");return function e(r,n){if(!Ge.isUndefined(r)){if(-1!==c.indexOf(r))throw Error("Circular reference detected in "+n.join("."));c.push(r),Ge.forEach(r,(function(r,A){!0===(!(Ge.isUndefined(r)||null===r)&&i.call(t,r,Ge.isString(A)?A.trim():A,n,u))&&e(r,n?n.concat(A):[A])})),c.pop()}}(e),t}function tt(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,(function(e){return t[e]}))}function rt(e,t){this._pairs=[],e&&et(e,this,t)}const nt=rt.prototype;function it(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function At(e,t,r){if(!t)return e;const n=r&&r.encode||it,i=r&&r.serialize;let A;if(A=i?i(t,r):Ge.isURLSearchParams(t)?t.toString():new rt(t,r).toString(n),A){const t=e.indexOf("#");-1!==t&&(e=e.slice(0,t)),e+=(-1===e.indexOf("?")?"?":"&")+A}return e}nt.append=function(e,t){this._pairs.push([e,t])},nt.toString=function(e){const t=e?function(t){return e.call(this,t,tt)}:tt;return this._pairs.map((function(e){return t(e[0])+"="+t(e[1])}),"").join("&")};class ot{constructor(){this.handlers=[]}use(e,t,r){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!r&&r.synchronous,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){Ge.forEach(this.handlers,(function(t){null!==t&&e(t)}))}}var st={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1};var at={isBrowser:!0,classes:{URLSearchParams:"undefined"!=typeof URLSearchParams?URLSearchParams:rt,FormData:"undefined"!=typeof FormData?FormData:null,Blob:"undefined"!=typeof Blob?Blob:null},isStandardBrowserEnv:(()=>{let e;return("undefined"==typeof navigator||"ReactNative"!==(e=navigator.product)&&"NativeScript"!==e&&"NS"!==e)&&("undefined"!=typeof window&&"undefined"!=typeof document)})(),isStandardBrowserWebWorkerEnv:"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"==typeof self.importScripts,protocols:["http","https","file","blob","url","data"]};function lt(e){function t(e,r,n,i){let A=e[i++];const o=Number.isFinite(+A),s=i>=e.length;if(A=!A&&Ge.isArray(n)?n.length:A,s)return Ge.hasOwnProp(n,A)?n[A]=[n[A],r]:n[A]=r,!o;n[A]&&Ge.isObject(n[A])||(n[A]=[]);return t(e,r,n[A],i)&&Ge.isArray(n[A])&&(n[A]=function(e){const t={},r=Object.keys(e);let n;const i=r.length;let A;for(n=0;n<i;n++)A=r[n],t[A]=e[A];return t}(n[A])),!o}if(Ge.isFormData(e)&&Ge.isFunction(e.entries)){const r={};return Ge.forEachEntry(e,((e,n)=>{t(function(e){return Ge.matchAll(/\w+|\[(\w*)]/g,e).map((e=>"[]"===e[0]?"":e[1]||e[0]))}(e),n,r,0)})),r}return null}const ct={"Content-Type":void 0};const ut={transitional:st,adapter:["xhr","http"],transformRequest:[function(e,t){const r=t.getContentType()||"",n=r.indexOf("application/json")>-1,i=Ge.isObject(e);i&&Ge.isHTMLForm(e)&&(e=new FormData(e));if(Ge.isFormData(e))return n&&n?JSON.stringify(lt(e)):e;if(Ge.isArrayBuffer(e)||Ge.isBuffer(e)||Ge.isStream(e)||Ge.isFile(e)||Ge.isBlob(e))return e;if(Ge.isArrayBufferView(e))return e.buffer;if(Ge.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let A;if(i){if(r.indexOf("application/x-www-form-urlencoded")>-1)return function(e,t){return et(e,new at.classes.URLSearchParams,Object.assign({visitor:function(e,t,r,n){return n.defaultVisitor.apply(this,arguments)}},t))}(e,this.formSerializer).toString();if((A=Ge.isFileList(e))||r.indexOf("multipart/form-data")>-1){const t=this.env&&this.env.FormData;return et(A?{"files[]":e}:e,t&&new t,this.formSerializer)}}return i||n?(t.setContentType("application/json",!1),function(e,t,r){if(Ge.isString(e))try{return(t||JSON.parse)(e),Ge.trim(e)}catch(e){if("SyntaxError"!==e.name)throw e}return(r||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){const t=this.transitional||ut.transitional,r=t&&t.forcedJSONParsing,n="json"===this.responseType;if(e&&Ge.isString(e)&&(r&&!this.responseType||n)){const r=!(t&&t.silentJSONParsing)&&n;try{return JSON.parse(e)}catch(e){if(r){if("SyntaxError"===e.name)throw qe.from(e,qe.ERR_BAD_RESPONSE,this,null,this.response);throw e}}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:at.classes.FormData,Blob:at.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};Ge.forEach(["delete","get","head"],(function(e){ut.headers[e]={}})),Ge.forEach(["post","put","patch"],(function(e){ut.headers[e]=Ge.merge(ct)}));const ht=Ge.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]);const dt=Symbol("internals");function pt(e){return e&&String(e).trim().toLowerCase()}function ft(e){return!1===e||null==e?e:Ge.isArray(e)?e.map(ft):String(e)}function mt(e,t,r,n,i){return Ge.isFunction(n)?n.call(this,t,r):(i&&(t=r),Ge.isString(t)?Ge.isString(n)?-1!==t.indexOf(n):Ge.isRegExp(n)?n.test(t):void 0:void 0)}class gt{constructor(e){e&&this.set(e)}set(e,t,r){const n=this;function i(e,t,r){const i=pt(t);if(!i)throw new Error("header name must be a non-empty string");const A=Ge.findKey(n,i);(!A||void 0===n[A]||!0===r||void 0===r&&!1!==n[A])&&(n[A||t]=ft(e))}const A=(e,t)=>Ge.forEach(e,((e,r)=>i(e,r,t)));return Ge.isPlainObject(e)||e instanceof this.constructor?A(e,t):Ge.isString(e)&&(e=e.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim())?A((e=>{const t={};let r,n,i;return e&&e.split("\n").forEach((function(e){i=e.indexOf(":"),r=e.substring(0,i).trim().toLowerCase(),n=e.substring(i+1).trim(),!r||t[r]&&ht[r]||("set-cookie"===r?t[r]?t[r].push(n):t[r]=[n]:t[r]=t[r]?t[r]+", "+n:n)})),t})(e),t):null!=e&&i(t,e,r),this}get(e,t){if(e=pt(e)){const r=Ge.findKey(this,e);if(r){const e=this[r];if(!t)return e;if(!0===t)return function(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(e);)t[n[1]]=n[2];return t}(e);if(Ge.isFunction(t))return t.call(this,e,r);if(Ge.isRegExp(t))return t.exec(e);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=pt(e)){const r=Ge.findKey(this,e);return!(!r||void 0===this[r]||t&&!mt(0,this[r],r,t))}return!1}delete(e,t){const r=this;let n=!1;function i(e){if(e=pt(e)){const i=Ge.findKey(r,e);!i||t&&!mt(0,r[i],i,t)||(delete r[i],n=!0)}}return Ge.isArray(e)?e.forEach(i):i(e),n}clear(e){const t=Object.keys(this);let r=t.length,n=!1;for(;r--;){const i=t[r];e&&!mt(0,this[i],i,e,!0)||(delete this[i],n=!0)}return n}normalize(e){const t=this,r={};return Ge.forEach(this,((n,i)=>{const A=Ge.findKey(r,i);if(A)return t[A]=ft(n),void delete t[i];const o=e?function(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,((e,t,r)=>t.toUpperCase()+r))}(i):String(i).trim();o!==i&&delete t[i],t[o]=ft(n),r[o]=!0})),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return Ge.forEach(this,((r,n)=>{null!=r&&!1!==r&&(t[n]=e&&Ge.isArray(r)?r.join(", "):r)})),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map((([e,t])=>e+": "+t)).join("\n")}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const r=new this(e);return t.forEach((e=>r.set(e))),r}static accessor(e){const t=(this[dt]=this[dt]={accessors:{}}).accessors,r=this.prototype;function n(e){const n=pt(e);t[n]||(!function(e,t){const r=Ge.toCamelCase(" "+t);["get","set","has"].forEach((n=>{Object.defineProperty(e,n+r,{value:function(e,r,i){return this[n].call(this,t,e,r,i)},configurable:!0})}))}(r,e),t[n]=!0)}return Ge.isArray(e)?e.forEach(n):n(e),this}}function yt(e,t){const r=this||ut,n=t||r,i=gt.from(n.headers);let A=n.data;return Ge.forEach(e,(function(e){A=e.call(r,A,i.normalize(),t?t.status:void 0)})),i.normalize(),A}function _t(e){return!(!e||!e.__CANCEL__)}function wt(e,t,r){qe.call(this,null==e?"canceled":e,qe.ERR_CANCELED,t,r),this.name="CanceledError"}gt.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),Ge.freezeMethods(gt.prototype),Ge.freezeMethods(gt),Ge.inherits(wt,qe,{__CANCEL__:!0});var xt=at.isStandardBrowserEnv?{write:function(e,t,r,n,i,A){const o=[];o.push(e+"="+encodeURIComponent(t)),Ge.isNumber(r)&&o.push("expires="+new Date(r).toGMTString()),Ge.isString(n)&&o.push("path="+n),Ge.isString(i)&&o.push("domain="+i),!0===A&&o.push("secure"),document.cookie=o.join("; ")},read:function(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}};function Bt(e,t){return e&&!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)?function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}(e,t):t}var vt=at.isStandardBrowserEnv?function(){const e=/(msie|trident)/i.test(navigator.userAgent),t=document.createElement("a");let r;function n(r){let n=r;return e&&(t.setAttribute("href",n),n=t.href),t.setAttribute("href",n),{href:t.href,protocol:t.protocol?t.protocol.replace(/:$/,""):"",host:t.host,search:t.search?t.search.replace(/^\?/,""):"",hash:t.hash?t.hash.replace(/^#/,""):"",hostname:t.hostname,port:t.port,pathname:"/"===t.pathname.charAt(0)?t.pathname:"/"+t.pathname}}return r=n(window.location.href),function(e){const t=Ge.isString(e)?n(e):e;return t.protocol===r.protocol&&t.host===r.host}}():function(){return!0};function bt(e,t){let r=0;const n=function(e,t){e=e||10;const r=new Array(e),n=new Array(e);let i,A=0,o=0;return t=void 0!==t?t:1e3,function(s){const a=Date.now(),l=n[o];i||(i=a),r[A]=s,n[A]=a;let c=o,u=0;for(;c!==A;)u+=r[c++],c%=e;if(A=(A+1)%e,A===o&&(o=(o+1)%e),a-i<t)return;const h=l&&a-l;return h?Math.round(1e3*u/h):void 0}}(50,250);return i=>{const A=i.loaded,o=i.lengthComputable?i.total:void 0,s=A-r,a=n(s);r=A;const l={loaded:A,total:o,progress:o?A/o:void 0,bytes:s,rate:a||void 0,estimated:a&&o&&A<=o?(o-A)/a:void 0,event:i};l[t?"download":"upload"]=!0,e(l)}}var Ct="undefined"!=typeof XMLHttpRequest&&function(e){return new Promise((function(t,r){let n=e.data;const i=gt.from(e.headers).normalize(),A=e.responseType;let o;function s(){e.cancelToken&&e.cancelToken.unsubscribe(o),e.signal&&e.signal.removeEventListener("abort",o)}Ge.isFormData(n)&&(at.isStandardBrowserEnv||at.isStandardBrowserWebWorkerEnv?i.setContentType(!1):i.setContentType("multipart/form-data;",!1));let a=new XMLHttpRequest;if(e.auth){const t=e.auth.username||"",r=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";i.set("Authorization","Basic "+btoa(t+":"+r))}const l=Bt(e.baseURL,e.url);function c(){if(!a)return;const n=gt.from("getAllResponseHeaders"in a&&a.getAllResponseHeaders());!function(e,t,r){const n=r.config.validateStatus;r.status&&n&&!n(r.status)?t(new qe("Request failed with status code "+r.status,[qe.ERR_BAD_REQUEST,qe.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r)):e(r)}((function(e){t(e),s()}),(function(e){r(e),s()}),{data:A&&"text"!==A&&"json"!==A?a.response:a.responseText,status:a.status,statusText:a.statusText,headers:n,config:e,request:a}),a=null}if(a.open(e.method.toUpperCase(),At(l,e.params,e.paramsSerializer),!0),a.timeout=e.timeout,"onloadend"in a?a.onloadend=c:a.onreadystatechange=function(){a&&4===a.readyState&&(0!==a.status||a.responseURL&&0===a.responseURL.indexOf("file:"))&&setTimeout(c)},a.onabort=function(){a&&(r(new qe("Request aborted",qe.ECONNABORTED,e,a)),a=null)},a.onerror=function(){r(new qe("Network Error",qe.ERR_NETWORK,e,a)),a=null},a.ontimeout=function(){let t=e.timeout?"timeout of "+e.timeout+"ms exceeded":"timeout exceeded";const n=e.transitional||st;e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),r(new qe(t,n.clarifyTimeoutError?qe.ETIMEDOUT:qe.ECONNABORTED,e,a)),a=null},at.isStandardBrowserEnv){const t=(e.withCredentials||vt(l))&&e.xsrfCookieName&&xt.read(e.xsrfCookieName);t&&i.set(e.xsrfHeaderName,t)}void 0===n&&i.setContentType(null),"setRequestHeader"in a&&Ge.forEach(i.toJSON(),(function(e,t){a.setRequestHeader(t,e)})),Ge.isUndefined(e.withCredentials)||(a.withCredentials=!!e.withCredentials),A&&"json"!==A&&(a.responseType=e.responseType),"function"==typeof e.onDownloadProgress&&a.addEventListener("progress",bt(e.onDownloadProgress,!0)),"function"==typeof e.onUploadProgress&&a.upload&&a.upload.addEventListener("progress",bt(e.onUploadProgress)),(e.cancelToken||e.signal)&&(o=t=>{a&&(r(!t||t.type?new wt(null,e,a):t),a.abort(),a=null)},e.cancelToken&&e.cancelToken.subscribe(o),e.signal&&(e.signal.aborted?o():e.signal.addEventListener("abort",o)));const u=function(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}(l);u&&-1===at.protocols.indexOf(u)?r(new qe("Unsupported protocol "+u+":",qe.ERR_BAD_REQUEST,e)):a.send(n||null)}))};const Ft={http:null,xhr:Ct};Ge.forEach(Ft,((e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch(e){}Object.defineProperty(e,"adapterName",{value:t})}}));var Et=e=>{e=Ge.isArray(e)?e:[e];const{length:t}=e;let r,n;for(let i=0;i<t&&(r=e[i],!(n=Ge.isString(r)?Ft[r.toLowerCase()]:r));i++);if(!n){if(!1===n)throw new qe(`Adapter ${r} is not supported by the environment`,"ERR_NOT_SUPPORT");throw new Error(Ge.hasOwnProp(Ft,r)?`Adapter '${r}' is not available in the build`:`Unknown adapter '${r}'`)}if(!Ge.isFunction(n))throw new TypeError("adapter is not a function");return n};function Ut(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new wt(null,e)}function Qt(e){Ut(e),e.headers=gt.from(e.headers),e.data=yt.call(e,e.transformRequest),-1!==["post","put","patch"].indexOf(e.method)&&e.headers.setContentType("application/x-www-form-urlencoded",!1);return Et(e.adapter||ut.adapter)(e).then((function(t){return Ut(e),t.data=yt.call(e,e.transformResponse,t),t.headers=gt.from(t.headers),t}),(function(t){return _t(t)||(Ut(e),t&&t.response&&(t.response.data=yt.call(e,e.transformResponse,t.response),t.response.headers=gt.from(t.response.headers))),Promise.reject(t)}))}const It=e=>e instanceof gt?e.toJSON():e;function Tt(e,t){t=t||{};const r={};function n(e,t,r){return Ge.isPlainObject(e)&&Ge.isPlainObject(t)?Ge.merge.call({caseless:r},e,t):Ge.isPlainObject(t)?Ge.merge({},t):Ge.isArray(t)?t.slice():t}function i(e,t,r){return Ge.isUndefined(t)?Ge.isUndefined(e)?void 0:n(void 0,e,r):n(e,t,r)}function A(e,t){if(!Ge.isUndefined(t))return n(void 0,t)}function o(e,t){return Ge.isUndefined(t)?Ge.isUndefined(e)?void 0:n(void 0,e):n(void 0,t)}function s(r,i,A){return A in t?n(r,i):A in e?n(void 0,r):void 0}const a={url:A,method:A,data:A,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:s,headers:(e,t)=>i(It(e),It(t),!0)};return Ge.forEach(Object.keys(Object.assign({},e,t)),(function(n){const A=a[n]||i,o=A(e[n],t[n],n);Ge.isUndefined(o)&&A!==s||(r[n]=o)})),r}const St="1.4.0",Mt={};["object","boolean","number","function","string","symbol"].forEach(((e,t)=>{Mt[e]=function(r){return typeof r===e||"a"+(t<1?"n ":" ")+e}}));const kt={};Mt.transitional=function(e,t,r){function n(e,t){return"[Axios v1.4.0] Transitional option '"+e+"'"+t+(r?". "+r:"")}return(r,i,A)=>{if(!1===e)throw new qe(n(i," has been removed"+(t?" in "+t:"")),qe.ERR_DEPRECATED);return t&&!kt[i]&&(kt[i]=!0,console.warn(n(i," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(r,i,A)}};var Dt={assertOptions:function(e,t,r){if("object"!=typeof e)throw new qe("options must be an object",qe.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let i=n.length;for(;i-- >0;){const A=n[i],o=t[A];if(o){const t=e[A],r=void 0===t||o(t,A,e);if(!0!==r)throw new qe("option "+A+" must be "+r,qe.ERR_BAD_OPTION_VALUE)}else if(!0!==r)throw new qe("Unknown option "+A,qe.ERR_BAD_OPTION)}},validators:Mt};const Lt=Dt.validators;class Pt{constructor(e){this.defaults=e,this.interceptors={request:new ot,response:new ot}}request(e,t){"string"==typeof e?(t=t||{}).url=e:t=e||{},t=Tt(this.defaults,t);const{transitional:r,paramsSerializer:n,headers:i}=t;let A;void 0!==r&&Dt.assertOptions(r,{silentJSONParsing:Lt.transitional(Lt.boolean),forcedJSONParsing:Lt.transitional(Lt.boolean),clarifyTimeoutError:Lt.transitional(Lt.boolean)},!1),null!=n&&(Ge.isFunction(n)?t.paramsSerializer={serialize:n}:Dt.assertOptions(n,{encode:Lt.function,serialize:Lt.function},!0)),t.method=(t.method||this.defaults.method||"get").toLowerCase(),A=i&&Ge.merge(i.common,i[t.method]),A&&Ge.forEach(["delete","get","head","post","put","patch","common"],(e=>{delete i[e]})),t.headers=gt.concat(A,i);const o=[];let s=!0;this.interceptors.request.forEach((function(e){"function"==typeof e.runWhen&&!1===e.runWhen(t)||(s=s&&e.synchronous,o.unshift(e.fulfilled,e.rejected))}));const a=[];let l;this.interceptors.response.forEach((function(e){a.push(e.fulfilled,e.rejected)}));let c,u=0;if(!s){const e=[Qt.bind(this),void 0];for(e.unshift.apply(e,o),e.push.apply(e,a),c=e.length,l=Promise.resolve(t);u<c;)l=l.then(e[u++],e[u++]);return l}c=o.length;let h=t;for(u=0;u<c;){const e=o[u++],t=o[u++];try{h=e(h)}catch(e){t.call(this,e);break}}try{l=Qt.call(this,h)}catch(e){return Promise.reject(e)}for(u=0,c=a.length;u<c;)l=l.then(a[u++],a[u++]);return l}getUri(e){return At(Bt((e=Tt(this.defaults,e)).baseURL,e.url),e.params,e.paramsSerializer)}}Ge.forEach(["delete","get","head","options"],(function(e){Pt.prototype[e]=function(t,r){return this.request(Tt(r||{},{method:e,url:t,data:(r||{}).data}))}})),Ge.forEach(["post","put","patch"],(function(e){function t(t){return function(r,n,i){return this.request(Tt(i||{},{method:e,headers:t?{"Content-Type":"multipart/form-data"}:{},url:r,data:n}))}}Pt.prototype[e]=t(),Pt.prototype[e+"Form"]=t(!0)}));class Ht{constructor(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");let t;this.promise=new Promise((function(e){t=e}));const r=this;this.promise.then((e=>{if(!r._listeners)return;let t=r._listeners.length;for(;t-- >0;)r._listeners[t](e);r._listeners=null})),this.promise.then=e=>{let t;const n=new Promise((e=>{r.subscribe(e),t=e})).then(e);return n.cancel=function(){r.unsubscribe(t)},n},e((function(e,n,i){r.reason||(r.reason=new wt(e,n,i),t(r.reason))}))}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}static source(){let e;return{token:new Ht((function(t){e=t})),cancel:e}}}const zt={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(zt).forEach((([e,t])=>{zt[t]=e}));const Rt=function e(t){const r=new Pt(t),n=he(Pt.prototype.request,r);return Ge.extend(n,Pt.prototype,r,{allOwnKeys:!0}),Ge.extend(n,r,null,{allOwnKeys:!0}),n.create=function(r){return e(Tt(t,r))},n}(ut);Rt.Axios=Pt,Rt.CanceledError=wt,Rt.CancelToken=Ht,Rt.isCancel=_t,Rt.VERSION=St,Rt.toFormData=et,Rt.AxiosError=qe,Rt.Cancel=Rt.CanceledError,Rt.all=function(e){return Promise.all(e)},Rt.spread=function(e){return function(t){return e.apply(null,t)}},Rt.isAxiosError=function(e){return Ge.isObject(e)&&!0===e.isAxiosError},Rt.mergeConfig=Tt,Rt.AxiosHeaders=gt,Rt.formToJSON=e=>lt(Ge.isHTMLForm(e)?new FormData(e):e),Rt.HttpStatusCode=zt,Rt.default=Rt;var Ot={},Kt={};function Vt(e){return new Function("d","return {"+e.map((function(e,t){return JSON.stringify(e)+": d["+t+'] || ""'})).join(",")+"}")}function $t(e){var t=Object.create(null),r=[];return e.forEach((function(e){for(var n in e)n in t||r.push(t[n]=n)})),r}function Nt(e,t){var r=e+"",n=r.length;return n<t?new Array(t-n+1).join(0)+r:r}function Gt(e){var t,r=e.getUTCHours(),n=e.getUTCMinutes(),i=e.getUTCSeconds(),A=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":((t=e.getUTCFullYear())<0?"-"+Nt(-t,6):t>9999?"+"+Nt(t,6):Nt(t,4))+"-"+Nt(e.getUTCMonth()+1,2)+"-"+Nt(e.getUTCDate(),2)+(A?"T"+Nt(r,2)+":"+Nt(n,2)+":"+Nt(i,2)+"."+Nt(A,3)+"Z":i?"T"+Nt(r,2)+":"+Nt(n,2)+":"+Nt(i,2)+"Z":n||r?"T"+Nt(r,2)+":"+Nt(n,2)+"Z":"")}var qt=function(e){var t=new RegExp('["'+e+"\n\r]"),r=e.charCodeAt(0);function n(e,t){var n,i=[],A=e.length,o=0,s=0,a=A<=0,l=!1;function c(){if(a)return Kt;if(l)return l=!1,Ot;var t,n,i=o;if(34===e.charCodeAt(i)){for(;o++<A&&34!==e.charCodeAt(o)||34===e.charCodeAt(++o););return(t=o)>=A?a=!0:10===(n=e.charCodeAt(o++))?l=!0:13===n&&(l=!0,10===e.charCodeAt(o)&&++o),e.slice(i+1,t-1).replace(/""/g,'"')}for(;o<A;){if(10===(n=e.charCodeAt(t=o++)))l=!0;else if(13===n)l=!0,10===e.charCodeAt(o)&&++o;else if(n!==r)continue;return e.slice(i,t)}return a=!0,e.slice(i,A)}for(10===e.charCodeAt(A-1)&&--A,13===e.charCodeAt(A-1)&&--A;(n=c())!==Kt;){for(var u=[];n!==Ot&&n!==Kt;)u.push(n),n=c();t&&null==(u=t(u,s++))||i.push(u)}return i}function i(t,r){return t.map((function(t){return r.map((function(e){return o(t[e])})).join(e)}))}function A(t){return t.map(o).join(e)}function o(e){return null==e?"":e instanceof Date?Gt(e):t.test(e+="")?'"'+e.replace(/"/g,'""')+'"':e}return{parse:function(e,t){var r,i,A=n(e,(function(e,n){if(r)return r(e,n-1);i=e,r=t?function(e,t){var r=Vt(e);return function(n,i){return t(r(n),i,e)}}(e,t):Vt(e)}));return A.columns=i||[],A},parseRows:n,format:function(t,r){return null==r&&(r=$t(t)),[r.map(o).join(e)].concat(i(t,r)).join("\n")},formatBody:function(e,t){return null==t&&(t=$t(e)),i(e,t).join("\n")},formatRows:function(e){return e.map(A).join("\n")},formatRow:A,formatValue:o}}(","),Xt=qt.parse;function jt(e){return e}function Zt(e,t){var r=t.id,n=t.bbox,i=null==t.properties?{}:t.properties,A=function(e,t){var r=function(e){if(null==e)return jt;var t,r,n=e.scale[0],i=e.scale[1],A=e.translate[0],o=e.translate[1];return function(e,s){s||(t=r=0);var a=2,l=e.length,c=new Array(l);for(c[0]=(t+=e[0])*n+A,c[1]=(r+=e[1])*i+o;a<l;)c[a]=e[a],++a;return c}}(e.transform),n=e.arcs;function i(e,t){t.length&&t.pop();for(var i=n[e<0?~e:e],A=0,o=i.length;A<o;++A)t.push(r(i[A],A));e<0&&function(e,t){for(var r,n=e.length,i=n-t;i<--n;)r=e[i],e[i++]=e[n],e[n]=r}(t,o)}function A(e){return r(e)}function o(e){for(var t=[],r=0,n=e.length;r<n;++r)i(e[r],t);return t.length<2&&t.push(t[0]),t}function s(e){for(var t=o(e);t.length<4;)t.push(t[0]);return t}function a(e){return e.map(s)}function l(e){var t,r=e.type;switch(r){case"GeometryCollection":return{type:r,geometries:e.geometries.map(l)};case"Point":t=A(e.coordinates);break;case"MultiPoint":t=e.coordinates.map(A);break;case"LineString":t=o(e.arcs);break;case"MultiLineString":t=e.arcs.map(o);break;case"Polygon":t=a(e.arcs);break;case"MultiPolygon":t=e.arcs.map(a);break;default:return null}return{type:r,coordinates:t}}return l(t)}(e,t);return null==r&&null==n?{type:"Feature",properties:i,geometry:A}:null==n?{type:"Feature",id:r,properties:i,geometry:A}:{type:"Feature",id:r,bbox:n,properties:i,geometry:A}}async function Jt(e,t){let r=await fetch(e),n=await r.json();var i,A;return await(i=n,A=t,"string"==typeof A&&(A=i.objects[A]),"GeometryCollection"===A.type?{type:"FeatureCollection",features:A.geometries.map((function(e){return Zt(i,e)}))}:Zt(i,A))}const Wt={light:{text:"#222",muted:"#777",pale:"#f0f0f0",background:"#fff"},dark:{text:"#fff",muted:"#bbb",pale:"#333",background:"#222"},lightblue:{text:"#206095",muted:"#707070",pale:"#f0f0f0",background:"rgb(188, 207, 222)"},elegant:{text:"#f8f8f8",muted:"#b7b7b7",pale:"#6d6d6d",background:"#282828"}},Yt={seq:["rgb(234, 236, 177)","rgb(169, 216, 145)","rgb(0, 167, 186)","rgb(0, 78, 166)","rgb(0, 13, 84)"],cat:["#206095","#A8BD3A","#003C57","#27A0CC","#118C7B","#F66068","#746CB1","#22D0B6","lightgrey"]},er=[];function tr(e,t){return null==e||null==t?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function rr(e,t){return null==e||null==t?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function nr(e){let t,r,n;function i(e,n,i=0,A=e.length){if(i<A){if(0!==t(n,n))return A;do{const t=i+A>>>1;r(e[t],n)<0?i=t+1:A=t}while(i<A)}return i}return 2!==e.length?(t=tr,r=(t,r)=>tr(e(t),r),n=(t,r)=>e(t)-r):(t=e===tr||e===rr?e:ir,r=e,n=e),{left:i,center:function(e,t,r=0,A=e.length){const o=i(e,t,r,A-1);return o>r&&n(e[o-1],t)>-n(e[o],t)?o-1:o},right:function(e,n,i=0,A=e.length){if(i<A){if(0!==t(n,n))return A;do{const t=i+A>>>1;r(e[t],n)<=0?i=t+1:A=t}while(i<A)}return i}}}function ir(){return 0}const Ar=nr(tr).right,or=(nr((function(e){return null===e?NaN:+e})).center,Math.sqrt(50)),sr=Math.sqrt(10),ar=Math.sqrt(2);function lr(e,t,r){const n=(t-e)/Math.max(0,r),i=Math.floor(Math.log10(n)),A=n/Math.pow(10,i),o=A>=or?10:A>=sr?5:A>=ar?2:1;let s,a,l;return i<0?(l=Math.pow(10,-i)/o,s=Math.round(e*l),a=Math.round(t*l),s/l<e&&++s,a/l>t&&--a,l=-l):(l=Math.pow(10,i)*o,s=Math.round(e/l),a=Math.round(t/l),s*l<e&&++s,a*l>t&&--a),a<s&&.5<=r&&r<2?lr(e,t,2*r):[s,a,l]}function cr(e,t,r){return lr(e=+e,t=+t,r=+r)[2]}function ur(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}function hr(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function dr(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function pr(){}var fr=.7,mr=1/fr,gr="\\s*([+-]?\\d+)\\s*",yr="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",_r="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",wr=/^#([0-9a-f]{3,8})$/,xr=new RegExp(`^rgb\\(${gr},${gr},${gr}\\)$`),Br=new RegExp(`^rgb\\(${_r},${_r},${_r}\\)$`),vr=new RegExp(`^rgba\\(${gr},${gr},${gr},${yr}\\)$`),br=new RegExp(`^rgba\\(${_r},${_r},${_r},${yr}\\)$`),Cr=new RegExp(`^hsl\\(${yr},${_r},${_r}\\)$`),Fr=new RegExp(`^hsla\\(${yr},${_r},${_r},${yr}\\)$`),Er={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Ur(){return this.rgb().formatHex()}function Qr(){return this.rgb().formatRgb()}function Ir(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=wr.exec(e))?(r=t[1].length,t=parseInt(t[1],16),6===r?Tr(t):3===r?new Dr(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===r?Sr(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===r?Sr(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=xr.exec(e))?new Dr(t[1],t[2],t[3],1):(t=Br.exec(e))?new Dr(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=vr.exec(e))?Sr(t[1],t[2],t[3],t[4]):(t=br.exec(e))?Sr(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=Cr.exec(e))?Or(t[1],t[2]/100,t[3]/100,1):(t=Fr.exec(e))?Or(t[1],t[2]/100,t[3]/100,t[4]):Er.hasOwnProperty(e)?Tr(Er[e]):"transparent"===e?new Dr(NaN,NaN,NaN,0):null}function Tr(e){return new Dr(e>>16&255,e>>8&255,255&e,1)}function Sr(e,t,r,n){return n<=0&&(e=t=r=NaN),new Dr(e,t,r,n)}function Mr(e){return e instanceof pr||(e=Ir(e)),e?new Dr((e=e.rgb()).r,e.g,e.b,e.opacity):new Dr}function kr(e,t,r,n){return 1===arguments.length?Mr(e):new Dr(e,t,r,null==n?1:n)}function Dr(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}function Lr(){return`#${Rr(this.r)}${Rr(this.g)}${Rr(this.b)}`}function Pr(){const e=Hr(this.opacity);return`${1===e?"rgb(":"rgba("}${zr(this.r)}, ${zr(this.g)}, ${zr(this.b)}${1===e?")":`, ${e})`}`}function Hr(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function zr(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Rr(e){return((e=zr(e))<16?"0":"")+e.toString(16)}function Or(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new Vr(e,t,r,n)}function Kr(e){if(e instanceof Vr)return new Vr(e.h,e.s,e.l,e.opacity);if(e instanceof pr||(e=Ir(e)),!e)return new Vr;if(e instanceof Vr)return e;var t=(e=e.rgb()).r/255,r=e.g/255,n=e.b/255,i=Math.min(t,r,n),A=Math.max(t,r,n),o=NaN,s=A-i,a=(A+i)/2;return s?(o=t===A?(r-n)/s+6*(r<n):r===A?(n-t)/s+2:(t-r)/s+4,s/=a<.5?A+i:2-A-i,o*=60):s=a>0&&a<1?0:o,new Vr(o,s,a,e.opacity)}function Vr(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}function $r(e){return(e=(e||0)%360)<0?e+360:e}function Nr(e){return Math.max(0,Math.min(1,e||0))}function Gr(e,t,r){return 255*(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)}hr(pr,Ir,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Ur,formatHex:Ur,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return Kr(this).formatHsl()},formatRgb:Qr,toString:Qr}),hr(Dr,kr,dr(pr,{brighter(e){return e=null==e?mr:Math.pow(mr,e),new Dr(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=null==e?fr:Math.pow(fr,e),new Dr(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Dr(zr(this.r),zr(this.g),zr(this.b),Hr(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Lr,formatHex:Lr,formatHex8:function(){return`#${Rr(this.r)}${Rr(this.g)}${Rr(this.b)}${Rr(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:Pr,toString:Pr})),hr(Vr,(function(e,t,r,n){return 1===arguments.length?Kr(e):new Vr(e,t,r,null==n?1:n)}),dr(pr,{brighter(e){return e=null==e?mr:Math.pow(mr,e),new Vr(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?fr:Math.pow(fr,e),new Vr(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,i=2*r-n;return new Dr(Gr(e>=240?e-240:e+120,i,n),Gr(e,i,n),Gr(e<120?e+240:e-120,i,n),this.opacity)},clamp(){return new Vr($r(this.h),Nr(this.s),Nr(this.l),Hr(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Hr(this.opacity);return`${1===e?"hsl(":"hsla("}${$r(this.h)}, ${100*Nr(this.s)}%, ${100*Nr(this.l)}%${1===e?")":`, ${e})`}`}}));const qr=Math.PI/180,Xr=180/Math.PI,jr=.96422,Zr=1,Jr=.82521,Wr=4/29,Yr=6/29,en=3*Yr*Yr,tn=Yr*Yr*Yr;function rn(e){if(e instanceof nn)return new nn(e.l,e.a,e.b,e.opacity);if(e instanceof cn)return un(e);e instanceof Dr||(e=Mr(e));var t,r,n=an(e.r),i=an(e.g),A=an(e.b),o=An((.2225045*n+.7168786*i+.0606169*A)/Zr);return n===i&&i===A?t=r=o:(t=An((.4360747*n+.3850649*i+.1430804*A)/jr),r=An((.0139322*n+.0971045*i+.7141733*A)/Jr)),new nn(116*o-16,500*(t-o),200*(o-r),e.opacity)}function nn(e,t,r,n){this.l=+e,this.a=+t,this.b=+r,this.opacity=+n}function An(e){return e>tn?Math.pow(e,1/3):e/en+Wr}function on(e){return e>Yr?e*e*e:en*(e-Wr)}function sn(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function an(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function ln(e,t,r,n){return 1===arguments.length?function(e){if(e instanceof cn)return new cn(e.h,e.c,e.l,e.opacity);if(e instanceof nn||(e=rn(e)),0===e.a&&0===e.b)return new cn(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*Xr;return new cn(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}(e):new cn(e,t,r,null==n?1:n)}function cn(e,t,r,n){this.h=+e,this.c=+t,this.l=+r,this.opacity=+n}function un(e){if(isNaN(e.h))return new nn(e.l,0,0,e.opacity);var t=e.h*qr;return new nn(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}hr(nn,(function(e,t,r,n){return 1===arguments.length?rn(e):new nn(e,t,r,null==n?1:n)}),dr(pr,{brighter(e){return new nn(this.l+18*(null==e?1:e),this.a,this.b,this.opacity)},darker(e){return new nn(this.l-18*(null==e?1:e),this.a,this.b,this.opacity)},rgb(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,r=isNaN(this.b)?e:e-this.b/200;return new Dr(sn(3.1338561*(t=jr*on(t))-1.6168667*(e=Zr*on(e))-.4906146*(r=Jr*on(r))),sn(-.9787684*t+1.9161415*e+.033454*r),sn(.0719453*t-.2289914*e+1.4052427*r),this.opacity)}})),hr(cn,ln,dr(pr,{brighter(e){return new cn(this.h,this.c,this.l+18*(null==e?1:e),this.opacity)},darker(e){return new cn(this.h,this.c,this.l-18*(null==e?1:e),this.opacity)},rgb(){return un(this).rgb()}}));var hn=e=>()=>e;function dn(e,t){return function(r){return e+r*t}}function pn(e){return 1==(e=+e)?fn:function(t,r){return r-t?function(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}(t,r,e):hn(isNaN(t)?r:t)}}function fn(e,t){var r=t-e;return r?dn(e,r):hn(isNaN(e)?t:e)}var mn=function e(t){var r=pn(t);function n(e,t){var n=r((e=kr(e)).r,(t=kr(t)).r),i=r(e.g,t.g),A=r(e.b,t.b),o=fn(e.opacity,t.opacity);return function(t){return e.r=n(t),e.g=i(t),e.b=A(t),e.opacity=o(t),e+""}}return n.gamma=e,n}(1);function gn(e,t){t||(t=[]);var r,n=e?Math.min(t.length,e.length):0,i=t.slice();return function(A){for(r=0;r<n;++r)i[r]=e[r]*(1-A)+t[r]*A;return i}}function yn(e,t){var r,n=t?t.length:0,i=e?Math.min(n,e.length):0,A=new Array(i),o=new Array(n);for(r=0;r<i;++r)A[r]=Cn(e[r],t[r]);for(;r<n;++r)o[r]=t[r];return function(e){for(r=0;r<i;++r)o[r]=A[r](e);return o}}function _n(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function wn(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function xn(e,t){var r,n={},i={};for(r in null!==e&&"object"==typeof e||(e={}),null!==t&&"object"==typeof t||(t={}),t)r in e?n[r]=Cn(e[r],t[r]):i[r]=t[r];return function(e){for(r in n)i[r]=n[r](e);return i}}var Bn=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,vn=new RegExp(Bn.source,"g");function bn(e,t){var r,n,i,A=Bn.lastIndex=vn.lastIndex=0,o=-1,s=[],a=[];for(e+="",t+="";(r=Bn.exec(e))&&(n=vn.exec(t));)(i=n.index)>A&&(i=t.slice(A,i),s[o]?s[o]+=i:s[++o]=i),(r=r[0])===(n=n[0])?s[o]?s[o]+=n:s[++o]=n:(s[++o]=null,a.push({i:o,x:wn(r,n)})),A=vn.lastIndex;return A<t.length&&(i=t.slice(A),s[o]?s[o]+=i:s[++o]=i),s.length<2?a[0]?function(e){return function(t){return e(t)+""}}(a[0].x):function(e){return function(){return e}}(t):(t=a.length,function(e){for(var r,n=0;n<t;++n)s[(r=a[n]).i]=r.x(e);return s.join("")})}function Cn(e,t){var r,n=typeof t;return null==t||"boolean"===n?hn(t):("number"===n?wn:"string"===n?(r=Ir(t))?(t=r,mn):bn:t instanceof Ir?mn:t instanceof Date?_n:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}(t)?gn:Array.isArray(t)?yn:"function"!=typeof t.valueOf&&"function"!=typeof t.toString||isNaN(t)?xn:wn)(e,t)}function Fn(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}var En,Un=180/Math.PI,Qn={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function In(e,t,r,n,i,A){var o,s,a;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(a=e*r+t*n)&&(r-=e*a,n-=t*a),(s=Math.sqrt(r*r+n*n))&&(r/=s,n/=s,a/=s),e*n<t*r&&(e=-e,t=-t,a=-a,o=-o),{translateX:i,translateY:A,rotate:Math.atan2(t,e)*Un,skewX:Math.atan(a)*Un,scaleX:o,scaleY:s}}function Tn(e,t,r,n){function i(e){return e.length?e.pop()+" ":""}return function(A,o){var s=[],a=[];return A=e(A),o=e(o),function(e,n,i,A,o,s){if(e!==i||n!==A){var a=o.push("translate(",null,t,null,r);s.push({i:a-4,x:wn(e,i)},{i:a-2,x:wn(n,A)})}else(i||A)&&o.push("translate("+i+t+A+r)}(A.translateX,A.translateY,o.translateX,o.translateY,s,a),function(e,t,r,A){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),A.push({i:r.push(i(r)+"rotate(",null,n)-2,x:wn(e,t)})):t&&r.push(i(r)+"rotate("+t+n)}(A.rotate,o.rotate,s,a),function(e,t,r,A){e!==t?A.push({i:r.push(i(r)+"skewX(",null,n)-2,x:wn(e,t)}):t&&r.push(i(r)+"skewX("+t+n)}(A.skewX,o.skewX,s,a),function(e,t,r,n,A,o){if(e!==r||t!==n){var s=A.push(i(A)+"scale(",null,",",null,")");o.push({i:s-4,x:wn(e,r)},{i:s-2,x:wn(t,n)})}else 1===r&&1===n||A.push(i(A)+"scale("+r+","+n+")")}(A.scaleX,A.scaleY,o.scaleX,o.scaleY,s,a),A=o=null,function(e){for(var t,r=-1,n=a.length;++r<n;)s[(t=a[r]).i]=t.x(e);return s.join("")}}}var Sn=Tn((function(e){const t=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Qn:In(t.a,t.b,t.c,t.d,t.e,t.f)}),"px, ","px)","deg)"),Mn=Tn((function(e){return null==e?Qn:(En||(En=document.createElementNS("http://www.w3.org/2000/svg","g")),En.setAttribute("transform",e),(e=En.transform.baseVal.consolidate())?In((e=e.matrix).a,e.b,e.c,e.d,e.e,e.f):Qn)}),", ",")",")");var kn=function(e){return function(t,r){var n=e((t=ln(t)).h,(r=ln(r)).h),i=fn(t.c,r.c),A=fn(t.l,r.l),o=fn(t.opacity,r.opacity);return function(e){return t.h=n(e),t.c=i(e),t.l=A(e),t.opacity=o(e),t+""}}}((function(e,t){var r=t-e;return r?dn(e,r>180||r<-180?r-360*Math.round(r/360):r):hn(isNaN(e)?t:e)}));function Dn(e){return+e}var Ln=[0,1];function Pn(e){return e}function Hn(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:function(e){return function(){return e}}(isNaN(t)?NaN:.5)}function zn(e,t,r){var n=e[0],i=e[1],A=t[0],o=t[1];return i<n?(n=Hn(i,n),A=r(o,A)):(n=Hn(n,i),A=r(A,o)),function(e){return A(n(e))}}function Rn(e,t,r){var n=Math.min(e.length,t.length)-1,i=new Array(n),A=new Array(n),o=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<n;)i[o]=Hn(e[o],e[o+1]),A[o]=r(t[o],t[o+1]);return function(t){var r=Ar(e,t,1,n)-1;return A[r](i[r](t))}}function On(){var e,t,r,n,i,A,o=Ln,s=Ln,a=Cn,l=Pn;function c(){var e=Math.min(o.length,s.length);return l!==Pn&&(l=function(e,t){var r;return e>t&&(r=e,e=t,t=r),function(r){return Math.max(e,Math.min(t,r))}}(o[0],o[e-1])),n=e>2?Rn:zn,i=A=null,u}function u(t){return null==t||isNaN(t=+t)?r:(i||(i=n(o.map(e),s,a)))(e(l(t)))}return u.invert=function(r){return l(t((A||(A=n(s,o.map(e),wn)))(r)))},u.domain=function(e){return arguments.length?(o=Array.from(e,Dn),c()):o.slice()},u.range=function(e){return arguments.length?(s=Array.from(e),c()):s.slice()},u.rangeRound=function(e){return s=Array.from(e),a=Fn,c()},u.clamp=function(e){return arguments.length?(l=!!e||Pn,c()):l!==Pn},u.interpolate=function(e){return arguments.length?(a=e,c()):a},u.unknown=function(e){return arguments.length?(r=e,u):r},function(r,n){return e=r,t=n,c()}}function Kn(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function Vn(e){return(e=Kn(Math.abs(e)))?e[1]:NaN}var $n,Nn=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Gn(e){if(!(t=Nn.exec(e)))throw new Error("invalid format: "+e);var t;return new qn({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function qn(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function Xn(e,t){var r=Kn(e,t);if(!r)return e+"";var n=r[0],i=r[1];return i<0?"0."+new Array(-i).join("0")+n:n.length>i+1?n.slice(0,i+1)+"."+n.slice(i+1):n+new Array(i-n.length+2).join("0")}Gn.prototype=qn.prototype,qn.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var jn={"%":(e,t)=>(100*e).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>Xn(100*e,t),r:Xn,s:function(e,t){var r=Kn(e,t);if(!r)return e+"";var n=r[0],i=r[1],A=i-($n=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,o=n.length;return A===o?n:A>o?n+new Array(A-o+1).join("0"):A>0?n.slice(0,A)+"."+n.slice(A):"0."+new Array(1-A).join("0")+Kn(e,Math.max(0,t+A-1))[0]},X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function Zn(e){return e}var Jn,Wn,Yn,ei=Array.prototype.map,ti=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function ri(e){var t,r,n=void 0===e.grouping||void 0===e.thousands?Zn:(t=ei.call(e.grouping,Number),r=e.thousands+"",function(e,n){for(var i=e.length,A=[],o=0,s=t[0],a=0;i>0&&s>0&&(a+s+1>n&&(s=Math.max(1,n-a)),A.push(e.substring(i-=s,i+s)),!((a+=s+1)>n));)s=t[o=(o+1)%t.length];return A.reverse().join(r)}),i=void 0===e.currency?"":e.currency[0]+"",A=void 0===e.currency?"":e.currency[1]+"",o=void 0===e.decimal?".":e.decimal+"",s=void 0===e.numerals?Zn:function(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}(ei.call(e.numerals,String)),a=void 0===e.percent?"%":e.percent+"",l=void 0===e.minus?"−":e.minus+"",c=void 0===e.nan?"NaN":e.nan+"";function u(e){var t=(e=Gn(e)).fill,r=e.align,u=e.sign,h=e.symbol,d=e.zero,p=e.width,f=e.comma,m=e.precision,g=e.trim,y=e.type;"n"===y?(f=!0,y="g"):jn[y]||(void 0===m&&(m=12),g=!0,y="g"),(d||"0"===t&&"="===r)&&(d=!0,t="0",r="=");var _="$"===h?i:"#"===h&&/[boxX]/.test(y)?"0"+y.toLowerCase():"",w="$"===h?A:/[%p]/.test(y)?a:"",x=jn[y],B=/[defgprs%]/.test(y);function v(e){var i,A,a,h=_,v=w;if("c"===y)v=x(e)+v,e="";else{var b=(e=+e)<0||1/e<0;if(e=isNaN(e)?c:x(Math.abs(e),m),g&&(e=function(e){e:for(var t,r=e.length,n=1,i=-1;n<r;++n)switch(e[n]){case".":i=t=n;break;case"0":0===i&&(i=n),t=n;break;default:if(!+e[n])break e;i>0&&(i=0)}return i>0?e.slice(0,i)+e.slice(t+1):e}(e)),b&&0==+e&&"+"!==u&&(b=!1),h=(b?"("===u?u:l:"-"===u||"("===u?"":u)+h,v=("s"===y?ti[8+$n/3]:"")+v+(b&&"("===u?")":""),B)for(i=-1,A=e.length;++i<A;)if(48>(a=e.charCodeAt(i))||a>57){v=(46===a?o+e.slice(i+1):e.slice(i))+v,e=e.slice(0,i);break}}f&&!d&&(e=n(e,1/0));var C=h.length+e.length+v.length,F=C<p?new Array(p-C+1).join(t):"";switch(f&&d&&(e=n(F+e,F.length?p-v.length:1/0),F=""),r){case"<":e=h+e+v+F;break;case"=":e=h+F+e+v;break;case"^":e=F.slice(0,C=F.length>>1)+h+e+v+F.slice(C);break;default:e=F+h+e+v}return s(e)}return m=void 0===m?6:/[gprs]/.test(y)?Math.max(1,Math.min(21,m)):Math.max(0,Math.min(20,m)),v.toString=function(){return e+""},v}return{format:u,formatPrefix:function(e,t){var r=u(((e=Gn(e)).type="f",e)),n=3*Math.max(-8,Math.min(8,Math.floor(Vn(t)/3))),i=Math.pow(10,-n),A=ti[8+n/3];return function(e){return r(i*e)+A}}}}function ni(e,t,r,n){var i,A=function(e,t,r){r=+r;const n=(t=+t)<(e=+e),i=n?cr(t,e,r):cr(e,t,r);return(n?-1:1)*(i<0?1/-i:i)}(e,t,r);switch((n=Gn(null==n?",f":n)).type){case"s":var o=Math.max(Math.abs(e),Math.abs(t));return null!=n.precision||isNaN(i=function(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Vn(t)/3)))-Vn(Math.abs(e)))}(A,o))||(n.precision=i),Yn(n,o);case"":case"e":case"g":case"p":case"r":null!=n.precision||isNaN(i=function(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Vn(t)-Vn(e))+1}(A,Math.max(Math.abs(e),Math.abs(t))))||(n.precision=i-("e"===n.type));break;case"f":case"%":null!=n.precision||isNaN(i=function(e){return Math.max(0,-Vn(Math.abs(e)))}(A))||(n.precision=i-2*("%"===n.type))}return Wn(n)}function ii(e){var t=e.domain;return e.ticks=function(e){var r=t();return function(e,t,r){if(!((r=+r)>0))return[];if((e=+e)==(t=+t))return[e];const n=t<e,[i,A,o]=n?lr(t,e,r):lr(e,t,r);if(!(A>=i))return[];const s=A-i+1,a=new Array(s);if(n)if(o<0)for(let e=0;e<s;++e)a[e]=(A-e)/-o;else for(let e=0;e<s;++e)a[e]=(A-e)*o;else if(o<0)for(let e=0;e<s;++e)a[e]=(i+e)/-o;else for(let e=0;e<s;++e)a[e]=(i+e)*o;return a}(r[0],r[r.length-1],null==e?10:e)},e.tickFormat=function(e,r){var n=t();return ni(n[0],n[n.length-1],null==e?10:e,r)},e.nice=function(r){null==r&&(r=10);var n,i,A=t(),o=0,s=A.length-1,a=A[o],l=A[s],c=10;for(l<a&&(i=a,a=l,l=i,i=o,o=s,s=i);c-- >0;){if((i=cr(a,l,r))===n)return A[o]=a,A[s]=l,t(A);if(i>0)a=Math.floor(a/i)*i,l=Math.ceil(l/i)*i;else{if(!(i<0))break;a=Math.ceil(a*i)/i,l=Math.floor(l*i)/i}n=i}return e},e}function Ai(){var e=On()(Pn,Pn);return e.copy=function(){return t=e,Ai().domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown());var t},ur.apply(e,arguments),ii(e)}function oi(){var e,t=[.5],r=[0,1],n=1;function i(i){return null!=i&&i<=i?r[Ar(t,i,0,n)]:e}return i.domain=function(e){return arguments.length?(t=Array.from(e),n=Math.min(t.length,r.length-1),i):t.slice()},i.range=function(e){return arguments.length?(r=Array.from(e),n=Math.min(t.length,r.length-1),i):r.slice()},i.invertExtent=function(e){var n=r.indexOf(e);return[t[n-1],t[n]]},i.unknown=function(t){return arguments.length?(e=t,i):e},i.copy=function(){return oi().domain(t).range(r).unknown(e)},ur.apply(i,arguments)}Jn=ri({thousands:",",grouping:[3],currency:["$",""]}),Wn=Jn.format,Yn=Jn.formatPrefix;"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;function si(e,t,r){return e(r={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==t&&r.path)}},r.exports),r.exports}si((function(e,t){
/*!
     * html2canvas 1.4.1 <https://html2canvas.hertzen.com>
     * Copyright (c) 2022 Niklas von Hertzen <https://hertzen.com>
     * Released under MIT License
     */
e.exports=function(){
/*! *****************************************************************************
        Copyright (c) Microsoft Corporation.

        Permission to use, copy, modify, and/or distribute this software for any
        purpose with or without fee is hereby granted.

        THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
        REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
        AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
        INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
        LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
        OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
        PERFORMANCE OF THIS SOFTWARE.
        ***************************************************************************** */
var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};function t(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}var r=function(){return r=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)};function n(e,t,r,n){function i(e){return e instanceof r?e:new r((function(t){t(e)}))}return new(r||(r=Promise))((function(r,A){function o(e){try{a(n.next(e))}catch(e){A(e)}}function s(e){try{a(n.throw(e))}catch(e){A(e)}}function a(e){e.done?r(e.value):i(e.value).then(o,s)}a((n=n.apply(e,t||[])).next())}))}function i(e,t){var r,n,i,A,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return A={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(A[Symbol.iterator]=function(){return this}),A;function s(e){return function(t){return a([e,t])}}function a(A){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(i=2&A[0]?n.return:A[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,A[1])).done)return i;switch(n=0,i&&(A=[2&A[0],i.value]),A[0]){case 0:case 1:i=A;break;case 4:return o.label++,{value:A[1],done:!1};case 5:o.label++,n=A[1],A=[0];continue;case 7:A=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==A[0]&&2!==A[0])){o=0;continue}if(3===A[0]&&(!i||A[1]>i[0]&&A[1]<i[3])){o.label=A[1];break}if(6===A[0]&&o.label<i[1]){o.label=i[1],i=A;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(A);break}i[2]&&o.ops.pop(),o.trys.pop();continue}A=t.call(e,o)}catch(e){A=[6,e],n=0}finally{r=i=0}if(5&A[0])throw A[1];return{value:A[0]?A[1]:void 0,done:!0}}}function A(e,t,r){if(r||2===arguments.length)for(var n,i=0,A=t.length;i<A;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||t)}for(var o=function(){function e(e,t,r,n){this.left=e,this.top=t,this.width=r,this.height=n}return e.prototype.add=function(t,r,n,i){return new e(this.left+t,this.top+r,this.width+n,this.height+i)},e.fromClientRect=function(t,r){return new e(r.left+t.windowBounds.left,r.top+t.windowBounds.top,r.width,r.height)},e.fromDOMRectList=function(t,r){var n=Array.from(r).find((function(e){return 0!==e.width}));return n?new e(n.left+t.windowBounds.left,n.top+t.windowBounds.top,n.width,n.height):e.EMPTY},e.EMPTY=new e(0,0,0,0),e}(),s=function(e,t){return o.fromClientRect(e,t.getBoundingClientRect())},a=function(e){var t=e.body,r=e.documentElement;if(!t||!r)throw new Error("Unable to get document size");var n=Math.max(Math.max(t.scrollWidth,r.scrollWidth),Math.max(t.offsetWidth,r.offsetWidth),Math.max(t.clientWidth,r.clientWidth)),i=Math.max(Math.max(t.scrollHeight,r.scrollHeight),Math.max(t.offsetHeight,r.offsetHeight),Math.max(t.clientHeight,r.clientHeight));return new o(0,0,n,i)},l=function(e){for(var t=[],r=0,n=e.length;r<n;){var i=e.charCodeAt(r++);if(i>=55296&&i<=56319&&r<n){var A=e.charCodeAt(r++);56320==(64512&A)?t.push(((1023&i)<<10)+(1023&A)+65536):(t.push(i),r--)}else t.push(i)}return t},c=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(String.fromCodePoint)return String.fromCodePoint.apply(String,e);var r=e.length;if(!r)return"";for(var n=[],i=-1,A="";++i<r;){var o=e[i];o<=65535?n.push(o):(o-=65536,n.push(55296+(o>>10),o%1024+56320)),(i+1===r||n.length>16384)&&(A+=String.fromCharCode.apply(String,n),n.length=0)}return A},u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",h="undefined"==typeof Uint8Array?[]:new Uint8Array(256),d=0;d<u.length;d++)h[u.charCodeAt(d)]=d;for(var p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",f="undefined"==typeof Uint8Array?[]:new Uint8Array(256),m=0;m<p.length;m++)f[p.charCodeAt(m)]=m;for(var g=function(e){var t,r,n,i,A,o=.75*e.length,s=e.length,a=0;"="===e[e.length-1]&&(o--,"="===e[e.length-2]&&o--);var l="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array&&void 0!==Uint8Array.prototype.slice?new ArrayBuffer(o):new Array(o),c=Array.isArray(l)?l:new Uint8Array(l);for(t=0;t<s;t+=4)r=f[e.charCodeAt(t)],n=f[e.charCodeAt(t+1)],i=f[e.charCodeAt(t+2)],A=f[e.charCodeAt(t+3)],c[a++]=r<<2|n>>4,c[a++]=(15&n)<<4|i>>2,c[a++]=(3&i)<<6|63&A;return l},y=function(e){for(var t=e.length,r=[],n=0;n<t;n+=2)r.push(e[n+1]<<8|e[n]);return r},_=function(e){for(var t=e.length,r=[],n=0;n<t;n+=4)r.push(e[n+3]<<24|e[n+2]<<16|e[n+1]<<8|e[n]);return r},w=5,x=11,B=2,v=65536>>w,b=(1<<w)-1,C=v+(1024>>w)+32,F=65536>>x,E=(1<<x-w)-1,U=function(e,t,r){return e.slice?e.slice(t,r):new Uint16Array(Array.prototype.slice.call(e,t,r))},Q=function(e,t,r){return e.slice?e.slice(t,r):new Uint32Array(Array.prototype.slice.call(e,t,r))},I=function(e,t){var r=g(e),n=Array.isArray(r)?_(r):new Uint32Array(r),i=Array.isArray(r)?y(r):new Uint16Array(r),A=24,o=U(i,A/2,n[4]/2),s=2===n[5]?U(i,(A+n[4])/2):Q(n,Math.ceil((A+n[4])/4));return new T(n[0],n[1],n[2],n[3],o,s)},T=function(){function e(e,t,r,n,i,A){this.initialValue=e,this.errorValue=t,this.highStart=r,this.highValueIndex=n,this.index=i,this.data=A}return e.prototype.get=function(e){var t;if(e>=0){if(e<55296||e>56319&&e<=65535)return t=((t=this.index[e>>w])<<B)+(e&b),this.data[t];if(e<=65535)return t=((t=this.index[v+(e-55296>>w)])<<B)+(e&b),this.data[t];if(e<this.highStart)return t=C-F+(e>>x),t=this.index[t],t+=e>>w&E,t=((t=this.index[t])<<B)+(e&b),this.data[t];if(e<=1114111)return this.data[this.highValueIndex]}return this.errorValue},e}(),S="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",M="undefined"==typeof Uint8Array?[]:new Uint8Array(256),k=0;k<S.length;k++)M[S.charCodeAt(k)]=k;var D=50,L=1,P=2,H=3,z=4,R=5,O=7,K=8,V=9,$=10,N=11,G=12,q=13,X=14,j=15,Z=16,J=17,W=18,Y=19,ee=20,te=21,re=22,ne=23,ie=24,Ae=25,oe=26,se=27,ae=28,le=29,ce=30,ue=31,he=32,de=33,pe=34,fe=35,me=36,ge=37,ye=38,_e=39,we=40,xe=41,Be=42,ve=43,be=[9001,65288],Ce="!",Fe="×",Ee="÷",Ue=I("KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA=="),Qe=[ce,me],Ie=[L,P,H,R],Te=[$,K],Se=[se,oe],Me=Ie.concat(Te),ke=[ye,_e,we,pe,fe],De=[j,q],Le=function(e,t){void 0===t&&(t="strict");var r=[],n=[],i=[];return e.forEach((function(e,A){var o=Ue.get(e);if(o>D?(i.push(!0),o-=D):i.push(!1),-1!==["normal","auto","loose"].indexOf(t)&&-1!==[8208,8211,12316,12448].indexOf(e))return n.push(A),r.push(Z);if(o===z||o===N){if(0===A)return n.push(A),r.push(ce);var s=r[A-1];return-1===Me.indexOf(s)?(n.push(n[A-1]),r.push(s)):(n.push(A),r.push(ce))}return n.push(A),o===ue?r.push("strict"===t?te:ge):o===Be||o===le?r.push(ce):o===ve?e>=131072&&e<=196605||e>=196608&&e<=262141?r.push(ge):r.push(ce):void r.push(o)})),[n,r,i]},Pe=function(e,t,r,n){var i=n[r];if(Array.isArray(e)?-1!==e.indexOf(i):e===i)for(var A=r;A<=n.length;){if((a=n[++A])===t)return!0;if(a!==$)break}if(i===$)for(A=r;A>0;){var o=n[--A];if(Array.isArray(e)?-1!==e.indexOf(o):e===o)for(var s=r;s<=n.length;){var a;if((a=n[++s])===t)return!0;if(a!==$)break}if(o!==$)break}return!1},He=function(e,t){for(var r=e;r>=0;){var n=t[r];if(n!==$)return n;r--}return 0},ze=function(e,t,r,n,i){if(0===r[n])return Fe;var A=n-1;if(Array.isArray(i)&&!0===i[A])return Fe;var o=A-1,s=A+1,a=t[A],l=o>=0?t[o]:0,c=t[s];if(a===P&&c===H)return Fe;if(-1!==Ie.indexOf(a))return Ce;if(-1!==Ie.indexOf(c))return Fe;if(-1!==Te.indexOf(c))return Fe;if(He(A,t)===K)return Ee;if(Ue.get(e[A])===N)return Fe;if((a===he||a===de)&&Ue.get(e[s])===N)return Fe;if(a===O||c===O)return Fe;if(a===V)return Fe;if(-1===[$,q,j].indexOf(a)&&c===V)return Fe;if(-1!==[J,W,Y,ie,ae].indexOf(c))return Fe;if(He(A,t)===re)return Fe;if(Pe(ne,re,A,t))return Fe;if(Pe([J,W],te,A,t))return Fe;if(Pe(G,G,A,t))return Fe;if(a===$)return Ee;if(a===ne||c===ne)return Fe;if(c===Z||a===Z)return Ee;if(-1!==[q,j,te].indexOf(c)||a===X)return Fe;if(l===me&&-1!==De.indexOf(a))return Fe;if(a===ae&&c===me)return Fe;if(c===ee)return Fe;if(-1!==Qe.indexOf(c)&&a===Ae||-1!==Qe.indexOf(a)&&c===Ae)return Fe;if(a===se&&-1!==[ge,he,de].indexOf(c)||-1!==[ge,he,de].indexOf(a)&&c===oe)return Fe;if(-1!==Qe.indexOf(a)&&-1!==Se.indexOf(c)||-1!==Se.indexOf(a)&&-1!==Qe.indexOf(c))return Fe;if(-1!==[se,oe].indexOf(a)&&(c===Ae||-1!==[re,j].indexOf(c)&&t[s+1]===Ae)||-1!==[re,j].indexOf(a)&&c===Ae||a===Ae&&-1!==[Ae,ae,ie].indexOf(c))return Fe;if(-1!==[Ae,ae,ie,J,W].indexOf(c))for(var u=A;u>=0;){if((h=t[u])===Ae)return Fe;if(-1===[ae,ie].indexOf(h))break;u--}if(-1!==[se,oe].indexOf(c))for(u=-1!==[J,W].indexOf(a)?o:A;u>=0;){var h;if((h=t[u])===Ae)return Fe;if(-1===[ae,ie].indexOf(h))break;u--}if(ye===a&&-1!==[ye,_e,pe,fe].indexOf(c)||-1!==[_e,pe].indexOf(a)&&-1!==[_e,we].indexOf(c)||-1!==[we,fe].indexOf(a)&&c===we)return Fe;if(-1!==ke.indexOf(a)&&-1!==[ee,oe].indexOf(c)||-1!==ke.indexOf(c)&&a===se)return Fe;if(-1!==Qe.indexOf(a)&&-1!==Qe.indexOf(c))return Fe;if(a===ie&&-1!==Qe.indexOf(c))return Fe;if(-1!==Qe.concat(Ae).indexOf(a)&&c===re&&-1===be.indexOf(e[s])||-1!==Qe.concat(Ae).indexOf(c)&&a===W)return Fe;if(a===xe&&c===xe){for(var d=r[A],p=1;d>0&&t[--d]===xe;)p++;if(p%2!=0)return Fe}return a===he&&c===de?Fe:Ee},Re=function(e,t){t||(t={lineBreak:"normal",wordBreak:"normal"});var r=Le(e,t.lineBreak),n=r[0],i=r[1],A=r[2];"break-all"!==t.wordBreak&&"break-word"!==t.wordBreak||(i=i.map((function(e){return-1!==[Ae,ce,Be].indexOf(e)?ge:e})));var o="keep-all"===t.wordBreak?A.map((function(t,r){return t&&e[r]>=19968&&e[r]<=40959})):void 0;return[n,i,o]},Oe=function(){function e(e,t,r,n){this.codePoints=e,this.required=t===Ce,this.start=r,this.end=n}return e.prototype.slice=function(){return c.apply(void 0,this.codePoints.slice(this.start,this.end))},e}(),Ke=function(e,t){var r=l(e),n=Re(r,t),i=n[0],A=n[1],o=n[2],s=r.length,a=0,c=0;return{next:function(){if(c>=s)return{done:!0,value:null};for(var e=Fe;c<s&&(e=ze(r,A,i,++c,o))===Fe;);if(e!==Fe||c===s){var t=new Oe(r,e,a,c);return a=c,{value:t,done:!1}}return{done:!0,value:null}}}},Ve=1,$e=2,Ne=4,Ge=8,qe=10,Xe=47,je=92,Ze=9,Je=32,We=34,Ye=61,et=35,tt=36,rt=37,nt=39,it=40,At=41,ot=95,st=45,at=33,lt=60,ct=62,ut=64,ht=91,dt=93,pt=61,ft=123,mt=63,gt=125,yt=124,_t=126,wt=128,xt=65533,Bt=42,vt=43,bt=44,Ct=58,Ft=59,Et=46,Ut=0,Qt=8,It=11,Tt=14,St=31,Mt=127,kt=-1,Dt=48,Lt=97,Pt=101,Ht=102,zt=117,Rt=122,Ot=65,Kt=69,Vt=70,$t=85,Nt=90,Gt=function(e){return e>=Dt&&e<=57},qt=function(e){return e>=55296&&e<=57343},Xt=function(e){return Gt(e)||e>=Ot&&e<=Vt||e>=Lt&&e<=Ht},jt=function(e){return e>=Lt&&e<=Rt},Zt=function(e){return e>=Ot&&e<=Nt},Jt=function(e){return jt(e)||Zt(e)},Wt=function(e){return e>=wt},Yt=function(e){return e===qe||e===Ze||e===Je},er=function(e){return Jt(e)||Wt(e)||e===ot},tr=function(e){return er(e)||Gt(e)||e===st},rr=function(e){return e>=Ut&&e<=Qt||e===It||e>=Tt&&e<=St||e===Mt},nr=function(e,t){return e===je&&t!==qe},ir=function(e,t,r){return e===st?er(t)||nr(t,r):!!er(e)||!(e!==je||!nr(e,t))},Ar=function(e,t,r){return e===vt||e===st?!!Gt(t)||t===Et&&Gt(r):Gt(e===Et?t:e)},or=function(e){var t=0,r=1;e[t]!==vt&&e[t]!==st||(e[t]===st&&(r=-1),t++);for(var n=[];Gt(e[t]);)n.push(e[t++]);var i=n.length?parseInt(c.apply(void 0,n),10):0;e[t]===Et&&t++;for(var A=[];Gt(e[t]);)A.push(e[t++]);var o=A.length,s=o?parseInt(c.apply(void 0,A),10):0;e[t]!==Kt&&e[t]!==Pt||t++;var a=1;e[t]!==vt&&e[t]!==st||(e[t]===st&&(a=-1),t++);for(var l=[];Gt(e[t]);)l.push(e[t++]);var u=l.length?parseInt(c.apply(void 0,l),10):0;return r*(i+s*Math.pow(10,-o))*Math.pow(10,a*u)},sr={type:2},ar={type:3},lr={type:4},cr={type:13},ur={type:8},hr={type:21},dr={type:9},pr={type:10},fr={type:11},mr={type:12},gr={type:14},yr={type:23},_r={type:1},wr={type:25},xr={type:24},Br={type:26},vr={type:27},br={type:28},Cr={type:29},Fr={type:31},Er={type:32},Ur=function(){function e(){this._value=[]}return e.prototype.write=function(e){this._value=this._value.concat(l(e))},e.prototype.read=function(){for(var e=[],t=this.consumeToken();t!==Er;)e.push(t),t=this.consumeToken();return e},e.prototype.consumeToken=function(){var e=this.consumeCodePoint();switch(e){case We:return this.consumeStringToken(We);case et:var t=this.peekCodePoint(0),r=this.peekCodePoint(1),n=this.peekCodePoint(2);if(tr(t)||nr(r,n)){var i=ir(t,r,n)?$e:Ve;return{type:5,value:this.consumeName(),flags:i}}break;case tt:if(this.peekCodePoint(0)===Ye)return this.consumeCodePoint(),cr;break;case nt:return this.consumeStringToken(nt);case it:return sr;case At:return ar;case Bt:if(this.peekCodePoint(0)===Ye)return this.consumeCodePoint(),gr;break;case vt:if(Ar(e,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(e),this.consumeNumericToken();break;case bt:return lr;case st:var A=e,o=this.peekCodePoint(0),s=this.peekCodePoint(1);if(Ar(A,o,s))return this.reconsumeCodePoint(e),this.consumeNumericToken();if(ir(A,o,s))return this.reconsumeCodePoint(e),this.consumeIdentLikeToken();if(o===st&&s===ct)return this.consumeCodePoint(),this.consumeCodePoint(),xr;break;case Et:if(Ar(e,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(e),this.consumeNumericToken();break;case Xe:if(this.peekCodePoint(0)===Bt)for(this.consumeCodePoint();;){var a=this.consumeCodePoint();if(a===Bt&&(a=this.consumeCodePoint())===Xe)return this.consumeToken();if(a===kt)return this.consumeToken()}break;case Ct:return Br;case Ft:return vr;case lt:if(this.peekCodePoint(0)===at&&this.peekCodePoint(1)===st&&this.peekCodePoint(2)===st)return this.consumeCodePoint(),this.consumeCodePoint(),wr;break;case ut:var l=this.peekCodePoint(0),u=this.peekCodePoint(1),h=this.peekCodePoint(2);if(ir(l,u,h))return{type:7,value:this.consumeName()};break;case ht:return br;case je:if(nr(e,this.peekCodePoint(0)))return this.reconsumeCodePoint(e),this.consumeIdentLikeToken();break;case dt:return Cr;case pt:if(this.peekCodePoint(0)===Ye)return this.consumeCodePoint(),ur;break;case ft:return fr;case gt:return mr;case zt:case $t:var d=this.peekCodePoint(0),p=this.peekCodePoint(1);return d!==vt||!Xt(p)&&p!==mt||(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(e),this.consumeIdentLikeToken();case yt:if(this.peekCodePoint(0)===Ye)return this.consumeCodePoint(),dr;if(this.peekCodePoint(0)===yt)return this.consumeCodePoint(),hr;break;case _t:if(this.peekCodePoint(0)===Ye)return this.consumeCodePoint(),pr;break;case kt:return Er}return Yt(e)?(this.consumeWhiteSpace(),Fr):Gt(e)?(this.reconsumeCodePoint(e),this.consumeNumericToken()):er(e)?(this.reconsumeCodePoint(e),this.consumeIdentLikeToken()):{type:6,value:c(e)}},e.prototype.consumeCodePoint=function(){var e=this._value.shift();return void 0===e?-1:e},e.prototype.reconsumeCodePoint=function(e){this._value.unshift(e)},e.prototype.peekCodePoint=function(e){return e>=this._value.length?-1:this._value[e]},e.prototype.consumeUnicodeRangeToken=function(){for(var e=[],t=this.consumeCodePoint();Xt(t)&&e.length<6;)e.push(t),t=this.consumeCodePoint();for(var r=!1;t===mt&&e.length<6;)e.push(t),t=this.consumeCodePoint(),r=!0;if(r)return{type:30,start:parseInt(c.apply(void 0,e.map((function(e){return e===mt?Dt:e}))),16),end:parseInt(c.apply(void 0,e.map((function(e){return e===mt?Vt:e}))),16)};var n=parseInt(c.apply(void 0,e),16);if(this.peekCodePoint(0)===st&&Xt(this.peekCodePoint(1))){this.consumeCodePoint(),t=this.consumeCodePoint();for(var i=[];Xt(t)&&i.length<6;)i.push(t),t=this.consumeCodePoint();return{type:30,start:n,end:parseInt(c.apply(void 0,i),16)}}return{type:30,start:n,end:n}},e.prototype.consumeIdentLikeToken=function(){var e=this.consumeName();return"url"===e.toLowerCase()&&this.peekCodePoint(0)===it?(this.consumeCodePoint(),this.consumeUrlToken()):this.peekCodePoint(0)===it?(this.consumeCodePoint(),{type:19,value:e}):{type:20,value:e}},e.prototype.consumeUrlToken=function(){var e=[];if(this.consumeWhiteSpace(),this.peekCodePoint(0)===kt)return{type:22,value:""};var t=this.peekCodePoint(0);if(t===nt||t===We){var r=this.consumeStringToken(this.consumeCodePoint());return 0===r.type&&(this.consumeWhiteSpace(),this.peekCodePoint(0)===kt||this.peekCodePoint(0)===At)?(this.consumeCodePoint(),{type:22,value:r.value}):(this.consumeBadUrlRemnants(),yr)}for(;;){var n=this.consumeCodePoint();if(n===kt||n===At)return{type:22,value:c.apply(void 0,e)};if(Yt(n))return this.consumeWhiteSpace(),this.peekCodePoint(0)===kt||this.peekCodePoint(0)===At?(this.consumeCodePoint(),{type:22,value:c.apply(void 0,e)}):(this.consumeBadUrlRemnants(),yr);if(n===We||n===nt||n===it||rr(n))return this.consumeBadUrlRemnants(),yr;if(n===je){if(!nr(n,this.peekCodePoint(0)))return this.consumeBadUrlRemnants(),yr;e.push(this.consumeEscapedCodePoint())}else e.push(n)}},e.prototype.consumeWhiteSpace=function(){for(;Yt(this.peekCodePoint(0));)this.consumeCodePoint()},e.prototype.consumeBadUrlRemnants=function(){for(;;){var e=this.consumeCodePoint();if(e===At||e===kt)return;nr(e,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},e.prototype.consumeStringSlice=function(e){for(var t=5e4,r="";e>0;){var n=Math.min(t,e);r+=c.apply(void 0,this._value.splice(0,n)),e-=n}return this._value.shift(),r},e.prototype.consumeStringToken=function(e){for(var t="",r=0;;){var n=this._value[r];if(n===kt||void 0===n||n===e)return{type:0,value:t+=this.consumeStringSlice(r)};if(n===qe)return this._value.splice(0,r),_r;if(n===je){var i=this._value[r+1];i!==kt&&void 0!==i&&(i===qe?(t+=this.consumeStringSlice(r),r=-1,this._value.shift()):nr(n,i)&&(t+=this.consumeStringSlice(r),t+=c(this.consumeEscapedCodePoint()),r=-1))}r++}},e.prototype.consumeNumber=function(){var e=[],t=Ne,r=this.peekCodePoint(0);for(r!==vt&&r!==st||e.push(this.consumeCodePoint());Gt(this.peekCodePoint(0));)e.push(this.consumeCodePoint());r=this.peekCodePoint(0);var n=this.peekCodePoint(1);if(r===Et&&Gt(n))for(e.push(this.consumeCodePoint(),this.consumeCodePoint()),t=Ge;Gt(this.peekCodePoint(0));)e.push(this.consumeCodePoint());r=this.peekCodePoint(0),n=this.peekCodePoint(1);var i=this.peekCodePoint(2);if((r===Kt||r===Pt)&&((n===vt||n===st)&&Gt(i)||Gt(n)))for(e.push(this.consumeCodePoint(),this.consumeCodePoint()),t=Ge;Gt(this.peekCodePoint(0));)e.push(this.consumeCodePoint());return[or(e),t]},e.prototype.consumeNumericToken=function(){var e=this.consumeNumber(),t=e[0],r=e[1],n=this.peekCodePoint(0),i=this.peekCodePoint(1),A=this.peekCodePoint(2);return ir(n,i,A)?{type:15,number:t,flags:r,unit:this.consumeName()}:n===rt?(this.consumeCodePoint(),{type:16,number:t,flags:r}):{type:17,number:t,flags:r}},e.prototype.consumeEscapedCodePoint=function(){var e=this.consumeCodePoint();if(Xt(e)){for(var t=c(e);Xt(this.peekCodePoint(0))&&t.length<6;)t+=c(this.consumeCodePoint());Yt(this.peekCodePoint(0))&&this.consumeCodePoint();var r=parseInt(t,16);return 0===r||qt(r)||r>1114111?xt:r}return e===kt?xt:e},e.prototype.consumeName=function(){for(var e="";;){var t=this.consumeCodePoint();if(tr(t))e+=c(t);else{if(!nr(t,this.peekCodePoint(0)))return this.reconsumeCodePoint(t),e;e+=c(this.consumeEscapedCodePoint())}}},e}(),Qr=function(){function e(e){this._tokens=e}return e.create=function(t){var r=new Ur;return r.write(t),new e(r.read())},e.parseValue=function(t){return e.create(t).parseComponentValue()},e.parseValues=function(t){return e.create(t).parseComponentValues()},e.prototype.parseComponentValue=function(){for(var e=this.consumeToken();31===e.type;)e=this.consumeToken();if(32===e.type)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(e);var t=this.consumeComponentValue();do{e=this.consumeToken()}while(31===e.type);if(32===e.type)return t;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},e.prototype.parseComponentValues=function(){for(var e=[];;){var t=this.consumeComponentValue();if(32===t.type)return e;e.push(t),e.push()}},e.prototype.consumeComponentValue=function(){var e=this.consumeToken();switch(e.type){case 11:case 28:case 2:return this.consumeSimpleBlock(e.type);case 19:return this.consumeFunction(e)}return e},e.prototype.consumeSimpleBlock=function(e){for(var t={type:e,values:[]},r=this.consumeToken();;){if(32===r.type||Hr(r,e))return t;this.reconsumeToken(r),t.values.push(this.consumeComponentValue()),r=this.consumeToken()}},e.prototype.consumeFunction=function(e){for(var t={name:e.value,values:[],type:18};;){var r=this.consumeToken();if(32===r.type||3===r.type)return t;this.reconsumeToken(r),t.values.push(this.consumeComponentValue())}},e.prototype.consumeToken=function(){var e=this._tokens.shift();return void 0===e?Er:e},e.prototype.reconsumeToken=function(e){this._tokens.unshift(e)},e}(),Ir=function(e){return 15===e.type},Tr=function(e){return 17===e.type},Sr=function(e){return 20===e.type},Mr=function(e){return 0===e.type},kr=function(e,t){return Sr(e)&&e.value===t},Dr=function(e){return 31!==e.type},Lr=function(e){return 31!==e.type&&4!==e.type},Pr=function(e){var t=[],r=[];return e.forEach((function(e){if(4===e.type){if(0===r.length)throw new Error("Error parsing function args, zero tokens for arg");return t.push(r),void(r=[])}31!==e.type&&r.push(e)})),r.length&&t.push(r),t},Hr=function(e,t){return 11===t&&12===e.type||28===t&&29===e.type||2===t&&3===e.type},zr=function(e){return 17===e.type||15===e.type},Rr=function(e){return 16===e.type||zr(e)},Or=function(e){return e.length>1?[e[0],e[1]]:[e[0]]},Kr={type:17,number:0,flags:Ne},Vr={type:16,number:50,flags:Ne},$r={type:16,number:100,flags:Ne},Nr=function(e,t,r){var n=e[0],i=e[1];return[Gr(n,t),Gr(void 0!==i?i:n,r)]},Gr=function(e,t){if(16===e.type)return e.number/100*t;if(Ir(e))switch(e.unit){case"rem":case"em":return 16*e.number;default:return e.number}return e.number},qr="deg",Xr="grad",jr="rad",Zr="turn",Jr={name:"angle",parse:function(e,t){if(15===t.type)switch(t.unit){case qr:return Math.PI*t.number/180;case Xr:return Math.PI/200*t.number;case jr:return t.number;case Zr:return 2*Math.PI*t.number}throw new Error("Unsupported angle type")}},Wr=function(e){return 15===e.type&&(e.unit===qr||e.unit===Xr||e.unit===jr||e.unit===Zr)},Yr=function(e){switch(e.filter(Sr).map((function(e){return e.value})).join(" ")){case"to bottom right":case"to right bottom":case"left top":case"top left":return[Kr,Kr];case"to top":case"bottom":return en(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[Kr,$r];case"to right":case"left":return en(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[$r,$r];case"to bottom":case"top":return en(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[$r,Kr];case"to left":case"right":return en(270)}return 0},en=function(e){return Math.PI*e/180},tn={name:"color",parse:function(e,t){if(18===t.type){var r=cn[t.name];if(void 0===r)throw new Error('Attempting to parse an unsupported color function "'+t.name+'"');return r(e,t.values)}if(5===t.type){if(3===t.value.length){var n=t.value.substring(0,1),i=t.value.substring(1,2),A=t.value.substring(2,3);return An(parseInt(n+n,16),parseInt(i+i,16),parseInt(A+A,16),1)}if(4===t.value.length){n=t.value.substring(0,1),i=t.value.substring(1,2),A=t.value.substring(2,3);var o=t.value.substring(3,4);return An(parseInt(n+n,16),parseInt(i+i,16),parseInt(A+A,16),parseInt(o+o,16)/255)}if(6===t.value.length)return n=t.value.substring(0,2),i=t.value.substring(2,4),A=t.value.substring(4,6),An(parseInt(n,16),parseInt(i,16),parseInt(A,16),1);if(8===t.value.length)return n=t.value.substring(0,2),i=t.value.substring(2,4),A=t.value.substring(4,6),o=t.value.substring(6,8),An(parseInt(n,16),parseInt(i,16),parseInt(A,16),parseInt(o,16)/255)}if(20===t.type){var s=hn[t.value.toUpperCase()];if(void 0!==s)return s}return hn.TRANSPARENT}},rn=function(e){return 0==(255&e)},nn=function(e){var t=255&e,r=255&e>>8,n=255&e>>16,i=255&e>>24;return t<255?"rgba("+i+","+n+","+r+","+t/255+")":"rgb("+i+","+n+","+r+")"},An=function(e,t,r,n){return(e<<24|t<<16|r<<8|Math.round(255*n)<<0)>>>0},on=function(e,t){if(17===e.type)return e.number;if(16===e.type){var r=3===t?1:255;return 3===t?e.number/100*r:Math.round(e.number/100*r)}return 0},sn=function(e,t){var r=t.filter(Lr);if(3===r.length){var n=r.map(on),i=n[0],A=n[1],o=n[2];return An(i,A,o,1)}if(4===r.length){var s=r.map(on),a=(i=s[0],A=s[1],o=s[2],s[3]);return An(i,A,o,a)}return 0};function an(e,t,r){return r<0&&(r+=1),r>=1&&(r-=1),r<1/6?(t-e)*r*6+e:r<.5?t:r<2/3?6*(t-e)*(2/3-r)+e:e}var ln=function(e,t){var r=t.filter(Lr),n=r[0],i=r[1],A=r[2],o=r[3],s=(17===n.type?en(n.number):Jr.parse(e,n))/(2*Math.PI),a=Rr(i)?i.number/100:0,l=Rr(A)?A.number/100:0,c=void 0!==o&&Rr(o)?Gr(o,1):1;if(0===a)return An(255*l,255*l,255*l,1);var u=l<=.5?l*(a+1):l+a-l*a,h=2*l-u,d=an(h,u,s+1/3),p=an(h,u,s),f=an(h,u,s-1/3);return An(255*d,255*p,255*f,c)},cn={hsl:ln,hsla:ln,rgb:sn,rgba:sn},un=function(e,t){return tn.parse(e,Qr.create(t).parseComponentValue())},hn={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},dn={name:"background-clip",initialValue:"border-box",prefix:!1,type:1,parse:function(e,t){return t.map((function(e){if(Sr(e))switch(e.value){case"padding-box":return 1;case"content-box":return 2}return 0}))}},pn={name:"background-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},fn=function(e,t){var r=tn.parse(e,t[0]),n=t[1];return n&&Rr(n)?{color:r,stop:n}:{color:r,stop:null}},mn=function(e,t){var r=e[0],n=e[e.length-1];null===r.stop&&(r.stop=Kr),null===n.stop&&(n.stop=$r);for(var i=[],A=0,o=0;o<e.length;o++){var s=e[o].stop;if(null!==s){var a=Gr(s,t);a>A?i.push(a):i.push(A),A=a}else i.push(null)}var l=null;for(o=0;o<i.length;o++){var c=i[o];if(null===c)null===l&&(l=o);else if(null!==l){for(var u=o-l,h=(c-i[l-1])/(u+1),d=1;d<=u;d++)i[l+d-1]=h*d;l=null}}return e.map((function(e,r){return{color:e.color,stop:Math.max(Math.min(1,i[r]/t),0)}}))},gn=function(e,t,r){var n=t/2,i=r/2,A=Gr(e[0],t)-n,o=i-Gr(e[1],r);return(Math.atan2(o,A)+2*Math.PI)%(2*Math.PI)},yn=function(e,t,r){var n="number"==typeof e?e:gn(e,t,r),i=Math.abs(t*Math.sin(n))+Math.abs(r*Math.cos(n)),A=t/2,o=r/2,s=i/2,a=Math.sin(n-Math.PI/2)*s,l=Math.cos(n-Math.PI/2)*s;return[i,A-l,A+l,o-a,o+a]},_n=function(e,t){return Math.sqrt(e*e+t*t)},wn=function(e,t,r,n,i){return[[0,0],[0,t],[e,0],[e,t]].reduce((function(e,t){var A=t[0],o=t[1],s=_n(r-A,n-o);return(i?s<e.optimumDistance:s>e.optimumDistance)?{optimumCorner:t,optimumDistance:s}:e}),{optimumDistance:i?1/0:-1/0,optimumCorner:null}).optimumCorner},xn=function(e,t,r,n,i){var A=0,o=0;switch(e.size){case 0:0===e.shape?A=o=Math.min(Math.abs(t),Math.abs(t-n),Math.abs(r),Math.abs(r-i)):1===e.shape&&(A=Math.min(Math.abs(t),Math.abs(t-n)),o=Math.min(Math.abs(r),Math.abs(r-i)));break;case 2:if(0===e.shape)A=o=Math.min(_n(t,r),_n(t,r-i),_n(t-n,r),_n(t-n,r-i));else if(1===e.shape){var s=Math.min(Math.abs(r),Math.abs(r-i))/Math.min(Math.abs(t),Math.abs(t-n)),a=wn(n,i,t,r,!0),l=a[0],c=a[1];o=s*(A=_n(l-t,(c-r)/s))}break;case 1:0===e.shape?A=o=Math.max(Math.abs(t),Math.abs(t-n),Math.abs(r),Math.abs(r-i)):1===e.shape&&(A=Math.max(Math.abs(t),Math.abs(t-n)),o=Math.max(Math.abs(r),Math.abs(r-i)));break;case 3:if(0===e.shape)A=o=Math.max(_n(t,r),_n(t,r-i),_n(t-n,r),_n(t-n,r-i));else if(1===e.shape){s=Math.max(Math.abs(r),Math.abs(r-i))/Math.max(Math.abs(t),Math.abs(t-n));var u=wn(n,i,t,r,!1);l=u[0],c=u[1],o=s*(A=_n(l-t,(c-r)/s))}}return Array.isArray(e.size)&&(A=Gr(e.size[0],n),o=2===e.size.length?Gr(e.size[1],i):A),[A,o]},Bn=function(e,t){var r=en(180),n=[];return Pr(t).forEach((function(t,i){if(0===i){var A=t[0];if(20===A.type&&"to"===A.value)return void(r=Yr(t));if(Wr(A))return void(r=Jr.parse(e,A))}var o=fn(e,t);n.push(o)})),{angle:r,stops:n,type:1}},vn=function(e,t){var r=en(180),n=[];return Pr(t).forEach((function(t,i){if(0===i){var A=t[0];if(20===A.type&&-1!==["top","left","right","bottom"].indexOf(A.value))return void(r=Yr(t));if(Wr(A))return void(r=(Jr.parse(e,A)+en(270))%en(360))}var o=fn(e,t);n.push(o)})),{angle:r,stops:n,type:1}},bn=function(e,t){var r=en(180),n=[],i=1,A=0,o=3,s=[];return Pr(t).forEach((function(t,r){var A=t[0];if(0===r){if(Sr(A)&&"linear"===A.value)return void(i=1);if(Sr(A)&&"radial"===A.value)return void(i=2)}if(18===A.type)if("from"===A.name){var o=tn.parse(e,A.values[0]);n.push({stop:Kr,color:o})}else if("to"===A.name)o=tn.parse(e,A.values[0]),n.push({stop:$r,color:o});else if("color-stop"===A.name){var s=A.values.filter(Lr);if(2===s.length){o=tn.parse(e,s[1]);var a=s[0];Tr(a)&&n.push({stop:{type:16,number:100*a.number,flags:a.flags},color:o})}}})),1===i?{angle:(r+en(180))%en(360),stops:n,type:i}:{size:o,shape:A,stops:n,position:s,type:i}},Cn="closest-side",Fn="farthest-side",En="closest-corner",Un="farthest-corner",Qn="circle",In="ellipse",Tn="cover",Sn="contain",Mn=function(e,t){var r=0,n=3,i=[],A=[];return Pr(t).forEach((function(t,o){var s=!0;if(0===o){var a=!1;s=t.reduce((function(e,t){if(a)if(Sr(t))switch(t.value){case"center":return A.push(Vr),e;case"top":case"left":return A.push(Kr),e;case"right":case"bottom":return A.push($r),e}else(Rr(t)||zr(t))&&A.push(t);else if(Sr(t))switch(t.value){case Qn:return r=0,!1;case In:return r=1,!1;case"at":return a=!0,!1;case Cn:return n=0,!1;case Tn:case Fn:return n=1,!1;case Sn:case En:return n=2,!1;case Un:return n=3,!1}else if(zr(t)||Rr(t))return Array.isArray(n)||(n=[]),n.push(t),!1;return e}),s)}if(s){var l=fn(e,t);i.push(l)}})),{size:n,shape:r,stops:i,position:A,type:2}},kn=function(e,t){var r=0,n=3,i=[],A=[];return Pr(t).forEach((function(t,o){var s=!0;if(0===o?s=t.reduce((function(e,t){if(Sr(t))switch(t.value){case"center":return A.push(Vr),!1;case"top":case"left":return A.push(Kr),!1;case"right":case"bottom":return A.push($r),!1}else if(Rr(t)||zr(t))return A.push(t),!1;return e}),s):1===o&&(s=t.reduce((function(e,t){if(Sr(t))switch(t.value){case Qn:return r=0,!1;case In:return r=1,!1;case Sn:case Cn:return n=0,!1;case Fn:return n=1,!1;case En:return n=2,!1;case Tn:case Un:return n=3,!1}else if(zr(t)||Rr(t))return Array.isArray(n)||(n=[]),n.push(t),!1;return e}),s)),s){var a=fn(e,t);i.push(a)}})),{size:n,shape:r,stops:i,position:A,type:2}},Dn=function(e){return 1===e.type},Ln=function(e){return 2===e.type},Pn={name:"image",parse:function(e,t){if(22===t.type){var r={url:t.value,type:0};return e.cache.addImage(t.value),r}if(18===t.type){var n=Rn[t.name];if(void 0===n)throw new Error('Attempting to parse an unsupported image function "'+t.name+'"');return n(e,t.values)}throw new Error("Unsupported image type "+t.type)}};function Hn(e){return!(20===e.type&&"none"===e.value||18===e.type&&!Rn[e.name])}var zn,Rn={"linear-gradient":Bn,"-moz-linear-gradient":vn,"-ms-linear-gradient":vn,"-o-linear-gradient":vn,"-webkit-linear-gradient":vn,"radial-gradient":Mn,"-moz-radial-gradient":kn,"-ms-radial-gradient":kn,"-o-radial-gradient":kn,"-webkit-radial-gradient":kn,"-webkit-gradient":bn},On={name:"background-image",initialValue:"none",type:1,prefix:!1,parse:function(e,t){if(0===t.length)return[];var r=t[0];return 20===r.type&&"none"===r.value?[]:t.filter((function(e){return Lr(e)&&Hn(e)})).map((function(t){return Pn.parse(e,t)}))}},Kn={name:"background-origin",initialValue:"border-box",prefix:!1,type:1,parse:function(e,t){return t.map((function(e){if(Sr(e))switch(e.value){case"padding-box":return 1;case"content-box":return 2}return 0}))}},Vn={name:"background-position",initialValue:"0% 0%",type:1,prefix:!1,parse:function(e,t){return Pr(t).map((function(e){return e.filter(Rr)})).map(Or)}},$n={name:"background-repeat",initialValue:"repeat",prefix:!1,type:1,parse:function(e,t){return Pr(t).map((function(e){return e.filter(Sr).map((function(e){return e.value})).join(" ")})).map(Nn)}},Nn=function(e){switch(e){case"no-repeat":return 1;case"repeat-x":case"repeat no-repeat":return 2;case"repeat-y":case"no-repeat repeat":return 3;default:return 0}};!function(e){e.AUTO="auto",e.CONTAIN="contain",e.COVER="cover"}(zn||(zn={}));var Gn,qn={name:"background-size",initialValue:"0",prefix:!1,type:1,parse:function(e,t){return Pr(t).map((function(e){return e.filter(Xn)}))}},Xn=function(e){return Sr(e)||Rr(e)},jn=function(e){return{name:"border-"+e+"-color",initialValue:"transparent",prefix:!1,type:3,format:"color"}},Zn=jn("top"),Jn=jn("right"),Wn=jn("bottom"),Yn=jn("left"),ei=function(e){return{name:"border-radius-"+e,initialValue:"0 0",prefix:!1,type:1,parse:function(e,t){return Or(t.filter(Rr))}}},ti=ei("top-left"),ri=ei("top-right"),ni=ei("bottom-right"),ii=ei("bottom-left"),Ai=function(e){return{name:"border-"+e+"-style",initialValue:"solid",prefix:!1,type:2,parse:function(e,t){switch(t){case"none":return 0;case"dashed":return 2;case"dotted":return 3;case"double":return 4}return 1}}},oi=Ai("top"),si=Ai("right"),ai=Ai("bottom"),li=Ai("left"),ci=function(e){return{name:"border-"+e+"-width",initialValue:"0",type:0,prefix:!1,parse:function(e,t){return Ir(t)?t.number:0}}},ui=ci("top"),hi=ci("right"),di=ci("bottom"),pi=ci("left"),fi={name:"color",initialValue:"transparent",prefix:!1,type:3,format:"color"},mi={name:"direction",initialValue:"ltr",prefix:!1,type:2,parse:function(e,t){return"rtl"===t?1:0}},gi={name:"display",initialValue:"inline-block",prefix:!1,type:1,parse:function(e,t){return t.filter(Sr).reduce((function(e,t){return e|yi(t.value)}),0)}},yi=function(e){switch(e){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},_i={name:"float",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"left":return 1;case"right":return 2;case"inline-start":return 3;case"inline-end":return 4}return 0}},wi={name:"letter-spacing",initialValue:"0",prefix:!1,type:0,parse:function(e,t){return 20===t.type&&"normal"===t.value?0:17===t.type||15===t.type?t.number:0}};!function(e){e.NORMAL="normal",e.STRICT="strict"}(Gn||(Gn={}));var xi,Bi={name:"line-break",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){return"strict"===t?Gn.STRICT:Gn.NORMAL}},vi={name:"line-height",initialValue:"normal",prefix:!1,type:4},bi=function(e,t){return Sr(e)&&"normal"===e.value?1.2*t:17===e.type?t*e.number:Rr(e)?Gr(e,t):t},Ci={name:"list-style-image",initialValue:"none",type:0,prefix:!1,parse:function(e,t){return 20===t.type&&"none"===t.value?null:Pn.parse(e,t)}},Fi={name:"list-style-position",initialValue:"outside",prefix:!1,type:2,parse:function(e,t){return"inside"===t?0:1}},Ei={name:"list-style-type",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"disc":return 0;case"circle":return 1;case"square":return 2;case"decimal":return 3;case"cjk-decimal":return 4;case"decimal-leading-zero":return 5;case"lower-roman":return 6;case"upper-roman":return 7;case"lower-greek":return 8;case"lower-alpha":return 9;case"upper-alpha":return 10;case"arabic-indic":return 11;case"armenian":return 12;case"bengali":return 13;case"cambodian":return 14;case"cjk-earthly-branch":return 15;case"cjk-heavenly-stem":return 16;case"cjk-ideographic":return 17;case"devanagari":return 18;case"ethiopic-numeric":return 19;case"georgian":return 20;case"gujarati":return 21;case"gurmukhi":case"hebrew":return 22;case"hiragana":return 23;case"hiragana-iroha":return 24;case"japanese-formal":return 25;case"japanese-informal":return 26;case"kannada":return 27;case"katakana":return 28;case"katakana-iroha":return 29;case"khmer":return 30;case"korean-hangul-formal":return 31;case"korean-hanja-formal":return 32;case"korean-hanja-informal":return 33;case"lao":return 34;case"lower-armenian":return 35;case"malayalam":return 36;case"mongolian":return 37;case"myanmar":return 38;case"oriya":return 39;case"persian":return 40;case"simp-chinese-formal":return 41;case"simp-chinese-informal":return 42;case"tamil":return 43;case"telugu":return 44;case"thai":return 45;case"tibetan":return 46;case"trad-chinese-formal":return 47;case"trad-chinese-informal":return 48;case"upper-armenian":return 49;case"disclosure-open":return 50;case"disclosure-closed":return 51;default:return-1}}},Ui=function(e){return{name:"margin-"+e,initialValue:"0",prefix:!1,type:4}},Qi=Ui("top"),Ii=Ui("right"),Ti=Ui("bottom"),Si=Ui("left"),Mi={name:"overflow",initialValue:"visible",prefix:!1,type:1,parse:function(e,t){return t.filter(Sr).map((function(e){switch(e.value){case"hidden":return 1;case"scroll":return 2;case"clip":return 3;case"auto":return 4;default:return 0}}))}},ki={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){return"break-word"===t?"break-word":"normal"}},Di=function(e){return{name:"padding-"+e,initialValue:"0",prefix:!1,type:3,format:"length-percentage"}},Li=Di("top"),Pi=Di("right"),Hi=Di("bottom"),zi=Di("left"),Ri={name:"text-align",initialValue:"left",prefix:!1,type:2,parse:function(e,t){switch(t){case"right":return 2;case"center":case"justify":return 1;default:return 0}}},Oi={name:"position",initialValue:"static",prefix:!1,type:2,parse:function(e,t){switch(t){case"relative":return 1;case"absolute":return 2;case"fixed":return 3;case"sticky":return 4}return 0}},Ki={name:"text-shadow",initialValue:"none",type:1,prefix:!1,parse:function(e,t){return 1===t.length&&kr(t[0],"none")?[]:Pr(t).map((function(t){for(var r={color:hn.TRANSPARENT,offsetX:Kr,offsetY:Kr,blur:Kr},n=0,i=0;i<t.length;i++){var A=t[i];zr(A)?(0===n?r.offsetX=A:1===n?r.offsetY=A:r.blur=A,n++):r.color=tn.parse(e,A)}return r}))}},Vi={name:"text-transform",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"uppercase":return 2;case"lowercase":return 1;case"capitalize":return 3}return 0}},$i={name:"transform",initialValue:"none",prefix:!0,type:0,parse:function(e,t){if(20===t.type&&"none"===t.value)return null;if(18===t.type){var r=Ni[t.name];if(void 0===r)throw new Error('Attempting to parse an unsupported transform function "'+t.name+'"');return r(t.values)}return null}},Ni={matrix:function(e){var t=e.filter((function(e){return 17===e.type})).map((function(e){return e.number}));return 6===t.length?t:null},matrix3d:function(e){var t=e.filter((function(e){return 17===e.type})).map((function(e){return e.number})),r=t[0],n=t[1];t[2],t[3];var i=t[4],A=t[5];t[6],t[7],t[8],t[9],t[10],t[11];var o=t[12],s=t[13];return t[14],t[15],16===t.length?[r,n,i,A,o,s]:null}},Gi={type:16,number:50,flags:Ne},qi=[Gi,Gi],Xi={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:1,parse:function(e,t){var r=t.filter(Rr);return 2!==r.length?qi:[r[0],r[1]]}},ji={name:"visible",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"hidden":return 1;case"collapse":return 2;default:return 0}}};!function(e){e.NORMAL="normal",e.BREAK_ALL="break-all",e.KEEP_ALL="keep-all"}(xi||(xi={}));for(var Zi={name:"word-break",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){switch(t){case"break-all":return xi.BREAK_ALL;case"keep-all":return xi.KEEP_ALL;default:return xi.NORMAL}}},Ji={name:"z-index",initialValue:"auto",prefix:!1,type:0,parse:function(e,t){if(20===t.type)return{auto:!0,order:0};if(Tr(t))return{auto:!1,order:t.number};throw new Error("Invalid z-index number parsed")}},Wi={name:"time",parse:function(e,t){if(15===t.type)switch(t.unit.toLowerCase()){case"s":return 1e3*t.number;case"ms":return t.number}throw new Error("Unsupported time type")}},Yi={name:"opacity",initialValue:"1",type:0,prefix:!1,parse:function(e,t){return Tr(t)?t.number:1}},eA={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},tA={name:"text-decoration-line",initialValue:"none",prefix:!1,type:1,parse:function(e,t){return t.filter(Sr).map((function(e){switch(e.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0})).filter((function(e){return 0!==e}))}},rA={name:"font-family",initialValue:"",prefix:!1,type:1,parse:function(e,t){var r=[],n=[];return t.forEach((function(e){switch(e.type){case 20:case 0:r.push(e.value);break;case 17:r.push(e.number.toString());break;case 4:n.push(r.join(" ")),r.length=0}})),r.length&&n.push(r.join(" ")),n.map((function(e){return-1===e.indexOf(" ")?e:"'"+e+"'"}))}},nA={name:"font-size",initialValue:"0",prefix:!1,type:3,format:"length"},iA={name:"font-weight",initialValue:"normal",type:0,prefix:!1,parse:function(e,t){return Tr(t)?t.number:Sr(t)&&"bold"===t.value?700:400}},AA={name:"font-variant",initialValue:"none",type:1,prefix:!1,parse:function(e,t){return t.filter(Sr).map((function(e){return e.value}))}},oA={name:"font-style",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){switch(t){case"oblique":return"oblique";case"italic":return"italic";default:return"normal"}}},sA=function(e,t){return 0!=(e&t)},aA={name:"content",initialValue:"none",type:1,prefix:!1,parse:function(e,t){if(0===t.length)return[];var r=t[0];return 20===r.type&&"none"===r.value?[]:t}},lA={name:"counter-increment",initialValue:"none",prefix:!0,type:1,parse:function(e,t){if(0===t.length)return null;var r=t[0];if(20===r.type&&"none"===r.value)return null;for(var n=[],i=t.filter(Dr),A=0;A<i.length;A++){var o=i[A],s=i[A+1];if(20===o.type){var a=s&&Tr(s)?s.number:1;n.push({counter:o.value,increment:a})}}return n}},cA={name:"counter-reset",initialValue:"none",prefix:!0,type:1,parse:function(e,t){if(0===t.length)return[];for(var r=[],n=t.filter(Dr),i=0;i<n.length;i++){var A=n[i],o=n[i+1];if(Sr(A)&&"none"!==A.value){var s=o&&Tr(o)?o.number:0;r.push({counter:A.value,reset:s})}}return r}},uA={name:"duration",initialValue:"0s",prefix:!1,type:1,parse:function(e,t){return t.filter(Ir).map((function(t){return Wi.parse(e,t)}))}},hA={name:"quotes",initialValue:"none",prefix:!0,type:1,parse:function(e,t){if(0===t.length)return null;var r=t[0];if(20===r.type&&"none"===r.value)return null;var n=[],i=t.filter(Mr);if(i.length%2!=0)return null;for(var A=0;A<i.length;A+=2){var o=i[A].value,s=i[A+1].value;n.push({open:o,close:s})}return n}},dA=function(e,t,r){if(!e)return"";var n=e[Math.min(t,e.length-1)];return n?r?n.open:n.close:""},pA={name:"box-shadow",initialValue:"none",type:1,prefix:!1,parse:function(e,t){return 1===t.length&&kr(t[0],"none")?[]:Pr(t).map((function(t){for(var r={color:255,offsetX:Kr,offsetY:Kr,blur:Kr,spread:Kr,inset:!1},n=0,i=0;i<t.length;i++){var A=t[i];kr(A,"inset")?r.inset=!0:zr(A)?(0===n?r.offsetX=A:1===n?r.offsetY=A:2===n?r.blur=A:r.spread=A,n++):r.color=tn.parse(e,A)}return r}))}},fA={name:"paint-order",initialValue:"normal",prefix:!1,type:1,parse:function(e,t){var r=[0,1,2],n=[];return t.filter(Sr).forEach((function(e){switch(e.value){case"stroke":n.push(1);break;case"fill":n.push(0);break;case"markers":n.push(2)}})),r.forEach((function(e){-1===n.indexOf(e)&&n.push(e)})),n}},mA={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:3,format:"color"},gA={name:"-webkit-text-stroke-width",initialValue:"0",type:0,prefix:!1,parse:function(e,t){return Ir(t)?t.number:0}},yA=function(){function e(e,t){var r,n;this.animationDuration=xA(e,uA,t.animationDuration),this.backgroundClip=xA(e,dn,t.backgroundClip),this.backgroundColor=xA(e,pn,t.backgroundColor),this.backgroundImage=xA(e,On,t.backgroundImage),this.backgroundOrigin=xA(e,Kn,t.backgroundOrigin),this.backgroundPosition=xA(e,Vn,t.backgroundPosition),this.backgroundRepeat=xA(e,$n,t.backgroundRepeat),this.backgroundSize=xA(e,qn,t.backgroundSize),this.borderTopColor=xA(e,Zn,t.borderTopColor),this.borderRightColor=xA(e,Jn,t.borderRightColor),this.borderBottomColor=xA(e,Wn,t.borderBottomColor),this.borderLeftColor=xA(e,Yn,t.borderLeftColor),this.borderTopLeftRadius=xA(e,ti,t.borderTopLeftRadius),this.borderTopRightRadius=xA(e,ri,t.borderTopRightRadius),this.borderBottomRightRadius=xA(e,ni,t.borderBottomRightRadius),this.borderBottomLeftRadius=xA(e,ii,t.borderBottomLeftRadius),this.borderTopStyle=xA(e,oi,t.borderTopStyle),this.borderRightStyle=xA(e,si,t.borderRightStyle),this.borderBottomStyle=xA(e,ai,t.borderBottomStyle),this.borderLeftStyle=xA(e,li,t.borderLeftStyle),this.borderTopWidth=xA(e,ui,t.borderTopWidth),this.borderRightWidth=xA(e,hi,t.borderRightWidth),this.borderBottomWidth=xA(e,di,t.borderBottomWidth),this.borderLeftWidth=xA(e,pi,t.borderLeftWidth),this.boxShadow=xA(e,pA,t.boxShadow),this.color=xA(e,fi,t.color),this.direction=xA(e,mi,t.direction),this.display=xA(e,gi,t.display),this.float=xA(e,_i,t.cssFloat),this.fontFamily=xA(e,rA,t.fontFamily),this.fontSize=xA(e,nA,t.fontSize),this.fontStyle=xA(e,oA,t.fontStyle),this.fontVariant=xA(e,AA,t.fontVariant),this.fontWeight=xA(e,iA,t.fontWeight),this.letterSpacing=xA(e,wi,t.letterSpacing),this.lineBreak=xA(e,Bi,t.lineBreak),this.lineHeight=xA(e,vi,t.lineHeight),this.listStyleImage=xA(e,Ci,t.listStyleImage),this.listStylePosition=xA(e,Fi,t.listStylePosition),this.listStyleType=xA(e,Ei,t.listStyleType),this.marginTop=xA(e,Qi,t.marginTop),this.marginRight=xA(e,Ii,t.marginRight),this.marginBottom=xA(e,Ti,t.marginBottom),this.marginLeft=xA(e,Si,t.marginLeft),this.opacity=xA(e,Yi,t.opacity);var i=xA(e,Mi,t.overflow);this.overflowX=i[0],this.overflowY=i[i.length>1?1:0],this.overflowWrap=xA(e,ki,t.overflowWrap),this.paddingTop=xA(e,Li,t.paddingTop),this.paddingRight=xA(e,Pi,t.paddingRight),this.paddingBottom=xA(e,Hi,t.paddingBottom),this.paddingLeft=xA(e,zi,t.paddingLeft),this.paintOrder=xA(e,fA,t.paintOrder),this.position=xA(e,Oi,t.position),this.textAlign=xA(e,Ri,t.textAlign),this.textDecorationColor=xA(e,eA,null!==(r=t.textDecorationColor)&&void 0!==r?r:t.color),this.textDecorationLine=xA(e,tA,null!==(n=t.textDecorationLine)&&void 0!==n?n:t.textDecoration),this.textShadow=xA(e,Ki,t.textShadow),this.textTransform=xA(e,Vi,t.textTransform),this.transform=xA(e,$i,t.transform),this.transformOrigin=xA(e,Xi,t.transformOrigin),this.visibility=xA(e,ji,t.visibility),this.webkitTextStrokeColor=xA(e,mA,t.webkitTextStrokeColor),this.webkitTextStrokeWidth=xA(e,gA,t.webkitTextStrokeWidth),this.wordBreak=xA(e,Zi,t.wordBreak),this.zIndex=xA(e,Ji,t.zIndex)}return e.prototype.isVisible=function(){return this.display>0&&this.opacity>0&&0===this.visibility},e.prototype.isTransparent=function(){return rn(this.backgroundColor)},e.prototype.isTransformed=function(){return null!==this.transform},e.prototype.isPositioned=function(){return 0!==this.position},e.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},e.prototype.isFloating=function(){return 0!==this.float},e.prototype.isInlineLevel=function(){return sA(this.display,4)||sA(this.display,33554432)||sA(this.display,268435456)||sA(this.display,536870912)||sA(this.display,67108864)||sA(this.display,134217728)},e}(),_A=function(){function e(e,t){this.content=xA(e,aA,t.content),this.quotes=xA(e,hA,t.quotes)}return e}(),wA=function(){function e(e,t){this.counterIncrement=xA(e,lA,t.counterIncrement),this.counterReset=xA(e,cA,t.counterReset)}return e}(),xA=function(e,t,r){var n=new Ur,i=null!=r?r.toString():t.initialValue;n.write(i);var A=new Qr(n.read());switch(t.type){case 2:var o=A.parseComponentValue();return t.parse(e,Sr(o)?o.value:t.initialValue);case 0:return t.parse(e,A.parseComponentValue());case 1:return t.parse(e,A.parseComponentValues());case 4:return A.parseComponentValue();case 3:switch(t.format){case"angle":return Jr.parse(e,A.parseComponentValue());case"color":return tn.parse(e,A.parseComponentValue());case"image":return Pn.parse(e,A.parseComponentValue());case"length":var s=A.parseComponentValue();return zr(s)?s:Kr;case"length-percentage":var a=A.parseComponentValue();return Rr(a)?a:Kr;case"time":return Wi.parse(e,A.parseComponentValue())}}},BA="data-html2canvas-debug",vA=function(e){switch(e.getAttribute(BA)){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}},bA=function(e,t){var r=vA(e);return 1===r||t===r},CA=function(){function e(e,t){this.context=e,this.textNodes=[],this.elements=[],this.flags=0,bA(t,3),this.styles=new yA(e,window.getComputedStyle(t,null)),ds(t)&&(this.styles.animationDuration.some((function(e){return e>0}))&&(t.style.animationDuration="0s"),null!==this.styles.transform&&(t.style.transform="none")),this.bounds=s(this.context,t),bA(t,4)&&(this.flags|=16)}return e}(),FA="AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA=",EA="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",UA="undefined"==typeof Uint8Array?[]:new Uint8Array(256),QA=0;QA<EA.length;QA++)UA[EA.charCodeAt(QA)]=QA;for(var IA=function(e){var t,r,n,i,A,o=.75*e.length,s=e.length,a=0;"="===e[e.length-1]&&(o--,"="===e[e.length-2]&&o--);var l="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array&&void 0!==Uint8Array.prototype.slice?new ArrayBuffer(o):new Array(o),c=Array.isArray(l)?l:new Uint8Array(l);for(t=0;t<s;t+=4)r=UA[e.charCodeAt(t)],n=UA[e.charCodeAt(t+1)],i=UA[e.charCodeAt(t+2)],A=UA[e.charCodeAt(t+3)],c[a++]=r<<2|n>>4,c[a++]=(15&n)<<4|i>>2,c[a++]=(3&i)<<6|63&A;return l},TA=function(e){for(var t=e.length,r=[],n=0;n<t;n+=2)r.push(e[n+1]<<8|e[n]);return r},SA=function(e){for(var t=e.length,r=[],n=0;n<t;n+=4)r.push(e[n+3]<<24|e[n+2]<<16|e[n+1]<<8|e[n]);return r},MA=5,kA=11,DA=2,LA=65536>>MA,PA=(1<<MA)-1,HA=LA+(1024>>MA)+32,zA=65536>>kA,RA=(1<<kA-MA)-1,OA=function(e,t,r){return e.slice?e.slice(t,r):new Uint16Array(Array.prototype.slice.call(e,t,r))},KA=function(e,t,r){return e.slice?e.slice(t,r):new Uint32Array(Array.prototype.slice.call(e,t,r))},VA=function(e,t){var r=IA(e),n=Array.isArray(r)?SA(r):new Uint32Array(r),i=Array.isArray(r)?TA(r):new Uint16Array(r),A=24,o=OA(i,A/2,n[4]/2),s=2===n[5]?OA(i,(A+n[4])/2):KA(n,Math.ceil((A+n[4])/4));return new $A(n[0],n[1],n[2],n[3],o,s)},$A=function(){function e(e,t,r,n,i,A){this.initialValue=e,this.errorValue=t,this.highStart=r,this.highValueIndex=n,this.index=i,this.data=A}return e.prototype.get=function(e){var t;if(e>=0){if(e<55296||e>56319&&e<=65535)return t=((t=this.index[e>>MA])<<DA)+(e&PA),this.data[t];if(e<=65535)return t=((t=this.index[LA+(e-55296>>MA)])<<DA)+(e&PA),this.data[t];if(e<this.highStart)return t=HA-zA+(e>>kA),t=this.index[t],t+=e>>MA&RA,t=((t=this.index[t])<<DA)+(e&PA),this.data[t];if(e<=1114111)return this.data[this.highValueIndex]}return this.errorValue},e}(),NA="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",GA="undefined"==typeof Uint8Array?[]:new Uint8Array(256),qA=0;qA<NA.length;qA++)GA[NA.charCodeAt(qA)]=qA;var XA,jA=1,ZA=2,JA=3,WA=4,YA=5,eo=7,to=8,ro=9,no=10,io=11,Ao=12,oo=13,so=14,ao=15,lo=function(e){for(var t=[],r=0,n=e.length;r<n;){var i=e.charCodeAt(r++);if(i>=55296&&i<=56319&&r<n){var A=e.charCodeAt(r++);56320==(64512&A)?t.push(((1023&i)<<10)+(1023&A)+65536):(t.push(i),r--)}else t.push(i)}return t},co=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(String.fromCodePoint)return String.fromCodePoint.apply(String,e);var r=e.length;if(!r)return"";for(var n=[],i=-1,A="";++i<r;){var o=e[i];o<=65535?n.push(o):(o-=65536,n.push(55296+(o>>10),o%1024+56320)),(i+1===r||n.length>16384)&&(A+=String.fromCharCode.apply(String,n),n.length=0)}return A},uo=VA(FA),ho="×",po="÷",fo=function(e){return uo.get(e)},mo=function(e,t,r){var n=r-2,i=t[n],A=t[r-1],o=t[r];if(A===ZA&&o===JA)return ho;if(A===ZA||A===JA||A===WA)return po;if(o===ZA||o===JA||o===WA)return po;if(A===to&&-1!==[to,ro,io,Ao].indexOf(o))return ho;if(!(A!==io&&A!==ro||o!==ro&&o!==no))return ho;if((A===Ao||A===no)&&o===no)return ho;if(o===oo||o===YA)return ho;if(o===eo)return ho;if(A===jA)return ho;if(A===oo&&o===so){for(;i===YA;)i=t[--n];if(i===so)return ho}if(A===ao&&o===ao){for(var s=0;i===ao;)s++,i=t[--n];if(s%2==0)return ho}return po},go=function(e){var t=lo(e),r=t.length,n=0,i=0,A=t.map(fo);return{next:function(){if(n>=r)return{done:!0,value:null};for(var e=ho;n<r&&(e=mo(t,A,++n))===ho;);if(e!==ho||n===r){var o=co.apply(null,t.slice(i,n));return i=n,{value:o,done:!1}}return{done:!0,value:null}}}},yo=function(e){for(var t,r=go(e),n=[];!(t=r.next()).done;)t.value&&n.push(t.value.slice());return n},_o=function(e){var t=123;if(e.createRange){var r=e.createRange();if(r.getBoundingClientRect){var n=e.createElement("boundtest");n.style.height=t+"px",n.style.display="block",e.body.appendChild(n),r.selectNode(n);var i=r.getBoundingClientRect(),A=Math.round(i.height);if(e.body.removeChild(n),A===t)return!0}}return!1},wo=function(e){var t=e.createElement("boundtest");t.style.width="50px",t.style.display="block",t.style.fontSize="12px",t.style.letterSpacing="0px",t.style.wordSpacing="0px",e.body.appendChild(t);var r=e.createRange();t.innerHTML="function"==typeof"".repeat?"&#128104;".repeat(10):"";var n=t.firstChild,i=l(n.data).map((function(e){return c(e)})),A=0,o={},s=i.every((function(e,t){r.setStart(n,A),r.setEnd(n,A+e.length);var i=r.getBoundingClientRect();A+=e.length;var s=i.x>o.x||i.y>o.y;return o=i,0===t||s}));return e.body.removeChild(t),s},xo=function(){return void 0!==(new Image).crossOrigin},Bo=function(){return"string"==typeof(new XMLHttpRequest).responseType},vo=function(e){var t=new Image,r=e.createElement("canvas"),n=r.getContext("2d");if(!n)return!1;t.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{n.drawImage(t,0,0),r.toDataURL()}catch(e){return!1}return!0},bo=function(e){return 0===e[0]&&255===e[1]&&0===e[2]&&255===e[3]},Co=function(e){var t=e.createElement("canvas"),r=100;t.width=r,t.height=r;var n=t.getContext("2d");if(!n)return Promise.reject(!1);n.fillStyle="rgb(0, 255, 0)",n.fillRect(0,0,r,r);var i=new Image,A=t.toDataURL();i.src=A;var o=Fo(r,r,0,0,i);return n.fillStyle="red",n.fillRect(0,0,r,r),Eo(o).then((function(t){n.drawImage(t,0,0);var i=n.getImageData(0,0,r,r).data;n.fillStyle="red",n.fillRect(0,0,r,r);var o=e.createElement("div");return o.style.backgroundImage="url("+A+")",o.style.height=r+"px",bo(i)?Eo(Fo(r,r,0,0,o)):Promise.reject(!1)})).then((function(e){return n.drawImage(e,0,0),bo(n.getImageData(0,0,r,r).data)})).catch((function(){return!1}))},Fo=function(e,t,r,n,i){var A="http://www.w3.org/2000/svg",o=document.createElementNS(A,"svg"),s=document.createElementNS(A,"foreignObject");return o.setAttributeNS(null,"width",e.toString()),o.setAttributeNS(null,"height",t.toString()),s.setAttributeNS(null,"width","100%"),s.setAttributeNS(null,"height","100%"),s.setAttributeNS(null,"x",r.toString()),s.setAttributeNS(null,"y",n.toString()),s.setAttributeNS(null,"externalResourcesRequired","true"),o.appendChild(s),s.appendChild(i),o},Eo=function(e){return new Promise((function(t,r){var n=new Image;n.onload=function(){return t(n)},n.onerror=r,n.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent((new XMLSerializer).serializeToString(e))}))},Uo={get SUPPORT_RANGE_BOUNDS(){var e=_o(document);return Object.defineProperty(Uo,"SUPPORT_RANGE_BOUNDS",{value:e}),e},get SUPPORT_WORD_BREAKING(){var e=Uo.SUPPORT_RANGE_BOUNDS&&wo(document);return Object.defineProperty(Uo,"SUPPORT_WORD_BREAKING",{value:e}),e},get SUPPORT_SVG_DRAWING(){var e=vo(document);return Object.defineProperty(Uo,"SUPPORT_SVG_DRAWING",{value:e}),e},get SUPPORT_FOREIGNOBJECT_DRAWING(){var e="function"==typeof Array.from&&"function"==typeof window.fetch?Co(document):Promise.resolve(!1);return Object.defineProperty(Uo,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:e}),e},get SUPPORT_CORS_IMAGES(){var e=xo();return Object.defineProperty(Uo,"SUPPORT_CORS_IMAGES",{value:e}),e},get SUPPORT_RESPONSE_TYPE(){var e=Bo();return Object.defineProperty(Uo,"SUPPORT_RESPONSE_TYPE",{value:e}),e},get SUPPORT_CORS_XHR(){var e="withCredentials"in new XMLHttpRequest;return Object.defineProperty(Uo,"SUPPORT_CORS_XHR",{value:e}),e},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){var e=!("undefined"==typeof Intl||!Intl.Segmenter);return Object.defineProperty(Uo,"SUPPORT_NATIVE_TEXT_SEGMENTATION",{value:e}),e}},Qo=function(){function e(e,t){this.text=e,this.bounds=t}return e}(),Io=function(e,t,r,n){var i=Do(t,r),A=[],s=0;return i.forEach((function(t){if(r.textDecorationLine.length||t.trim().length>0)if(Uo.SUPPORT_RANGE_BOUNDS){var i=So(n,s,t.length).getClientRects();if(i.length>1){var a=Mo(t),l=0;a.forEach((function(t){A.push(new Qo(t,o.fromDOMRectList(e,So(n,l+s,t.length).getClientRects()))),l+=t.length}))}else A.push(new Qo(t,o.fromDOMRectList(e,i)))}else{var c=n.splitText(t.length);A.push(new Qo(t,To(e,n))),n=c}else Uo.SUPPORT_RANGE_BOUNDS||(n=n.splitText(t.length));s+=t.length})),A},To=function(e,t){var r=t.ownerDocument;if(r){var n=r.createElement("html2canvaswrapper");n.appendChild(t.cloneNode(!0));var i=t.parentNode;if(i){i.replaceChild(n,t);var A=s(e,n);return n.firstChild&&i.replaceChild(n.firstChild,n),A}}return o.EMPTY},So=function(e,t,r){var n=e.ownerDocument;if(!n)throw new Error("Node has no owner document");var i=n.createRange();return i.setStart(e,t),i.setEnd(e,t+r),i},Mo=function(e){if(Uo.SUPPORT_NATIVE_TEXT_SEGMENTATION){var t=new Intl.Segmenter(void 0,{granularity:"grapheme"});return Array.from(t.segment(e)).map((function(e){return e.segment}))}return yo(e)},ko=function(e,t){if(Uo.SUPPORT_NATIVE_TEXT_SEGMENTATION){var r=new Intl.Segmenter(void 0,{granularity:"word"});return Array.from(r.segment(e)).map((function(e){return e.segment}))}return Po(e,t)},Do=function(e,t){return 0!==t.letterSpacing?Mo(e):ko(e,t)},Lo=[32,160,4961,65792,65793,4153,4241],Po=function(e,t){for(var r,n=Ke(e,{lineBreak:t.lineBreak,wordBreak:"break-word"===t.overflowWrap?"break-word":t.wordBreak}),i=[],A=function(){if(r.value){var e=r.value.slice(),t=l(e),n="";t.forEach((function(e){-1===Lo.indexOf(e)?n+=c(e):(n.length&&i.push(n),i.push(c(e)),n="")})),n.length&&i.push(n)}};!(r=n.next()).done;)A();return i},Ho=function(){function e(e,t,r){this.text=zo(t.data,r.textTransform),this.textBounds=Io(e,this.text,r,t)}return e}(),zo=function(e,t){switch(t){case 1:return e.toLowerCase();case 3:return e.replace(Ro,Oo);case 2:return e.toUpperCase();default:return e}},Ro=/(^|\s|:|-|\(|\))([a-z])/g,Oo=function(e,t,r){return e.length>0?t+r.toUpperCase():e},Ko=function(e){function r(t,r){var n=e.call(this,t,r)||this;return n.src=r.currentSrc||r.src,n.intrinsicWidth=r.naturalWidth,n.intrinsicHeight=r.naturalHeight,n.context.cache.addImage(n.src),n}return t(r,e),r}(CA),Vo=function(e){function r(t,r){var n=e.call(this,t,r)||this;return n.canvas=r,n.intrinsicWidth=r.width,n.intrinsicHeight=r.height,n}return t(r,e),r}(CA),$o=function(e){function r(t,r){var n=e.call(this,t,r)||this,i=new XMLSerializer,A=s(t,r);return r.setAttribute("width",A.width+"px"),r.setAttribute("height",A.height+"px"),n.svg="data:image/svg+xml,"+encodeURIComponent(i.serializeToString(r)),n.intrinsicWidth=r.width.baseVal.value,n.intrinsicHeight=r.height.baseVal.value,n.context.cache.addImage(n.svg),n}return t(r,e),r}(CA),No=function(e){function r(t,r){var n=e.call(this,t,r)||this;return n.value=r.value,n}return t(r,e),r}(CA),Go=function(e){function r(t,r){var n=e.call(this,t,r)||this;return n.start=r.start,n.reversed="boolean"==typeof r.reversed&&!0===r.reversed,n}return t(r,e),r}(CA),qo=[{type:15,flags:0,unit:"px",number:3}],Xo=[{type:16,flags:0,number:50}],jo=function(e){return e.width>e.height?new o(e.left+(e.width-e.height)/2,e.top,e.height,e.height):e.width<e.height?new o(e.left,e.top+(e.height-e.width)/2,e.width,e.width):e},Zo=function(e){var t=e.type===Yo?new Array(e.value.length+1).join("•"):e.value;return 0===t.length?e.placeholder||"":t},Jo="checkbox",Wo="radio",Yo="password",es=707406591,ts=function(e){function r(t,r){var n=e.call(this,t,r)||this;switch(n.type=r.type.toLowerCase(),n.checked=r.checked,n.value=Zo(r),n.type!==Jo&&n.type!==Wo||(n.styles.backgroundColor=3739148031,n.styles.borderTopColor=n.styles.borderRightColor=n.styles.borderBottomColor=n.styles.borderLeftColor=2779096575,n.styles.borderTopWidth=n.styles.borderRightWidth=n.styles.borderBottomWidth=n.styles.borderLeftWidth=1,n.styles.borderTopStyle=n.styles.borderRightStyle=n.styles.borderBottomStyle=n.styles.borderLeftStyle=1,n.styles.backgroundClip=[0],n.styles.backgroundOrigin=[0],n.bounds=jo(n.bounds)),n.type){case Jo:n.styles.borderTopRightRadius=n.styles.borderTopLeftRadius=n.styles.borderBottomRightRadius=n.styles.borderBottomLeftRadius=qo;break;case Wo:n.styles.borderTopRightRadius=n.styles.borderTopLeftRadius=n.styles.borderBottomRightRadius=n.styles.borderBottomLeftRadius=Xo}return n}return t(r,e),r}(CA),rs=function(e){function r(t,r){var n=e.call(this,t,r)||this,i=r.options[r.selectedIndex||0];return n.value=i&&i.text||"",n}return t(r,e),r}(CA),ns=function(e){function r(t,r){var n=e.call(this,t,r)||this;return n.value=r.value,n}return t(r,e),r}(CA),is=function(e){function r(t,r){var n=e.call(this,t,r)||this;n.src=r.src,n.width=parseInt(r.width,10)||0,n.height=parseInt(r.height,10)||0,n.backgroundColor=n.styles.backgroundColor;try{if(r.contentWindow&&r.contentWindow.document&&r.contentWindow.document.documentElement){n.tree=as(t,r.contentWindow.document.documentElement);var i=r.contentWindow.document.documentElement?un(t,getComputedStyle(r.contentWindow.document.documentElement).backgroundColor):hn.TRANSPARENT,A=r.contentWindow.document.body?un(t,getComputedStyle(r.contentWindow.document.body).backgroundColor):hn.TRANSPARENT;n.backgroundColor=rn(i)?rn(A)?n.styles.backgroundColor:A:i}}catch(e){}return n}return t(r,e),r}(CA),As=["OL","UL","MENU"],os=function(e,t,r,n){for(var i=t.firstChild,A=void 0;i;i=A)if(A=i.nextSibling,us(i)&&i.data.trim().length>0)r.textNodes.push(new Ho(e,i,r.styles));else if(hs(i))if(Qs(i)&&i.assignedNodes)i.assignedNodes().forEach((function(t){return os(e,t,r,n)}));else{var o=ss(e,i);o.styles.isVisible()&&(ls(i,o,n)?o.flags|=4:cs(o.styles)&&(o.flags|=2),-1!==As.indexOf(i.tagName)&&(o.flags|=8),r.elements.push(o),i.slot,i.shadowRoot?os(e,i.shadowRoot,o,n):Es(i)||_s(i)||Us(i)||os(e,i,o,n))}},ss=function(e,t){return vs(t)?new Ko(e,t):xs(t)?new Vo(e,t):_s(t)?new $o(e,t):fs(t)?new No(e,t):ms(t)?new Go(e,t):gs(t)?new ts(e,t):Us(t)?new rs(e,t):Es(t)?new ns(e,t):bs(t)?new is(e,t):new CA(e,t)},as=function(e,t){var r=ss(e,t);return r.flags|=4,os(e,t,r,r),r},ls=function(e,t,r){return t.styles.isPositionedWithZIndex()||t.styles.opacity<1||t.styles.isTransformed()||ws(e)&&r.styles.isTransparent()},cs=function(e){return e.isPositioned()||e.isFloating()},us=function(e){return e.nodeType===Node.TEXT_NODE},hs=function(e){return e.nodeType===Node.ELEMENT_NODE},ds=function(e){return hs(e)&&void 0!==e.style&&!ps(e)},ps=function(e){return"object"==typeof e.className},fs=function(e){return"LI"===e.tagName},ms=function(e){return"OL"===e.tagName},gs=function(e){return"INPUT"===e.tagName},ys=function(e){return"HTML"===e.tagName},_s=function(e){return"svg"===e.tagName},ws=function(e){return"BODY"===e.tagName},xs=function(e){return"CANVAS"===e.tagName},Bs=function(e){return"VIDEO"===e.tagName},vs=function(e){return"IMG"===e.tagName},bs=function(e){return"IFRAME"===e.tagName},Cs=function(e){return"STYLE"===e.tagName},Fs=function(e){return"SCRIPT"===e.tagName},Es=function(e){return"TEXTAREA"===e.tagName},Us=function(e){return"SELECT"===e.tagName},Qs=function(e){return"SLOT"===e.tagName},Is=function(e){return e.tagName.indexOf("-")>0},Ts=function(){function e(){this.counters={}}return e.prototype.getCounterValue=function(e){var t=this.counters[e];return t&&t.length?t[t.length-1]:1},e.prototype.getCounterValues=function(e){var t=this.counters[e];return t||[]},e.prototype.pop=function(e){var t=this;e.forEach((function(e){return t.counters[e].pop()}))},e.prototype.parse=function(e){var t=this,r=e.counterIncrement,n=e.counterReset,i=!0;null!==r&&r.forEach((function(e){var r=t.counters[e.counter];r&&0!==e.increment&&(i=!1,r.length||r.push(1),r[Math.max(0,r.length-1)]+=e.increment)}));var A=[];return i&&n.forEach((function(e){var r=t.counters[e.counter];A.push(e.counter),r||(r=t.counters[e.counter]=[]),r.push(e.reset)})),A},e}(),Ss={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},Ms={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["Ք","Փ","Ւ","Ց","Ր","Տ","Վ","Ս","Ռ","Ջ","Պ","Չ","Ո","Շ","Ն","Յ","Մ","Ճ","Ղ","Ձ","Հ","Կ","Ծ","Խ","Լ","Ի","Ժ","Թ","Ը","Է","Զ","Ե","Դ","Գ","Բ","Ա"]},ks={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["י׳","ט׳","ח׳","ז׳","ו׳","ה׳","ד׳","ג׳","ב׳","א׳","ת","ש","ר","ק","צ","פ","ע","ס","נ","מ","ל","כ","יט","יח","יז","טז","טו","י","ט","ח","ז","ו","ה","ד","ג","ב","א"]},Ds={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["ჵ","ჰ","ჯ","ჴ","ხ","ჭ","წ","ძ","ც","ჩ","შ","ყ","ღ","ქ","ფ","ჳ","ტ","ს","რ","ჟ","პ","ო","ჲ","ნ","მ","ლ","კ","ი","თ","ჱ","ზ","ვ","ე","დ","გ","ბ","ა"]},Ls=function(e,t,r,n,i,A){return e<t||e>r?js(e,i,A.length>0):n.integers.reduce((function(t,r,i){for(;e>=r;)e-=r,t+=n.values[i];return t}),"")+A},Ps=function(e,t,r,n){var i="";do{r||e--,i=n(e)+i,e/=t}while(e*t>=t);return i},Hs=function(e,t,r,n,i){var A=r-t+1;return(e<0?"-":"")+(Ps(Math.abs(e),A,n,(function(e){return c(Math.floor(e%A)+t)}))+i)},zs=function(e,t,r){void 0===r&&(r=". ");var n=t.length;return Ps(Math.abs(e),n,!1,(function(e){return t[Math.floor(e%n)]}))+r},Rs=1,Os=2,Ks=4,Vs=8,$s=function(e,t,r,n,i,A){if(e<-9999||e>9999)return js(e,4,i.length>0);var o=Math.abs(e),s=i;if(0===o)return t[0]+s;for(var a=0;o>0&&a<=4;a++){var l=o%10;0===l&&sA(A,Rs)&&""!==s?s=t[l]+s:l>1||1===l&&0===a||1===l&&1===a&&sA(A,Os)||1===l&&1===a&&sA(A,Ks)&&e>100||1===l&&a>1&&sA(A,Vs)?s=t[l]+(a>0?r[a-1]:"")+s:1===l&&a>0&&(s=r[a-1]+s),o=Math.floor(o/10)}return(e<0?n:"")+s},Ns="十百千萬",Gs="拾佰仟萬",qs="マイナス",Xs="마이너스",js=function(e,t,r){var n=r?". ":"",i=r?"、":"",A=r?", ":"",o=r?" ":"";switch(t){case 0:return"•"+o;case 1:return"◦"+o;case 2:return"◾"+o;case 5:var s=Hs(e,48,57,!0,n);return s.length<4?"0"+s:s;case 4:return zs(e,"〇一二三四五六七八九",i);case 6:return Ls(e,1,3999,Ss,3,n).toLowerCase();case 7:return Ls(e,1,3999,Ss,3,n);case 8:return Hs(e,945,969,!1,n);case 9:return Hs(e,97,122,!1,n);case 10:return Hs(e,65,90,!1,n);case 11:return Hs(e,1632,1641,!0,n);case 12:case 49:return Ls(e,1,9999,Ms,3,n);case 35:return Ls(e,1,9999,Ms,3,n).toLowerCase();case 13:return Hs(e,2534,2543,!0,n);case 14:case 30:return Hs(e,6112,6121,!0,n);case 15:return zs(e,"子丑寅卯辰巳午未申酉戌亥",i);case 16:return zs(e,"甲乙丙丁戊己庚辛壬癸",i);case 17:case 48:return $s(e,"零一二三四五六七八九",Ns,"負",i,Os|Ks|Vs);case 47:return $s(e,"零壹貳參肆伍陸柒捌玖",Gs,"負",i,Rs|Os|Ks|Vs);case 42:return $s(e,"零一二三四五六七八九",Ns,"负",i,Os|Ks|Vs);case 41:return $s(e,"零壹贰叁肆伍陆柒捌玖",Gs,"负",i,Rs|Os|Ks|Vs);case 26:return $s(e,"〇一二三四五六七八九","十百千万",qs,i,0);case 25:return $s(e,"零壱弐参四伍六七八九","拾百千万",qs,i,Rs|Os|Ks);case 31:return $s(e,"영일이삼사오육칠팔구","십백천만",Xs,A,Rs|Os|Ks);case 33:return $s(e,"零一二三四五六七八九","十百千萬",Xs,A,0);case 32:return $s(e,"零壹貳參四五六七八九","拾百千",Xs,A,Rs|Os|Ks);case 18:return Hs(e,2406,2415,!0,n);case 20:return Ls(e,1,19999,Ds,3,n);case 21:return Hs(e,2790,2799,!0,n);case 22:return Hs(e,2662,2671,!0,n);case 22:return Ls(e,1,10999,ks,3,n);case 23:return zs(e,"あいうえおかきくけこさしすせそたちつてとなにぬねのはひふへほまみむめもやゆよらりるれろわゐゑをん");case 24:return zs(e,"いろはにほへとちりぬるをわかよたれそつねならむうゐのおくやまけふこえてあさきゆめみしゑひもせす");case 27:return Hs(e,3302,3311,!0,n);case 28:return zs(e,"アイウエオカキクケコサシスセソタチツテトナニヌネノハヒフヘホマミムメモヤユヨラリルレロワヰヱヲン",i);case 29:return zs(e,"イロハニホヘトチリヌルヲワカヨタレソツネナラムウヰノオクヤマケフコエテアサキユメミシヱヒモセス",i);case 34:return Hs(e,3792,3801,!0,n);case 37:return Hs(e,6160,6169,!0,n);case 38:return Hs(e,4160,4169,!0,n);case 39:return Hs(e,2918,2927,!0,n);case 40:return Hs(e,1776,1785,!0,n);case 43:return Hs(e,3046,3055,!0,n);case 44:return Hs(e,3174,3183,!0,n);case 45:return Hs(e,3664,3673,!0,n);case 46:return Hs(e,3872,3881,!0,n);default:return Hs(e,48,57,!0,n)}},Zs="data-html2canvas-ignore",Js=function(){function e(e,t,r){if(this.context=e,this.options=r,this.scrolledElements=[],this.referenceElement=t,this.counters=new Ts,this.quoteDepth=0,!t.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(t.ownerDocument.documentElement,!1)}return e.prototype.toIFrame=function(e,t){var r=this,A=Ys(e,t);if(!A.contentWindow)return Promise.reject("Unable to find iframe window");var o=e.defaultView.pageXOffset,s=e.defaultView.pageYOffset,a=A.contentWindow,l=a.document,c=ra(A).then((function(){return n(r,void 0,void 0,(function(){var e,r;return i(this,(function(n){switch(n.label){case 0:return this.scrolledElements.forEach(sa),a&&(a.scrollTo(t.left,t.top),!/(iPad|iPhone|iPod)/g.test(navigator.userAgent)||a.scrollY===t.top&&a.scrollX===t.left||(this.context.logger.warn("Unable to restore scroll position for cloned document"),this.context.windowBounds=this.context.windowBounds.add(a.scrollX-t.left,a.scrollY-t.top,0,0))),e=this.options.onclone,void 0===(r=this.clonedReferenceElement)?[2,Promise.reject("Error finding the "+this.referenceElement.nodeName+" in the cloned document")]:l.fonts&&l.fonts.ready?[4,l.fonts.ready]:[3,2];case 1:n.sent(),n.label=2;case 2:return/(AppleWebKit)/g.test(navigator.userAgent)?[4,ta(l)]:[3,4];case 3:n.sent(),n.label=4;case 4:return"function"==typeof e?[2,Promise.resolve().then((function(){return e(l,r)})).then((function(){return A}))]:[2,A]}}))}))}));return l.open(),l.write(Aa(document.doctype)+"<html></html>"),oa(this.referenceElement.ownerDocument,o,s),l.replaceChild(l.adoptNode(this.documentElement),l.documentElement),l.close(),c},e.prototype.createElementClone=function(e){if(bA(e,2),xs(e))return this.createCanvasClone(e);if(Bs(e))return this.createVideoClone(e);if(Cs(e))return this.createStyleClone(e);var t=e.cloneNode(!1);return vs(t)&&(vs(e)&&e.currentSrc&&e.currentSrc!==e.src&&(t.src=e.currentSrc,t.srcset=""),"lazy"===t.loading&&(t.loading="eager")),Is(t)?this.createCustomElementClone(t):t},e.prototype.createCustomElementClone=function(e){var t=document.createElement("html2canvascustomelement");return ia(e.style,t),t},e.prototype.createStyleClone=function(e){try{var t=e.sheet;if(t&&t.cssRules){var r=[].slice.call(t.cssRules,0).reduce((function(e,t){return t&&"string"==typeof t.cssText?e+t.cssText:e}),""),n=e.cloneNode(!1);return n.textContent=r,n}}catch(e){if(this.context.logger.error("Unable to access cssRules property",e),"SecurityError"!==e.name)throw e}return e.cloneNode(!1)},e.prototype.createCanvasClone=function(e){var t;if(this.options.inlineImages&&e.ownerDocument){var r=e.ownerDocument.createElement("img");try{return r.src=e.toDataURL(),r}catch(t){this.context.logger.info("Unable to inline canvas contents, canvas is tainted",e)}}var n=e.cloneNode(!1);try{n.width=e.width,n.height=e.height;var i=e.getContext("2d"),A=n.getContext("2d");if(A)if(!this.options.allowTaint&&i)A.putImageData(i.getImageData(0,0,e.width,e.height),0,0);else{var o=null!==(t=e.getContext("webgl2"))&&void 0!==t?t:e.getContext("webgl");if(o){var s=o.getContextAttributes();!1===(null==s?void 0:s.preserveDrawingBuffer)&&this.context.logger.warn("Unable to clone WebGL context as it has preserveDrawingBuffer=false",e)}A.drawImage(e,0,0)}return n}catch(t){this.context.logger.info("Unable to clone canvas as it is tainted",e)}return n},e.prototype.createVideoClone=function(e){var t=e.ownerDocument.createElement("canvas");t.width=e.offsetWidth,t.height=e.offsetHeight;var r=t.getContext("2d");try{return r&&(r.drawImage(e,0,0,t.width,t.height),this.options.allowTaint||r.getImageData(0,0,t.width,t.height)),t}catch(t){this.context.logger.info("Unable to clone video as it is tainted",e)}var n=e.ownerDocument.createElement("canvas");return n.width=e.offsetWidth,n.height=e.offsetHeight,n},e.prototype.appendChildNode=function(e,t,r){hs(t)&&(Fs(t)||t.hasAttribute(Zs)||"function"==typeof this.options.ignoreElements&&this.options.ignoreElements(t))||this.options.copyStyles&&hs(t)&&Cs(t)||e.appendChild(this.cloneNode(t,r))},e.prototype.cloneChildNodes=function(e,t,r){for(var n=this,i=e.shadowRoot?e.shadowRoot.firstChild:e.firstChild;i;i=i.nextSibling)if(hs(i)&&Qs(i)&&"function"==typeof i.assignedNodes){var A=i.assignedNodes();A.length&&A.forEach((function(e){return n.appendChildNode(t,e,r)}))}else this.appendChildNode(t,i,r)},e.prototype.cloneNode=function(e,t){if(us(e))return document.createTextNode(e.data);if(!e.ownerDocument)return e.cloneNode(!1);var r=e.ownerDocument.defaultView;if(r&&hs(e)&&(ds(e)||ps(e))){var n=this.createElementClone(e);n.style.transitionProperty="none";var i=r.getComputedStyle(e),A=r.getComputedStyle(e,":before"),o=r.getComputedStyle(e,":after");this.referenceElement===e&&ds(n)&&(this.clonedReferenceElement=n),ws(n)&&da(n);var s=this.counters.parse(new wA(this.context,i)),a=this.resolvePseudoContent(e,n,A,XA.BEFORE);Is(e)&&(t=!0),Bs(e)||this.cloneChildNodes(e,n,t),a&&n.insertBefore(a,n.firstChild);var l=this.resolvePseudoContent(e,n,o,XA.AFTER);return l&&n.appendChild(l),this.counters.pop(s),(i&&(this.options.copyStyles||ps(e))&&!bs(e)||t)&&ia(i,n),0===e.scrollTop&&0===e.scrollLeft||this.scrolledElements.push([n,e.scrollLeft,e.scrollTop]),(Es(e)||Us(e))&&(Es(n)||Us(n))&&(n.value=e.value),n}return e.cloneNode(!1)},e.prototype.resolvePseudoContent=function(e,t,r,n){var i=this;if(r){var A=r.content,o=t.ownerDocument;if(o&&A&&"none"!==A&&"-moz-alt-content"!==A&&"none"!==r.display){this.counters.parse(new wA(this.context,r));var s=new _A(this.context,r),a=o.createElement("html2canvaspseudoelement");ia(r,a),s.content.forEach((function(t){if(0===t.type)a.appendChild(o.createTextNode(t.value));else if(22===t.type){var r=o.createElement("img");r.src=t.value,r.style.opacity="1",a.appendChild(r)}else if(18===t.type){if("attr"===t.name){var n=t.values.filter(Sr);n.length&&a.appendChild(o.createTextNode(e.getAttribute(n[0].value)||""))}else if("counter"===t.name){var A=t.values.filter(Lr),l=A[0],c=A[1];if(l&&Sr(l)){var u=i.counters.getCounterValue(l.value),h=c&&Sr(c)?Ei.parse(i.context,c.value):3;a.appendChild(o.createTextNode(js(u,h,!1)))}}else if("counters"===t.name){var d=t.values.filter(Lr),p=(l=d[0],d[1]);if(c=d[2],l&&Sr(l)){var f=i.counters.getCounterValues(l.value),m=c&&Sr(c)?Ei.parse(i.context,c.value):3,g=p&&0===p.type?p.value:"",y=f.map((function(e){return js(e,m,!1)})).join(g);a.appendChild(o.createTextNode(y))}}}else if(20===t.type)switch(t.value){case"open-quote":a.appendChild(o.createTextNode(dA(s.quotes,i.quoteDepth++,!0)));break;case"close-quote":a.appendChild(o.createTextNode(dA(s.quotes,--i.quoteDepth,!1)));break;default:a.appendChild(o.createTextNode(t.value))}})),a.className=ca+" "+ua;var l=n===XA.BEFORE?" "+ca:" "+ua;return ps(t)?t.className.baseValue+=l:t.className+=l,a}}},e.destroy=function(e){return!!e.parentNode&&(e.parentNode.removeChild(e),!0)},e}();!function(e){e[e.BEFORE=0]="BEFORE",e[e.AFTER=1]="AFTER"}(XA||(XA={}));var Ws,Ys=function(e,t){var r=e.createElement("iframe");return r.className="html2canvas-container",r.style.visibility="hidden",r.style.position="fixed",r.style.left="-10000px",r.style.top="0px",r.style.border="0",r.width=t.width.toString(),r.height=t.height.toString(),r.scrolling="no",r.setAttribute(Zs,"true"),e.body.appendChild(r),r},ea=function(e){return new Promise((function(t){e.complete?t():e.src?(e.onload=t,e.onerror=t):t()}))},ta=function(e){return Promise.all([].slice.call(e.images,0).map(ea))},ra=function(e){return new Promise((function(t,r){var n=e.contentWindow;if(!n)return r("No window assigned for iframe");var i=n.document;n.onload=e.onload=function(){n.onload=e.onload=null;var r=setInterval((function(){i.body.childNodes.length>0&&"complete"===i.readyState&&(clearInterval(r),t(e))}),50)}}))},na=["all","d","content"],ia=function(e,t){for(var r=e.length-1;r>=0;r--){var n=e.item(r);-1===na.indexOf(n)&&t.style.setProperty(n,e.getPropertyValue(n))}return t},Aa=function(e){var t="";return e&&(t+="<!DOCTYPE ",e.name&&(t+=e.name),e.internalSubset&&(t+=e.internalSubset),e.publicId&&(t+='"'+e.publicId+'"'),e.systemId&&(t+='"'+e.systemId+'"'),t+=">"),t},oa=function(e,t,r){e&&e.defaultView&&(t!==e.defaultView.pageXOffset||r!==e.defaultView.pageYOffset)&&e.defaultView.scrollTo(t,r)},sa=function(e){var t=e[0],r=e[1],n=e[2];t.scrollLeft=r,t.scrollTop=n},aa=":before",la=":after",ca="___html2canvas___pseudoelement_before",ua="___html2canvas___pseudoelement_after",ha='{\n    content: "" !important;\n    display: none !important;\n}',da=function(e){pa(e,"."+ca+aa+ha+"\n         ."+ua+la+ha)},pa=function(e,t){var r=e.ownerDocument;if(r){var n=r.createElement("style");n.textContent=t,e.appendChild(n)}},fa=function(){function e(){}return e.getOrigin=function(t){var r=e._link;return r?(r.href=t,r.href=r.href,r.protocol+r.hostname+r.port):"about:blank"},e.isSameOrigin=function(t){return e.getOrigin(t)===e._origin},e.setContext=function(t){e._link=t.document.createElement("a"),e._origin=e.getOrigin(t.location.href)},e._origin="about:blank",e}(),ma=function(){function e(e,t){this.context=e,this._options=t,this._cache={}}return e.prototype.addImage=function(e){var t=Promise.resolve();return this.has(e)?t:va(e)||wa(e)?((this._cache[e]=this.loadImage(e)).catch((function(){})),t):t},e.prototype.match=function(e){return this._cache[e]},e.prototype.loadImage=function(e){return n(this,void 0,void 0,(function(){var t,r,n,A,o=this;return i(this,(function(i){switch(i.label){case 0:return t=fa.isSameOrigin(e),r=!xa(e)&&!0===this._options.useCORS&&Uo.SUPPORT_CORS_IMAGES&&!t,n=!xa(e)&&!t&&!va(e)&&"string"==typeof this._options.proxy&&Uo.SUPPORT_CORS_XHR&&!r,t||!1!==this._options.allowTaint||xa(e)||va(e)||n||r?(A=e,n?[4,this.proxy(A)]:[3,2]):[2];case 1:A=i.sent(),i.label=2;case 2:return this.context.logger.debug("Added image "+e.substring(0,256)),[4,new Promise((function(e,t){var n=new Image;n.onload=function(){return e(n)},n.onerror=t,(Ba(A)||r)&&(n.crossOrigin="anonymous"),n.src=A,!0===n.complete&&setTimeout((function(){return e(n)}),500),o._options.imageTimeout>0&&setTimeout((function(){return t("Timed out ("+o._options.imageTimeout+"ms) loading image")}),o._options.imageTimeout)}))];case 3:return[2,i.sent()]}}))}))},e.prototype.has=function(e){return void 0!==this._cache[e]},e.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},e.prototype.proxy=function(e){var t=this,r=this._options.proxy;if(!r)throw new Error("No proxy defined");var n=e.substring(0,256);return new Promise((function(i,A){var o=Uo.SUPPORT_RESPONSE_TYPE?"blob":"text",s=new XMLHttpRequest;s.onload=function(){if(200===s.status)if("text"===o)i(s.response);else{var e=new FileReader;e.addEventListener("load",(function(){return i(e.result)}),!1),e.addEventListener("error",(function(e){return A(e)}),!1),e.readAsDataURL(s.response)}else A("Failed to proxy resource "+n+" with status code "+s.status)},s.onerror=A;var a=r.indexOf("?")>-1?"&":"?";if(s.open("GET",""+r+a+"url="+encodeURIComponent(e)+"&responseType="+o),"text"!==o&&s instanceof XMLHttpRequest&&(s.responseType=o),t._options.imageTimeout){var l=t._options.imageTimeout;s.timeout=l,s.ontimeout=function(){return A("Timed out ("+l+"ms) proxying "+n)}}s.send()}))},e}(),ga=/^data:image\/svg\+xml/i,ya=/^data:image\/.*;base64,/i,_a=/^data:image\/.*/i,wa=function(e){return Uo.SUPPORT_SVG_DRAWING||!ba(e)},xa=function(e){return _a.test(e)},Ba=function(e){return ya.test(e)},va=function(e){return"blob"===e.substr(0,4)},ba=function(e){return"svg"===e.substr(-3).toLowerCase()||ga.test(e)},Ca=function(){function e(e,t){this.type=0,this.x=e,this.y=t}return e.prototype.add=function(t,r){return new e(this.x+t,this.y+r)},e}(),Fa=function(e,t,r){return new Ca(e.x+(t.x-e.x)*r,e.y+(t.y-e.y)*r)},Ea=function(){function e(e,t,r,n){this.type=1,this.start=e,this.startControl=t,this.endControl=r,this.end=n}return e.prototype.subdivide=function(t,r){var n=Fa(this.start,this.startControl,t),i=Fa(this.startControl,this.endControl,t),A=Fa(this.endControl,this.end,t),o=Fa(n,i,t),s=Fa(i,A,t),a=Fa(o,s,t);return r?new e(this.start,n,o,a):new e(a,s,A,this.end)},e.prototype.add=function(t,r){return new e(this.start.add(t,r),this.startControl.add(t,r),this.endControl.add(t,r),this.end.add(t,r))},e.prototype.reverse=function(){return new e(this.end,this.endControl,this.startControl,this.start)},e}(),Ua=function(e){return 1===e.type},Qa=function(){function e(e){var t=e.styles,r=e.bounds,n=Nr(t.borderTopLeftRadius,r.width,r.height),i=n[0],A=n[1],o=Nr(t.borderTopRightRadius,r.width,r.height),s=o[0],a=o[1],l=Nr(t.borderBottomRightRadius,r.width,r.height),c=l[0],u=l[1],h=Nr(t.borderBottomLeftRadius,r.width,r.height),d=h[0],p=h[1],f=[];f.push((i+s)/r.width),f.push((d+c)/r.width),f.push((A+p)/r.height),f.push((a+u)/r.height);var m=Math.max.apply(Math,f);m>1&&(i/=m,A/=m,s/=m,a/=m,c/=m,u/=m,d/=m,p/=m);var g=r.width-s,y=r.height-u,_=r.width-c,w=r.height-p,x=t.borderTopWidth,B=t.borderRightWidth,v=t.borderBottomWidth,b=t.borderLeftWidth,C=Gr(t.paddingTop,e.bounds.width),F=Gr(t.paddingRight,e.bounds.width),E=Gr(t.paddingBottom,e.bounds.width),U=Gr(t.paddingLeft,e.bounds.width);this.topLeftBorderDoubleOuterBox=i>0||A>0?Ia(r.left+b/3,r.top+x/3,i-b/3,A-x/3,Ws.TOP_LEFT):new Ca(r.left+b/3,r.top+x/3),this.topRightBorderDoubleOuterBox=i>0||A>0?Ia(r.left+g,r.top+x/3,s-B/3,a-x/3,Ws.TOP_RIGHT):new Ca(r.left+r.width-B/3,r.top+x/3),this.bottomRightBorderDoubleOuterBox=c>0||u>0?Ia(r.left+_,r.top+y,c-B/3,u-v/3,Ws.BOTTOM_RIGHT):new Ca(r.left+r.width-B/3,r.top+r.height-v/3),this.bottomLeftBorderDoubleOuterBox=d>0||p>0?Ia(r.left+b/3,r.top+w,d-b/3,p-v/3,Ws.BOTTOM_LEFT):new Ca(r.left+b/3,r.top+r.height-v/3),this.topLeftBorderDoubleInnerBox=i>0||A>0?Ia(r.left+2*b/3,r.top+2*x/3,i-2*b/3,A-2*x/3,Ws.TOP_LEFT):new Ca(r.left+2*b/3,r.top+2*x/3),this.topRightBorderDoubleInnerBox=i>0||A>0?Ia(r.left+g,r.top+2*x/3,s-2*B/3,a-2*x/3,Ws.TOP_RIGHT):new Ca(r.left+r.width-2*B/3,r.top+2*x/3),this.bottomRightBorderDoubleInnerBox=c>0||u>0?Ia(r.left+_,r.top+y,c-2*B/3,u-2*v/3,Ws.BOTTOM_RIGHT):new Ca(r.left+r.width-2*B/3,r.top+r.height-2*v/3),this.bottomLeftBorderDoubleInnerBox=d>0||p>0?Ia(r.left+2*b/3,r.top+w,d-2*b/3,p-2*v/3,Ws.BOTTOM_LEFT):new Ca(r.left+2*b/3,r.top+r.height-2*v/3),this.topLeftBorderStroke=i>0||A>0?Ia(r.left+b/2,r.top+x/2,i-b/2,A-x/2,Ws.TOP_LEFT):new Ca(r.left+b/2,r.top+x/2),this.topRightBorderStroke=i>0||A>0?Ia(r.left+g,r.top+x/2,s-B/2,a-x/2,Ws.TOP_RIGHT):new Ca(r.left+r.width-B/2,r.top+x/2),this.bottomRightBorderStroke=c>0||u>0?Ia(r.left+_,r.top+y,c-B/2,u-v/2,Ws.BOTTOM_RIGHT):new Ca(r.left+r.width-B/2,r.top+r.height-v/2),this.bottomLeftBorderStroke=d>0||p>0?Ia(r.left+b/2,r.top+w,d-b/2,p-v/2,Ws.BOTTOM_LEFT):new Ca(r.left+b/2,r.top+r.height-v/2),this.topLeftBorderBox=i>0||A>0?Ia(r.left,r.top,i,A,Ws.TOP_LEFT):new Ca(r.left,r.top),this.topRightBorderBox=s>0||a>0?Ia(r.left+g,r.top,s,a,Ws.TOP_RIGHT):new Ca(r.left+r.width,r.top),this.bottomRightBorderBox=c>0||u>0?Ia(r.left+_,r.top+y,c,u,Ws.BOTTOM_RIGHT):new Ca(r.left+r.width,r.top+r.height),this.bottomLeftBorderBox=d>0||p>0?Ia(r.left,r.top+w,d,p,Ws.BOTTOM_LEFT):new Ca(r.left,r.top+r.height),this.topLeftPaddingBox=i>0||A>0?Ia(r.left+b,r.top+x,Math.max(0,i-b),Math.max(0,A-x),Ws.TOP_LEFT):new Ca(r.left+b,r.top+x),this.topRightPaddingBox=s>0||a>0?Ia(r.left+Math.min(g,r.width-B),r.top+x,g>r.width+B?0:Math.max(0,s-B),Math.max(0,a-x),Ws.TOP_RIGHT):new Ca(r.left+r.width-B,r.top+x),this.bottomRightPaddingBox=c>0||u>0?Ia(r.left+Math.min(_,r.width-b),r.top+Math.min(y,r.height-v),Math.max(0,c-B),Math.max(0,u-v),Ws.BOTTOM_RIGHT):new Ca(r.left+r.width-B,r.top+r.height-v),this.bottomLeftPaddingBox=d>0||p>0?Ia(r.left+b,r.top+Math.min(w,r.height-v),Math.max(0,d-b),Math.max(0,p-v),Ws.BOTTOM_LEFT):new Ca(r.left+b,r.top+r.height-v),this.topLeftContentBox=i>0||A>0?Ia(r.left+b+U,r.top+x+C,Math.max(0,i-(b+U)),Math.max(0,A-(x+C)),Ws.TOP_LEFT):new Ca(r.left+b+U,r.top+x+C),this.topRightContentBox=s>0||a>0?Ia(r.left+Math.min(g,r.width+b+U),r.top+x+C,g>r.width+b+U?0:s-b+U,a-(x+C),Ws.TOP_RIGHT):new Ca(r.left+r.width-(B+F),r.top+x+C),this.bottomRightContentBox=c>0||u>0?Ia(r.left+Math.min(_,r.width-(b+U)),r.top+Math.min(y,r.height+x+C),Math.max(0,c-(B+F)),u-(v+E),Ws.BOTTOM_RIGHT):new Ca(r.left+r.width-(B+F),r.top+r.height-(v+E)),this.bottomLeftContentBox=d>0||p>0?Ia(r.left+b+U,r.top+w,Math.max(0,d-(b+U)),p-(v+E),Ws.BOTTOM_LEFT):new Ca(r.left+b+U,r.top+r.height-(v+E))}return e}();!function(e){e[e.TOP_LEFT=0]="TOP_LEFT",e[e.TOP_RIGHT=1]="TOP_RIGHT",e[e.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",e[e.BOTTOM_LEFT=3]="BOTTOM_LEFT"}(Ws||(Ws={}));var Ia=function(e,t,r,n,i){var A=(Math.sqrt(2)-1)/3*4,o=r*A,s=n*A,a=e+r,l=t+n;switch(i){case Ws.TOP_LEFT:return new Ea(new Ca(e,l),new Ca(e,l-s),new Ca(a-o,t),new Ca(a,t));case Ws.TOP_RIGHT:return new Ea(new Ca(e,t),new Ca(e+o,t),new Ca(a,l-s),new Ca(a,l));case Ws.BOTTOM_RIGHT:return new Ea(new Ca(a,t),new Ca(a,t+s),new Ca(e+o,l),new Ca(e,l));case Ws.BOTTOM_LEFT:default:return new Ea(new Ca(a,l),new Ca(a-o,l),new Ca(e,t+s),new Ca(e,t))}},Ta=function(e){return[e.topLeftBorderBox,e.topRightBorderBox,e.bottomRightBorderBox,e.bottomLeftBorderBox]},Sa=function(e){return[e.topLeftContentBox,e.topRightContentBox,e.bottomRightContentBox,e.bottomLeftContentBox]},Ma=function(e){return[e.topLeftPaddingBox,e.topRightPaddingBox,e.bottomRightPaddingBox,e.bottomLeftPaddingBox]},ka=function(){function e(e,t,r){this.offsetX=e,this.offsetY=t,this.matrix=r,this.type=0,this.target=6}return e}(),Da=function(){function e(e,t){this.path=e,this.target=t,this.type=1}return e}(),La=function(){function e(e){this.opacity=e,this.type=2,this.target=6}return e}(),Pa=function(e){return 0===e.type},Ha=function(e){return 1===e.type},za=function(e){return 2===e.type},Ra=function(e,t){return e.length===t.length&&e.some((function(e,r){return e===t[r]}))},Oa=function(e,t,r,n,i){return e.map((function(e,A){switch(A){case 0:return e.add(t,r);case 1:return e.add(t+n,r);case 2:return e.add(t+n,r+i);case 3:return e.add(t,r+i)}return e}))},Ka=function(){function e(e){this.element=e,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]}return e}(),Va=function(){function e(e,t){if(this.container=e,this.parent=t,this.effects=[],this.curves=new Qa(this.container),this.container.styles.opacity<1&&this.effects.push(new La(this.container.styles.opacity)),null!==this.container.styles.transform){var r=this.container.bounds.left+this.container.styles.transformOrigin[0].number,n=this.container.bounds.top+this.container.styles.transformOrigin[1].number,i=this.container.styles.transform;this.effects.push(new ka(r,n,i))}if(0!==this.container.styles.overflowX){var A=Ta(this.curves),o=Ma(this.curves);Ra(A,o)?this.effects.push(new Da(A,6)):(this.effects.push(new Da(A,2)),this.effects.push(new Da(o,4)))}}return e.prototype.getEffects=function(e){for(var t=-1===[2,3].indexOf(this.container.styles.position),r=this.parent,n=this.effects.slice(0);r;){var i=r.effects.filter((function(e){return!Ha(e)}));if(t||0!==r.container.styles.position||!r.parent){if(n.unshift.apply(n,i),t=-1===[2,3].indexOf(r.container.styles.position),0!==r.container.styles.overflowX){var A=Ta(r.curves),o=Ma(r.curves);Ra(A,o)||n.unshift(new Da(o,6))}}else n.unshift.apply(n,i);r=r.parent}return n.filter((function(t){return sA(t.target,e)}))},e}(),$a=function(e,t,r,n){e.container.elements.forEach((function(i){var A=sA(i.flags,4),o=sA(i.flags,2),s=new Va(i,e);sA(i.styles.display,2048)&&n.push(s);var a=sA(i.flags,8)?[]:n;if(A||o){var l=A||i.styles.isPositioned()?r:t,c=new Ka(s);if(i.styles.isPositioned()||i.styles.opacity<1||i.styles.isTransformed()){var u=i.styles.zIndex.order;if(u<0){var h=0;l.negativeZIndex.some((function(e,t){return u>e.element.container.styles.zIndex.order?(h=t,!1):h>0})),l.negativeZIndex.splice(h,0,c)}else if(u>0){var d=0;l.positiveZIndex.some((function(e,t){return u>=e.element.container.styles.zIndex.order?(d=t+1,!1):d>0})),l.positiveZIndex.splice(d,0,c)}else l.zeroOrAutoZIndexOrTransformedOrOpacity.push(c)}else i.styles.isFloating()?l.nonPositionedFloats.push(c):l.nonPositionedInlineLevel.push(c);$a(s,c,A?c:r,a)}else i.styles.isInlineLevel()?t.inlineLevel.push(s):t.nonInlineLevel.push(s),$a(s,t,r,a);sA(i.flags,8)&&Na(i,a)}))},Na=function(e,t){for(var r=e instanceof Go?e.start:1,n=e instanceof Go&&e.reversed,i=0;i<t.length;i++){var A=t[i];A.container instanceof No&&"number"==typeof A.container.value&&0!==A.container.value&&(r=A.container.value),A.listValue=js(r,A.container.styles.listStyleType,!0),r+=n?-1:1}},Ga=function(e){var t=new Va(e,null),r=new Ka(t),n=[];return $a(t,r,r,n),Na(t.container,n),r},qa=function(e,t){switch(t){case 0:return Wa(e.topLeftBorderBox,e.topLeftPaddingBox,e.topRightBorderBox,e.topRightPaddingBox);case 1:return Wa(e.topRightBorderBox,e.topRightPaddingBox,e.bottomRightBorderBox,e.bottomRightPaddingBox);case 2:return Wa(e.bottomRightBorderBox,e.bottomRightPaddingBox,e.bottomLeftBorderBox,e.bottomLeftPaddingBox);default:return Wa(e.bottomLeftBorderBox,e.bottomLeftPaddingBox,e.topLeftBorderBox,e.topLeftPaddingBox)}},Xa=function(e,t){switch(t){case 0:return Wa(e.topLeftBorderBox,e.topLeftBorderDoubleOuterBox,e.topRightBorderBox,e.topRightBorderDoubleOuterBox);case 1:return Wa(e.topRightBorderBox,e.topRightBorderDoubleOuterBox,e.bottomRightBorderBox,e.bottomRightBorderDoubleOuterBox);case 2:return Wa(e.bottomRightBorderBox,e.bottomRightBorderDoubleOuterBox,e.bottomLeftBorderBox,e.bottomLeftBorderDoubleOuterBox);default:return Wa(e.bottomLeftBorderBox,e.bottomLeftBorderDoubleOuterBox,e.topLeftBorderBox,e.topLeftBorderDoubleOuterBox)}},ja=function(e,t){switch(t){case 0:return Wa(e.topLeftBorderDoubleInnerBox,e.topLeftPaddingBox,e.topRightBorderDoubleInnerBox,e.topRightPaddingBox);case 1:return Wa(e.topRightBorderDoubleInnerBox,e.topRightPaddingBox,e.bottomRightBorderDoubleInnerBox,e.bottomRightPaddingBox);case 2:return Wa(e.bottomRightBorderDoubleInnerBox,e.bottomRightPaddingBox,e.bottomLeftBorderDoubleInnerBox,e.bottomLeftPaddingBox);default:return Wa(e.bottomLeftBorderDoubleInnerBox,e.bottomLeftPaddingBox,e.topLeftBorderDoubleInnerBox,e.topLeftPaddingBox)}},Za=function(e,t){switch(t){case 0:return Ja(e.topLeftBorderStroke,e.topRightBorderStroke);case 1:return Ja(e.topRightBorderStroke,e.bottomRightBorderStroke);case 2:return Ja(e.bottomRightBorderStroke,e.bottomLeftBorderStroke);default:return Ja(e.bottomLeftBorderStroke,e.topLeftBorderStroke)}},Ja=function(e,t){var r=[];return Ua(e)?r.push(e.subdivide(.5,!1)):r.push(e),Ua(t)?r.push(t.subdivide(.5,!0)):r.push(t),r},Wa=function(e,t,r,n){var i=[];return Ua(e)?i.push(e.subdivide(.5,!1)):i.push(e),Ua(r)?i.push(r.subdivide(.5,!0)):i.push(r),Ua(n)?i.push(n.subdivide(.5,!0).reverse()):i.push(n),Ua(t)?i.push(t.subdivide(.5,!1).reverse()):i.push(t),i},Ya=function(e){var t=e.bounds,r=e.styles;return t.add(r.borderLeftWidth,r.borderTopWidth,-(r.borderRightWidth+r.borderLeftWidth),-(r.borderTopWidth+r.borderBottomWidth))},el=function(e){var t=e.styles,r=e.bounds,n=Gr(t.paddingLeft,r.width),i=Gr(t.paddingRight,r.width),A=Gr(t.paddingTop,r.width),o=Gr(t.paddingBottom,r.width);return r.add(n+t.borderLeftWidth,A+t.borderTopWidth,-(t.borderRightWidth+t.borderLeftWidth+n+i),-(t.borderTopWidth+t.borderBottomWidth+A+o))},tl=function(e,t){return 0===e?t.bounds:2===e?el(t):Ya(t)},rl=function(e,t){return 0===e?t.bounds:2===e?el(t):Ya(t)},nl=function(e,t,r){var n=tl(sl(e.styles.backgroundOrigin,t),e),i=rl(sl(e.styles.backgroundClip,t),e),A=ol(sl(e.styles.backgroundSize,t),r,n),o=A[0],s=A[1],a=Nr(sl(e.styles.backgroundPosition,t),n.width-o,n.height-s);return[al(sl(e.styles.backgroundRepeat,t),a,A,n,i),Math.round(n.left+a[0]),Math.round(n.top+a[1]),o,s]},il=function(e){return Sr(e)&&e.value===zn.AUTO},Al=function(e){return"number"==typeof e},ol=function(e,t,r){var n=t[0],i=t[1],A=t[2],o=e[0],s=e[1];if(!o)return[0,0];if(Rr(o)&&s&&Rr(s))return[Gr(o,r.width),Gr(s,r.height)];var a=Al(A);if(Sr(o)&&(o.value===zn.CONTAIN||o.value===zn.COVER))return Al(A)?r.width/r.height<A!=(o.value===zn.COVER)?[r.width,r.width/A]:[r.height*A,r.height]:[r.width,r.height];var l=Al(n),c=Al(i),u=l||c;if(il(o)&&(!s||il(s)))return l&&c?[n,i]:a||u?u&&a?[l?n:i*A,c?i:n/A]:[l?n:r.width,c?i:r.height]:[r.width,r.height];if(a){var h=0,d=0;return Rr(o)?h=Gr(o,r.width):Rr(s)&&(d=Gr(s,r.height)),il(o)?h=d*A:s&&!il(s)||(d=h/A),[h,d]}var p=null,f=null;if(Rr(o)?p=Gr(o,r.width):s&&Rr(s)&&(f=Gr(s,r.height)),null===p||s&&!il(s)||(f=l&&c?p/n*i:r.height),null!==f&&il(o)&&(p=l&&c?f/i*n:r.width),null!==p&&null!==f)return[p,f];throw new Error("Unable to calculate background-size for element")},sl=function(e,t){var r=e[t];return void 0===r?e[0]:r},al=function(e,t,r,n,i){var A=t[0],o=t[1],s=r[0],a=r[1];switch(e){case 2:return[new Ca(Math.round(n.left),Math.round(n.top+o)),new Ca(Math.round(n.left+n.width),Math.round(n.top+o)),new Ca(Math.round(n.left+n.width),Math.round(a+n.top+o)),new Ca(Math.round(n.left),Math.round(a+n.top+o))];case 3:return[new Ca(Math.round(n.left+A),Math.round(n.top)),new Ca(Math.round(n.left+A+s),Math.round(n.top)),new Ca(Math.round(n.left+A+s),Math.round(n.height+n.top)),new Ca(Math.round(n.left+A),Math.round(n.height+n.top))];case 1:return[new Ca(Math.round(n.left+A),Math.round(n.top+o)),new Ca(Math.round(n.left+A+s),Math.round(n.top+o)),new Ca(Math.round(n.left+A+s),Math.round(n.top+o+a)),new Ca(Math.round(n.left+A),Math.round(n.top+o+a))];default:return[new Ca(Math.round(i.left),Math.round(i.top)),new Ca(Math.round(i.left+i.width),Math.round(i.top)),new Ca(Math.round(i.left+i.width),Math.round(i.height+i.top)),new Ca(Math.round(i.left),Math.round(i.height+i.top))]}},ll="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",cl="Hidden Text",ul=function(){function e(e){this._data={},this._document=e}return e.prototype.parseMetrics=function(e,t){var r=this._document.createElement("div"),n=this._document.createElement("img"),i=this._document.createElement("span"),A=this._document.body;r.style.visibility="hidden",r.style.fontFamily=e,r.style.fontSize=t,r.style.margin="0",r.style.padding="0",r.style.whiteSpace="nowrap",A.appendChild(r),n.src=ll,n.width=1,n.height=1,n.style.margin="0",n.style.padding="0",n.style.verticalAlign="baseline",i.style.fontFamily=e,i.style.fontSize=t,i.style.margin="0",i.style.padding="0",i.appendChild(this._document.createTextNode(cl)),r.appendChild(i),r.appendChild(n);var o=n.offsetTop-i.offsetTop+2;r.removeChild(i),r.appendChild(this._document.createTextNode(cl)),r.style.lineHeight="normal",n.style.verticalAlign="super";var s=n.offsetTop-r.offsetTop+2;return A.removeChild(r),{baseline:o,middle:s}},e.prototype.getMetrics=function(e,t){var r=e+" "+t;return void 0===this._data[r]&&(this._data[r]=this.parseMetrics(e,t)),this._data[r]},e}(),hl=function(){function e(e,t){this.context=e,this.options=t}return e}(),dl=1e4,pl=function(e){function r(t,r){var n=e.call(this,t,r)||this;return n._activeEffects=[],n.canvas=r.canvas?r.canvas:document.createElement("canvas"),n.ctx=n.canvas.getContext("2d"),r.canvas||(n.canvas.width=Math.floor(r.width*r.scale),n.canvas.height=Math.floor(r.height*r.scale),n.canvas.style.width=r.width+"px",n.canvas.style.height=r.height+"px"),n.fontMetrics=new ul(document),n.ctx.scale(n.options.scale,n.options.scale),n.ctx.translate(-r.x,-r.y),n.ctx.textBaseline="bottom",n._activeEffects=[],n.context.logger.debug("Canvas renderer initialized ("+r.width+"x"+r.height+") with scale "+r.scale),n}return t(r,e),r.prototype.applyEffects=function(e){for(var t=this;this._activeEffects.length;)this.popEffect();e.forEach((function(e){return t.applyEffect(e)}))},r.prototype.applyEffect=function(e){this.ctx.save(),za(e)&&(this.ctx.globalAlpha=e.opacity),Pa(e)&&(this.ctx.translate(e.offsetX,e.offsetY),this.ctx.transform(e.matrix[0],e.matrix[1],e.matrix[2],e.matrix[3],e.matrix[4],e.matrix[5]),this.ctx.translate(-e.offsetX,-e.offsetY)),Ha(e)&&(this.path(e.path),this.ctx.clip()),this._activeEffects.push(e)},r.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},r.prototype.renderStack=function(e){return n(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return e.element.container.styles.isVisible()?[4,this.renderStackContent(e)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},r.prototype.renderNode=function(e){return n(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return sA(e.container.flags,16),e.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(e)]:[3,3];case 1:return t.sent(),[4,this.renderNodeContent(e)];case 2:t.sent(),t.label=3;case 3:return[2]}}))}))},r.prototype.renderTextWithLetterSpacing=function(e,t,r){var n=this;0===t?this.ctx.fillText(e.text,e.bounds.left,e.bounds.top+r):Mo(e.text).reduce((function(t,i){return n.ctx.fillText(i,t,e.bounds.top+r),t+n.ctx.measureText(i).width}),e.bounds.left)},r.prototype.createFontStyle=function(e){var t=e.fontVariant.filter((function(e){return"normal"===e||"small-caps"===e})).join(""),r=_l(e.fontFamily).join(", "),n=Ir(e.fontSize)?""+e.fontSize.number+e.fontSize.unit:e.fontSize.number+"px";return[[e.fontStyle,t,e.fontWeight,n,r].join(" "),r,n]},r.prototype.renderTextNode=function(e,t){return n(this,void 0,void 0,(function(){var r,n,A,o,s,a,l,c,u=this;return i(this,(function(i){return r=this.createFontStyle(t),n=r[0],A=r[1],o=r[2],this.ctx.font=n,this.ctx.direction=1===t.direction?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",s=this.fontMetrics.getMetrics(A,o),a=s.baseline,l=s.middle,c=t.paintOrder,e.textBounds.forEach((function(e){c.forEach((function(r){switch(r){case 0:u.ctx.fillStyle=nn(t.color),u.renderTextWithLetterSpacing(e,t.letterSpacing,a);var n=t.textShadow;n.length&&e.text.trim().length&&(n.slice(0).reverse().forEach((function(r){u.ctx.shadowColor=nn(r.color),u.ctx.shadowOffsetX=r.offsetX.number*u.options.scale,u.ctx.shadowOffsetY=r.offsetY.number*u.options.scale,u.ctx.shadowBlur=r.blur.number,u.renderTextWithLetterSpacing(e,t.letterSpacing,a)})),u.ctx.shadowColor="",u.ctx.shadowOffsetX=0,u.ctx.shadowOffsetY=0,u.ctx.shadowBlur=0),t.textDecorationLine.length&&(u.ctx.fillStyle=nn(t.textDecorationColor||t.color),t.textDecorationLine.forEach((function(t){switch(t){case 1:u.ctx.fillRect(e.bounds.left,Math.round(e.bounds.top+a),e.bounds.width,1);break;case 2:u.ctx.fillRect(e.bounds.left,Math.round(e.bounds.top),e.bounds.width,1);break;case 3:u.ctx.fillRect(e.bounds.left,Math.ceil(e.bounds.top+l),e.bounds.width,1)}})));break;case 1:t.webkitTextStrokeWidth&&e.text.trim().length&&(u.ctx.strokeStyle=nn(t.webkitTextStrokeColor),u.ctx.lineWidth=t.webkitTextStrokeWidth,u.ctx.lineJoin=window.chrome?"miter":"round",u.ctx.strokeText(e.text,e.bounds.left,e.bounds.top+a)),u.ctx.strokeStyle="",u.ctx.lineWidth=0,u.ctx.lineJoin="miter"}}))})),[2]}))}))},r.prototype.renderReplacedElement=function(e,t,r){if(r&&e.intrinsicWidth>0&&e.intrinsicHeight>0){var n=el(e),i=Ma(t);this.path(i),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(r,0,0,e.intrinsicWidth,e.intrinsicHeight,n.left,n.top,n.width,n.height),this.ctx.restore()}},r.prototype.renderNodeContent=function(e){return n(this,void 0,void 0,(function(){var t,n,A,s,a,l,c,u,h,d,p,f,m,g,y,_,w,x;return i(this,(function(i){switch(i.label){case 0:this.applyEffects(e.getEffects(4)),t=e.container,n=e.curves,A=t.styles,s=0,a=t.textNodes,i.label=1;case 1:return s<a.length?(l=a[s],[4,this.renderTextNode(l,A)]):[3,4];case 2:i.sent(),i.label=3;case 3:return s++,[3,1];case 4:if(!(t instanceof Ko))return[3,8];i.label=5;case 5:return i.trys.push([5,7,,8]),[4,this.context.cache.match(t.src)];case 6:return y=i.sent(),this.renderReplacedElement(t,n,y),[3,8];case 7:return i.sent(),this.context.logger.error("Error loading image "+t.src),[3,8];case 8:if(t instanceof Vo&&this.renderReplacedElement(t,n,t.canvas),!(t instanceof $o))return[3,12];i.label=9;case 9:return i.trys.push([9,11,,12]),[4,this.context.cache.match(t.svg)];case 10:return y=i.sent(),this.renderReplacedElement(t,n,y),[3,12];case 11:return i.sent(),this.context.logger.error("Error loading svg "+t.svg.substring(0,255)),[3,12];case 12:return t instanceof is&&t.tree?[4,new r(this.context,{scale:this.options.scale,backgroundColor:t.backgroundColor,x:0,y:0,width:t.width,height:t.height}).render(t.tree)]:[3,14];case 13:c=i.sent(),t.width&&t.height&&this.ctx.drawImage(c,0,0,t.width,t.height,t.bounds.left,t.bounds.top,t.bounds.width,t.bounds.height),i.label=14;case 14:if(t instanceof ts&&(u=Math.min(t.bounds.width,t.bounds.height),t.type===Jo?t.checked&&(this.ctx.save(),this.path([new Ca(t.bounds.left+.39363*u,t.bounds.top+.79*u),new Ca(t.bounds.left+.16*u,t.bounds.top+.5549*u),new Ca(t.bounds.left+.27347*u,t.bounds.top+.44071*u),new Ca(t.bounds.left+.39694*u,t.bounds.top+.5649*u),new Ca(t.bounds.left+.72983*u,t.bounds.top+.23*u),new Ca(t.bounds.left+.84*u,t.bounds.top+.34085*u),new Ca(t.bounds.left+.39363*u,t.bounds.top+.79*u)]),this.ctx.fillStyle=nn(es),this.ctx.fill(),this.ctx.restore()):t.type===Wo&&t.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(t.bounds.left+u/2,t.bounds.top+u/2,u/4,0,2*Math.PI,!0),this.ctx.fillStyle=nn(es),this.ctx.fill(),this.ctx.restore())),fl(t)&&t.value.length){switch(h=this.createFontStyle(A),w=h[0],d=h[1],p=this.fontMetrics.getMetrics(w,d).baseline,this.ctx.font=w,this.ctx.fillStyle=nn(A.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=gl(t.styles.textAlign),x=el(t),f=0,t.styles.textAlign){case 1:f+=x.width/2;break;case 2:f+=x.width}m=x.add(f,0,0,-x.height/2+1),this.ctx.save(),this.path([new Ca(x.left,x.top),new Ca(x.left+x.width,x.top),new Ca(x.left+x.width,x.top+x.height),new Ca(x.left,x.top+x.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new Qo(t.value,m),A.letterSpacing,p),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!sA(t.styles.display,2048))return[3,20];if(null===t.styles.listStyleImage)return[3,19];if(0!==(g=t.styles.listStyleImage).type)return[3,18];y=void 0,_=g.url,i.label=15;case 15:return i.trys.push([15,17,,18]),[4,this.context.cache.match(_)];case 16:return y=i.sent(),this.ctx.drawImage(y,t.bounds.left-(y.width+10),t.bounds.top),[3,18];case 17:return i.sent(),this.context.logger.error("Error loading list-style-image "+_),[3,18];case 18:return[3,20];case 19:e.listValue&&-1!==t.styles.listStyleType&&(w=this.createFontStyle(A)[0],this.ctx.font=w,this.ctx.fillStyle=nn(A.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",x=new o(t.bounds.left,t.bounds.top+Gr(t.styles.paddingTop,t.bounds.width),t.bounds.width,bi(A.lineHeight,A.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new Qo(e.listValue,x),A.letterSpacing,bi(A.lineHeight,A.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),i.label=20;case 20:return[2]}}))}))},r.prototype.renderStackContent=function(e){return n(this,void 0,void 0,(function(){var t,r,n,A,o,s,a,l,c,u,h,d,p,f,m;return i(this,(function(i){switch(i.label){case 0:return sA(e.element.container.flags,16),[4,this.renderNodeBackgroundAndBorders(e.element)];case 1:i.sent(),t=0,r=e.negativeZIndex,i.label=2;case 2:return t<r.length?(m=r[t],[4,this.renderStack(m)]):[3,5];case 3:i.sent(),i.label=4;case 4:return t++,[3,2];case 5:return[4,this.renderNodeContent(e.element)];case 6:i.sent(),n=0,A=e.nonInlineLevel,i.label=7;case 7:return n<A.length?(m=A[n],[4,this.renderNode(m)]):[3,10];case 8:i.sent(),i.label=9;case 9:return n++,[3,7];case 10:o=0,s=e.nonPositionedFloats,i.label=11;case 11:return o<s.length?(m=s[o],[4,this.renderStack(m)]):[3,14];case 12:i.sent(),i.label=13;case 13:return o++,[3,11];case 14:a=0,l=e.nonPositionedInlineLevel,i.label=15;case 15:return a<l.length?(m=l[a],[4,this.renderStack(m)]):[3,18];case 16:i.sent(),i.label=17;case 17:return a++,[3,15];case 18:c=0,u=e.inlineLevel,i.label=19;case 19:return c<u.length?(m=u[c],[4,this.renderNode(m)]):[3,22];case 20:i.sent(),i.label=21;case 21:return c++,[3,19];case 22:h=0,d=e.zeroOrAutoZIndexOrTransformedOrOpacity,i.label=23;case 23:return h<d.length?(m=d[h],[4,this.renderStack(m)]):[3,26];case 24:i.sent(),i.label=25;case 25:return h++,[3,23];case 26:p=0,f=e.positiveZIndex,i.label=27;case 27:return p<f.length?(m=f[p],[4,this.renderStack(m)]):[3,30];case 28:i.sent(),i.label=29;case 29:return p++,[3,27];case 30:return[2]}}))}))},r.prototype.mask=function(e){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(e.slice(0).reverse()),this.ctx.closePath()},r.prototype.path=function(e){this.ctx.beginPath(),this.formatPath(e),this.ctx.closePath()},r.prototype.formatPath=function(e){var t=this;e.forEach((function(e,r){var n=Ua(e)?e.start:e;0===r?t.ctx.moveTo(n.x,n.y):t.ctx.lineTo(n.x,n.y),Ua(e)&&t.ctx.bezierCurveTo(e.startControl.x,e.startControl.y,e.endControl.x,e.endControl.y,e.end.x,e.end.y)}))},r.prototype.renderRepeat=function(e,t,r,n){this.path(e),this.ctx.fillStyle=t,this.ctx.translate(r,n),this.ctx.fill(),this.ctx.translate(-r,-n)},r.prototype.resizeImage=function(e,t,r){var n;if(e.width===t&&e.height===r)return e;var i=(null!==(n=this.canvas.ownerDocument)&&void 0!==n?n:document).createElement("canvas");return i.width=Math.max(1,t),i.height=Math.max(1,r),i.getContext("2d").drawImage(e,0,0,e.width,e.height,0,0,t,r),i},r.prototype.renderBackgroundImage=function(e){return n(this,void 0,void 0,(function(){var t,r,n,A,o,s;return i(this,(function(a){switch(a.label){case 0:t=e.styles.backgroundImage.length-1,r=function(r){var A,o,s,a,l,c,u,h,d,p,f,m,g,y,_,w,x,B,v,b,C,F,E,U,Q,I,T,S,M,k,D;return i(this,(function(i){switch(i.label){case 0:if(0!==r.type)return[3,5];A=void 0,o=r.url,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,n.context.cache.match(o)];case 2:return A=i.sent(),[3,4];case 3:return i.sent(),n.context.logger.error("Error loading background-image "+o),[3,4];case 4:return A&&(s=nl(e,t,[A.width,A.height,A.width/A.height]),w=s[0],F=s[1],E=s[2],v=s[3],b=s[4],y=n.ctx.createPattern(n.resizeImage(A,v,b),"repeat"),n.renderRepeat(w,y,F,E)),[3,6];case 5:Dn(r)?(a=nl(e,t,[null,null,null]),w=a[0],F=a[1],E=a[2],v=a[3],b=a[4],l=yn(r.angle,v,b),c=l[0],u=l[1],h=l[2],d=l[3],p=l[4],(f=document.createElement("canvas")).width=v,f.height=b,m=f.getContext("2d"),g=m.createLinearGradient(u,d,h,p),mn(r.stops,c).forEach((function(e){return g.addColorStop(e.stop,nn(e.color))})),m.fillStyle=g,m.fillRect(0,0,v,b),v>0&&b>0&&(y=n.ctx.createPattern(f,"repeat"),n.renderRepeat(w,y,F,E))):Ln(r)&&(_=nl(e,t,[null,null,null]),w=_[0],x=_[1],B=_[2],v=_[3],b=_[4],C=0===r.position.length?[Vr]:r.position,F=Gr(C[0],v),E=Gr(C[C.length-1],b),U=xn(r,F,E,v,b),Q=U[0],I=U[1],Q>0&&I>0&&(T=n.ctx.createRadialGradient(x+F,B+E,0,x+F,B+E,Q),mn(r.stops,2*Q).forEach((function(e){return T.addColorStop(e.stop,nn(e.color))})),n.path(w),n.ctx.fillStyle=T,Q!==I?(S=e.bounds.left+.5*e.bounds.width,M=e.bounds.top+.5*e.bounds.height,D=1/(k=I/Q),n.ctx.save(),n.ctx.translate(S,M),n.ctx.transform(1,0,0,k,0,0),n.ctx.translate(-S,-M),n.ctx.fillRect(x,D*(B-M)+M,v,b*D),n.ctx.restore()):n.ctx.fill())),i.label=6;case 6:return t--,[2]}}))},n=this,A=0,o=e.styles.backgroundImage.slice(0).reverse(),a.label=1;case 1:return A<o.length?(s=o[A],[5,r(s)]):[3,4];case 2:a.sent(),a.label=3;case 3:return A++,[3,1];case 4:return[2]}}))}))},r.prototype.renderSolidBorder=function(e,t,r){return n(this,void 0,void 0,(function(){return i(this,(function(n){return this.path(qa(r,t)),this.ctx.fillStyle=nn(e),this.ctx.fill(),[2]}))}))},r.prototype.renderDoubleBorder=function(e,t,r,A){return n(this,void 0,void 0,(function(){var n,o;return i(this,(function(i){switch(i.label){case 0:return t<3?[4,this.renderSolidBorder(e,r,A)]:[3,2];case 1:return i.sent(),[2];case 2:return n=Xa(A,r),this.path(n),this.ctx.fillStyle=nn(e),this.ctx.fill(),o=ja(A,r),this.path(o),this.ctx.fill(),[2]}}))}))},r.prototype.renderNodeBackgroundAndBorders=function(e){return n(this,void 0,void 0,(function(){var t,r,n,A,o,s,a,l,c=this;return i(this,(function(i){switch(i.label){case 0:return this.applyEffects(e.getEffects(2)),t=e.container.styles,r=!rn(t.backgroundColor)||t.backgroundImage.length,n=[{style:t.borderTopStyle,color:t.borderTopColor,width:t.borderTopWidth},{style:t.borderRightStyle,color:t.borderRightColor,width:t.borderRightWidth},{style:t.borderBottomStyle,color:t.borderBottomColor,width:t.borderBottomWidth},{style:t.borderLeftStyle,color:t.borderLeftColor,width:t.borderLeftWidth}],A=ml(sl(t.backgroundClip,0),e.curves),r||t.boxShadow.length?(this.ctx.save(),this.path(A),this.ctx.clip(),rn(t.backgroundColor)||(this.ctx.fillStyle=nn(t.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(e.container)]):[3,2];case 1:i.sent(),this.ctx.restore(),t.boxShadow.slice(0).reverse().forEach((function(t){c.ctx.save();var r=Ta(e.curves),n=t.inset?0:dl,i=Oa(r,-n+(t.inset?1:-1)*t.spread.number,(t.inset?1:-1)*t.spread.number,t.spread.number*(t.inset?-2:2),t.spread.number*(t.inset?-2:2));t.inset?(c.path(r),c.ctx.clip(),c.mask(i)):(c.mask(r),c.ctx.clip(),c.path(i)),c.ctx.shadowOffsetX=t.offsetX.number+n,c.ctx.shadowOffsetY=t.offsetY.number,c.ctx.shadowColor=nn(t.color),c.ctx.shadowBlur=t.blur.number,c.ctx.fillStyle=t.inset?nn(t.color):"rgba(0,0,0,1)",c.ctx.fill(),c.ctx.restore()})),i.label=2;case 2:o=0,s=0,a=n,i.label=3;case 3:return s<a.length?0!==(l=a[s]).style&&!rn(l.color)&&l.width>0?2!==l.style?[3,5]:[4,this.renderDashedDottedBorder(l.color,l.width,o,e.curves,2)]:[3,11]:[3,13];case 4:return i.sent(),[3,11];case 5:return 3!==l.style?[3,7]:[4,this.renderDashedDottedBorder(l.color,l.width,o,e.curves,3)];case 6:return i.sent(),[3,11];case 7:return 4!==l.style?[3,9]:[4,this.renderDoubleBorder(l.color,l.width,o,e.curves)];case 8:return i.sent(),[3,11];case 9:return[4,this.renderSolidBorder(l.color,o,e.curves)];case 10:i.sent(),i.label=11;case 11:o++,i.label=12;case 12:return s++,[3,3];case 13:return[2]}}))}))},r.prototype.renderDashedDottedBorder=function(e,t,r,A,o){return n(this,void 0,void 0,(function(){var n,s,a,l,c,u,h,d,p,f,m,g,y,_,w,x;return i(this,(function(i){return this.ctx.save(),n=Za(A,r),s=qa(A,r),2===o&&(this.path(s),this.ctx.clip()),Ua(s[0])?(a=s[0].start.x,l=s[0].start.y):(a=s[0].x,l=s[0].y),Ua(s[1])?(c=s[1].end.x,u=s[1].end.y):(c=s[1].x,u=s[1].y),h=0===r||2===r?Math.abs(a-c):Math.abs(l-u),this.ctx.beginPath(),3===o?this.formatPath(n):this.formatPath(s.slice(0,2)),d=t<3?3*t:2*t,p=t<3?2*t:t,3===o&&(d=t,p=t),f=!0,h<=2*d?f=!1:h<=2*d+p?(d*=m=h/(2*d+p),p*=m):(g=Math.floor((h+p)/(d+p)),y=(h-g*d)/(g-1),p=(_=(h-(g+1)*d)/g)<=0||Math.abs(p-y)<Math.abs(p-_)?y:_),f&&(3===o?this.ctx.setLineDash([0,d+p]):this.ctx.setLineDash([d,p])),3===o?(this.ctx.lineCap="round",this.ctx.lineWidth=t):this.ctx.lineWidth=2*t+1.1,this.ctx.strokeStyle=nn(e),this.ctx.stroke(),this.ctx.setLineDash([]),2===o&&(Ua(s[0])&&(w=s[3],x=s[0],this.ctx.beginPath(),this.formatPath([new Ca(w.end.x,w.end.y),new Ca(x.start.x,x.start.y)]),this.ctx.stroke()),Ua(s[1])&&(w=s[1],x=s[2],this.ctx.beginPath(),this.formatPath([new Ca(w.end.x,w.end.y),new Ca(x.start.x,x.start.y)]),this.ctx.stroke())),this.ctx.restore(),[2]}))}))},r.prototype.render=function(e){return n(this,void 0,void 0,(function(){var t;return i(this,(function(r){switch(r.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=nn(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),t=Ga(e),[4,this.renderStack(t)];case 1:return r.sent(),this.applyEffects([]),[2,this.canvas]}}))}))},r}(hl),fl=function(e){return e instanceof ns||e instanceof rs||e instanceof ts&&e.type!==Wo&&e.type!==Jo},ml=function(e,t){switch(e){case 0:return Ta(t);case 2:return Sa(t);default:return Ma(t)}},gl=function(e){switch(e){case 1:return"center";case 2:return"right";default:return"left"}},yl=["-apple-system","system-ui"],_l=function(e){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?e.filter((function(e){return-1===yl.indexOf(e)})):e},wl=function(e){function r(t,r){var n=e.call(this,t,r)||this;return n.canvas=r.canvas?r.canvas:document.createElement("canvas"),n.ctx=n.canvas.getContext("2d"),n.options=r,n.canvas.width=Math.floor(r.width*r.scale),n.canvas.height=Math.floor(r.height*r.scale),n.canvas.style.width=r.width+"px",n.canvas.style.height=r.height+"px",n.ctx.scale(n.options.scale,n.options.scale),n.ctx.translate(-r.x,-r.y),n.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized ("+r.width+"x"+r.height+" at "+r.x+","+r.y+") with scale "+r.scale),n}return t(r,e),r.prototype.render=function(e){return n(this,void 0,void 0,(function(){var t,r;return i(this,(function(n){switch(n.label){case 0:return t=Fo(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,e),[4,xl(t)];case 1:return r=n.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=nn(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(r,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}}))}))},r}(hl),xl=function(e){return new Promise((function(t,r){var n=new Image;n.onload=function(){t(n)},n.onerror=r,n.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent((new XMLSerializer).serializeToString(e))}))},Bl=function(){function e(e){var t=e.id,r=e.enabled;this.id=t,this.enabled=r,this.start=Date.now()}return e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.enabled&&("undefined"!=typeof window&&window.console&&"function"==typeof console.debug?console.debug.apply(console,A([this.id,this.getTime()+"ms"],e)):this.info.apply(this,e))},e.prototype.getTime=function(){return Date.now()-this.start},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.enabled&&"undefined"!=typeof window&&window.console&&"function"==typeof console.info&&console.info.apply(console,A([this.id,this.getTime()+"ms"],e))},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.enabled&&("undefined"!=typeof window&&window.console&&"function"==typeof console.warn?console.warn.apply(console,A([this.id,this.getTime()+"ms"],e)):this.info.apply(this,e))},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.enabled&&("undefined"!=typeof window&&window.console&&"function"==typeof console.error?console.error.apply(console,A([this.id,this.getTime()+"ms"],e)):this.info.apply(this,e))},e.instances={},e}(),vl=function(){function e(t,r){var n;this.windowBounds=r,this.instanceName="#"+e.instanceCount++,this.logger=new Bl({id:this.instanceName,enabled:t.logging}),this.cache=null!==(n=t.cache)&&void 0!==n?n:new ma(this,t)}return e.instanceCount=1,e}(),bl=function(e,t){return void 0===t&&(t={}),Cl(e,t)};"undefined"!=typeof window&&fa.setContext(window);var Cl=function(e,t){return n(void 0,void 0,void 0,(function(){var n,A,l,c,u,h,d,p,f,m,g,y,_,w,x,B,v,b,C,F,E,U,Q,I,T,S,M,k,D,L,P,H,z,R,O,K,V,$;return i(this,(function(i){switch(i.label){case 0:if(!e||"object"!=typeof e)return[2,Promise.reject("Invalid element provided as first argument")];if(!(n=e.ownerDocument))throw new Error("Element is not attached to a Document");if(!(A=n.defaultView))throw new Error("Document is not attached to a Window");return l={allowTaint:null!==(U=t.allowTaint)&&void 0!==U&&U,imageTimeout:null!==(Q=t.imageTimeout)&&void 0!==Q?Q:15e3,proxy:t.proxy,useCORS:null!==(I=t.useCORS)&&void 0!==I&&I},c=r({logging:null===(T=t.logging)||void 0===T||T,cache:t.cache},l),u={windowWidth:null!==(S=t.windowWidth)&&void 0!==S?S:A.innerWidth,windowHeight:null!==(M=t.windowHeight)&&void 0!==M?M:A.innerHeight,scrollX:null!==(k=t.scrollX)&&void 0!==k?k:A.pageXOffset,scrollY:null!==(D=t.scrollY)&&void 0!==D?D:A.pageYOffset},h=new o(u.scrollX,u.scrollY,u.windowWidth,u.windowHeight),d=new vl(c,h),p=null!==(L=t.foreignObjectRendering)&&void 0!==L&&L,f={allowTaint:null!==(P=t.allowTaint)&&void 0!==P&&P,onclone:t.onclone,ignoreElements:t.ignoreElements,inlineImages:p,copyStyles:p},d.logger.debug("Starting document clone with size "+h.width+"x"+h.height+" scrolled to "+-h.left+","+-h.top),m=new Js(d,e,f),(g=m.clonedReferenceElement)?[4,m.toIFrame(n,h)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return y=i.sent(),_=ws(g)||ys(g)?a(g.ownerDocument):s(d,g),w=_.width,x=_.height,B=_.left,v=_.top,b=Fl(d,g,t.backgroundColor),C={canvas:t.canvas,backgroundColor:b,scale:null!==(z=null!==(H=t.scale)&&void 0!==H?H:A.devicePixelRatio)&&void 0!==z?z:1,x:(null!==(R=t.x)&&void 0!==R?R:0)+B,y:(null!==(O=t.y)&&void 0!==O?O:0)+v,width:null!==(K=t.width)&&void 0!==K?K:Math.ceil(w),height:null!==(V=t.height)&&void 0!==V?V:Math.ceil(x)},p?(d.logger.debug("Document cloned, using foreign object rendering"),[4,new wl(d,C).render(g)]):[3,3];case 2:return F=i.sent(),[3,5];case 3:return d.logger.debug("Document cloned, element located at "+B+","+v+" with size "+w+"x"+x+" using computed rendering"),d.logger.debug("Starting DOM parsing"),E=as(d,g),b===E.styles.backgroundColor&&(E.styles.backgroundColor=hn.TRANSPARENT),d.logger.debug("Starting renderer for element at "+C.x+","+C.y+" with size "+C.width+"x"+C.height),[4,new pl(d,C).render(E)];case 4:F=i.sent(),i.label=5;case 5:return(null===($=t.removeContainer)||void 0===$||$)&&(Js.destroy(y)||d.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore")),d.logger.debug("Finished rendering"),[2,F]}}))}))},Fl=function(e,t,r){var n=t.ownerDocument,i=n.documentElement?un(e,getComputedStyle(n.documentElement).backgroundColor):hn.TRANSPARENT,A=n.body?un(e,getComputedStyle(n.body).backgroundColor):hn.TRANSPARENT,o="string"==typeof r?un(e,r):null===r?hn.TRANSPARENT:4294967295;return t===n.documentElement?rn(i)?rn(A)?o:A:i:o};return bl}()}));function ai(e){let t,r;return{c(){t=w("img"),a(t.src,r="./img/ons-logo-black-en.svg")||F(t,"src","./img/ons-logo-black-en.svg"),F(t,"alt","UCLouvain"),F(t,"class","svelte-cukzw5")},m(e,r){y(e,t,r)},d(e){e&&_(t)}}}function li(e){let t,r;return{c(){t=w("img"),a(t.src,r="./img/ons-logo-black-en.svg")||F(t,"src","./img/ons-logo-black-en.svg"),F(t,"alt","UCLouvain"),F(t,"class","svelte-cukzw5")},m(e,r){y(e,t,r)},d(e){e&&_(t)}}}function ci(e){let t,r;return{c(){t=w("img"),a(t.src,r="./img/ons-logo-black-en.svg")||F(t,"src","./img/ons-logo-black-en.svg"),F(t,"alt","UCLouvain"),F(t,"class","svelte-cukzw5")},m(e,r){y(e,t,r)},d(e){e&&_(t)}}}function ui(t){let r,n,i,A,o;function s(e,t){return"dark"==e[0]?ci:1==e[1]?li:ai}let a=s(t),l=a(t);return{c(){r=w("nav"),n=w("div"),i=w("a"),A=w("picture"),l.c(),F(A,"class","svelte-cukzw5"),F(i,"href","https://uclouvain.be/fr/index.html"),F(i,"class","svelte-cukzw5"),F(n,"class","col-wide middle"),S(n,"center",t[2]),F(r,"style",o="border-bottom-color: "+Wt[t[0]].muted+"; "+(t[1]?"background-color: "+Wt[t[0]].background+";":"")),F(r,"class","svelte-cukzw5")},m(e,t){y(e,r,t),m(r,n),m(n,i),m(i,A),l.m(A,null)},p(e,[t]){a!==(a=s(e))&&(l.d(1),l=a(e),l&&(l.c(),l.m(A,null))),4&t&&S(n,"center",e[2]),3&t&&o!==(o="border-bottom-color: "+Wt[e[0]].muted+"; "+(e[1]?"background-color: "+Wt[e[0]].background+";":""))&&F(r,"style",o)},i:e,o:e,d(e){e&&_(r),l.d()}}}function hi(e,t,r){let{theme:n=R("theme")}=t,{filled:i=!1}=t,{center:A=!0}=t;return e.$$set=e=>{"theme"in e&&r(0,n=e.theme),"filled"in e&&r(1,i=e.filled),"center"in e&&r(2,A=e.center)},[n,i,A]}class di extends ue{constructor(e){super(),ce(this,e,hi,ui,o,{theme:0,filled:1,center:2})}}function pi(e){let t,r;return{c(){t=w("img"),F(t,"class","logo-img svelte-y2rmy6"),a(t.src,r="./img/ons-logo-black-en.svg")||F(t,"src","./img/ons-logo-black-en.svg"),F(t,"alt","Office for National Statistics")},m(e,r){y(e,t,r)},d(e){e&&_(t)}}}function fi(e){let t,r;return{c(){t=w("img"),F(t,"class","logo-img svelte-y2rmy6"),a(t.src,r="./img/ons-logo-neg-en.svg")||F(t,"src","./img/ons-logo-neg-en.svg"),F(t,"alt","Office for National Statistics")},m(e,r){y(e,t,r)},d(e){e&&_(t)}}}function mi(t){let r,n,i,A,o,s,a,l,c,u,h,d,p,f,g,v;function b(e,t){return"dark"==e[0]?fi:pi}let C=b(t),E=C(t);return{c(){r=w("footer"),n=w("div"),i=w("a"),E.c(),A=B(),o=w("ul"),s=w("li"),a=w("a"),l=x("COMU"),c=B(),u=w("li"),h=w("a"),d=x("Ecole de journalisme de l'UCLouvain"),p=B(),f=w("hr"),g=B(),v=w("div"),v.textContent="Ce travail est un mémoire-projet mené dans le cadre du Master120 de l'école de jounralisme de l'UCLouvain",F(i,"href","https://uclouvain.be/fr/index.html"),F(i,"class","svelte-y2rmy6"),F(a,"href","https://uclouvain.be/fr/facultes/espo/comu.html"),F(a,"class","link svelte-y2rmy6"),I(a,"color",Wt[t[0]].text),F(s,"class","svelte-y2rmy6"),F(h,"href","https://uclouvain.be/fr/facultes/espo/comu/master-en-journalisme.html"),F(h,"class","link svelte-y2rmy6"),I(h,"color",Wt[t[0]].text),F(u,"class","svelte-y2rmy6"),F(o,"class","svelte-y2rmy6"),I(f,"border-top-color",Wt[t[0]].muted),F(f,"class","svelte-y2rmy6"),F(v,"class","license svelte-y2rmy6"),F(n,"class","col-wide"),F(n,"data-analytics","footer"),I(r,"color",Wt[t[0]].text),I(r,"background-color",Wt[t[0]].pale),F(r,"class","svelte-y2rmy6")},m(e,t){y(e,r,t),m(r,n),m(n,i),E.m(i,null),m(n,A),m(n,o),m(o,s),m(s,a),m(a,l),m(o,c),m(o,u),m(u,h),m(h,d),m(n,p),m(n,f),m(n,g),m(n,v)},p(e,[t]){C!==(C=b(e))&&(E.d(1),E=C(e),E&&(E.c(),E.m(i,null))),1&t&&I(a,"color",Wt[e[0]].text),1&t&&I(h,"color",Wt[e[0]].text),1&t&&I(f,"border-top-color",Wt[e[0]].muted),1&t&&I(r,"color",Wt[e[0]].text),1&t&&I(r,"background-color",Wt[e[0]].pale)},i:e,o:e,d(e){e&&_(r),E.d()}}}function gi(e,t,r){let{theme:n=R("theme")}=t;return e.$$set=e=>{"theme"in e&&r(0,n=e.theme)},[n]}class yi extends ue{constructor(e){super(),ce(this,e,gi,mi,o,{theme:0})}}function _i(e){let t,r,n,i,A;const o=e[8].default,s=c(o,e,e[7],null);return{c(){t=w("header"),r=w("div"),n=w("div"),s&&s.c(),F(n,"class","header-content svelte-153zzg5"),F(r,"class","v-padded col-wide middle svelte-153zzg5"),I(r,"position","relative"),S(r,"short",e[2]),S(r,"height-full",!e[2]),F(t,"style",i="color: "+Wt[e[0]].text+"; background-color: "+(e[1]?e[1]:Wt[e[0]].background)+"; "+e[3]),F(t,"class","svelte-153zzg5"),S(t,"short",e[2])},m(e,i){y(e,t,i),m(t,r),m(r,n),s&&s.m(n,null),A=!0},p(e,[n]){s&&s.p&&(!A||128&n)&&d(s,o,e,e[7],A?h(o,e[7],n,null):p(e[7]),null),(!A||4&n)&&S(r,"short",e[2]),(!A||4&n)&&S(r,"height-full",!e[2]),(!A||11&n&&i!==(i="color: "+Wt[e[0]].text+"; background-color: "+(e[1]?e[1]:Wt[e[0]].background)+"; "+e[3]))&&F(t,"style",i),(!A||4&n)&&S(t,"short",e[2])},i(e){A||(ne(s,e),A=!0)},o(e){ie(s,e),A=!1},d(e){e&&_(t),s&&s.d(e)}}}function wi(e,t,r){let{$$slots:n={},$$scope:i}=t,{theme:A=R("theme")}=t,{bgimage:o=null}=t,{bgcolor:s=null}=t,{bgfixed:a=!1}=t,{center:l=!0}=t,{short:c=!1}=t,u="";return u+=o?`background-image: url(${o});`:"background-image: none;",a&&(u+=" background-attachment: fixed;"),e.$$set=e=>{"theme"in e&&r(0,A=e.theme),"bgimage"in e&&r(4,o=e.bgimage),"bgcolor"in e&&r(1,s=e.bgcolor),"bgfixed"in e&&r(5,a=e.bgfixed),"center"in e&&r(6,l=e.center),"short"in e&&r(2,c=e.short),"$$scope"in e&&r(7,i=e.$$scope)},[A,s,c,u,o,a,l,i,n]}class xi extends ue{constructor(e){super(),ce(this,e,wi,_i,o,{theme:0,bgimage:4,bgcolor:1,bgfixed:5,center:6,short:2})}}function Bi(e){let t,r,n;const i=e[2].default,A=c(i,e,e[1],null);return{c(){t=w("section"),r=w("div"),A&&A.c(),F(r,"class","col-medium"),I(t,"color",Wt[e[0]].text),I(t,"background-color",Wt[e[0]].background)},m(e,i){y(e,t,i),m(t,r),A&&A.m(r,null),n=!0},p(e,[r]){A&&A.p&&(!n||2&r)&&d(A,i,e,e[1],n?h(i,e[1],r,null):p(e[1]),null),(!n||1&r)&&I(t,"color",Wt[e[0]].text),(!n||1&r)&&I(t,"background-color",Wt[e[0]].background)},i(e){n||(ne(A,e),n=!0)},o(e){ie(A,e),n=!1},d(e){e&&_(t),A&&A.d(e)}}}function vi(e,t,r){let{$$slots:n={},$$scope:i}=t,{theme:A=R("theme")}=t;return e.$$set=e=>{"theme"in e&&r(0,A=e.theme),"$$scope"in e&&r(1,i=e.$$scope)},[A,i,n]}class bi extends ue{constructor(e){super(),ce(this,e,vi,Bi,o,{theme:0})}}const{window:Ci}=f,Fi=e=>({}),Ei=e=>({}),Ui=e=>({}),Qi=e=>({});function Ii(e){let t,r,n,i,A,o,s,a;q(e[19]);const l=e[18].background,u=c(l,e,e[17],Qi),f=e[18].foreground,g=c(f,e,e[17],Ei);return{c(){t=w("svelte-scroller-outer"),r=w("svelte-scroller-background-container"),n=w("svelte-scroller-background"),u&&u.c(),i=B(),A=w("svelte-scroller-foreground"),g&&g.c(),E(n,"class","svelte-3stote"),E(r,"class","background-container svelte-3stote"),E(A,"class","svelte-3stote"),E(t,"class","svelte-3stote"),S(t,"splitscreen",e[0])},m(l,c){y(l,t,c),m(t,r),m(r,n),u&&u.m(n,null),e[20](n),e[21](r),m(t,i),m(t,A),g&&g.m(A,null),e[22](A),e[23](t),o=!0,s||(a=C(Ci,"resize",e[19]),s=!0)},p(e,r){u&&u.p&&(!o||131072&r[0])&&d(u,l,e,e[17],o?h(l,e[17],r,Ui):p(e[17]),Qi),g&&g.p&&(!o||131072&r[0])&&d(g,f,e,e[17],o?h(f,e[17],r,Fi):p(e[17]),Ei),(!o||1&r[0])&&S(t,"splitscreen",e[0])},i(e){o||(ne(u,e),ne(g,e),o=!0)},o(e){ie(u,e),ie(g,e),o=!1},d(r){r&&_(t),u&&u.d(r),e[20](null),e[21](null),g&&g.d(r),e[22](null),e[23](null),s=!1,a()}}}const Ti=[];let Si;if("undefined"!=typeof window){const e=()=>Ti.forEach((e=>e()));window.addEventListener("scroll",e),window.addEventListener("resize",e)}if("undefined"!=typeof IntersectionObserver){const e=new Map,t=new IntersectionObserver(((t,r)=>{t.forEach((t=>{const r=e.get(t.target),n=Ti.indexOf(r);t.isIntersecting?-1===n&&Ti.push(r):(r(),-1!==n&&Ti.splice(n,1))}))}),{rootMargin:"400px 0px"});Si={add:({outer:r,update:n})=>{const{top:i,bottom:A}=r.getBoundingClientRect();i<window.innerHeight&&A>0&&Ti.push(n),e.set(r,n),t.observe(r)},remove:({outer:r,update:n})=>{const i=Ti.indexOf(n);-1!==i&&Ti.splice(i,1),e.delete(r),t.unobserve(r)}}}else Si={add:({update:e})=>{Ti.push(e)},remove:({update:e})=>{const t=Ti.indexOf(e);-1!==t&&Ti.splice(t,1)}};function Mi(e,t,r){let n,i,A,o,s,a,l,c,u,h,d,{$$slots:p={},$$scope:f}=t,{top:m=0}=t,{bottom:g=1}=t,{threshold:y=.5}=t,{query:_="section"}=t,{parallax:w=!1}=t,{index:x=0}=t,{count:B=0}=t,{offset:v=0}=t,{progress:b=0}=t,{visible:C=!1}=t,{splitscreen:F=!1}=t,{id:E=null}=t,U=0,Q=1;function I(){if(s){let e=`position: ${h?"fixed":"absolute"}; top: 0; transform: translate(0, ${d}px); width: ${Q}px; z-index: 1;`;r(3,s.style.cssText=e,s)}}function T(){if(!a)return;const e=o.getBoundingClientRect();c=e.left,Q=e.right-e.left;const t=a.getBoundingClientRect(),s=l.getBoundingClientRect();r(10,C=t.top<U&&t.bottom>0);const p=t.bottom-t.top,f=s.bottom-s.top,m=i-n;for(r(9,b=(n-t.top)/(p-m)),b<=0?(d=0,h&&(h=!1,I())):b>=1?(d=w?p-f:p-m,h&&(h=!1,I())):(d=w?Math.round(n-b*(f-m)):n,h||(h=!0,I())),r(6,x=0);x<u.length;r(6,x+=1)){const e=u[x],{top:n}=e.getBoundingClientRect(),i=u[x+1],o=i?i.getBoundingClientRect().top:t.bottom;if(r(8,v=(A-n)/(o-n)),r(11,E=e.dataset.id?e.dataset.id:null),o>=A)break}}return L((()=>{u=a.querySelectorAll(_),r(7,B=u.length),T();const e={outer:o,update:T};return Si.add(e),()=>Si.remove(e)})),e.$$set=e=>{"top"in e&&r(12,m=e.top),"bottom"in e&&r(13,g=e.bottom),"threshold"in e&&r(14,y=e.threshold),"query"in e&&r(15,_=e.query),"parallax"in e&&r(16,w=e.parallax),"index"in e&&r(6,x=e.index),"count"in e&&r(7,B=e.count),"offset"in e&&r(8,v=e.offset),"progress"in e&&r(9,b=e.progress),"visible"in e&&r(10,C=e.visible),"splitscreen"in e&&r(0,F=e.splitscreen),"id"in e&&r(11,E=e.id),"$$scope"in e&&r(17,f=e.$$scope)},e.$$.update=()=>{4098&e.$$.dirty[0]&&(n=Math.round(m*U)),8194&e.$$.dirty[0]&&(i=Math.round(g*U)),16386&e.$$.dirty[0]&&(A=Math.round(y*U)),94208&e.$$.dirty[0]&&T()},[F,U,o,s,a,l,x,B,v,b,C,E,m,g,y,_,w,f,p,function(){r(1,U=Ci.innerHeight)},function(e){K[e?"unshift":"push"]((()=>{l=e,r(5,l)}))},function(e){K[e?"unshift":"push"]((()=>{s=e,r(3,s)}))},function(e){K[e?"unshift":"push"]((()=>{a=e,r(4,a)}))},function(e){K[e?"unshift":"push"]((()=>{o=e,r(2,o)}))}]}class ki extends ue{constructor(e){super(),ce(this,e,Mi,Ii,o,{top:12,bottom:13,threshold:14,query:15,parallax:16,index:6,count:7,offset:8,progress:9,visible:10,splitscreen:0,id:11},null,[-1,-1])}}function Di(e){let t,r,n;const i=e[5].default,A=c(i,e,e[4],null);return{c(){t=w("section"),r=w("div"),A&&A.c(),F(r,"class","middle svelte-1odf9sx"),S(r,"center",e[1]),S(r,"col-medium",!e[2]),S(r,"col-wide",e[2]),S(r,"height-full",!e[3]),S(r,"short",e[3]),I(t,"color",Wt[e[0]].text),I(t,"background-color",Wt[e[0]].background),F(t,"class","svelte-1odf9sx")},m(e,i){y(e,t,i),m(t,r),A&&A.m(r,null),n=!0},p(e,[o]){A&&A.p&&(!n||16&o)&&d(A,i,e,e[4],n?h(i,e[4],o,null):p(e[4]),null),(!n||2&o)&&S(r,"center",e[1]),(!n||4&o)&&S(r,"col-medium",!e[2]),(!n||4&o)&&S(r,"col-wide",e[2]),(!n||8&o)&&S(r,"height-full",!e[3]),(!n||8&o)&&S(r,"short",e[3]),(!n||1&o)&&I(t,"color",Wt[e[0]].text),(!n||1&o)&&I(t,"background-color",Wt[e[0]].background)},i(e){n||(ne(A,e),n=!0)},o(e){ie(A,e),n=!1},d(e){e&&_(t),A&&A.d(e)}}}function Li(e,t,r){let{$$slots:n={},$$scope:i}=t,{theme:A=R("theme")}=t,{center:o=!0}=t,{wide:s=!1}=t,{short:a=!1}=t;return e.$$set=e=>{"theme"in e&&r(0,A=e.theme),"center"in e&&r(1,o=e.center),"wide"in e&&r(2,s=e.wide),"short"in e&&r(3,a=e.short),"$$scope"in e&&r(4,i=e.$$scope)},[A,o,s,a,i,n]}class Pi extends ue{constructor(e){super(),ce(this,e,Li,Di,o,{theme:0,center:1,wide:2,short:3})}}function Hi(e){let t;return{c(){t=w("hr"),I(t,"color",Wt[e[0]].muted),I(t,"border","none"),F(t,"class","svelte-1l2to1w")},m(e,r){y(e,t,r)},p(e,r){1&r&&I(t,"color",Wt[e[0]].muted)},d(e){e&&_(t)}}}function zi(e){let t;return{c(){t=w("hr"),I(t,"color",Wt[e[0]].muted),F(t,"class","svelte-1l2to1w")},m(e,r){y(e,t,r)},p(e,r){1&r&&I(t,"color",Wt[e[0]].muted)},d(e){e&&_(t)}}}function Ri(t){let r,n;function i(e,t){return e[1]?zi:Hi}let A=i(t),o=A(t);return{c(){r=w("section"),n=w("div"),o.c(),F(n,"class","col-medium"),I(r,"color",Wt[t[0]].text),I(r,"background-color",Wt[t[0]].background)},m(e,t){y(e,r,t),m(r,n),o.m(n,null)},p(e,[t]){A===(A=i(e))&&o?o.p(e,t):(o.d(1),o=A(e),o&&(o.c(),o.m(n,null))),1&t&&I(r,"color",Wt[e[0]].text),1&t&&I(r,"background-color",Wt[e[0]].background)},i:e,o:e,d(e){e&&_(r),o.d()}}}function Oi(e,t,r){let{theme:n=R("theme")}=t,{hr:i=!0}=t;return e.$$set=e=>{"theme"in e&&r(0,n=e.theme),"hr"in e&&r(1,i=e.hr)},[n,i]}class Ki extends ue{constructor(e){super(),ce(this,e,Oi,Ri,o,{theme:0,hr:1})}}function Vi(t){let r,n,i,A,o,s,a;return{c(){r=w("div"),n=w("input"),i=B(),A=w("label"),o=x(t[2]),F(n,"id",t[1]),F(n,"type","checkbox"),F(n,"class","switch-input svelte-13gkv9q"),F(n,"tabindex","0"),F(A,"for",t[1]),F(A,"class","switch-label svelte-13gkv9q"),S(A,"mono",t[3]),F(r,"class","switch svelte-13gkv9q")},m(e,l){y(e,r,l),m(r,n),n.checked=t[0],m(r,i),m(r,A),m(A,o),s||(a=C(n,"change",t[4]),s=!0)},p(e,[t]){2&t&&F(n,"id",e[1]),1&t&&(n.checked=e[0]),4&t&&U(o,e[2]),2&t&&F(A,"for",e[1]),8&t&&S(A,"mono",e[3])},i:e,o:e,d(e){e&&_(r),s=!1,a()}}}function $i(e,t,r){let{id:n="switch"}=t,{label:i="Label"}=t,{mono:A=!1}=t,{checked:o}=t;return e.$$set=e=>{"id"in e&&r(1,n=e.id),"label"in e&&r(2,i=e.label),"mono"in e&&r(3,A=e.mono),"checked"in e&&r(0,o=e.checked)},[o,n,i,A,function(){o=this.checked,r(0,o)}]}class Ni extends ue{constructor(e){super(),ce(this,e,$i,Vi,o,{id:1,label:2,mono:3,checked:0})}}function Gi(e){let t,r,n;const i=e[4].default,A=c(i,e,e[3],null);return{c(){t=w("img"),A&&A.c(),a(t.src,r="./img/scroll-down-"+e[0]+".svg")||F(t,"src",r),F(t,"class","arrow left svelte-1bj9a7f"),F(t,"alt",""),F(t,"aria-hidden","true"),S(t,"bounce",e[1])},m(e,r){y(e,t,r),A&&A.m(e,r),n=!0},p(e,o){(!n||1&o&&!a(t.src,r="./img/scroll-down-"+e[0]+".svg"))&&F(t,"src",r),(!n||2&o)&&S(t,"bounce",e[1]),A&&A.p&&(!n||8&o)&&d(A,i,e,e[3],n?h(i,e[3],o,null):p(e[3]),null)},i(e){n||(ne(A,e),n=!0)},o(e){ie(A,e),n=!1},d(e){e&&_(t),A&&A.d(e)}}}function qi(e){let t,r,n,i,A;const o=e[4].default,s=c(o,e,e[3],null);return{c(){s&&s.c(),t=w("br"),r=B(),n=w("img"),a(n.src,i="./img/scroll-down-"+e[0]+".svg")||F(n,"src",i),F(n,"class","arrow svelte-1bj9a7f"),F(n,"alt",""),F(n,"aria-hidden","true"),S(n,"bounce",e[1])},m(e,i){s&&s.m(e,i),y(e,t,i),y(e,r,i),y(e,n,i),A=!0},p(e,t){s&&s.p&&(!A||8&t)&&d(s,o,e,e[3],A?h(o,e[3],t,null):p(e[3]),null),(!A||1&t&&!a(n.src,i="./img/scroll-down-"+e[0]+".svg"))&&F(n,"src",i),(!A||2&t)&&S(n,"bounce",e[1])},i(e){A||(ne(s,e),A=!0)},o(e){ie(s,e),A=!1},d(e){s&&s.d(e),e&&_(t),e&&_(r),e&&_(n)}}}function Xi(e){let t,r,n,i;const A=[qi,Gi],o=[];function s(e,t){return e[2]?0:1}return t=s(e),r=o[t]=A[t](e),{c(){r.c(),n=v()},m(e,r){o[t].m(e,r),y(e,n,r),i=!0},p(e,[i]){let a=t;t=s(e),t===a?o[t].p(e,i):(te(),ie(o[a],1,1,(()=>{o[a]=null})),re(),r=o[t],r?r.p(e,i):(r=o[t]=A[t](e),r.c()),ne(r,1),r.m(n.parentNode,n))},i(e){i||(ne(r),i=!0)},o(e){ie(r),i=!1},d(e){o[t].d(e),e&&_(n)}}}function ji(e,t,r){let{$$slots:n={},$$scope:i}=t,{color:A="black"}=t,{animation:o=!0}=t,{center:s=!0}=t;return A=["black","white"].includes(A)?A:"black",e.$$set=e=>{"color"in e&&r(0,A=e.color),"animation"in e&&r(1,o=e.animation),"center"in e&&r(2,s=e.center),"$$scope"in e&&r(3,i=e.$$scope)},[A,o,s,i,n]}class Zi extends ue{constructor(e){super(),ce(this,e,ji,Xi,o,{color:0,animation:1,center:2})}}var Ji={rgb2hsl:Wi,rgb2hsv:Yi,rgb2hwb:eA,rgb2cmyk:tA,rgb2keyword:rA,rgb2xyz:nA,rgb2lab:iA,rgb2lch:function(e){return hA(iA(e))},hsl2rgb:AA,hsl2hsv:function(e){var t=e[0],r=e[1]/100,n=e[2]/100;if(0===n)return[0,0,0];return[t,100*(2*(r*=(n*=2)<=1?n:2-n)/(n+r)),100*((n+r)/2)]},hsl2hwb:function(e){return eA(AA(e))},hsl2cmyk:function(e){return tA(AA(e))},hsl2keyword:function(e){return rA(AA(e))},hsv2rgb:oA,hsv2hsl:function(e){var t,r,n=e[0],i=e[1]/100,A=e[2]/100;return t=i*A,[n,100*(t=(t/=(r=(2-i)*A)<=1?r:2-r)||0),100*(r/=2)]},hsv2hwb:function(e){return eA(oA(e))},hsv2cmyk:function(e){return tA(oA(e))},hsv2keyword:function(e){return rA(oA(e))},hwb2rgb:sA,hwb2hsl:function(e){return Wi(sA(e))},hwb2hsv:function(e){return Yi(sA(e))},hwb2cmyk:function(e){return tA(sA(e))},hwb2keyword:function(e){return rA(sA(e))},cmyk2rgb:aA,cmyk2hsl:function(e){return Wi(aA(e))},cmyk2hsv:function(e){return Yi(aA(e))},cmyk2hwb:function(e){return eA(aA(e))},cmyk2keyword:function(e){return rA(aA(e))},keyword2rgb:fA,keyword2hsl:function(e){return Wi(fA(e))},keyword2hsv:function(e){return Yi(fA(e))},keyword2hwb:function(e){return eA(fA(e))},keyword2cmyk:function(e){return tA(fA(e))},keyword2lab:function(e){return iA(fA(e))},keyword2xyz:function(e){return nA(fA(e))},xyz2rgb:lA,xyz2lab:cA,xyz2lch:function(e){return hA(cA(e))},lab2xyz:uA,lab2rgb:dA,lab2lch:hA,lch2lab:pA,lch2xyz:function(e){return uA(pA(e))},lch2rgb:function(e){return dA(pA(e))}};function Wi(e){var t,r,n=e[0]/255,i=e[1]/255,A=e[2]/255,o=Math.min(n,i,A),s=Math.max(n,i,A),a=s-o;return s==o?t=0:n==s?t=(i-A)/a:i==s?t=2+(A-n)/a:A==s&&(t=4+(n-i)/a),(t=Math.min(60*t,360))<0&&(t+=360),r=(o+s)/2,[t,100*(s==o?0:r<=.5?a/(s+o):a/(2-s-o)),100*r]}function Yi(e){var t,r,n=e[0],i=e[1],A=e[2],o=Math.min(n,i,A),s=Math.max(n,i,A),a=s-o;return r=0==s?0:a/s*1e3/10,s==o?t=0:n==s?t=(i-A)/a:i==s?t=2+(A-n)/a:A==s&&(t=4+(n-i)/a),(t=Math.min(60*t,360))<0&&(t+=360),[t,r,s/255*1e3/10]}function eA(e){var t=e[0],r=e[1],n=e[2];return[Wi(e)[0],100*(1/255*Math.min(t,Math.min(r,n))),100*(n=1-1/255*Math.max(t,Math.max(r,n)))]}function tA(e){var t,r=e[0]/255,n=e[1]/255,i=e[2]/255;return[100*((1-r-(t=Math.min(1-r,1-n,1-i)))/(1-t)||0),100*((1-n-t)/(1-t)||0),100*((1-i-t)/(1-t)||0),100*t]}function rA(e){return gA[JSON.stringify(e)]}function nA(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255;return[100*(.4124*(t=t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92)+.3576*(r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92)+.1805*(n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92)),100*(.2126*t+.7152*r+.0722*n),100*(.0193*t+.1192*r+.9505*n)]}function iA(e){var t=nA(e),r=t[0],n=t[1],i=t[2];return n/=100,i/=108.883,r=(r/=95.047)>.008856?Math.pow(r,1/3):7.787*r+16/116,[116*(n=n>.008856?Math.pow(n,1/3):7.787*n+16/116)-16,500*(r-n),200*(n-(i=i>.008856?Math.pow(i,1/3):7.787*i+16/116))]}function AA(e){var t,r,n,i,A,o=e[0]/360,s=e[1]/100,a=e[2]/100;if(0==s)return[A=255*a,A,A];t=2*a-(r=a<.5?a*(1+s):a+s-a*s),i=[0,0,0];for(var l=0;l<3;l++)(n=o+1/3*-(l-1))<0&&n++,n>1&&n--,A=6*n<1?t+6*(r-t)*n:2*n<1?r:3*n<2?t+(r-t)*(2/3-n)*6:t,i[l]=255*A;return i}function oA(e){var t=e[0]/60,r=e[1]/100,n=e[2]/100,i=Math.floor(t)%6,A=t-Math.floor(t),o=255*n*(1-r),s=255*n*(1-r*A),a=255*n*(1-r*(1-A));n*=255;switch(i){case 0:return[n,a,o];case 1:return[s,n,o];case 2:return[o,n,a];case 3:return[o,s,n];case 4:return[a,o,n];case 5:return[n,o,s]}}function sA(e){var t,n,i,A,o=e[0]/360,s=e[1]/100,a=e[2]/100,l=s+a;switch(l>1&&(s/=l,a/=l),i=6*o-(t=Math.floor(6*o)),0!=(1&t)&&(i=1-i),A=s+i*((n=1-a)-s),t){default:case 6:case 0:r=n,g=A,b=s;break;case 1:r=A,g=n,b=s;break;case 2:r=s,g=n,b=A;break;case 3:r=s,g=A,b=n;break;case 4:r=A,g=s,b=n;break;case 5:r=n,g=s,b=A}return[255*r,255*g,255*b]}function aA(e){var t=e[0]/100,r=e[1]/100,n=e[2]/100,i=e[3]/100;return[255*(1-Math.min(1,t*(1-i)+i)),255*(1-Math.min(1,r*(1-i)+i)),255*(1-Math.min(1,n*(1-i)+i))]}function lA(e){var t,r,n,i=e[0]/100,A=e[1]/100,o=e[2]/100;return r=-.9689*i+1.8758*A+.0415*o,n=.0557*i+-.204*A+1.057*o,t=(t=3.2406*i+-1.5372*A+-.4986*o)>.0031308?1.055*Math.pow(t,1/2.4)-.055:t*=12.92,r=r>.0031308?1.055*Math.pow(r,1/2.4)-.055:r*=12.92,n=n>.0031308?1.055*Math.pow(n,1/2.4)-.055:n*=12.92,[255*(t=Math.min(Math.max(0,t),1)),255*(r=Math.min(Math.max(0,r),1)),255*(n=Math.min(Math.max(0,n),1))]}function cA(e){var t=e[0],r=e[1],n=e[2];return r/=100,n/=108.883,t=(t/=95.047)>.008856?Math.pow(t,1/3):7.787*t+16/116,[116*(r=r>.008856?Math.pow(r,1/3):7.787*r+16/116)-16,500*(t-r),200*(r-(n=n>.008856?Math.pow(n,1/3):7.787*n+16/116))]}function uA(e){var t,r,n,i,A=e[0],o=e[1],s=e[2];return A<=8?i=(r=100*A/903.3)/100*7.787+16/116:(r=100*Math.pow((A+16)/116,3),i=Math.pow(r/100,1/3)),[t=t/95.047<=.008856?t=95.047*(o/500+i-16/116)/7.787:95.047*Math.pow(o/500+i,3),r,n=n/108.883<=.008859?n=108.883*(i-s/200-16/116)/7.787:108.883*Math.pow(i-s/200,3)]}function hA(e){var t,r=e[0],n=e[1],i=e[2];return(t=360*Math.atan2(i,n)/2/Math.PI)<0&&(t+=360),[r,Math.sqrt(n*n+i*i),t]}function dA(e){return lA(uA(e))}function pA(e){var t,r=e[0],n=e[1];return t=e[2]/360*2*Math.PI,[r,n*Math.cos(t),n*Math.sin(t)]}function fA(e){return mA[e]}var mA={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},gA={};for(var yA in mA)gA[JSON.stringify(mA[yA])]=yA;var _A=function(){return new bA};for(var wA in Ji){_A[wA+"Raw"]=function(e){return function(t){return"number"==typeof t&&(t=Array.prototype.slice.call(arguments)),Ji[e](t)}}(wA);var xA=/(\w+)2(\w+)/.exec(wA),BA=xA[1],vA=xA[2];(_A[BA]=_A[BA]||{})[vA]=_A[wA]=function(e){return function(t){"number"==typeof t&&(t=Array.prototype.slice.call(arguments));var r=Ji[e](t);if("string"==typeof r||void 0===r)return r;for(var n=0;n<r.length;n++)r[n]=Math.round(r[n]);return r}}(wA)}var bA=function(){this.convs={}};bA.prototype.routeSpace=function(e,t){var r=t[0];return void 0===r?this.getValues(e):("number"==typeof r&&(r=Array.prototype.slice.call(t)),this.setValues(e,r))},bA.prototype.setValues=function(e,t){return this.space=e,this.convs={},this.convs[e]=t,this},bA.prototype.getValues=function(e){var t=this.convs[e];if(!t){var r=this.space,n=this.convs[r];t=_A[r][e](n),this.convs[e]=t}return t},["rgb","hsl","hsv","cmyk","keyword"].forEach((function(e){bA.prototype[e]=function(t){return this.routeSpace(e,arguments)}}));var CA=_A;function FA(e){let t,r;const n=e[5].default,i=c(n,e,e[4],null);return{c(){t=w("span"),i&&i.c(),F(t,"class","em svelte-s1t2y4"),I(t,"background-color",e[0]),I(t,"color",e[2]),F(t,"role","presentation"),S(t,"nowrap",e[1])},m(e,n){y(e,t,n),i&&i.m(t,null),r=!0},p(e,[A]){i&&i.p&&(!r||16&A)&&d(i,n,e,e[4],r?h(n,e[4],A,null):p(e[4]),null),(!r||1&A)&&I(t,"background-color",e[0]),(!r||4&A)&&I(t,"color",e[2]),(!r||2&A)&&S(t,"nowrap",e[1])},i(e){r||(ne(i,e),r=!0)},o(e){ie(i,e),r=!1},d(e){e&&_(t),i&&i.d(e)}}}function EA(e,t,r){let n,{$$slots:i={},$$scope:A}=t,{color:o="lightgrey"}=t,{nowrap:s=!0}=t;let a="black";return e.$$set=e=>{"color"in e&&r(0,o=e.color),"nowrap"in e&&r(1,s=e.nowrap),"$$scope"in e&&r(4,A=e.$$scope)},e.$$.update=()=>{1&e.$$.dirty&&r(3,n=function(e){var t,r,n,i;if(t=/^((?:rgb|hs[lv]|cmyk|xyz|lab)a?)\s*\(([^\)]*)\)/.exec(e)){var A=t[1],o="cmyk"===(s=A.replace(/a$/,""))?4:3;r=CA[s],n=t[2].replace(/^\s+|\s+$/g,"").split(/\s*,\s*/).map((function(e,t){return/%$/.test(e)&&t===o?parseFloat(e)/100:(/%$/.test(e),parseFloat(e))})),A===s&&n.push(1),i=void 0===n[o]?1:n[o],n=n.slice(0,o),r[s]=function(){return n}}else if(/^#[A-Fa-f0-9]+$/.test(e)){var s;o=(s=e.replace(/^#/,"")).length,r=CA.rgb,n=(n=s.split(3===o?/(.)/:/(..)/)).filter(Boolean).map((function(e){return 3===o?parseInt(e+e,16):parseInt(e,16)})),i=1,r.rgb=function(){return n},n[0]||(n[0]=0),n[1]||(n[1]=0),n[2]||(n[2]=0)}else(r=CA.keyword).keyword=function(){return e},n=e,i=1;var a={rgb:void 0,hsl:void 0,hsv:void 0,cmyk:void 0,keyword:void 0,hex:void 0};try{a.rgb=r.rgb(n)}catch(e){}try{a.hsl=r.hsl(n)}catch(e){}try{a.hsv=r.hsv(n)}catch(e){}try{a.cmyk=r.cmyk(n)}catch(e){}try{a.keyword=r.keyword(n)}catch(e){}return a.rgb&&(a.hex="#"+a.rgb.map((function(e){var t=e.toString(16);return 1===t.length?"0"+t:t})).join("")),a.rgb&&(a.rgba=a.rgb.concat(i)),a.hsl&&(a.hsla=a.hsl.concat(i)),a.hsv&&(a.hsva=a.hsv.concat(i)),a.cmyk&&(a.cmyka=a.cmyk.concat(i)),a}(o).rgb),8&e.$$.dirty&&n&&r(2,a=function(e){return(299*e[0]+587*e[1]+114*e[2])/1e3>125?"black":"white"}(n))},[o,s,a,n,A,i]}class UA extends ue{constructor(e){super(),ce(this,e,EA,FA,o,{color:0,nowrap:1})}}var QA={value:()=>{}};function IA(){for(var e,t=0,r=arguments.length,n={};t<r;++t){if(!(e=arguments[t]+"")||e in n||/[\s.]/.test(e))throw new Error("illegal type: "+e);n[e]=[]}return new TA(n)}function TA(e){this._=e}function SA(e,t){for(var r,n=0,i=e.length;n<i;++n)if((r=e[n]).name===t)return r.value}function MA(e,t,r){for(var n=0,i=e.length;n<i;++n)if(e[n].name===t){e[n]=QA,e=e.slice(0,n).concat(e.slice(n+1));break}return null!=r&&e.push({name:t,value:r}),e}TA.prototype=IA.prototype={constructor:TA,on:function(e,t){var r,n,i=this._,A=(n=i,(e+"").trim().split(/^|\s+/).map((function(e){var t="",r=e.indexOf(".");if(r>=0&&(t=e.slice(r+1),e=e.slice(0,r)),e&&!n.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:t}}))),o=-1,s=A.length;if(!(arguments.length<2)){if(null!=t&&"function"!=typeof t)throw new Error("invalid callback: "+t);for(;++o<s;)if(r=(e=A[o]).type)i[r]=MA(i[r],e.name,t);else if(null==t)for(r in i)i[r]=MA(i[r],e.name,null);return this}for(;++o<s;)if((r=(e=A[o]).type)&&(r=SA(i[r],e.name)))return r},copy:function(){var e={},t=this._;for(var r in t)e[r]=t[r].slice();return new TA(e)},call:function(e,t){if((r=arguments.length-2)>0)for(var r,n,i=new Array(r),A=0;A<r;++A)i[A]=arguments[A+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(A=0,r=(n=this._[e]).length;A<r;++A)n[A].value.apply(t,i)},apply:function(e,t,r){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var n=this._[e],i=0,A=n.length;i<A;++i)n[i].value.apply(t,r)}};var kA="http://www.w3.org/1999/xhtml",DA={svg:"http://www.w3.org/2000/svg",xhtml:kA,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function LA(e){var t=e+="",r=t.indexOf(":");return r>=0&&"xmlns"!==(t=e.slice(0,r))&&(e=e.slice(r+1)),DA.hasOwnProperty(t)?{space:DA[t],local:e}:e}function PA(e){return function(){var t=this.ownerDocument,r=this.namespaceURI;return r===kA&&t.documentElement.namespaceURI===kA?t.createElement(e):t.createElementNS(r,e)}}function HA(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function zA(e){var t=LA(e);return(t.local?HA:PA)(t)}function RA(){}function OA(e){return null==e?RA:function(){return this.querySelector(e)}}function KA(){return[]}function VA(e){return null==e?KA:function(){return this.querySelectorAll(e)}}function $A(e){return function(){return function(e){return null==e?[]:Array.isArray(e)?e:Array.from(e)}(e.apply(this,arguments))}}function NA(e){return function(){return this.matches(e)}}function GA(e){return function(t){return t.matches(e)}}var qA=Array.prototype.find;function XA(){return this.firstElementChild}var jA=Array.prototype.filter;function ZA(){return Array.from(this.children)}function JA(e){return new Array(e.length)}function WA(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}function YA(e,t,r,n,i,A){for(var o,s=0,a=t.length,l=A.length;s<l;++s)(o=t[s])?(o.__data__=A[s],n[s]=o):r[s]=new WA(e,A[s]);for(;s<a;++s)(o=t[s])&&(i[s]=o)}function eo(e,t,r,n,i,A,o){var s,a,l,c=new Map,u=t.length,h=A.length,d=new Array(u);for(s=0;s<u;++s)(a=t[s])&&(d[s]=l=o.call(a,a.__data__,s,t)+"",c.has(l)?i[s]=a:c.set(l,a));for(s=0;s<h;++s)l=o.call(e,A[s],s,A)+"",(a=c.get(l))?(n[s]=a,a.__data__=A[s],c.delete(l)):r[s]=new WA(e,A[s]);for(s=0;s<u;++s)(a=t[s])&&c.get(d[s])===a&&(i[s]=a)}function to(e){return e.__data__}function ro(e){return"object"==typeof e&&"length"in e?e:Array.from(e)}function no(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function io(e){return function(){this.removeAttribute(e)}}function Ao(e){return function(){this.removeAttributeNS(e.space,e.local)}}function oo(e,t){return function(){this.setAttribute(e,t)}}function so(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function ao(e,t){return function(){var r=t.apply(this,arguments);null==r?this.removeAttribute(e):this.setAttribute(e,r)}}function lo(e,t){return function(){var r=t.apply(this,arguments);null==r?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,r)}}function co(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function uo(e){return function(){this.style.removeProperty(e)}}function ho(e,t,r){return function(){this.style.setProperty(e,t,r)}}function po(e,t,r){return function(){var n=t.apply(this,arguments);null==n?this.style.removeProperty(e):this.style.setProperty(e,n,r)}}function fo(e,t){return e.style.getPropertyValue(t)||co(e).getComputedStyle(e,null).getPropertyValue(t)}function mo(e){return function(){delete this[e]}}function go(e,t){return function(){this[e]=t}}function yo(e,t){return function(){var r=t.apply(this,arguments);null==r?delete this[e]:this[e]=r}}function _o(e){return e.trim().split(/^|\s+/)}function wo(e){return e.classList||new xo(e)}function xo(e){this._node=e,this._names=_o(e.getAttribute("class")||"")}function Bo(e,t){for(var r=wo(e),n=-1,i=t.length;++n<i;)r.add(t[n])}function vo(e,t){for(var r=wo(e),n=-1,i=t.length;++n<i;)r.remove(t[n])}function bo(e){return function(){Bo(this,e)}}function Co(e){return function(){vo(this,e)}}function Fo(e,t){return function(){(t.apply(this,arguments)?Bo:vo)(this,e)}}function Eo(){this.textContent=""}function Uo(e){return function(){this.textContent=e}}function Qo(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}}function Io(){this.innerHTML=""}function To(e){return function(){this.innerHTML=e}}function So(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}}function Mo(){this.nextSibling&&this.parentNode.appendChild(this)}function ko(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Do(){return null}function Lo(){var e=this.parentNode;e&&e.removeChild(this)}function Po(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Ho(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function zo(e){return function(){var t=this.__on;if(t){for(var r,n=0,i=-1,A=t.length;n<A;++n)r=t[n],e.type&&r.type!==e.type||r.name!==e.name?t[++i]=r:this.removeEventListener(r.type,r.listener,r.options);++i?t.length=i:delete this.__on}}}function Ro(e,t,r){return function(){var n,i=this.__on,A=function(e){return function(t){e.call(this,t,this.__data__)}}(t);if(i)for(var o=0,s=i.length;o<s;++o)if((n=i[o]).type===e.type&&n.name===e.name)return this.removeEventListener(n.type,n.listener,n.options),this.addEventListener(n.type,n.listener=A,n.options=r),void(n.value=t);this.addEventListener(e.type,A,r),n={type:e.type,name:e.name,value:t,listener:A,options:r},i?i.push(n):this.__on=[n]}}function Oo(e,t,r){var n=co(e),i=n.CustomEvent;"function"==typeof i?i=new i(t,r):(i=n.document.createEvent("Event"),r?(i.initEvent(t,r.bubbles,r.cancelable),i.detail=r.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function Ko(e,t){return function(){return Oo(this,e,t)}}function Vo(e,t){return function(){return Oo(this,e,t.apply(this,arguments))}}WA.prototype={constructor:WA,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}},xo.prototype={add:function(e){this._names.indexOf(e)<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};var $o=[null];function No(e,t){this._groups=e,this._parents=t}function Go(){return new No([[document.documentElement]],$o)}No.prototype=Go.prototype={constructor:No,select:function(e){"function"!=typeof e&&(e=OA(e));for(var t=this._groups,r=t.length,n=new Array(r),i=0;i<r;++i)for(var A,o,s=t[i],a=s.length,l=n[i]=new Array(a),c=0;c<a;++c)(A=s[c])&&(o=e.call(A,A.__data__,c,s))&&("__data__"in A&&(o.__data__=A.__data__),l[c]=o);return new No(n,this._parents)},selectAll:function(e){e="function"==typeof e?$A(e):VA(e);for(var t=this._groups,r=t.length,n=[],i=[],A=0;A<r;++A)for(var o,s=t[A],a=s.length,l=0;l<a;++l)(o=s[l])&&(n.push(e.call(o,o.__data__,l,s)),i.push(o));return new No(n,i)},selectChild:function(e){return this.select(null==e?XA:function(e){return function(){return qA.call(this.children,e)}}("function"==typeof e?e:GA(e)))},selectChildren:function(e){return this.selectAll(null==e?ZA:function(e){return function(){return jA.call(this.children,e)}}("function"==typeof e?e:GA(e)))},filter:function(e){"function"!=typeof e&&(e=NA(e));for(var t=this._groups,r=t.length,n=new Array(r),i=0;i<r;++i)for(var A,o=t[i],s=o.length,a=n[i]=[],l=0;l<s;++l)(A=o[l])&&e.call(A,A.__data__,l,o)&&a.push(A);return new No(n,this._parents)},data:function(e,t){if(!arguments.length)return Array.from(this,to);var r=t?eo:YA,n=this._parents,i=this._groups;"function"!=typeof e&&(e=function(e){return function(){return e}}(e));for(var A=i.length,o=new Array(A),s=new Array(A),a=new Array(A),l=0;l<A;++l){var c=n[l],u=i[l],h=u.length,d=ro(e.call(c,c&&c.__data__,l,n)),p=d.length,f=s[l]=new Array(p),m=o[l]=new Array(p);r(c,u,f,m,a[l]=new Array(h),d,t);for(var g,y,_=0,w=0;_<p;++_)if(g=f[_]){for(_>=w&&(w=_+1);!(y=m[w])&&++w<p;);g._next=y||null}}return(o=new No(o,n))._enter=s,o._exit=a,o},enter:function(){return new No(this._enter||this._groups.map(JA),this._parents)},exit:function(){return new No(this._exit||this._groups.map(JA),this._parents)},join:function(e,t,r){var n=this.enter(),i=this,A=this.exit();return"function"==typeof e?(n=e(n))&&(n=n.selection()):n=n.append(e+""),null!=t&&(i=t(i))&&(i=i.selection()),null==r?A.remove():r(A),n&&i?n.merge(i).order():i},merge:function(e){for(var t=e.selection?e.selection():e,r=this._groups,n=t._groups,i=r.length,A=n.length,o=Math.min(i,A),s=new Array(i),a=0;a<o;++a)for(var l,c=r[a],u=n[a],h=c.length,d=s[a]=new Array(h),p=0;p<h;++p)(l=c[p]||u[p])&&(d[p]=l);for(;a<i;++a)s[a]=r[a];return new No(s,this._parents)},selection:function(){return this},order:function(){for(var e=this._groups,t=-1,r=e.length;++t<r;)for(var n,i=e[t],A=i.length-1,o=i[A];--A>=0;)(n=i[A])&&(o&&4^n.compareDocumentPosition(o)&&o.parentNode.insertBefore(n,o),o=n);return this},sort:function(e){function t(t,r){return t&&r?e(t.__data__,r.__data__):!t-!r}e||(e=no);for(var r=this._groups,n=r.length,i=new Array(n),A=0;A<n;++A){for(var o,s=r[A],a=s.length,l=i[A]=new Array(a),c=0;c<a;++c)(o=s[c])&&(l[c]=o);l.sort(t)}return new No(i,this._parents).order()},call:function(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var n=e[t],i=0,A=n.length;i<A;++i){var o=n[i];if(o)return o}return null},size:function(){let e=0;for(const t of this)++e;return e},empty:function(){return!this.node()},each:function(e){for(var t=this._groups,r=0,n=t.length;r<n;++r)for(var i,A=t[r],o=0,s=A.length;o<s;++o)(i=A[o])&&e.call(i,i.__data__,o,A);return this},attr:function(e,t){var r=LA(e);if(arguments.length<2){var n=this.node();return r.local?n.getAttributeNS(r.space,r.local):n.getAttribute(r)}return this.each((null==t?r.local?Ao:io:"function"==typeof t?r.local?lo:ao:r.local?so:oo)(r,t))},style:function(e,t,r){return arguments.length>1?this.each((null==t?uo:"function"==typeof t?po:ho)(e,t,null==r?"":r)):fo(this.node(),e)},property:function(e,t){return arguments.length>1?this.each((null==t?mo:"function"==typeof t?yo:go)(e,t)):this.node()[e]},classed:function(e,t){var r=_o(e+"");if(arguments.length<2){for(var n=wo(this.node()),i=-1,A=r.length;++i<A;)if(!n.contains(r[i]))return!1;return!0}return this.each(("function"==typeof t?Fo:t?bo:Co)(r,t))},text:function(e){return arguments.length?this.each(null==e?Eo:("function"==typeof e?Qo:Uo)(e)):this.node().textContent},html:function(e){return arguments.length?this.each(null==e?Io:("function"==typeof e?So:To)(e)):this.node().innerHTML},raise:function(){return this.each(Mo)},lower:function(){return this.each(ko)},append:function(e){var t="function"==typeof e?e:zA(e);return this.select((function(){return this.appendChild(t.apply(this,arguments))}))},insert:function(e,t){var r="function"==typeof e?e:zA(e),n=null==t?Do:"function"==typeof t?t:OA(t);return this.select((function(){return this.insertBefore(r.apply(this,arguments),n.apply(this,arguments)||null)}))},remove:function(){return this.each(Lo)},clone:function(e){return this.select(e?Ho:Po)},datum:function(e){return arguments.length?this.property("__data__",e):this.node().__data__},on:function(e,t,r){var n,i,A=function(e){return e.trim().split(/^|\s+/).map((function(e){var t="",r=e.indexOf(".");return r>=0&&(t=e.slice(r+1),e=e.slice(0,r)),{type:e,name:t}}))}(e+""),o=A.length;if(!(arguments.length<2)){for(s=t?Ro:zo,n=0;n<o;++n)this.each(s(A[n],t,r));return this}var s=this.node().__on;if(s)for(var a,l=0,c=s.length;l<c;++l)for(n=0,a=s[l];n<o;++n)if((i=A[n]).type===a.type&&i.name===a.name)return a.value},dispatch:function(e,t){return this.each(("function"==typeof t?Vo:Ko)(e,t))},[Symbol.iterator]:function*(){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var n,i=e[t],A=0,o=i.length;A<o;++A)(n=i[A])&&(yield n)}};var qo,Xo,jo=0,Zo=0,Jo=0,Wo=1e3,Yo=0,es=0,ts=0,rs="object"==typeof performance&&performance.now?performance:Date,ns="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function is(){return es||(ns(As),es=rs.now()+ts)}function As(){es=0}function os(){this._call=this._time=this._next=null}function ss(e,t,r){var n=new os;return n.restart(e,t,r),n}function as(){es=(Yo=rs.now())+ts,jo=Zo=0;try{!function(){is(),++jo;for(var e,t=qo;t;)(e=es-t._time)>=0&&t._call.call(void 0,e),t=t._next;--jo}()}finally{jo=0,function(){var e,t,r=qo,n=1/0;for(;r;)r._call?(n>r._time&&(n=r._time),e=r,r=r._next):(t=r._next,r._next=null,r=e?e._next=t:qo=t);Xo=e,cs(n)}(),es=0}}function ls(){var e=rs.now(),t=e-Yo;t>Wo&&(ts-=t,Yo=e)}function cs(e){jo||(Zo&&(Zo=clearTimeout(Zo)),e-es>24?(e<1/0&&(Zo=setTimeout(as,e-rs.now()-ts)),Jo&&(Jo=clearInterval(Jo))):(Jo||(Yo=rs.now(),Jo=setInterval(ls,Wo)),jo=1,ns(as)))}function us(e,t,r){var n=new os;return t=null==t?0:+t,n.restart((r=>{n.stop(),e(r+t)}),t,r),n}os.prototype=ss.prototype={constructor:os,restart:function(e,t,r){if("function"!=typeof e)throw new TypeError("callback is not a function");r=(null==r?is():+r)+(null==t?0:+t),this._next||Xo===this||(Xo?Xo._next=this:qo=this,Xo=this),this._call=e,this._time=r,cs()},stop:function(){this._call&&(this._call=null,this._time=1/0,cs())}};var hs=IA("start","end","cancel","interrupt"),ds=[],ps=0,fs=1,ms=2,gs=3,ys=4,_s=5,ws=6;function xs(e,t,r,n,i,A){var o=e.__transition;if(o){if(r in o)return}else e.__transition={};!function(e,t,r){var n,i=e.__transition;function A(e){r.state=fs,r.timer.restart(o,r.delay,r.time),r.delay<=e&&o(e-r.delay)}function o(A){var l,c,u,h;if(r.state!==fs)return a();for(l in i)if((h=i[l]).name===r.name){if(h.state===gs)return us(o);h.state===ys?(h.state=ws,h.timer.stop(),h.on.call("interrupt",e,e.__data__,h.index,h.group),delete i[l]):+l<t&&(h.state=ws,h.timer.stop(),h.on.call("cancel",e,e.__data__,h.index,h.group),delete i[l])}if(us((function(){r.state===gs&&(r.state=ys,r.timer.restart(s,r.delay,r.time),s(A))})),r.state=ms,r.on.call("start",e,e.__data__,r.index,r.group),r.state===ms){for(r.state=gs,n=new Array(u=r.tween.length),l=0,c=-1;l<u;++l)(h=r.tween[l].value.call(e,e.__data__,r.index,r.group))&&(n[++c]=h);n.length=c+1}}function s(t){for(var i=t<r.duration?r.ease.call(null,t/r.duration):(r.timer.restart(a),r.state=_s,1),A=-1,o=n.length;++A<o;)n[A].call(e,i);r.state===_s&&(r.on.call("end",e,e.__data__,r.index,r.group),a())}function a(){for(var n in r.state=ws,r.timer.stop(),delete i[t],i)return;delete e.__transition}i[t]=r,r.timer=ss(A,0,r.time)}(e,r,{name:t,index:n,group:i,on:hs,tween:ds,time:A.time,delay:A.delay,duration:A.duration,ease:A.ease,timer:null,state:ps})}function Bs(e,t){var r=bs(e,t);if(r.state>ps)throw new Error("too late; already scheduled");return r}function vs(e,t){var r=bs(e,t);if(r.state>gs)throw new Error("too late; already running");return r}function bs(e,t){var r=e.__transition;if(!r||!(r=r[t]))throw new Error("transition not found");return r}function Cs(e,t){var r,n;return function(){var i=vs(this,e),A=i.tween;if(A!==r)for(var o=0,s=(n=r=A).length;o<s;++o)if(n[o].name===t){(n=n.slice()).splice(o,1);break}i.tween=n}}function Fs(e,t,r){var n,i;if("function"!=typeof r)throw new Error;return function(){var A=vs(this,e),o=A.tween;if(o!==n){i=(n=o).slice();for(var s={name:t,value:r},a=0,l=i.length;a<l;++a)if(i[a].name===t){i[a]=s;break}a===l&&i.push(s)}A.tween=i}}function Es(e,t,r){var n=e._id;return e.each((function(){var e=vs(this,n);(e.value||(e.value={}))[t]=r.apply(this,arguments)})),function(e){return bs(e,n).value[t]}}function Us(e,t){var r;return("number"==typeof t?wn:t instanceof Ir?mn:(r=Ir(t))?(t=r,mn):bn)(e,t)}function Qs(e){return function(){this.removeAttribute(e)}}function Is(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Ts(e,t,r){var n,i,A=r+"";return function(){var o=this.getAttribute(e);return o===A?null:o===n?i:i=t(n=o,r)}}function Ss(e,t,r){var n,i,A=r+"";return function(){var o=this.getAttributeNS(e.space,e.local);return o===A?null:o===n?i:i=t(n=o,r)}}function Ms(e,t,r){var n,i,A;return function(){var o,s,a=r(this);if(null!=a)return(o=this.getAttribute(e))===(s=a+"")?null:o===n&&s===i?A:(i=s,A=t(n=o,a));this.removeAttribute(e)}}function ks(e,t,r){var n,i,A;return function(){var o,s,a=r(this);if(null!=a)return(o=this.getAttributeNS(e.space,e.local))===(s=a+"")?null:o===n&&s===i?A:(i=s,A=t(n=o,a));this.removeAttributeNS(e.space,e.local)}}function Ds(e,t){var r,n;function i(){var i=t.apply(this,arguments);return i!==n&&(r=(n=i)&&function(e,t){return function(r){this.setAttributeNS(e.space,e.local,t.call(this,r))}}(e,i)),r}return i._value=t,i}function Ls(e,t){var r,n;function i(){var i=t.apply(this,arguments);return i!==n&&(r=(n=i)&&function(e,t){return function(r){this.setAttribute(e,t.call(this,r))}}(e,i)),r}return i._value=t,i}function Ps(e,t){return function(){Bs(this,e).delay=+t.apply(this,arguments)}}function Hs(e,t){return t=+t,function(){Bs(this,e).delay=t}}function zs(e,t){return function(){vs(this,e).duration=+t.apply(this,arguments)}}function Rs(e,t){return t=+t,function(){vs(this,e).duration=t}}var Os=Go.prototype.constructor;function Ks(e){return function(){this.style.removeProperty(e)}}var Vs=0;function $s(e,t,r,n){this._groups=e,this._parents=t,this._name=r,this._id=n}function Ns(){return++Vs}var Gs=Go.prototype;$s.prototype=function(e){return Go().transition(e)}.prototype={constructor:$s,select:function(e){var t=this._name,r=this._id;"function"!=typeof e&&(e=OA(e));for(var n=this._groups,i=n.length,A=new Array(i),o=0;o<i;++o)for(var s,a,l=n[o],c=l.length,u=A[o]=new Array(c),h=0;h<c;++h)(s=l[h])&&(a=e.call(s,s.__data__,h,l))&&("__data__"in s&&(a.__data__=s.__data__),u[h]=a,xs(u[h],t,r,h,u,bs(s,r)));return new $s(A,this._parents,t,r)},selectAll:function(e){var t=this._name,r=this._id;"function"!=typeof e&&(e=VA(e));for(var n=this._groups,i=n.length,A=[],o=[],s=0;s<i;++s)for(var a,l=n[s],c=l.length,u=0;u<c;++u)if(a=l[u]){for(var h,d=e.call(a,a.__data__,u,l),p=bs(a,r),f=0,m=d.length;f<m;++f)(h=d[f])&&xs(h,t,r,f,d,p);A.push(d),o.push(a)}return new $s(A,o,t,r)},selectChild:Gs.selectChild,selectChildren:Gs.selectChildren,filter:function(e){"function"!=typeof e&&(e=NA(e));for(var t=this._groups,r=t.length,n=new Array(r),i=0;i<r;++i)for(var A,o=t[i],s=o.length,a=n[i]=[],l=0;l<s;++l)(A=o[l])&&e.call(A,A.__data__,l,o)&&a.push(A);return new $s(n,this._parents,this._name,this._id)},merge:function(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,r=e._groups,n=t.length,i=r.length,A=Math.min(n,i),o=new Array(n),s=0;s<A;++s)for(var a,l=t[s],c=r[s],u=l.length,h=o[s]=new Array(u),d=0;d<u;++d)(a=l[d]||c[d])&&(h[d]=a);for(;s<n;++s)o[s]=t[s];return new $s(o,this._parents,this._name,this._id)},selection:function(){return new Os(this._groups,this._parents)},transition:function(){for(var e=this._name,t=this._id,r=Ns(),n=this._groups,i=n.length,A=0;A<i;++A)for(var o,s=n[A],a=s.length,l=0;l<a;++l)if(o=s[l]){var c=bs(o,t);xs(o,e,r,l,s,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new $s(n,this._parents,e,r)},call:Gs.call,nodes:Gs.nodes,node:Gs.node,size:Gs.size,empty:Gs.empty,each:Gs.each,on:function(e,t){var r=this._id;return arguments.length<2?bs(this.node(),r).on.on(e):this.each(function(e,t,r){var n,i,A=function(e){return(e+"").trim().split(/^|\s+/).every((function(e){var t=e.indexOf(".");return t>=0&&(e=e.slice(0,t)),!e||"start"===e}))}(t)?Bs:vs;return function(){var o=A(this,e),s=o.on;s!==n&&(i=(n=s).copy()).on(t,r),o.on=i}}(r,e,t))},attr:function(e,t){var r=LA(e),n="transform"===r?Mn:Us;return this.attrTween(e,"function"==typeof t?(r.local?ks:Ms)(r,n,Es(this,"attr."+e,t)):null==t?(r.local?Is:Qs)(r):(r.local?Ss:Ts)(r,n,t))},attrTween:function(e,t){var r="attr."+e;if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==t)return this.tween(r,null);if("function"!=typeof t)throw new Error;var n=LA(e);return this.tween(r,(n.local?Ds:Ls)(n,t))},style:function(e,t,r){var n="transform"==(e+="")?Sn:Us;return null==t?this.styleTween(e,function(e,t){var r,n,i;return function(){var A=fo(this,e),o=(this.style.removeProperty(e),fo(this,e));return A===o?null:A===r&&o===n?i:i=t(r=A,n=o)}}(e,n)).on("end.style."+e,Ks(e)):"function"==typeof t?this.styleTween(e,function(e,t,r){var n,i,A;return function(){var o=fo(this,e),s=r(this),a=s+"";return null==s&&(this.style.removeProperty(e),a=s=fo(this,e)),o===a?null:o===n&&a===i?A:(i=a,A=t(n=o,s))}}(e,n,Es(this,"style."+e,t))).each(function(e,t){var r,n,i,A,o="style."+t,s="end."+o;return function(){var a=vs(this,e),l=a.on,c=null==a.value[o]?A||(A=Ks(t)):void 0;l===r&&i===c||(n=(r=l).copy()).on(s,i=c),a.on=n}}(this._id,e)):this.styleTween(e,function(e,t,r){var n,i,A=r+"";return function(){var o=fo(this,e);return o===A?null:o===n?i:i=t(n=o,r)}}(e,n,t),r).on("end.style."+e,null)},styleTween:function(e,t,r){var n="style."+(e+="");if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==t)return this.tween(n,null);if("function"!=typeof t)throw new Error;return this.tween(n,function(e,t,r){var n,i;function A(){var A=t.apply(this,arguments);return A!==i&&(n=(i=A)&&function(e,t,r){return function(n){this.style.setProperty(e,t.call(this,n),r)}}(e,A,r)),n}return A._value=t,A}(e,t,null==r?"":r))},text:function(e){return this.tween("text","function"==typeof e?function(e){return function(){var t=e(this);this.textContent=null==t?"":t}}(Es(this,"text",e)):function(e){return function(){this.textContent=e}}(null==e?"":e+""))},textTween:function(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(null==e)return this.tween(t,null);if("function"!=typeof e)throw new Error;return this.tween(t,function(e){var t,r;function n(){var n=e.apply(this,arguments);return n!==r&&(t=(r=n)&&function(e){return function(t){this.textContent=e.call(this,t)}}(n)),t}return n._value=e,n}(e))},remove:function(){return this.on("end.remove",function(e){return function(){var t=this.parentNode;for(var r in this.__transition)if(+r!==e)return;t&&t.removeChild(this)}}(this._id))},tween:function(e,t){var r=this._id;if(e+="",arguments.length<2){for(var n,i=bs(this.node(),r).tween,A=0,o=i.length;A<o;++A)if((n=i[A]).name===e)return n.value;return null}return this.each((null==t?Cs:Fs)(r,e,t))},delay:function(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?Ps:Hs)(t,e)):bs(this.node(),t).delay},duration:function(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?zs:Rs)(t,e)):bs(this.node(),t).duration},ease:function(e){var t=this._id;return arguments.length?this.each(function(e,t){if("function"!=typeof t)throw new Error;return function(){vs(this,e).ease=t}}(t,e)):bs(this.node(),t).ease},easeVarying:function(e){if("function"!=typeof e)throw new Error;return this.each(function(e,t){return function(){var r=t.apply(this,arguments);if("function"!=typeof r)throw new Error;vs(this,e).ease=r}}(this._id,e))},end:function(){var e,t,r=this,n=r._id,i=r.size();return new Promise((function(A,o){var s={value:o},a={value:function(){0==--i&&A()}};r.each((function(){var r=vs(this,n),i=r.on;i!==e&&((t=(e=i).copy())._.cancel.push(s),t._.interrupt.push(s),t._.end.push(a)),r.on=t})),0===i&&A()}))},[Symbol.iterator]:Gs[Symbol.iterator]};var qs={time:null,delay:0,duration:250,ease:function(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}};function Xs(e,t){for(var r;!(r=e.__transition)||!(r=r[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return r}function js(t){let r;return{c(){r=w("div"),F(r,"id","legende")},m(e,n){y(e,r,n),t[1](r)},p:e,i:e,o:e,d(e){e&&_(r),t[1](null)}}}function Zs(e,t,r){let n;return L((()=>{var e=640,t=Ai().range(["#fde0dd","#dd3497","#49006a","#4575b4","#abd9e9"]).domain([e,480,320,160,0]).interpolate(kn),r=function(e){return"string"==typeof e?new No([[document.querySelector(e)]],[document.documentElement]):new No([[e]],$o)}(n).append("svg").attr("width","100%").attr("viewBox","0 0 640 64");r.selectAll(".bars").data(function(e,t,r){e=+e,t=+t,r=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+r;for(var n=-1,i=0|Math.max(0,Math.ceil((t-e)/r)),A=new Array(i);++n<i;)A[n]=e+n*r;return A}(e),(e=>e)).enter().append("rect").attr("class","bars").attr("x",(function(e,t){return e})).attr("y",5).attr("height",35).attr("width",2).attr("fill",(function(e,r){return t(e)}))})),[n,function(e){K[e?"unshift":"push"]((()=>{n=e,r(0,n)}))}]}Go.prototype.interrupt=function(e){return this.each((function(){!function(e,t){var r,n,i,A=e.__transition,o=!0;if(A){for(i in t=null==t?null:t+"",A)(r=A[i]).name===t?(n=r.state>ms&&r.state<_s,r.state=ws,r.timer.stop(),r.on.call(n?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete A[i]):o=!1;o&&delete e.__transition}}(this,e)}))},Go.prototype.transition=function(e){var t,r;e instanceof $s?(t=e._id,e=e._name):(t=Ns(),(r=qs).time=is(),e=null==e?null:e+"");for(var n=this._groups,i=n.length,A=0;A<i;++A)for(var o,s=n[A],a=s.length,l=0;l<a;++l)(o=s[l])&&xs(o,e,t,l,s,r||Xs(o,t));return new $s(n,this._parents,e,t)};class Js extends ue{constructor(e){super(),ce(this,e,Zs,js,o,{})}}function Ws(e,t,r){if(null!==e)for(var n,i,A,o,s,a,l,c,u=0,h=0,d=e.type,p="FeatureCollection"===d,f="Feature"===d,m=p?e.features.length:1,g=0;g<m;g++){s=(c=!!(l=p?e.features[g].geometry:f?e.geometry:e)&&"GeometryCollection"===l.type)?l.geometries.length:1;for(var y=0;y<s;y++){var _=0,w=0;if(null!==(o=c?l.geometries[y]:l)){a=o.coordinates;var x=o.type;switch(u=!r||"Polygon"!==x&&"MultiPolygon"!==x?0:1,x){case null:break;case"Point":if(!1===t(a,h,g,_,w))return!1;h++,_++;break;case"LineString":case"MultiPoint":for(n=0;n<a.length;n++){if(!1===t(a[n],h,g,_,w))return!1;h++,"MultiPoint"===x&&_++}"LineString"===x&&_++;break;case"Polygon":case"MultiLineString":for(n=0;n<a.length;n++){for(i=0;i<a[n].length-u;i++){if(!1===t(a[n][i],h,g,_,w))return!1;h++}"MultiLineString"===x&&_++,"Polygon"===x&&w++}"Polygon"===x&&_++;break;case"MultiPolygon":for(n=0;n<a.length;n++){for(w=0,i=0;i<a[n].length;i++){for(A=0;A<a[n][i].length-u;A++){if(!1===t(a[n][i][A],h,g,_,w))return!1;h++}w++}_++}break;case"GeometryCollection":for(n=0;n<o.geometries.length;n++)if(!1===Ws(o.geometries[n],t,r))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function Ys(e){var t=[1/0,1/0,-1/0,-1/0];return Ws(e,(function(e){t[0]>e[0]&&(t[0]=e[0]),t[1]>e[1]&&(t[1]=e[1]),t[2]<e[0]&&(t[2]=e[0]),t[3]<e[1]&&(t[3]=e[1])})),t}Ys.default=Ys;var ea=si((function(e,t){e.exports=function(){var e,t,r;function n(n,i){if(e)if(t){var A="var sharedChunk = {}; ("+e+")(sharedChunk); ("+t+")(sharedChunk);",o={};e(o),r=i(o),"undefined"!=typeof window&&(r.workerUrl=window.URL.createObjectURL(new Blob([A],{type:"text/javascript"})))}else t=i;else e=i}return n(["exports"],(function(e){var t=r;function r(e,t,r,n){this.cx=3*e,this.bx=3*(r-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(n-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=t,this.p2x=r,this.p2y=n}function n(e,r,n,i){const A=new t(e,r,n,i);return function(e){return A.solve(e)}}r.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,t){if(void 0===t&&(t=1e-6),e<0)return 0;if(e>1)return 1;for(var r=e,n=0;n<8;n++){var i=this.sampleCurveX(r)-e;if(Math.abs(i)<t)return r;var A=this.sampleCurveDerivativeX(r);if(Math.abs(A)<1e-6)break;r-=i/A}var o=0,s=1;for(r=e,n=0;n<20&&(i=this.sampleCurveX(r),!(Math.abs(i-e)<t));n++)e>i?o=r:s=r,r=.5*(s-o)+o;return r},solve:function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))}};const i=n(.25,.1,.25,1);function A(e,t,r){return Math.min(r,Math.max(t,e))}function o(e,t,r){const n=r-t,i=((e-t)%n+n)%n+t;return i===t?r:i}function s(e,...t){for(const r of t)for(const t in r)e[t]=r[t];return e}let a=1;function l(e,t){e.forEach((e=>{t[e]&&(t[e]=t[e].bind(t))}))}function c(e,t,r){const n={};for(const i in e)n[i]=t.call(r||this,e[i],i,e);return n}function u(e,t,r){const n={};for(const i in e)t.call(r||this,e[i],i,e)&&(n[i]=e[i]);return n}function h(e){return Array.isArray(e)?e.map(h):"object"==typeof e&&e?c(e,h):e}const d={};function p(e){d[e]||("undefined"!=typeof console&&console.warn(e),d[e]=!0)}function f(e,t,r){return(r.y-e.y)*(t.x-e.x)>(t.y-e.y)*(r.x-e.x)}function m(e){let t=0;for(let r,n,i=0,A=e.length,o=A-1;i<A;o=i++)r=e[i],n=e[o],t+=(n.x-r.x)*(r.y+n.y);return t}function g(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}function y(e){const t={};if(e.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,((e,r,n,i)=>{const A=n||i;return t[r]=!A||A.toLowerCase(),""})),t["max-age"]){const e=parseInt(t["max-age"],10);isNaN(e)?delete t["max-age"]:t["max-age"]=e}return t}let _,w,x=null;function B(e){if(null==x){const t=e.navigator?e.navigator.userAgent:null;x=!!e.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return x}function v(e){return"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap}const b={now:"undefined"!=typeof performance&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(e){const t=requestAnimationFrame(e);return{cancel:()=>cancelAnimationFrame(t)}},getImageData(e,t=0){const r=window.document.createElement("canvas"),n=r.getContext("2d");if(!n)throw new Error("failed to create canvas 2d context");return r.width=e.width,r.height=e.height,n.drawImage(e,0,0,e.width,e.height),n.getImageData(-t,-t,e.width+2*t,e.height+2*t)},resolveURL:e=>(_||(_=document.createElement("a")),_.href=e,_.href),hardwareConcurrency:"undefined"!=typeof navigator&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(null==w&&(w=matchMedia("(prefers-reduced-motion: reduce)")),w.matches)}};var C=F;function F(e,t){this.x=e,this.y=t}F.prototype={clone:function(){return new F(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,r=e.y-this.y;return t*t+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[2]*this.x+e[3]*this.y;return this.x=e[0]*this.x+e[1]*this.y,this.y=t,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),r=Math.sin(e),n=r*this.x+t*this.y;return this.x=t*this.x-r*this.y,this.y=n,this},_rotateAround:function(e,t){var r=Math.cos(e),n=Math.sin(e),i=t.y+n*(this.x-t.x)+r*(this.y-t.y);return this.x=t.x+r*(this.x-t.x)-n*(this.y-t.y),this.y=i,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},F.convert=function(e){return e instanceof F?e:Array.isArray(e)?new F(e[0],e[1]):e};const E={MAX_PARALLEL_IMAGE_REQUESTS:16,REGISTERED_PROTOCOLS:{}},U="mapbox-tiles";let Q,I,T=500,S=50;function M(){"undefined"==typeof caches||Q||(Q=caches.open(U))}let k=1/0;const D={supported:!1,testSupport:function(e){!H&&P&&(z?R(e):L=e)}};let L,P,H=!1,z=!1;function R(e){const t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);try{if(e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,P),e.isContextLost())return;D.supported=!0}catch(e){}e.deleteTexture(t),H=!0}"undefined"!=typeof document&&(P=document.createElement("img"),P.onload=function(){L&&R(L),L=null,z=!0},P.onerror=function(){H=!0,L=null},P.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const O={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(O);class K extends Error{constructor(e,t,r,n){super(`AJAXError: ${t} (${e}): ${r}`),this.status=e,this.statusText=t,this.url=r,this.body=n}}const V=g()?()=>self.worker&&self.worker.referrer:()=>("blob:"===window.location.protocol?window.parent:window).location.href;function $(e,t){const r=new AbortController,n=new Request(e.url,{method:e.method||"GET",body:e.body,credentials:e.credentials,headers:e.headers,referrer:V(),signal:r.signal});let i=!1,A=!1;return"json"===e.type&&n.headers.set("Accept","application/json"),((r,o,s)=>{if(A)return;const a=Date.now();fetch(n).then((r=>r.ok?((r,o,s)=>{("arrayBuffer"===e.type?r.arrayBuffer():"json"===e.type?r.json():r.text()).then((e=>{A||(o&&s&&function(e,t,r){if(M(),!Q)return;const n={status:t.status,statusText:t.statusText,headers:new Headers};t.headers.forEach(((e,t)=>n.headers.set(t,e)));const i=y(t.headers.get("Cache-Control")||"");i["no-store"]||(i["max-age"]&&n.headers.set("Expires",new Date(r+1e3*i["max-age"]).toUTCString()),new Date(n.headers.get("Expires")).getTime()-r<42e4||function(e,t){if(void 0===I)try{new Response(new ReadableStream),I=!0}catch(e){I=!1}I?t(e.body):e.blob().then(t)}(t,(t=>{const r=new Response(t,n);M(),Q&&Q.then((t=>t.put(function(e){const t=e.indexOf("?");return t<0?e:e.slice(0,t)}(e.url),r))).catch((e=>p(e.message)))})))}(n,o,s),i=!0,t(null,e,r.headers.get("Cache-Control"),r.headers.get("Expires")))})).catch((e=>{A||t(new Error(e.message))}))})(r,null,a):r.blob().then((n=>t(new K(r.status,r.statusText,e.url,n)))))).catch((e=>{20!==e.code&&t(new Error(e.message))}))})(),{cancel:()=>{A=!0,i||r.abort()}}}const N=function(e,t){if(/:\/\//.test(e.url)&&!/^https?:|^file:/.test(e.url)){if(g()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",e,t);if(!g()){const r=e.url.substring(0,e.url.indexOf("://"));return(E.REGISTERED_PROTOCOLS[r]||$)(e,t)}}if(!(/^file:/.test(r=e.url)||/^file:/.test(V())&&!/^\w+:/.test(r))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return $(e,t);if(g()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",e,t,void 0,!0)}var r;return function(e,t){const r=new XMLHttpRequest;r.open(e.method||"GET",e.url,!0),"arrayBuffer"===e.type&&(r.responseType="arraybuffer");for(const t in e.headers)r.setRequestHeader(t,e.headers[t]);return"json"===e.type&&(r.responseType="text",r.setRequestHeader("Accept","application/json")),r.withCredentials="include"===e.credentials,r.onerror=()=>{t(new Error(r.statusText))},r.onload=()=>{if((r.status>=200&&r.status<300||0===r.status)&&null!==r.response){let n=r.response;if("json"===e.type)try{n=JSON.parse(r.response)}catch(e){return t(e)}t(null,n,r.getResponseHeader("Cache-Control"),r.getResponseHeader("Expires"))}else{const n=new Blob([r.response],{type:r.getResponseHeader("Content-Type")});t(new K(r.status,r.statusText,e.url,n))}},r.send(e.body),{cancel:()=>r.abort()}}(e,t)},G=function(e,t){return N(s(e,{type:"arrayBuffer"}),t)};function q(e){const t=window.document.createElement("a");return t.href=e,t.protocol===window.document.location.protocol&&t.host===window.document.location.host}const X="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let j,Z;j=[],Z=0;const J=function(e,t){if(D.supported&&(e.headers||(e.headers={}),e.headers.accept="image/webp,*/*"),Z>=E.MAX_PARALLEL_IMAGE_REQUESTS){const r={requestParameters:e,callback:t,cancelled:!1,cancel(){this.cancelled=!0}};return j.push(r),r}Z++;let r=!1;const n=()=>{if(!r)for(r=!0,Z--;j.length&&Z<E.MAX_PARALLEL_IMAGE_REQUESTS;){const e=j.shift(),{requestParameters:t,callback:r,cancelled:n}=e;n||(e.cancel=J(t,r).cancel)}},i=G(e,((e,r,i,A)=>{n(),e?t(e):r&&function(e,t){"function"==typeof createImageBitmap?function(e,t){const r=new Blob([new Uint8Array(e)],{type:"image/png"});createImageBitmap(r).then((e=>{t(null,e)})).catch((e=>{t(new Error(`Could not load image because of ${e.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))}))}(e,t):function(e,t){const r=new Image;r.onload=()=>{t(null,r),URL.revokeObjectURL(r.src),r.onload=null,window.requestAnimationFrame((()=>{r.src=X}))},r.onerror=()=>t(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const n=new Blob([new Uint8Array(e)],{type:"image/png"});r.src=e.byteLength?URL.createObjectURL(n):X}(e,t)}(r,((e,r)=>{null!=e?t(e):null!=r&&t(null,r,{cacheControl:i,expires:A})}))}));return{cancel:()=>{i.cancel(),n()}}};function W(e,t,r){r[e]&&-1!==r[e].indexOf(t)||(r[e]=r[e]||[],r[e].push(t))}function Y(e,t,r){if(r&&r[e]){const n=r[e].indexOf(t);-1!==n&&r[e].splice(n,1)}}class ee{constructor(e,t={}){s(this,t),this.type=e}}class te extends ee{constructor(e,t={}){super("error",s({error:e},t))}}class re{on(e,t){return this._listeners=this._listeners||{},W(e,t,this._listeners),this}off(e,t){return Y(e,t,this._listeners),Y(e,t,this._oneTimeListeners),this}once(e,t){return this._oneTimeListeners=this._oneTimeListeners||{},W(e,t,this._oneTimeListeners),this}fire(e,t){"string"==typeof e&&(e=new ee(e,t||{}));const r=e.type;if(this.listens(r)){e.target=this;const t=this._listeners&&this._listeners[r]?this._listeners[r].slice():[];for(const r of t)r.call(this,e);const n=this._oneTimeListeners&&this._oneTimeListeners[r]?this._oneTimeListeners[r].slice():[];for(const t of n)Y(r,t,this._oneTimeListeners),t.call(this,e);const i=this._eventedParent;i&&(s(e,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),i.fire(e))}else e instanceof te&&console.error(e.error);return this}listens(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)}setEventedParent(e,t){return this._eventedParent=e,this._eventedParentData=t,this}}var ne={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1},elevationOffset:{type:"number",default:450}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};class ie{constructor(e,t,r,n){this.message=(e?`${e}: `:"")+r,n&&(this.identifier=n),null!=t&&t.__line__&&(this.line=t.__line__)}}function Ae(e){const t=e.value;return t?[new ie(e.key,t,"constants have been deprecated as of v8")]:[]}function oe(e,...t){for(const r of t)for(const t in r)e[t]=r[t];return e}function se(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function ae(e){if(Array.isArray(e))return e.map(ae);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){const t={};for(const r in e)t[r]=ae(e[r]);return t}return se(e)}class le extends Error{constructor(e,t){super(t),this.message=t,this.key=e}}class ce{constructor(e,t=[]){this.parent=e,this.bindings={};for(const[e,r]of t)this.bindings[e]=r}concat(e){return new ce(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}const ue={kind:"null"},he={kind:"number"},de={kind:"string"},pe={kind:"boolean"},fe={kind:"color"},me={kind:"object"},ge={kind:"value"},ye={kind:"collator"},_e={kind:"formatted"},we={kind:"padding"},xe={kind:"resolvedImage"};function Be(e,t){return{kind:"array",itemType:e,N:t}}function ve(e){if("array"===e.kind){const t=ve(e.itemType);return"number"==typeof e.N?`array<${t}, ${e.N}>`:"value"===e.itemType.kind?"array":`array<${t}>`}return e.kind}const be=[ue,he,de,pe,fe,_e,me,Be(ge),we,xe];function Ce(e,t){if("error"===t.kind)return null;if("array"===e.kind){if("array"===t.kind&&(0===t.N&&"value"===t.itemType.kind||!Ce(e.itemType,t.itemType))&&("number"!=typeof e.N||e.N===t.N))return null}else{if(e.kind===t.kind)return null;if("value"===e.kind)for(const e of be)if(!Ce(e,t))return null}return`Expected ${ve(e)} but found ${ve(t)} instead.`}function Fe(e,t){return t.some((t=>t.kind===e.kind))}function Ee(e,t){return t.some((t=>"null"===t?null===e:"array"===t?Array.isArray(e):"object"===t?e&&!Array.isArray(e)&&"object"==typeof e:t===typeof e))}var Ue,Qe={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Ie(e){return(e=Math.round(e))<0?0:e>255?255:e}function Te(e){return Ie("%"===e[e.length-1]?parseFloat(e)/100*255:parseInt(e))}function Se(e){return(t="%"===e[e.length-1]?parseFloat(e)/100:parseFloat(e))<0?0:t>1?1:t;var t}function Me(e,t,r){return r<0?r+=1:r>1&&(r-=1),6*r<1?e+(t-e)*r*6:2*r<1?t:3*r<2?e+(t-e)*(2/3-r)*6:e}try{Ue={}.parseCSSColor=function(e){var t,r=e.replace(/ /g,"").toLowerCase();if(r in Qe)return Qe[r].slice();if("#"===r[0])return 4===r.length?(t=parseInt(r.substr(1),16))>=0&&t<=4095?[(3840&t)>>4|(3840&t)>>8,240&t|(240&t)>>4,15&t|(15&t)<<4,1]:null:7===r.length&&(t=parseInt(r.substr(1),16))>=0&&t<=16777215?[(16711680&t)>>16,(65280&t)>>8,255&t,1]:null;var n=r.indexOf("("),i=r.indexOf(")");if(-1!==n&&i+1===r.length){var A=r.substr(0,n),o=r.substr(n+1,i-(n+1)).split(","),s=1;switch(A){case"rgba":if(4!==o.length)return null;s=Se(o.pop());case"rgb":return 3!==o.length?null:[Te(o[0]),Te(o[1]),Te(o[2]),s];case"hsla":if(4!==o.length)return null;s=Se(o.pop());case"hsl":if(3!==o.length)return null;var a=(parseFloat(o[0])%360+360)%360/360,l=Se(o[1]),c=Se(o[2]),u=c<=.5?c*(l+1):c+l-c*l,h=2*c-u;return[Ie(255*Me(h,u,a+1/3)),Ie(255*Me(h,u,a)),Ie(255*Me(h,u,a-1/3)),s];default:return null}}return null}}catch(e){}class ke{constructor(e,t,r,n=1){this.r=e,this.g=t,this.b=r,this.a=n}static parse(e){if(!e)return;if(e instanceof ke)return e;if("string"!=typeof e)return;const t=Ue(e);return t?new ke(t[0]/255*t[3],t[1]/255*t[3],t[2]/255*t[3],t[3]):void 0}toString(){const[e,t,r,n]=this.toArray();return`rgba(${Math.round(e)},${Math.round(t)},${Math.round(r)},${n})`}toArray(){const{r:e,g:t,b:r,a:n}=this;return 0===n?[0,0,0,0]:[255*e/n,255*t/n,255*r/n,n]}}ke.black=new ke(0,0,0,1),ke.white=new ke(1,1,1,1),ke.transparent=new ke(0,0,0,0),ke.red=new ke(1,0,0,1);class De{constructor(e,t,r){this.sensitivity=e?t?"variant":"case":t?"accent":"base",this.locale=r,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,t){return this.collator.compare(e,t)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Le{constructor(e,t,r,n,i){this.text=e,this.image=t,this.scale=r,this.fontStack=n,this.textColor=i}}class Pe{constructor(e){this.sections=e}static fromString(e){return new Pe([new Le(e,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some((e=>0!==e.text.length||e.image&&0!==e.image.name.length))}static factory(e){return e instanceof Pe?e:Pe.fromString(e)}toString(){return 0===this.sections.length?"":this.sections.map((e=>e.text)).join("")}}class He{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof He)return e;if("number"==typeof e)return new He([e,e,e,e]);if(Array.isArray(e)&&!(e.length<1||e.length>4)){for(const t of e)if("number"!=typeof t)return;switch(e.length){case 1:e=[e[0],e[0],e[0],e[0]];break;case 2:e=[e[0],e[1],e[0],e[1]];break;case 3:e=[e[0],e[1],e[2],e[1]]}return new He(e)}}toString(){return JSON.stringify(this.values)}}class ze{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new ze({name:e,available:!1}):null}}function Re(e,t,r,n){return"number"==typeof e&&e>=0&&e<=255&&"number"==typeof t&&t>=0&&t<=255&&"number"==typeof r&&r>=0&&r<=255?void 0===n||"number"==typeof n&&n>=0&&n<=1?null:`Invalid rgba value [${[e,t,r,n].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof n?[e,t,r,n]:[e,t,r]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Oe(e){if(null===e)return!0;if("string"==typeof e)return!0;if("boolean"==typeof e)return!0;if("number"==typeof e)return!0;if(e instanceof ke)return!0;if(e instanceof De)return!0;if(e instanceof Pe)return!0;if(e instanceof He)return!0;if(e instanceof ze)return!0;if(Array.isArray(e)){for(const t of e)if(!Oe(t))return!1;return!0}if("object"==typeof e){for(const t in e)if(!Oe(e[t]))return!1;return!0}return!1}function Ke(e){if(null===e)return ue;if("string"==typeof e)return de;if("boolean"==typeof e)return pe;if("number"==typeof e)return he;if(e instanceof ke)return fe;if(e instanceof De)return ye;if(e instanceof Pe)return _e;if(e instanceof He)return we;if(e instanceof ze)return xe;if(Array.isArray(e)){const t=e.length;let r;for(const t of e){const e=Ke(t);if(r){if(r===e)continue;r=ge;break}r=e}return Be(r||ge,t)}return me}function Ve(e){const t=typeof e;return null===e?"":"string"===t||"number"===t||"boolean"===t?String(e):e instanceof ke||e instanceof Pe||e instanceof He||e instanceof ze?e.toString():JSON.stringify(e)}class $e{constructor(e,t){this.type=e,this.value=t}static parse(e,t){if(2!==e.length)return t.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!Oe(e[1]))return t.error("invalid value");const r=e[1];let n=Ke(r);const i=t.expectedType;return"array"!==n.kind||0!==n.N||!i||"array"!==i.kind||"number"==typeof i.N&&0!==i.N||(n=i),new $e(n,r)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class Ne{constructor(e){this.name="ExpressionEvaluationError",this.message=e}toJSON(){return this.message}}const Ge={string:de,number:he,boolean:pe,object:me};class qe{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");let r,n=1;const i=e[0];if("array"===i){let i,A;if(e.length>2){const r=e[1];if("string"!=typeof r||!(r in Ge)||"object"===r)return t.error('The item type argument of "array" must be one of string, number, boolean',1);i=Ge[r],n++}else i=ge;if(e.length>3){if(null!==e[2]&&("number"!=typeof e[2]||e[2]<0||e[2]!==Math.floor(e[2])))return t.error('The length argument to "array" must be a positive integer literal',2);A=e[2],n++}r=Be(i,A)}else{if(!Ge[i])throw new Error(`Types doesn't contain name = ${i}`);r=Ge[i]}const A=[];for(;n<e.length;n++){const r=t.parse(e[n],n,ge);if(!r)return null;A.push(r)}return new qe(r,A)}evaluate(e){for(let t=0;t<this.args.length;t++){const r=this.args[t].evaluate(e);if(!Ce(this.type,Ke(r)))return r;if(t===this.args.length-1)throw new Ne(`Expected value to be of type ${ve(this.type)}, but found ${ve(Ke(r))} instead.`)}throw new Error}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}}const Xe={"to-boolean":pe,"to-color":fe,"to-number":he,"to-string":de};class je{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");const r=e[0];if(!Xe[r])throw new Error(`Can't parse ${r} as it is not part of the known types`);if(("to-boolean"===r||"to-string"===r)&&2!==e.length)return t.error("Expected one argument.");const n=Xe[r],i=[];for(let r=1;r<e.length;r++){const n=t.parse(e[r],r,ge);if(!n)return null;i.push(n)}return new je(n,i)}evaluate(e){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(e));if("color"===this.type.kind){let t,r;for(const n of this.args){if(t=n.evaluate(e),r=null,t instanceof ke)return t;if("string"==typeof t){const r=e.parseColor(t);if(r)return r}else if(Array.isArray(t)&&(r=t.length<3||t.length>4?`Invalid rbga value ${JSON.stringify(t)}: expected an array containing either three or four numeric values.`:Re(t[0],t[1],t[2],t[3]),!r))return new ke(t[0]/255,t[1]/255,t[2]/255,t[3])}throw new Ne(r||`Could not parse color from value '${"string"==typeof t?t:JSON.stringify(t)}'`)}if("padding"===this.type.kind){let t;for(const r of this.args){t=r.evaluate(e);const n=He.parse(t);if(n)return n}throw new Ne(`Could not parse padding from value '${"string"==typeof t?t:JSON.stringify(t)}'`)}if("number"===this.type.kind){let t=null;for(const r of this.args){if(t=r.evaluate(e),null===t)return 0;const n=Number(t);if(!isNaN(n))return n}throw new Ne(`Could not convert ${JSON.stringify(t)} to number.`)}return"formatted"===this.type.kind?Pe.fromString(Ve(this.args[0].evaluate(e))):"resolvedImage"===this.type.kind?ze.fromString(Ve(this.args[0].evaluate(e))):Ve(this.args[0].evaluate(e))}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}}const Ze=["Unknown","Point","LineString","Polygon"];class Je{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?Ze[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(e){let t=this._parseColorCache[e];return t||(t=this._parseColorCache[e]=ke.parse(e)),t}}class We{constructor(e,t,r,n){this.name=e,this.type=t,this._evaluate=r,this.args=n}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}static parse(e,t){const r=e[0],n=We.definitions[r];if(!n)return t.error(`Unknown expression "${r}". If you wanted a literal array, use ["literal", [...]].`,0);const i=Array.isArray(n)?n[0]:n.type,A=Array.isArray(n)?[[n[1],n[2]]]:n.overloads,o=A.filter((([t])=>!Array.isArray(t)||t.length===e.length-1));let s=null;for(const[n,A]of o){s=new xt(t.registry,t.path,null,t.scope);const o=[];let a=!1;for(let t=1;t<e.length;t++){const r=e[t],i=Array.isArray(n)?n[t-1]:n.type,A=s.parse(r,1+o.length,i);if(!A){a=!0;break}o.push(A)}if(!a)if(Array.isArray(n)&&n.length!==o.length)s.error(`Expected ${n.length} arguments, but found ${o.length} instead.`);else{for(let e=0;e<o.length;e++){const t=Array.isArray(n)?n[e]:n.type,r=o[e];s.concat(e+1).checkSubtype(t,r.type)}if(0===s.errors.length)return new We(r,i,A,o)}}if(1===o.length)t.errors.push(...s.errors);else{const r=(o.length?o:A).map((([e])=>{return t=e,Array.isArray(t)?`(${t.map(ve).join(", ")})`:`(${ve(t.type)}...)`;var t})).join(" | "),n=[];for(let r=1;r<e.length;r++){const i=t.parse(e[r],1+n.length);if(!i)return null;n.push(ve(i.type))}t.error(`Expected arguments of type ${r}, but found (${n.join(", ")}) instead.`)}return null}static register(e,t){We.definitions=t;for(const r in t)e[r]=We}}class Ye{constructor(e,t,r){this.type=ye,this.locale=r,this.caseSensitive=e,this.diacriticSensitive=t}static parse(e,t){if(2!==e.length)return t.error("Expected one argument.");const r=e[1];if("object"!=typeof r||Array.isArray(r))return t.error("Collator options argument must be an object.");const n=t.parse(void 0!==r["case-sensitive"]&&r["case-sensitive"],1,pe);if(!n)return null;const i=t.parse(void 0!==r["diacritic-sensitive"]&&r["diacritic-sensitive"],1,pe);if(!i)return null;let A=null;return r.locale&&(A=t.parse(r.locale,1,de),!A)?null:new Ye(n,i,A)}evaluate(e){return new De(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}}const et=8192;function tt(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[0]),e[3]=Math.max(e[3],t[1])}function rt(e,t){return!(e[0]<=t[0]||e[2]>=t[2]||e[1]<=t[1]||e[3]>=t[3])}function nt(e,t){const r=(180+e[0])/360,n=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e[1]*Math.PI/360)))/360,i=Math.pow(2,t.z);return[Math.round(r*i*et),Math.round(n*i*et)]}function it(e,t,r){const n=e[0]-t[0],i=e[1]-t[1],A=e[0]-r[0],o=e[1]-r[1];return n*o-A*i==0&&n*A<=0&&i*o<=0}function At(e,t){let r=!1;for(let o=0,s=t.length;o<s;o++){const s=t[o];for(let t=0,o=s.length;t<o-1;t++){if(it(e,s[t],s[t+1]))return!1;(i=s[t])[1]>(n=e)[1]!=(A=s[t+1])[1]>n[1]&&n[0]<(A[0]-i[0])*(n[1]-i[1])/(A[1]-i[1])+i[0]&&(r=!r)}}var n,i,A;return r}function ot(e,t){for(let r=0;r<t.length;r++)if(At(e,t[r]))return!0;return!1}function st(e,t,r,n){const i=n[0]-r[0],A=n[1]-r[1],o=(e[0]-r[0])*A-i*(e[1]-r[1]),s=(t[0]-r[0])*A-i*(t[1]-r[1]);return o>0&&s<0||o<0&&s>0}function at(e,t,r){for(const l of r)for(let r=0;r<l.length-1;++r)if(0!=(s=[(o=l[r+1])[0]-(A=l[r])[0],o[1]-A[1]])[0]*(a=[(i=t)[0]-(n=e)[0],i[1]-n[1]])[1]-s[1]*a[0]&&st(n,i,A,o)&&st(A,o,n,i))return!0;var n,i,A,o,s,a;return!1}function lt(e,t){for(let r=0;r<e.length;++r)if(!At(e[r],t))return!1;for(let r=0;r<e.length-1;++r)if(at(e[r],e[r+1],t))return!1;return!0}function ct(e,t){for(let r=0;r<t.length;r++)if(lt(e,t[r]))return!0;return!1}function ut(e,t,r){const n=[];for(let i=0;i<e.length;i++){const A=[];for(let n=0;n<e[i].length;n++){const o=nt(e[i][n],r);tt(t,o),A.push(o)}n.push(A)}return n}function ht(e,t,r){const n=[];for(let i=0;i<e.length;i++){const A=ut(e[i],t,r);n.push(A)}return n}function dt(e,t,r,n){if(e[0]<r[0]||e[0]>r[2]){const t=.5*n;let i=e[0]-r[0]>t?-n:r[0]-e[0]>t?n:0;0===i&&(i=e[0]-r[2]>t?-n:r[2]-e[0]>t?n:0),e[0]+=i}tt(t,e)}function pt(e,t,r,n){const i=Math.pow(2,n.z)*et,A=[n.x*et,n.y*et],o=[];for(const n of e)for(const e of n){const n=[e.x+A[0],e.y+A[1]];dt(n,t,r,i),o.push(n)}return o}function ft(e,t,r,n){const i=Math.pow(2,n.z)*et,A=[n.x*et,n.y*et],o=[];for(const r of e){const e=[];for(const n of r){const r=[n.x+A[0],n.y+A[1]];tt(t,r),e.push(r)}o.push(e)}if(t[2]-t[0]<=i/2){(s=t)[0]=s[1]=1/0,s[2]=s[3]=-1/0;for(const e of o)for(const n of e)dt(n,t,r,i)}var s;return o}class mt{constructor(e,t){this.type=pe,this.geojson=e,this.geometries=t}static parse(e,t){if(2!==e.length)return t.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(Oe(e[1])){const t=e[1];if("FeatureCollection"===t.type)for(let e=0;e<t.features.length;++e){const r=t.features[e].geometry.type;if("Polygon"===r||"MultiPolygon"===r)return new mt(t,t.features[e].geometry)}else if("Feature"===t.type){const e=t.geometry.type;if("Polygon"===e||"MultiPolygon"===e)return new mt(t,t.geometry)}else if("Polygon"===t.type||"MultiPolygon"===t.type)return new mt(t,t)}return t.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(null!=e.geometry()&&null!=e.canonicalID()){if("Point"===e.geometryType())return function(e,t){const r=[1/0,1/0,-1/0,-1/0],n=[1/0,1/0,-1/0,-1/0],i=e.canonicalID();if("Polygon"===t.type){const A=ut(t.coordinates,n,i),o=pt(e.geometry(),r,n,i);if(!rt(r,n))return!1;for(const e of o)if(!At(e,A))return!1}if("MultiPolygon"===t.type){const A=ht(t.coordinates,n,i),o=pt(e.geometry(),r,n,i);if(!rt(r,n))return!1;for(const e of o)if(!ot(e,A))return!1}return!0}(e,this.geometries);if("LineString"===e.geometryType())return function(e,t){const r=[1/0,1/0,-1/0,-1/0],n=[1/0,1/0,-1/0,-1/0],i=e.canonicalID();if("Polygon"===t.type){const A=ut(t.coordinates,n,i),o=ft(e.geometry(),r,n,i);if(!rt(r,n))return!1;for(const e of o)if(!lt(e,A))return!1}if("MultiPolygon"===t.type){const A=ht(t.coordinates,n,i),o=ft(e.geometry(),r,n,i);if(!rt(r,n))return!1;for(const e of o)if(!ct(e,A))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}function gt(e){if(e instanceof We){if("get"===e.name&&1===e.args.length)return!1;if("feature-state"===e.name)return!1;if("has"===e.name&&1===e.args.length)return!1;if("properties"===e.name||"geometry-type"===e.name||"id"===e.name)return!1;if(/^filter-/.test(e.name))return!1}if(e instanceof mt)return!1;let t=!0;return e.eachChild((e=>{t&&!gt(e)&&(t=!1)})),t}function yt(e){if(e instanceof We&&"feature-state"===e.name)return!1;let t=!0;return e.eachChild((e=>{t&&!yt(e)&&(t=!1)})),t}function _t(e,t){if(e instanceof We&&t.indexOf(e.name)>=0)return!1;let r=!0;return e.eachChild((e=>{r&&!_t(e,t)&&(r=!1)})),r}class wt{constructor(e,t){this.type=t.type,this.name=e,this.boundExpression=t}static parse(e,t){if(2!==e.length||"string"!=typeof e[1])return t.error("'var' expression requires exactly one string literal argument.");const r=e[1];return t.scope.has(r)?new wt(r,t.scope.get(r)):t.error(`Unknown variable "${r}". Make sure "${r}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}}class xt{constructor(e,t=[],r,n=new ce,i=[]){this.registry=e,this.path=t,this.key=t.map((e=>`[${e}]`)).join(""),this.scope=n,this.errors=i,this.expectedType=r}parse(e,t,r,n,i={}){return t?this.concat(t,r,n)._parse(e,i):this._parse(e,i)}_parse(e,t){function r(e,t,r){return"assert"===r?new qe(t,[e]):"coerce"===r?new je(t,[e]):e}if(null!==e&&"string"!=typeof e&&"boolean"!=typeof e&&"number"!=typeof e||(e=["literal",e]),Array.isArray(e)){if(0===e.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const n=e[0];if("string"!=typeof n)return this.error(`Expression name must be a string, but found ${typeof n} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const i=this.registry[n];if(i){let n=i.parse(e,this);if(!n)return null;if(this.expectedType){const e=this.expectedType,i=n.type;if("string"!==e.kind&&"number"!==e.kind&&"boolean"!==e.kind&&"object"!==e.kind&&"array"!==e.kind||"value"!==i.kind)if("color"!==e.kind&&"formatted"!==e.kind&&"resolvedImage"!==e.kind||"value"!==i.kind&&"string"!==i.kind)if("padding"!==e.kind||"value"!==i.kind&&"number"!==i.kind&&"array"!==i.kind){if(this.checkSubtype(e,i))return null}else n=r(n,e,t.typeAnnotation||"coerce");else n=r(n,e,t.typeAnnotation||"coerce");else n=r(n,e,t.typeAnnotation||"assert")}if(!(n instanceof $e)&&"resolvedImage"!==n.type.kind&&Bt(n)){const t=new Je;try{n=new $e(n.type,n.evaluate(t))}catch(e){return this.error(e.message),null}}return n}return this.error(`Unknown expression "${n}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(void 0===e?"'undefined' value invalid. Use null instead.":"object"==typeof e?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,t,r){const n="number"==typeof e?this.path.concat(e):this.path,i=r?this.scope.concat(r):this.scope;return new xt(this.registry,n,t||null,i,this.errors)}error(e,...t){const r=`${this.key}${t.map((e=>`[${e}]`)).join("")}`;this.errors.push(new le(r,e))}checkSubtype(e,t){const r=Ce(e,t);return r&&this.error(r),r}}function Bt(e){if(e instanceof wt)return Bt(e.boundExpression);if(e instanceof We&&"error"===e.name)return!1;if(e instanceof Ye)return!1;if(e instanceof mt)return!1;const t=e instanceof je||e instanceof qe;let r=!0;return e.eachChild((e=>{r=t?r&&Bt(e):r&&e instanceof $e})),!!r&&gt(e)&&_t(e,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function vt(e,t){const r=e.length-1;let n,i,A=0,o=r,s=0;for(;A<=o;)if(s=Math.floor((A+o)/2),n=e[s],i=e[s+1],n<=t){if(s===r||t<i)return s;A=s+1}else{if(!(n>t))throw new Ne("Input is not a number.");o=s-1}return 0}class bt{constructor(e,t,r){this.type=e,this.input=t,this.labels=[],this.outputs=[];for(const[e,t]of r)this.labels.push(e),this.outputs.push(t)}static parse(e,t){if(e.length-1<4)return t.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");const r=t.parse(e[1],1,he);if(!r)return null;const n=[];let i=null;t.expectedType&&"value"!==t.expectedType.kind&&(i=t.expectedType);for(let r=1;r<e.length;r+=2){const A=1===r?-1/0:e[r],o=e[r+1],s=r,a=r+1;if("number"!=typeof A)return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',s);if(n.length&&n[n.length-1][0]>=A)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',s);const l=t.parse(o,a,i);if(!l)return null;i=i||l.type,n.push([A,l])}return new bt(i,r,n)}evaluate(e){const t=this.labels,r=this.outputs;if(1===t.length)return r[0].evaluate(e);const n=this.input.evaluate(e);if(n<=t[0])return r[0].evaluate(e);const i=t.length;return n>=t[i-1]?r[i-1].evaluate(e):r[vt(t,n)].evaluate(e)}eachChild(e){e(this.input);for(const t of this.outputs)e(t)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))}}function Ct(e,t,r){return e*(1-r)+t*r}var Ft=Object.freeze({__proto__:null,number:Ct,color:function(e,t,r){return new ke(Ct(e.r,t.r,r),Ct(e.g,t.g,r),Ct(e.b,t.b,r),Ct(e.a,t.a,r))},array:function(e,t,r){return e.map(((e,n)=>Ct(e,t[n],r)))},padding:function(e,t,r){const n=e.values,i=t.values;return new He([Ct(n[0],i[0],r),Ct(n[1],i[1],r),Ct(n[2],i[2],r),Ct(n[3],i[3],r)])}});const Et=.95047,Ut=1.08883,Qt=4/29,It=6/29,Tt=3*It*It,St=Math.PI/180,Mt=180/Math.PI;function kt(e){return e>.008856451679035631?Math.pow(e,1/3):e/Tt+Qt}function Dt(e){return e>It?e*e*e:Tt*(e-Qt)}function Lt(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Pt(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Ht(e){const t=Pt(e.r),r=Pt(e.g),n=Pt(e.b),i=kt((.4124564*t+.3575761*r+.1804375*n)/Et),A=kt((.2126729*t+.7151522*r+.072175*n)/1);return{l:116*A-16,a:500*(i-A),b:200*(A-kt((.0193339*t+.119192*r+.9503041*n)/Ut)),alpha:e.a}}function zt(e){let t=(e.l+16)/116,r=isNaN(e.a)?t:t+e.a/500,n=isNaN(e.b)?t:t-e.b/200;return t=1*Dt(t),r=Et*Dt(r),n=Ut*Dt(n),new ke(Lt(3.2404542*r-1.5371385*t-.4985314*n),Lt(-.969266*r+1.8760108*t+.041556*n),Lt(.0556434*r-.2040259*t+1.0572252*n),e.alpha)}function Rt(e,t,r){const n=t-e;return e+r*(n>180||n<-180?n-360*Math.round(n/360):n)}const Ot={forward:Ht,reverse:zt,interpolate:function(e,t,r){return{l:Ct(e.l,t.l,r),a:Ct(e.a,t.a,r),b:Ct(e.b,t.b,r),alpha:Ct(e.alpha,t.alpha,r)}}},Kt={forward:function(e){const{l:t,a:r,b:n}=Ht(e),i=Math.atan2(n,r)*Mt;return{h:i<0?i+360:i,c:Math.sqrt(r*r+n*n),l:t,alpha:e.a}},reverse:function(e){const t=e.h*St,r=e.c;return zt({l:e.l,a:Math.cos(t)*r,b:Math.sin(t)*r,alpha:e.alpha})},interpolate:function(e,t,r){return{h:Rt(e.h,t.h,r),c:Ct(e.c,t.c,r),l:Ct(e.l,t.l,r),alpha:Ct(e.alpha,t.alpha,r)}}};var Vt=Object.freeze({__proto__:null,lab:Ot,hcl:Kt});class $t{constructor(e,t,r,n,i){this.type=e,this.operator=t,this.interpolation=r,this.input=n,this.labels=[],this.outputs=[];for(const[e,t]of i)this.labels.push(e),this.outputs.push(t)}static interpolationFactor(e,r,n,i){let A=0;if("exponential"===e.name)A=Nt(r,e.base,n,i);else if("linear"===e.name)A=Nt(r,1,n,i);else if("cubic-bezier"===e.name){const o=e.controlPoints;A=new t(o[0],o[1],o[2],o[3]).solve(Nt(r,1,n,i))}return A}static parse(e,t){let[r,n,i,...A]=e;if(!Array.isArray(n)||0===n.length)return t.error("Expected an interpolation type expression.",1);if("linear"===n[0])n={name:"linear"};else if("exponential"===n[0]){const e=n[1];if("number"!=typeof e)return t.error("Exponential interpolation requires a numeric base.",1,1);n={name:"exponential",base:e}}else{if("cubic-bezier"!==n[0])return t.error(`Unknown interpolation type ${String(n[0])}`,1,0);{const e=n.slice(1);if(4!==e.length||e.some((e=>"number"!=typeof e||e<0||e>1)))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);n={name:"cubic-bezier",controlPoints:e}}}if(e.length-1<4)return t.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");if(i=t.parse(i,2,he),!i)return null;const o=[];let s=null;"interpolate-hcl"===r||"interpolate-lab"===r?s=fe:t.expectedType&&"value"!==t.expectedType.kind&&(s=t.expectedType);for(let e=0;e<A.length;e+=2){const r=A[e],n=A[e+1],i=e+3,a=e+4;if("number"!=typeof r)return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',i);if(o.length&&o[o.length-1][0]>=r)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',i);const l=t.parse(n,a,s);if(!l)return null;s=s||l.type,o.push([r,l])}return"number"===s.kind||"color"===s.kind||"padding"===s.kind||"array"===s.kind&&"number"===s.itemType.kind&&"number"==typeof s.N?new $t(s,r,n,i,o):t.error(`Type ${ve(s)} is not interpolatable.`)}evaluate(e){const t=this.labels,r=this.outputs;if(1===t.length)return r[0].evaluate(e);const n=this.input.evaluate(e);if(n<=t[0])return r[0].evaluate(e);const i=t.length;if(n>=t[i-1])return r[i-1].evaluate(e);const A=vt(t,n),o=$t.interpolationFactor(this.interpolation,n,t[A],t[A+1]),s=r[A].evaluate(e),a=r[A+1].evaluate(e);return"interpolate"===this.operator?Ft[this.type.kind.toLowerCase()](s,a,o):"interpolate-hcl"===this.operator?Kt.reverse(Kt.interpolate(Kt.forward(s),Kt.forward(a),o)):Ot.reverse(Ot.interpolate(Ot.forward(s),Ot.forward(a),o))}eachChild(e){e(this.input);for(const t of this.outputs)e(t)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))}}function Nt(e,t,r,n){const i=n-r,A=e-r;return 0===i?0:1===t?A/i:(Math.pow(t,A)-1)/(Math.pow(t,i)-1)}class Gt{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expectected at least one argument.");let r=null;const n=t.expectedType;n&&"value"!==n.kind&&(r=n);const i=[];for(const n of e.slice(1)){const e=t.parse(n,1+i.length,r,void 0,{typeAnnotation:"omit"});if(!e)return null;r=r||e.type,i.push(e)}if(!r)throw new Error("No output type");const A=n&&i.some((e=>Ce(n,e.type)));return new Gt(A?ge:r,i)}evaluate(e){let t,r=null,n=0;for(const i of this.args)if(n++,r=i.evaluate(e),r&&r instanceof ze&&!r.available&&(t||(t=r.name),r=null,n===this.args.length&&(r=t)),null!==r)break;return r}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}}class qt{constructor(e,t){this.type=t.type,this.bindings=[].concat(e),this.result=t}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const t of this.bindings)e(t[1]);e(this.result)}static parse(e,t){if(e.length<4)return t.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const r=[];for(let n=1;n<e.length-1;n+=2){const i=e[n];if("string"!=typeof i)return t.error(`Expected string, but found ${typeof i} instead.`,n);if(/[^a-zA-Z0-9_]/.test(i))return t.error("Variable names must contain only alphanumeric characters or '_'.",n);const A=t.parse(e[n+1],n+1);if(!A)return null;r.push([i,A])}const n=t.parse(e[e.length-1],e.length-1,t.expectedType,r);return n?new qt(r,n):null}outputDefined(){return this.result.outputDefined()}}class Xt{constructor(e,t,r){this.type=e,this.index=t,this.input=r}static parse(e,t){if(3!==e.length)return t.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const r=t.parse(e[1],1,he),n=t.parse(e[2],2,Be(t.expectedType||ge));return r&&n?new Xt(n.type.itemType,r,n):null}evaluate(e){const t=this.index.evaluate(e),r=this.input.evaluate(e);if(t<0)throw new Ne(`Array index out of bounds: ${t} < 0.`);if(t>=r.length)throw new Ne(`Array index out of bounds: ${t} > ${r.length-1}.`);if(t!==Math.floor(t))throw new Ne(`Array index must be an integer, but found ${t} instead.`);return r[t]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}}class jt{constructor(e,t){this.type=pe,this.needle=e,this.haystack=t}static parse(e,t){if(3!==e.length)return t.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const r=t.parse(e[1],1,ge),n=t.parse(e[2],2,ge);return r&&n?Fe(r.type,[pe,de,he,ue,ge])?new jt(r,n):t.error(`Expected first argument to be of type boolean, string, number or null, but found ${ve(r.type)} instead`):null}evaluate(e){const t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!r)return!1;if(!Ee(t,["boolean","string","number","null"]))throw new Ne(`Expected first argument to be of type boolean, string, number or null, but found ${ve(Ke(t))} instead.`);if(!Ee(r,["string","array"]))throw new Ne(`Expected second argument to be of type array or string, but found ${ve(Ke(r))} instead.`);return r.indexOf(t)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}}class Zt{constructor(e,t,r){this.type=he,this.needle=e,this.haystack=t,this.fromIndex=r}static parse(e,t){if(e.length<=2||e.length>=5)return t.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const r=t.parse(e[1],1,ge),n=t.parse(e[2],2,ge);if(!r||!n)return null;if(!Fe(r.type,[pe,de,he,ue,ge]))return t.error(`Expected first argument to be of type boolean, string, number or null, but found ${ve(r.type)} instead`);if(4===e.length){const i=t.parse(e[3],3,he);return i?new Zt(r,n,i):null}return new Zt(r,n)}evaluate(e){const t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!Ee(t,["boolean","string","number","null"]))throw new Ne(`Expected first argument to be of type boolean, string, number or null, but found ${ve(Ke(t))} instead.`);if(!Ee(r,["string","array"]))throw new Ne(`Expected second argument to be of type array or string, but found ${ve(Ke(r))} instead.`);if(this.fromIndex){const n=this.fromIndex.evaluate(e);return r.indexOf(t,n)}return r.indexOf(t)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}}class Jt{constructor(e,t,r,n,i,A){this.inputType=e,this.type=t,this.input=r,this.cases=n,this.outputs=i,this.otherwise=A}static parse(e,t){if(e.length<5)return t.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return t.error("Expected an even number of arguments.");let r,n;t.expectedType&&"value"!==t.expectedType.kind&&(n=t.expectedType);const i={},A=[];for(let o=2;o<e.length-1;o+=2){let s=e[o];const a=e[o+1];Array.isArray(s)||(s=[s]);const l=t.concat(o);if(0===s.length)return l.error("Expected at least one branch label.");for(const e of s){if("number"!=typeof e&&"string"!=typeof e)return l.error("Branch labels must be numbers or strings.");if("number"==typeof e&&Math.abs(e)>Number.MAX_SAFE_INTEGER)return l.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof e&&Math.floor(e)!==e)return l.error("Numeric branch labels must be integer values.");if(r){if(l.checkSubtype(r,Ke(e)))return null}else r=Ke(e);if(void 0!==i[String(e)])return l.error("Branch labels must be unique.");i[String(e)]=A.length}const c=t.parse(a,o,n);if(!c)return null;n=n||c.type,A.push(c)}const o=t.parse(e[1],1,ge);if(!o)return null;const s=t.parse(e[e.length-1],e.length-1,n);return s?"value"!==o.type.kind&&t.concat(1).checkSubtype(r,o.type)?null:new Jt(r,n,o,i,A,s):null}evaluate(e){const t=this.input.evaluate(e);return(Ke(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))&&this.otherwise.outputDefined()}}class Wt{constructor(e,t,r){this.type=e,this.branches=t,this.otherwise=r}static parse(e,t){if(e.length<4)return t.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return t.error("Expected an odd number of arguments.");let r;t.expectedType&&"value"!==t.expectedType.kind&&(r=t.expectedType);const n=[];for(let i=1;i<e.length-1;i+=2){const A=t.parse(e[i],i,pe);if(!A)return null;const o=t.parse(e[i+1],i+1,r);if(!o)return null;n.push([A,o]),r=r||o.type}const i=t.parse(e[e.length-1],e.length-1,r);if(!i)return null;if(!r)throw new Error("Can't infer output type");return new Wt(r,n,i)}evaluate(e){for(const[t,r]of this.branches)if(t.evaluate(e))return r.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[t,r]of this.branches)e(t),e(r);e(this.otherwise)}outputDefined(){return this.branches.every((([e,t])=>t.outputDefined()))&&this.otherwise.outputDefined()}}class Yt{constructor(e,t,r,n){this.type=e,this.input=t,this.beginIndex=r,this.endIndex=n}static parse(e,t){if(e.length<=2||e.length>=5)return t.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const r=t.parse(e[1],1,ge),n=t.parse(e[2],2,he);if(!r||!n)return null;if(!Fe(r.type,[Be(ge),de,ge]))return t.error(`Expected first argument to be of type array or string, but found ${ve(r.type)} instead`);if(4===e.length){const i=t.parse(e[3],3,he);return i?new Yt(r.type,r,n,i):null}return new Yt(r.type,r,n)}evaluate(e){const t=this.input.evaluate(e),r=this.beginIndex.evaluate(e);if(!Ee(t,["string","array"]))throw new Ne(`Expected first argument to be of type array or string, but found ${ve(Ke(t))} instead.`);if(this.endIndex){const n=this.endIndex.evaluate(e);return t.slice(r,n)}return t.slice(r)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}}function er(e,t){return"=="===e||"!="===e?"boolean"===t.kind||"string"===t.kind||"number"===t.kind||"null"===t.kind||"value"===t.kind:"string"===t.kind||"number"===t.kind||"value"===t.kind}function tr(e,t,r,n){return 0===n.compare(t,r)}function rr(e,t,r){const n="=="!==e&&"!="!==e;return class i{constructor(e,t,r){this.type=pe,this.lhs=e,this.rhs=t,this.collator=r,this.hasUntypedArgument="value"===e.type.kind||"value"===t.type.kind}static parse(e,t){if(3!==e.length&&4!==e.length)return t.error("Expected two or three arguments.");const r=e[0];let A=t.parse(e[1],1,ge);if(!A)return null;if(!er(r,A.type))return t.concat(1).error(`"${r}" comparisons are not supported for type '${ve(A.type)}'.`);let o=t.parse(e[2],2,ge);if(!o)return null;if(!er(r,o.type))return t.concat(2).error(`"${r}" comparisons are not supported for type '${ve(o.type)}'.`);if(A.type.kind!==o.type.kind&&"value"!==A.type.kind&&"value"!==o.type.kind)return t.error(`Cannot compare types '${ve(A.type)}' and '${ve(o.type)}'.`);n&&("value"===A.type.kind&&"value"!==o.type.kind?A=new qe(o.type,[A]):"value"!==A.type.kind&&"value"===o.type.kind&&(o=new qe(A.type,[o])));let s=null;if(4===e.length){if("string"!==A.type.kind&&"string"!==o.type.kind&&"value"!==A.type.kind&&"value"!==o.type.kind)return t.error("Cannot use collator to compare non-string types.");if(s=t.parse(e[3],3,ye),!s)return null}return new i(A,o,s)}evaluate(i){const A=this.lhs.evaluate(i),o=this.rhs.evaluate(i);if(n&&this.hasUntypedArgument){const t=Ke(A),r=Ke(o);if(t.kind!==r.kind||"string"!==t.kind&&"number"!==t.kind)throw new Ne(`Expected arguments for "${e}" to be (string, string) or (number, number), but found (${t.kind}, ${r.kind}) instead.`)}if(this.collator&&!n&&this.hasUntypedArgument){const e=Ke(A),r=Ke(o);if("string"!==e.kind||"string"!==r.kind)return t(i,A,o)}return this.collator?r(i,A,o,this.collator.evaluate(i)):t(i,A,o)}eachChild(e){e(this.lhs),e(this.rhs),this.collator&&e(this.collator)}outputDefined(){return!0}}}const nr=rr("==",(function(e,t,r){return t===r}),tr),ir=rr("!=",(function(e,t,r){return t!==r}),(function(e,t,r,n){return!tr(0,t,r,n)})),Ar=rr("<",(function(e,t,r){return t<r}),(function(e,t,r,n){return n.compare(t,r)<0})),or=rr(">",(function(e,t,r){return t>r}),(function(e,t,r,n){return n.compare(t,r)>0})),sr=rr("<=",(function(e,t,r){return t<=r}),(function(e,t,r,n){return n.compare(t,r)<=0})),ar=rr(">=",(function(e,t,r){return t>=r}),(function(e,t,r,n){return n.compare(t,r)>=0}));class lr{constructor(e,t,r,n,i){this.type=de,this.number=e,this.locale=t,this.currency=r,this.minFractionDigits=n,this.maxFractionDigits=i}static parse(e,t){if(3!==e.length)return t.error("Expected two arguments.");const r=t.parse(e[1],1,he);if(!r)return null;const n=e[2];if("object"!=typeof n||Array.isArray(n))return t.error("NumberFormat options argument must be an object.");let i=null;if(n.locale&&(i=t.parse(n.locale,1,de),!i))return null;let A=null;if(n.currency&&(A=t.parse(n.currency,1,de),!A))return null;let o=null;if(n["min-fraction-digits"]&&(o=t.parse(n["min-fraction-digits"],1,he),!o))return null;let s=null;return n["max-fraction-digits"]&&(s=t.parse(n["max-fraction-digits"],1,he),!s)?null:new lr(r,i,A,o,s)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}}class cr{constructor(e){this.type=_e,this.sections=e}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");const r=e[1];if(!Array.isArray(r)&&"object"==typeof r)return t.error("First argument must be an image or text section.");const n=[];let i=!1;for(let r=1;r<=e.length-1;++r){const A=e[r];if(i&&"object"==typeof A&&!Array.isArray(A)){i=!1;let e=null;if(A["font-scale"]&&(e=t.parse(A["font-scale"],1,he),!e))return null;let r=null;if(A["text-font"]&&(r=t.parse(A["text-font"],1,Be(de)),!r))return null;let o=null;if(A["text-color"]&&(o=t.parse(A["text-color"],1,fe),!o))return null;const s=n[n.length-1];s.scale=e,s.font=r,s.textColor=o}else{const A=t.parse(e[r],1,ge);if(!A)return null;const o=A.type.kind;if("string"!==o&&"value"!==o&&"null"!==o&&"resolvedImage"!==o)return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");i=!0,n.push({content:A,scale:null,font:null,textColor:null})}}return new cr(n)}evaluate(e){return new Pe(this.sections.map((t=>{const r=t.content.evaluate(e);return Ke(r)===xe?new Le("",r,null,null,null):new Le(Ve(r),null,t.scale?t.scale.evaluate(e):null,t.font?t.font.evaluate(e).join(","):null,t.textColor?t.textColor.evaluate(e):null)})))}eachChild(e){for(const t of this.sections)e(t.content),t.scale&&e(t.scale),t.font&&e(t.font),t.textColor&&e(t.textColor)}outputDefined(){return!1}}class ur{constructor(e){this.type=xe,this.input=e}static parse(e,t){if(2!==e.length)return t.error("Expected two arguments.");const r=t.parse(e[1],1,de);return r?new ur(r):t.error("No image name provided.")}evaluate(e){const t=this.input.evaluate(e),r=ze.fromString(t);return r&&e.availableImages&&(r.available=e.availableImages.indexOf(t)>-1),r}eachChild(e){e(this.input)}outputDefined(){return!1}}class hr{constructor(e){this.type=he,this.input=e}static parse(e,t){if(2!==e.length)return t.error(`Expected 1 argument, but found ${e.length-1} instead.`);const r=t.parse(e[1],1);return r?"array"!==r.type.kind&&"string"!==r.type.kind&&"value"!==r.type.kind?t.error(`Expected argument of type string or array, but found ${ve(r.type)} instead.`):new hr(r):null}evaluate(e){const t=this.input.evaluate(e);if("string"==typeof t)return t.length;if(Array.isArray(t))return t.length;throw new Ne(`Expected value to be of type string or array, but found ${ve(Ke(t))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}}const dr={"==":nr,"!=":ir,">":or,"<":Ar,">=":ar,"<=":sr,array:qe,at:Xt,boolean:qe,case:Wt,coalesce:Gt,collator:Ye,format:cr,image:ur,in:jt,"index-of":Zt,interpolate:$t,"interpolate-hcl":$t,"interpolate-lab":$t,length:hr,let:qt,literal:$e,match:Jt,number:qe,"number-format":lr,object:qe,slice:Yt,step:bt,string:qe,"to-boolean":je,"to-color":je,"to-number":je,"to-string":je,var:wt,within:mt};function pr(e,[t,r,n,i]){t=t.evaluate(e),r=r.evaluate(e),n=n.evaluate(e);const A=i?i.evaluate(e):1,o=Re(t,r,n,A);if(o)throw new Ne(o);return new ke(t/255*A,r/255*A,n/255*A,A)}function fr(e,t){return e in t}function mr(e,t){const r=t[e];return void 0===r?null:r}function gr(e){return{type:e}}function yr(e){return{result:"success",value:e}}function _r(e){return{result:"error",value:e}}function wr(e){return"data-driven"===e["property-type"]||"cross-faded-data-driven"===e["property-type"]}function xr(e){return!!e.expression&&e.expression.parameters.indexOf("zoom")>-1}function Br(e){return!!e.expression&&e.expression.interpolated}function vr(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":null===e?"null":typeof e}function br(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}function Cr(e){return e}function Fr(e,t){const r="color"===t.type,n=e.stops&&"object"==typeof e.stops[0][0],i=n||!(n||void 0!==e.property),A=e.type||(Br(t)?"exponential":"interval");if(r||"padding"===t.type){const n=r?ke.parse:He.parse;(e=oe({},e)).stops&&(e.stops=e.stops.map((e=>[e[0],n(e[1])]))),e.default=n(e.default?e.default:t.default)}if(e.colorSpace&&"rgb"!==e.colorSpace&&!Vt[e.colorSpace])throw new Error(`Unknown color space: ${e.colorSpace}`);let o,s,a;if("exponential"===A)o=Ir;else if("interval"===A)o=Qr;else if("categorical"===A){o=Ur,s=Object.create(null);for(const t of e.stops)s[t[0]]=t[1];a=typeof e.stops[0][0]}else{if("identity"!==A)throw new Error(`Unknown function type "${A}"`);o=Tr}if(n){const r={},n=[];for(let t=0;t<e.stops.length;t++){const i=e.stops[t],A=i[0].zoom;void 0===r[A]&&(r[A]={zoom:A,type:e.type,property:e.property,default:e.default,stops:[]},n.push(A)),r[A].stops.push([i[0].value,i[1]])}const i=[];for(const e of n)i.push([r[e].zoom,Fr(r[e],t)]);const A={name:"linear"};return{kind:"composite",interpolationType:A,interpolationFactor:$t.interpolationFactor.bind(void 0,A),zoomStops:i.map((e=>e[0])),evaluate:({zoom:r},n)=>Ir({stops:i,base:e.base},t,r).evaluate(r,n)}}if(i){const r="exponential"===A?{name:"exponential",base:void 0!==e.base?e.base:1}:null;return{kind:"camera",interpolationType:r,interpolationFactor:$t.interpolationFactor.bind(void 0,r),zoomStops:e.stops.map((e=>e[0])),evaluate:({zoom:r})=>o(e,t,r,s,a)}}return{kind:"source",evaluate(r,n){const i=n&&n.properties?n.properties[e.property]:void 0;return void 0===i?Er(e.default,t.default):o(e,t,i,s,a)}}}function Er(e,t,r){return void 0!==e?e:void 0!==t?t:void 0!==r?r:void 0}function Ur(e,t,r,n,i){return Er(typeof r===i?n[r]:void 0,e.default,t.default)}function Qr(e,t,r){if("number"!==vr(r))return Er(e.default,t.default);const n=e.stops.length;if(1===n)return e.stops[0][1];if(r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[n-1][0])return e.stops[n-1][1];const i=vt(e.stops.map((e=>e[0])),r);return e.stops[i][1]}function Ir(e,t,r){const n=void 0!==e.base?e.base:1;if("number"!==vr(r))return Er(e.default,t.default);const i=e.stops.length;if(1===i)return e.stops[0][1];if(r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[i-1][0])return e.stops[i-1][1];const A=vt(e.stops.map((e=>e[0])),r),o=function(e,t,r,n){const i=n-r,A=e-r;return 0===i?0:1===t?A/i:(Math.pow(t,A)-1)/(Math.pow(t,i)-1)}(r,n,e.stops[A][0],e.stops[A+1][0]),s=e.stops[A][1],a=e.stops[A+1][1];let l=Ft[t.type]||Cr;if(e.colorSpace&&"rgb"!==e.colorSpace){const t=Vt[e.colorSpace];l=(e,r)=>t.reverse(t.interpolate(t.forward(e),t.forward(r),o))}return"function"==typeof s.evaluate?{evaluate(...e){const t=s.evaluate.apply(void 0,e),r=a.evaluate.apply(void 0,e);if(void 0!==t&&void 0!==r)return l(t,r,o)}}:l(s,a,o)}function Tr(e,t,r){switch(t.type){case"color":r=ke.parse(r);break;case"formatted":r=Pe.fromString(r.toString());break;case"resolvedImage":r=ze.fromString(r.toString());break;case"padding":r=He.parse(r);break;default:vr(r)===t.type||"enum"===t.type&&t.values[r]||(r=void 0)}return Er(r,e.default,t.default)}We.register(dr,{error:[{kind:"error"},[de],(e,[t])=>{throw new Ne(t.evaluate(e))}],typeof:[de,[ge],(e,[t])=>ve(Ke(t.evaluate(e)))],"to-rgba":[Be(he,4),[fe],(e,[t])=>t.evaluate(e).toArray()],rgb:[fe,[he,he,he],pr],rgba:[fe,[he,he,he,he],pr],has:{type:pe,overloads:[[[de],(e,[t])=>fr(t.evaluate(e),e.properties())],[[de,me],(e,[t,r])=>fr(t.evaluate(e),r.evaluate(e))]]},get:{type:ge,overloads:[[[de],(e,[t])=>mr(t.evaluate(e),e.properties())],[[de,me],(e,[t,r])=>mr(t.evaluate(e),r.evaluate(e))]]},"feature-state":[ge,[de],(e,[t])=>mr(t.evaluate(e),e.featureState||{})],properties:[me,[],e=>e.properties()],"geometry-type":[de,[],e=>e.geometryType()],id:[ge,[],e=>e.id()],zoom:[he,[],e=>e.globals.zoom],"heatmap-density":[he,[],e=>e.globals.heatmapDensity||0],"line-progress":[he,[],e=>e.globals.lineProgress||0],accumulated:[ge,[],e=>void 0===e.globals.accumulated?null:e.globals.accumulated],"+":[he,gr(he),(e,t)=>{let r=0;for(const n of t)r+=n.evaluate(e);return r}],"*":[he,gr(he),(e,t)=>{let r=1;for(const n of t)r*=n.evaluate(e);return r}],"-":{type:he,overloads:[[[he,he],(e,[t,r])=>t.evaluate(e)-r.evaluate(e)],[[he],(e,[t])=>-t.evaluate(e)]]},"/":[he,[he,he],(e,[t,r])=>t.evaluate(e)/r.evaluate(e)],"%":[he,[he,he],(e,[t,r])=>t.evaluate(e)%r.evaluate(e)],ln2:[he,[],()=>Math.LN2],pi:[he,[],()=>Math.PI],e:[he,[],()=>Math.E],"^":[he,[he,he],(e,[t,r])=>Math.pow(t.evaluate(e),r.evaluate(e))],sqrt:[he,[he],(e,[t])=>Math.sqrt(t.evaluate(e))],log10:[he,[he],(e,[t])=>Math.log(t.evaluate(e))/Math.LN10],ln:[he,[he],(e,[t])=>Math.log(t.evaluate(e))],log2:[he,[he],(e,[t])=>Math.log(t.evaluate(e))/Math.LN2],sin:[he,[he],(e,[t])=>Math.sin(t.evaluate(e))],cos:[he,[he],(e,[t])=>Math.cos(t.evaluate(e))],tan:[he,[he],(e,[t])=>Math.tan(t.evaluate(e))],asin:[he,[he],(e,[t])=>Math.asin(t.evaluate(e))],acos:[he,[he],(e,[t])=>Math.acos(t.evaluate(e))],atan:[he,[he],(e,[t])=>Math.atan(t.evaluate(e))],min:[he,gr(he),(e,t)=>Math.min(...t.map((t=>t.evaluate(e))))],max:[he,gr(he),(e,t)=>Math.max(...t.map((t=>t.evaluate(e))))],abs:[he,[he],(e,[t])=>Math.abs(t.evaluate(e))],round:[he,[he],(e,[t])=>{const r=t.evaluate(e);return r<0?-Math.round(-r):Math.round(r)}],floor:[he,[he],(e,[t])=>Math.floor(t.evaluate(e))],ceil:[he,[he],(e,[t])=>Math.ceil(t.evaluate(e))],"filter-==":[pe,[de,ge],(e,[t,r])=>e.properties()[t.value]===r.value],"filter-id-==":[pe,[ge],(e,[t])=>e.id()===t.value],"filter-type-==":[pe,[de],(e,[t])=>e.geometryType()===t.value],"filter-<":[pe,[de,ge],(e,[t,r])=>{const n=e.properties()[t.value],i=r.value;return typeof n==typeof i&&n<i}],"filter-id-<":[pe,[ge],(e,[t])=>{const r=e.id(),n=t.value;return typeof r==typeof n&&r<n}],"filter->":[pe,[de,ge],(e,[t,r])=>{const n=e.properties()[t.value],i=r.value;return typeof n==typeof i&&n>i}],"filter-id->":[pe,[ge],(e,[t])=>{const r=e.id(),n=t.value;return typeof r==typeof n&&r>n}],"filter-<=":[pe,[de,ge],(e,[t,r])=>{const n=e.properties()[t.value],i=r.value;return typeof n==typeof i&&n<=i}],"filter-id-<=":[pe,[ge],(e,[t])=>{const r=e.id(),n=t.value;return typeof r==typeof n&&r<=n}],"filter->=":[pe,[de,ge],(e,[t,r])=>{const n=e.properties()[t.value],i=r.value;return typeof n==typeof i&&n>=i}],"filter-id->=":[pe,[ge],(e,[t])=>{const r=e.id(),n=t.value;return typeof r==typeof n&&r>=n}],"filter-has":[pe,[ge],(e,[t])=>t.value in e.properties()],"filter-has-id":[pe,[],e=>null!==e.id()&&void 0!==e.id()],"filter-type-in":[pe,[Be(de)],(e,[t])=>t.value.indexOf(e.geometryType())>=0],"filter-id-in":[pe,[Be(ge)],(e,[t])=>t.value.indexOf(e.id())>=0],"filter-in-small":[pe,[de,Be(ge)],(e,[t,r])=>r.value.indexOf(e.properties()[t.value])>=0],"filter-in-large":[pe,[de,Be(ge)],(e,[t,r])=>function(e,t,r,n){for(;r<=n;){const i=r+n>>1;if(t[i]===e)return!0;t[i]>e?n=i-1:r=i+1}return!1}(e.properties()[t.value],r.value,0,r.value.length-1)],all:{type:pe,overloads:[[[pe,pe],(e,[t,r])=>t.evaluate(e)&&r.evaluate(e)],[gr(pe),(e,t)=>{for(const r of t)if(!r.evaluate(e))return!1;return!0}]]},any:{type:pe,overloads:[[[pe,pe],(e,[t,r])=>t.evaluate(e)||r.evaluate(e)],[gr(pe),(e,t)=>{for(const r of t)if(r.evaluate(e))return!0;return!1}]]},"!":[pe,[pe],(e,[t])=>!t.evaluate(e)],"is-supported-script":[pe,[de],(e,[t])=>{const r=e.globals&&e.globals.isSupportedScript;return!r||r(t.evaluate(e))}],upcase:[de,[de],(e,[t])=>t.evaluate(e).toUpperCase()],downcase:[de,[de],(e,[t])=>t.evaluate(e).toLowerCase()],concat:[de,gr(ge),(e,t)=>t.map((t=>Ve(t.evaluate(e)))).join("")],"resolved-locale":[de,[ye],(e,[t])=>t.evaluate(e).resolvedLocale()]});class Sr{constructor(e,t){this.expression=e,this._warningHistory={},this._evaluator=new Je,this._defaultValue=t?function(e){return"color"===e.type&&br(e.default)?new ke(0,0,0,0):"color"===e.type?ke.parse(e.default)||null:"padding"===e.type?He.parse(e.default)||null:void 0===e.default?null:e.default}(t):null,this._enumValues=t&&"enum"===t.type?t.values:null}evaluateWithoutErrorHandling(e,t,r,n,i,A){return this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=r,this._evaluator.canonical=n,this._evaluator.availableImages=i||null,this._evaluator.formattedSection=A,this.expression.evaluate(this._evaluator)}evaluate(e,t,r,n,i,A){this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=r||null,this._evaluator.canonical=n,this._evaluator.availableImages=i||null,this._evaluator.formattedSection=A||null;try{const e=this.expression.evaluate(this._evaluator);if(null==e||"number"==typeof e&&e!=e)return this._defaultValue;if(this._enumValues&&!(e in this._enumValues))throw new Ne(`Expected value to be one of ${Object.keys(this._enumValues).map((e=>JSON.stringify(e))).join(", ")}, but found ${JSON.stringify(e)} instead.`);return e}catch(e){return this._warningHistory[e.message]||(this._warningHistory[e.message]=!0,"undefined"!=typeof console&&console.warn(e.message)),this._defaultValue}}}function Mr(e){return Array.isArray(e)&&e.length>0&&"string"==typeof e[0]&&e[0]in dr}function kr(e,t){const r=new xt(dr,[],t?function(e){const t={color:fe,string:de,number:he,enum:de,boolean:pe,formatted:_e,padding:we,resolvedImage:xe};return"array"===e.type?Be(t[e.value]||ge,e.length):t[e.type]}(t):void 0),n=r.parse(e,void 0,void 0,void 0,t&&"string"===t.type?{typeAnnotation:"coerce"}:void 0);return n?yr(new Sr(n,t)):_r(r.errors)}class Dr{constructor(e,t){this.kind=e,this._styleExpression=t,this.isStateDependent="constant"!==e&&!yt(t.expression)}evaluateWithoutErrorHandling(e,t,r,n,i,A){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,n,i,A)}evaluate(e,t,r,n,i,A){return this._styleExpression.evaluate(e,t,r,n,i,A)}}class Lr{constructor(e,t,r,n){this.kind=e,this.zoomStops=r,this._styleExpression=t,this.isStateDependent="camera"!==e&&!yt(t.expression),this.interpolationType=n}evaluateWithoutErrorHandling(e,t,r,n,i,A){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,n,i,A)}evaluate(e,t,r,n,i,A){return this._styleExpression.evaluate(e,t,r,n,i,A)}interpolationFactor(e,t,r){return this.interpolationType?$t.interpolationFactor(this.interpolationType,e,t,r):0}}function Pr(e,t){const r=kr(e,t);if("error"===r.result)return r;const n=r.value.expression,i=gt(n);if(!i&&!wr(t))return _r([new le("","data expressions not supported")]);const A=_t(n,["zoom"]);if(!A&&!xr(t))return _r([new le("","zoom expressions not supported")]);const o=zr(n);return o||A?o instanceof le?_r([o]):o instanceof $t&&!Br(t)?_r([new le("",'"interpolate" expressions cannot be used with this property')]):yr(o?new Lr(i?"camera":"composite",r.value,o.labels,o instanceof $t?o.interpolation:void 0):new Dr(i?"constant":"source",r.value)):_r([new le("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Hr{constructor(e,t){this._parameters=e,this._specification=t,oe(this,Fr(this._parameters,this._specification))}static deserialize(e){return new Hr(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function zr(e){let t=null;if(e instanceof qt)t=zr(e.result);else if(e instanceof Gt){for(const r of e.args)if(t=zr(r),t)break}else(e instanceof bt||e instanceof $t)&&e.input instanceof We&&"zoom"===e.input.name&&(t=e);return t instanceof le||e.eachChild((e=>{const r=zr(e);r instanceof le?t=r:!t&&r?t=new le("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&r&&t!==r&&(t=new le("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),t}function Rr(e){const t=e.key,r=e.value,n=e.valueSpec||{},i=e.objectElementValidators||{},A=e.style,o=e.styleSpec;let s=[];const a=vr(r);if("object"!==a)return[new ie(t,r,`object expected, ${a} found`)];for(const e in r){const a=e.split(".")[0],l=n[a]||n["*"];let c;if(i[a])c=i[a];else if(n[a])c=fn;else if(i["*"])c=i["*"];else{if(!n["*"]){s.push(new ie(t,r[e],`unknown property "${e}"`));continue}c=fn}s=s.concat(c({key:(t?`${t}.`:t)+e,value:r[e],valueSpec:l,style:A,styleSpec:o,object:r,objectKey:e},r))}for(const e in n)i[e]||n[e].required&&void 0===n[e].default&&void 0===r[e]&&s.push(new ie(t,r,`missing required property "${e}"`));return s}function Or(e){const t=e.value,r=e.valueSpec,n=e.style,i=e.styleSpec,A=e.key,o=e.arrayElementValidator||fn;if("array"!==vr(t))return[new ie(A,t,`array expected, ${vr(t)} found`)];if(r.length&&t.length!==r.length)return[new ie(A,t,`array length ${r.length} expected, length ${t.length} found`)];if(r["min-length"]&&t.length<r["min-length"])return[new ie(A,t,`array length at least ${r["min-length"]} expected, length ${t.length} found`)];let s={type:r.value,values:r.values};i.$version<7&&(s.function=r.function),"object"===vr(r.value)&&(s=r.value);let a=[];for(let e=0;e<t.length;e++)a=a.concat(o({array:t,arrayIndex:e,value:t[e],valueSpec:s,style:n,styleSpec:i,key:`${A}[${e}]`}));return a}function Kr(e){const t=e.key,r=e.value,n=e.valueSpec;let i=vr(r);return"number"===i&&r!=r&&(i="NaN"),"number"!==i?[new ie(t,r,`number expected, ${i} found`)]:"minimum"in n&&r<n.minimum?[new ie(t,r,`${r} is less than the minimum value ${n.minimum}`)]:"maximum"in n&&r>n.maximum?[new ie(t,r,`${r} is greater than the maximum value ${n.maximum}`)]:[]}function Vr(e){const t=e.valueSpec,r=se(e.value.type);let n,i,A,o={};const s="categorical"!==r&&void 0===e.value.property,a=!s,l="array"===vr(e.value.stops)&&"array"===vr(e.value.stops[0])&&"object"===vr(e.value.stops[0][0]),c=Rr({key:e.key,value:e.value,valueSpec:e.styleSpec.function,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:function(e){if("identity"===r)return[new ie(e.key,e.value,'identity function may not have a "stops" property')];let t=[];const n=e.value;return t=t.concat(Or({key:e.key,value:n,valueSpec:e.valueSpec,style:e.style,styleSpec:e.styleSpec,arrayElementValidator:u})),"array"===vr(n)&&0===n.length&&t.push(new ie(e.key,n,"array must have at least one stop")),t},default:function(e){return fn({key:e.key,value:e.value,valueSpec:t,style:e.style,styleSpec:e.styleSpec})}}});return"identity"===r&&s&&c.push(new ie(e.key,e.value,'missing required property "property"')),"identity"===r||e.value.stops||c.push(new ie(e.key,e.value,'missing required property "stops"')),"exponential"===r&&e.valueSpec.expression&&!Br(e.valueSpec)&&c.push(new ie(e.key,e.value,"exponential functions not supported")),e.styleSpec.$version>=8&&(a&&!wr(e.valueSpec)?c.push(new ie(e.key,e.value,"property functions not supported")):s&&!xr(e.valueSpec)&&c.push(new ie(e.key,e.value,"zoom functions not supported"))),"categorical"!==r&&!l||void 0!==e.value.property||c.push(new ie(e.key,e.value,'"property" property is required')),c;function u(e){let r=[];const n=e.value,s=e.key;if("array"!==vr(n))return[new ie(s,n,`array expected, ${vr(n)} found`)];if(2!==n.length)return[new ie(s,n,`array length 2 expected, length ${n.length} found`)];if(l){if("object"!==vr(n[0]))return[new ie(s,n,`object expected, ${vr(n[0])} found`)];if(void 0===n[0].zoom)return[new ie(s,n,"object stop key must have zoom")];if(void 0===n[0].value)return[new ie(s,n,"object stop key must have value")];if(A&&A>se(n[0].zoom))return[new ie(s,n[0].zoom,"stop zoom values must appear in ascending order")];se(n[0].zoom)!==A&&(A=se(n[0].zoom),i=void 0,o={}),r=r.concat(Rr({key:`${s}[0]`,value:n[0],valueSpec:{zoom:{}},style:e.style,styleSpec:e.styleSpec,objectElementValidators:{zoom:Kr,value:h}}))}else r=r.concat(h({key:`${s}[0]`,value:n[0],valueSpec:{},style:e.style,styleSpec:e.styleSpec},n));return Mr(ae(n[1]))?r.concat([new ie(`${s}[1]`,n[1],"expressions are not allowed in function stops.")]):r.concat(fn({key:`${s}[1]`,value:n[1],valueSpec:t,style:e.style,styleSpec:e.styleSpec}))}function h(e,A){const s=vr(e.value),a=se(e.value),l=null!==e.value?e.value:A;if(n){if(s!==n)return[new ie(e.key,l,`${s} stop domain type must match previous stop domain type ${n}`)]}else n=s;if("number"!==s&&"string"!==s&&"boolean"!==s)return[new ie(e.key,l,"stop domain value must be a number, string, or boolean")];if("number"!==s&&"categorical"!==r){let n=`number expected, ${s} found`;return wr(t)&&void 0===r&&(n+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new ie(e.key,l,n)]}return"categorical"!==r||"number"!==s||isFinite(a)&&Math.floor(a)===a?"categorical"!==r&&"number"===s&&void 0!==i&&a<i?[new ie(e.key,l,"stop domain values must appear in ascending order")]:(i=a,"categorical"===r&&a in o?[new ie(e.key,l,"stop domain values must be unique")]:(o[a]=!0,[])):[new ie(e.key,l,`integer expected, found ${a}`)]}}function $r(e){const t=("property"===e.expressionContext?Pr:kr)(ae(e.value),e.valueSpec);if("error"===t.result)return t.value.map((t=>new ie(`${e.key}${t.key}`,e.value,t.message)));const r=t.value.expression||t.value._styleExpression.expression;if("property"===e.expressionContext&&"text-font"===e.propertyKey&&!r.outputDefined())return[new ie(e.key,e.value,`Invalid data expression for "${e.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===e.expressionContext&&"layout"===e.propertyType&&!yt(r))return[new ie(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===e.expressionContext&&!yt(r))return[new ie(e.key,e.value,'"feature-state" data expressions are not supported with filters.')];if(e.expressionContext&&0===e.expressionContext.indexOf("cluster")){if(!_t(r,["zoom","feature-state"]))return[new ie(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===e.expressionContext&&!gt(r))return[new ie(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Nr(e){const t=e.key,r=e.value,n=e.valueSpec,i=[];return Array.isArray(n.values)?-1===n.values.indexOf(se(r))&&i.push(new ie(t,r,`expected one of [${n.values.join(", ")}], ${JSON.stringify(r)} found`)):-1===Object.keys(n.values).indexOf(se(r))&&i.push(new ie(t,r,`expected one of [${Object.keys(n.values).join(", ")}], ${JSON.stringify(r)} found`)),i}function Gr(e){if(!0===e||!1===e)return!0;if(!Array.isArray(e)||0===e.length)return!1;switch(e[0]){case"has":return e.length>=2&&"$id"!==e[1]&&"$type"!==e[1];case"in":return e.length>=3&&("string"!=typeof e[1]||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==e.length||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(const t of e.slice(1))if(!Gr(t)&&"boolean"!=typeof t)return!1;return!0;default:return!0}}const qr={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Xr(e){if(null==e)return{filter:()=>!0,needGeometry:!1};Gr(e)||(e=Jr(e));const t=kr(e,qr);if("error"===t.result)throw new Error(t.value.map((e=>`${e.key}: ${e.message}`)).join(", "));return{filter:(e,r,n)=>t.value.evaluate(e,r,{},n),needGeometry:Zr(e)}}function jr(e,t){return e<t?-1:e>t?1:0}function Zr(e){if(!Array.isArray(e))return!1;if("within"===e[0])return!0;for(let t=1;t<e.length;t++)if(Zr(e[t]))return!0;return!1}function Jr(e){if(!e)return!0;const t=e[0];return e.length<=1?"any"!==t:"=="===t?Wr(e[1],e[2],"=="):"!="===t?tn(Wr(e[1],e[2],"==")):"<"===t||">"===t||"<="===t||">="===t?Wr(e[1],e[2],t):"any"===t?(r=e.slice(1),["any"].concat(r.map(Jr))):"all"===t?["all"].concat(e.slice(1).map(Jr)):"none"===t?["all"].concat(e.slice(1).map(Jr).map(tn)):"in"===t?Yr(e[1],e.slice(2)):"!in"===t?tn(Yr(e[1],e.slice(2))):"has"===t?en(e[1]):"!has"===t?tn(en(e[1])):"within"!==t||e;var r}function Wr(e,t,r){switch(e){case"$type":return[`filter-type-${r}`,t];case"$id":return[`filter-id-${r}`,t];default:return[`filter-${r}`,e,t]}}function Yr(e,t){if(0===t.length)return!1;switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some((e=>typeof e!=typeof t[0]))?["filter-in-large",e,["literal",t.sort(jr)]]:["filter-in-small",e,["literal",t]]}}function en(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function tn(e){return["!",e]}function rn(e){return Gr(ae(e.value))?$r(oe({},e,{expressionContext:"filter",valueSpec:{value:"boolean"}})):nn(e)}function nn(e){const t=e.value,r=e.key;if("array"!==vr(t))return[new ie(r,t,`array expected, ${vr(t)} found`)];const n=e.styleSpec;let i,A=[];if(t.length<1)return[new ie(r,t,"filter array must have at least 1 element")];switch(A=A.concat(Nr({key:`${r}[0]`,value:t[0],valueSpec:n.filter_operator,style:e.style,styleSpec:e.styleSpec})),se(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&"$type"===se(t[1])&&A.push(new ie(r,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":3!==t.length&&A.push(new ie(r,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(i=vr(t[1]),"string"!==i&&A.push(new ie(`${r}[1]`,t[1],`string expected, ${i} found`)));for(let o=2;o<t.length;o++)i=vr(t[o]),"$type"===se(t[1])?A=A.concat(Nr({key:`${r}[${o}]`,value:t[o],valueSpec:n.geometry_type,style:e.style,styleSpec:e.styleSpec})):"string"!==i&&"number"!==i&&"boolean"!==i&&A.push(new ie(`${r}[${o}]`,t[o],`string, number, or boolean expected, ${i} found`));break;case"any":case"all":case"none":for(let n=1;n<t.length;n++)A=A.concat(nn({key:`${r}[${n}]`,value:t[n],style:e.style,styleSpec:e.styleSpec}));break;case"has":case"!has":i=vr(t[1]),2!==t.length?A.push(new ie(r,t,`filter array for "${t[0]}" operator must have 2 elements`)):"string"!==i&&A.push(new ie(`${r}[1]`,t[1],`string expected, ${i} found`));break;case"within":i=vr(t[1]),2!==t.length?A.push(new ie(r,t,`filter array for "${t[0]}" operator must have 2 elements`)):"object"!==i&&A.push(new ie(`${r}[1]`,t[1],`object expected, ${i} found`))}return A}function An(e,t){const r=e.key,n=e.style,i=e.styleSpec,A=e.value,o=e.objectKey,s=i[`${t}_${e.layerType}`];if(!s)return[];const a=o.match(/^(.*)-transition$/);if("paint"===t&&a&&s[a[1]]&&s[a[1]].transition)return fn({key:r,value:A,valueSpec:i.transition,style:n,styleSpec:i});const l=e.valueSpec||s[o];if(!l)return[new ie(r,A,`unknown property "${o}"`)];let c;if("string"===vr(A)&&wr(l)&&!l.tokens&&(c=/^{([^}]+)}$/.exec(A)))return[new ie(r,A,`"${o}" does not support interpolation syntax\nUse an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(c[1])} }\`.`)];const u=[];return"symbol"===e.layerType&&("text-field"===o&&n&&!n.glyphs&&u.push(new ie(r,A,'use of "text-field" requires a style "glyphs" property')),"text-font"===o&&br(ae(A))&&"identity"===se(A.type)&&u.push(new ie(r,A,'"text-font" does not support identity functions'))),u.concat(fn({key:e.key,value:A,valueSpec:l,style:n,styleSpec:i,expressionContext:"property",propertyType:t,propertyKey:o}))}function on(e){return An(e,"paint")}function sn(e){return An(e,"layout")}function an(e){let t=[];const r=e.value,n=e.key,i=e.style,A=e.styleSpec;r.type||r.ref||t.push(new ie(n,r,'either "type" or "ref" is required'));let o=se(r.type);const s=se(r.ref);if(r.id){const A=se(r.id);for(let o=0;o<e.arrayIndex;o++){const e=i.layers[o];se(e.id)===A&&t.push(new ie(n,r.id,`duplicate layer id "${r.id}", previously used at line ${e.id.__line__}`))}}if("ref"in r){let e;["type","source","source-layer","filter","layout"].forEach((e=>{e in r&&t.push(new ie(n,r[e],`"${e}" is prohibited for ref layers`))})),i.layers.forEach((t=>{se(t.id)===s&&(e=t)})),e?e.ref?t.push(new ie(n,r.ref,"ref cannot reference another ref layer")):o=se(e.type):t.push(new ie(n,r.ref,`ref layer "${s}" not found`))}else if("background"!==o)if(r.source){const e=i.sources&&i.sources[r.source],A=e&&se(e.type);e?"vector"===A&&"raster"===o?t.push(new ie(n,r.source,`layer "${r.id}" requires a raster source`)):"raster"===A&&"raster"!==o?t.push(new ie(n,r.source,`layer "${r.id}" requires a vector source`)):"vector"!==A||r["source-layer"]?"raster-dem"===A&&"hillshade"!==o?t.push(new ie(n,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==o||!r.paint||!r.paint["line-gradient"]||"geojson"===A&&e.lineMetrics||t.push(new ie(n,r,`layer "${r.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new ie(n,r,`layer "${r.id}" must specify a "source-layer"`)):t.push(new ie(n,r.source,`source "${r.source}" not found`))}else t.push(new ie(n,r,'missing required property "source"'));return t=t.concat(Rr({key:n,value:r,valueSpec:A.layer,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":()=>[],type:()=>fn({key:`${n}.type`,value:r.type,valueSpec:A.layer.type,style:e.style,styleSpec:e.styleSpec,object:r,objectKey:"type"}),filter:rn,layout:e=>Rr({layer:r,key:e.key,value:e.value,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":e=>sn(oe({layerType:o},e))}}),paint:e=>Rr({layer:r,key:e.key,value:e.value,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":e=>on(oe({layerType:o},e))}})}})),t}function ln(e){const t=e.value,r=e.key,n=vr(t);return"string"!==n?[new ie(r,t,`string expected, ${n} found`)]:[]}const cn={promoteId:function({key:e,value:t}){if("string"===vr(t))return ln({key:e,value:t});{const r=[];for(const n in t)r.push(...ln({key:`${e}.${n}`,value:t[n]}));return r}}};function un(e){const t=e.value,r=e.key,n=e.styleSpec,i=e.style;if(!t.type)return[new ie(r,t,'"type" is required')];const A=se(t.type);let o;switch(A){case"vector":case"raster":case"raster-dem":return o=Rr({key:r,value:t,valueSpec:n[`source_${A.replace("-","_")}`],style:e.style,styleSpec:n,objectElementValidators:cn}),o;case"geojson":if(o=Rr({key:r,value:t,valueSpec:n.source_geojson,style:i,styleSpec:n,objectElementValidators:cn}),t.cluster)for(const e in t.clusterProperties){const[n,i]=t.clusterProperties[e],A="string"==typeof n?[n,["accumulated"],["get",e]]:n;o.push(...$r({key:`${r}.${e}.map`,value:i,expressionContext:"cluster-map"})),o.push(...$r({key:`${r}.${e}.reduce`,value:A,expressionContext:"cluster-reduce"}))}return o;case"video":return Rr({key:r,value:t,valueSpec:n.source_video,style:i,styleSpec:n});case"image":return Rr({key:r,value:t,valueSpec:n.source_image,style:i,styleSpec:n});case"canvas":return[new ie(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Nr({key:`${r}.type`,value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:i,styleSpec:n})}}function hn(e){const t=e.value,r=e.styleSpec,n=r.light,i=e.style;let A=[];const o=vr(t);if(void 0===t)return A;if("object"!==o)return A=A.concat([new ie("light",t,`object expected, ${o} found`)]),A;for(const e in t){const o=e.match(/^(.*)-transition$/);A=A.concat(o&&n[o[1]]&&n[o[1]].transition?fn({key:e,value:t[e],valueSpec:r.transition,style:i,styleSpec:r}):n[e]?fn({key:e,value:t[e],valueSpec:n[e],style:i,styleSpec:r}):[new ie(e,t[e],`unknown property "${e}"`)])}return A}function dn(e){const t=e.value,r=e.styleSpec,n=r.terrain,i=e.style;let A=[];const o=vr(t);if(void 0===t)return A;if("object"!==o)return A=A.concat([new ie("terrain",t,`object expected, ${o} found`)]),A;for(const e in t)A=A.concat(n[e]?fn({key:e,value:t[e],valueSpec:n[e],style:i,styleSpec:r}):[new ie(e,t[e],`unknown property "${e}"`)]);return A}const pn={"*":()=>[],array:Or,boolean:function(e){const t=e.value,r=e.key,n=vr(t);return"boolean"!==n?[new ie(r,t,`boolean expected, ${n} found`)]:[]},number:Kr,color:function(e){const t=e.key,r=e.value,n=vr(r);return"string"!==n?[new ie(t,r,`color expected, ${n} found`)]:null===Ue(r)?[new ie(t,r,`color expected, "${r}" found`)]:[]},constants:Ae,enum:Nr,filter:rn,function:Vr,layer:an,object:Rr,source:un,light:hn,terrain:dn,string:ln,formatted:function(e){return 0===ln(e).length?[]:$r(e)},resolvedImage:function(e){return 0===ln(e).length?[]:$r(e)},padding:function(e){const t=e.key,r=e.value;if("array"===vr(r)){if(r.length<1||r.length>4)return[new ie(t,r,`padding requires 1 to 4 values; ${r.length} values found`)];const e={type:"number"};let n=[];for(let i=0;i<r.length;i++)n=n.concat(fn({key:`${t}[${i}]`,value:r[i],valueSpec:e}));return n}return Kr({key:t,value:r,valueSpec:{}})}};function fn(e){const t=e.value,r=e.valueSpec,n=e.styleSpec;return r.expression&&br(se(t))?Vr(e):r.expression&&Mr(ae(t))?$r(e):r.type&&pn[r.type]?pn[r.type](e):Rr(oe({},e,{valueSpec:r.type?n[r.type]:r}))}function mn(e){const t=e.value,r=e.key,n=ln(e);return n.length||(-1===t.indexOf("{fontstack}")&&n.push(new ie(r,t,'"glyphs" url must include a "{fontstack}" token')),-1===t.indexOf("{range}")&&n.push(new ie(r,t,'"glyphs" url must include a "{range}" token'))),n}function gn(e,t=ne){let r=[];return r=r.concat(fn({key:"",value:e,valueSpec:t.$root,styleSpec:t,style:e,objectElementValidators:{glyphs:mn,"*":()=>[]}})),e.constants&&(r=r.concat(Ae({key:"constants",value:e.constants,style:e,styleSpec:t}))),yn(r)}function yn(e){return[].concat(e).sort(((e,t)=>e.line-t.line))}function _n(e){return function(...t){return yn(e.apply(this,t))}}gn.source=_n(un),gn.light=_n(hn),gn.terrain=_n(dn),gn.layer=_n(an),gn.filter=_n(rn),gn.paintProperty=_n(on),gn.layoutProperty=_n(sn);const wn=gn,xn=wn.light,Bn=wn.paintProperty,vn=wn.layoutProperty;function bn(e,t){let r=!1;if(t&&t.length)for(const n of t)e.fire(new te(new Error(n.message))),r=!0;return r}class Cn{constructor(e,t,r){const n=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;const i=new Int32Array(this.arrayBuffer);e=i[0],this.d=(t=i[1])+2*(r=i[2]);for(let e=0;e<this.d*this.d;e++){const t=i[3+e],r=i[3+e+1];n.push(t===r?null:i.subarray(t,r))}const A=i[3+n.length+1];this.keys=i.subarray(i[3+n.length],A),this.bboxes=i.subarray(A),this.insert=this._insertReadonly}else{this.d=t+2*r;for(let e=0;e<this.d*this.d;e++)n.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=e,this.padding=r,this.scale=t/e,this.uid=0;const i=r/t*e;this.min=-i,this.max=e+i}insert(e,t,r,n,i){this._forEachCell(t,r,n,i,this._insertCell,this.uid++,void 0,void 0),this.keys.push(e),this.bboxes.push(t),this.bboxes.push(r),this.bboxes.push(n),this.bboxes.push(i)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(e,t,r,n,i,A){this.cells[i].push(A)}query(e,t,r,n,i){const A=this.min,o=this.max;if(e<=A&&t<=A&&o<=r&&o<=n&&!i)return Array.prototype.slice.call(this.keys);{const A=[];return this._forEachCell(e,t,r,n,this._queryCell,A,{},i),A}}_queryCell(e,t,r,n,i,A,o,s){const a=this.cells[i];if(null!==a){const i=this.keys,l=this.bboxes;for(let c=0;c<a.length;c++){const u=a[c];if(void 0===o[u]){const a=4*u;(s?s(l[a+0],l[a+1],l[a+2],l[a+3]):e<=l[a+2]&&t<=l[a+3]&&r>=l[a+0]&&n>=l[a+1])?(o[u]=!0,A.push(i[u])):o[u]=!1}}}}_forEachCell(e,t,r,n,i,A,o,s){const a=this._convertToCellCoord(e),l=this._convertToCellCoord(t),c=this._convertToCellCoord(r),u=this._convertToCellCoord(n);for(let h=a;h<=c;h++)for(let a=l;a<=u;a++){const l=this.d*a+h;if((!s||s(this._convertFromCellCoord(h),this._convertFromCellCoord(a),this._convertFromCellCoord(h+1),this._convertFromCellCoord(a+1)))&&i.call(this,e,t,r,n,l,A,o,s))return}}_convertFromCellCoord(e){return(e-this.padding)/this.scale}_convertToCellCoord(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const e=this.cells,t=3+this.cells.length+1+1;let r=0;for(let e=0;e<this.cells.length;e++)r+=this.cells[e].length;const n=new Int32Array(t+r+this.keys.length+this.bboxes.length);n[0]=this.extent,n[1]=this.n,n[2]=this.padding;let i=t;for(let t=0;t<e.length;t++){const r=e[t];n[3+t]=i,n.set(r,i),i+=r.length}return n[3+e.length]=i,n.set(this.keys,i),i+=this.keys.length,n[3+e.length+1]=i,n.set(this.bboxes,i),i+=this.bboxes.length,n.buffer}static serialize(e,t){const r=e.toArrayBuffer();return t&&t.push(r),{buffer:r}}static deserialize(e){return new Cn(e.buffer)}}const Fn={};function En(e,t,r={}){if(Fn[e])throw new Error(`${e} is already registered.`);Object.defineProperty(t,"_classRegistryKey",{value:e,writeable:!1}),Fn[e]={klass:t,omit:r.omit||[],shallow:r.shallow||[]}}En("Object",Object),En("TransferableGridIndex",Cn),En("Color",ke),En("Error",Error),En("AJAXError",K),En("ResolvedImage",ze),En("StylePropertyFunction",Hr),En("StyleExpression",Sr,{omit:["_evaluator"]}),En("ZoomDependentExpression",Lr),En("ZoomConstantExpression",Dr),En("CompoundExpression",We,{omit:["_evaluate"]});for(const e in dr)dr[e]._classRegistryKey||En(`Expression_${e}`,dr[e]);function Un(e){return e&&"undefined"!=typeof ArrayBuffer&&(e instanceof ArrayBuffer||e.constructor&&"ArrayBuffer"===e.constructor.name)}function Qn(e,t){if(null==e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||e instanceof Blob)return e;if(Un(e))return t&&t.push(e),e;if(v(e))return t&&t.push(e),e;if(ArrayBuffer.isView(e)){const r=e;return t&&t.push(r.buffer),r}if(e instanceof ImageData)return t&&t.push(e.data.buffer),e;if(Array.isArray(e)){const r=[];for(const n of e)r.push(Qn(n,t));return r}if("object"==typeof e){const r=e.constructor,n=r._classRegistryKey;if(!n)throw new Error("can't serialize object of unregistered class");if(!Fn[n])throw new Error(`${n} is not registered.`);const i=r.serialize?r.serialize(e,t):{};if(r.serialize){if(t&&i===t[t.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const r in e){if(!e.hasOwnProperty(r))continue;if(Fn[n].omit.indexOf(r)>=0)continue;const A=e[r];i[r]=Fn[n].shallow.indexOf(r)>=0?A:Qn(A,t)}e instanceof Error&&(i.message=e.message)}if(i.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==n&&(i.$name=n),i}throw new Error("can't serialize object of type "+typeof e)}function In(e){if(null==e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||e instanceof Blob||Un(e)||v(e)||ArrayBuffer.isView(e)||e instanceof ImageData)return e;if(Array.isArray(e))return e.map(In);if("object"==typeof e){const t=e.$name||"Object";if(!Fn[t])throw new Error(`can't deserialize unregistered class ${t}`);const{klass:r}=Fn[t];if(!r)throw new Error(`can't deserialize unregistered class ${t}`);if(r.deserialize)return r.deserialize(e);const n=Object.create(r.prototype);for(const r of Object.keys(e)){if("$name"===r)continue;const i=e[r];n[r]=Fn[t].shallow.indexOf(r)>=0?i:In(i)}return n}throw new Error("can't deserialize object of type "+typeof e)}class Tn{constructor(){this.first=!0}update(e,t){const r=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=r,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=r,!0):(this.lastFloorZoom>r?(this.lastIntegerZoom=r+1,this.lastIntegerZoomTime=t):this.lastFloorZoom<r&&(this.lastIntegerZoom=r,this.lastIntegerZoomTime=t),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=r,!0))}}const Sn={"Latin-1 Supplement":e=>e>=128&&e<=255,Arabic:e=>e>=1536&&e<=1791,"Arabic Supplement":e=>e>=1872&&e<=1919,"Arabic Extended-A":e=>e>=2208&&e<=2303,"Hangul Jamo":e=>e>=4352&&e<=4607,"Unified Canadian Aboriginal Syllabics":e=>e>=5120&&e<=5759,Khmer:e=>e>=6016&&e<=6143,"Unified Canadian Aboriginal Syllabics Extended":e=>e>=6320&&e<=6399,"General Punctuation":e=>e>=8192&&e<=8303,"Letterlike Symbols":e=>e>=8448&&e<=8527,"Number Forms":e=>e>=8528&&e<=8591,"Miscellaneous Technical":e=>e>=8960&&e<=9215,"Control Pictures":e=>e>=9216&&e<=9279,"Optical Character Recognition":e=>e>=9280&&e<=9311,"Enclosed Alphanumerics":e=>e>=9312&&e<=9471,"Geometric Shapes":e=>e>=9632&&e<=9727,"Miscellaneous Symbols":e=>e>=9728&&e<=9983,"Miscellaneous Symbols and Arrows":e=>e>=11008&&e<=11263,"CJK Radicals Supplement":e=>e>=11904&&e<=12031,"Kangxi Radicals":e=>e>=12032&&e<=12255,"Ideographic Description Characters":e=>e>=12272&&e<=12287,"CJK Symbols and Punctuation":e=>e>=12288&&e<=12351,Hiragana:e=>e>=12352&&e<=12447,Katakana:e=>e>=12448&&e<=12543,Bopomofo:e=>e>=12544&&e<=12591,"Hangul Compatibility Jamo":e=>e>=12592&&e<=12687,Kanbun:e=>e>=12688&&e<=12703,"Bopomofo Extended":e=>e>=12704&&e<=12735,"CJK Strokes":e=>e>=12736&&e<=12783,"Katakana Phonetic Extensions":e=>e>=12784&&e<=12799,"Enclosed CJK Letters and Months":e=>e>=12800&&e<=13055,"CJK Compatibility":e=>e>=13056&&e<=13311,"CJK Unified Ideographs Extension A":e=>e>=13312&&e<=19903,"Yijing Hexagram Symbols":e=>e>=19904&&e<=19967,"CJK Unified Ideographs":e=>e>=19968&&e<=40959,"Yi Syllables":e=>e>=40960&&e<=42127,"Yi Radicals":e=>e>=42128&&e<=42191,"Hangul Jamo Extended-A":e=>e>=43360&&e<=43391,"Hangul Syllables":e=>e>=44032&&e<=55215,"Hangul Jamo Extended-B":e=>e>=55216&&e<=55295,"Private Use Area":e=>e>=57344&&e<=63743,"CJK Compatibility Ideographs":e=>e>=63744&&e<=64255,"Arabic Presentation Forms-A":e=>e>=64336&&e<=65023,"Vertical Forms":e=>e>=65040&&e<=65055,"CJK Compatibility Forms":e=>e>=65072&&e<=65103,"Small Form Variants":e=>e>=65104&&e<=65135,"Arabic Presentation Forms-B":e=>e>=65136&&e<=65279,"Halfwidth and Fullwidth Forms":e=>e>=65280&&e<=65519};function Mn(e){for(const t of e)if(Ln(t.charCodeAt(0)))return!0;return!1}function kn(e){for(const t of e)if(!Dn(t.charCodeAt(0)))return!1;return!0}function Dn(e){return!(Sn.Arabic(e)||Sn["Arabic Supplement"](e)||Sn["Arabic Extended-A"](e)||Sn["Arabic Presentation Forms-A"](e)||Sn["Arabic Presentation Forms-B"](e))}function Ln(e){return!(746!==e&&747!==e&&(e<4352||!(Sn["Bopomofo Extended"](e)||Sn.Bopomofo(e)||Sn["CJK Compatibility Forms"](e)&&!(e>=65097&&e<=65103)||Sn["CJK Compatibility Ideographs"](e)||Sn["CJK Compatibility"](e)||Sn["CJK Radicals Supplement"](e)||Sn["CJK Strokes"](e)||!(!Sn["CJK Symbols and Punctuation"](e)||e>=12296&&e<=12305||e>=12308&&e<=12319||12336===e)||Sn["CJK Unified Ideographs Extension A"](e)||Sn["CJK Unified Ideographs"](e)||Sn["Enclosed CJK Letters and Months"](e)||Sn["Hangul Compatibility Jamo"](e)||Sn["Hangul Jamo Extended-A"](e)||Sn["Hangul Jamo Extended-B"](e)||Sn["Hangul Jamo"](e)||Sn["Hangul Syllables"](e)||Sn.Hiragana(e)||Sn["Ideographic Description Characters"](e)||Sn.Kanbun(e)||Sn["Kangxi Radicals"](e)||Sn["Katakana Phonetic Extensions"](e)||Sn.Katakana(e)&&12540!==e||!(!Sn["Halfwidth and Fullwidth Forms"](e)||65288===e||65289===e||65293===e||e>=65306&&e<=65310||65339===e||65341===e||65343===e||e>=65371&&e<=65503||65507===e||e>=65512&&e<=65519)||!(!Sn["Small Form Variants"](e)||e>=65112&&e<=65118||e>=65123&&e<=65126)||Sn["Unified Canadian Aboriginal Syllabics"](e)||Sn["Unified Canadian Aboriginal Syllabics Extended"](e)||Sn["Vertical Forms"](e)||Sn["Yijing Hexagram Symbols"](e)||Sn["Yi Syllables"](e)||Sn["Yi Radicals"](e))))}function Pn(e){return!(Ln(e)||function(e){return!!(Sn["Latin-1 Supplement"](e)&&(167===e||169===e||174===e||177===e||188===e||189===e||190===e||215===e||247===e)||Sn["General Punctuation"](e)&&(8214===e||8224===e||8225===e||8240===e||8241===e||8251===e||8252===e||8258===e||8263===e||8264===e||8265===e||8273===e)||Sn["Letterlike Symbols"](e)||Sn["Number Forms"](e)||Sn["Miscellaneous Technical"](e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||9003===e||e>=9085&&e<=9114||e>=9150&&e<=9165||9167===e||e>=9169&&e<=9179||e>=9186&&e<=9215)||Sn["Control Pictures"](e)&&9251!==e||Sn["Optical Character Recognition"](e)||Sn["Enclosed Alphanumerics"](e)||Sn["Geometric Shapes"](e)||Sn["Miscellaneous Symbols"](e)&&!(e>=9754&&e<=9759)||Sn["Miscellaneous Symbols and Arrows"](e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||Sn["CJK Symbols and Punctuation"](e)||Sn.Katakana(e)||Sn["Private Use Area"](e)||Sn["CJK Compatibility Forms"](e)||Sn["Small Form Variants"](e)||Sn["Halfwidth and Fullwidth Forms"](e)||8734===e||8756===e||8757===e||e>=9984&&e<=10087||e>=10102&&e<=10131||65532===e||65533===e)}(e))}function Hn(e){return e>=1424&&e<=2303||Sn["Arabic Presentation Forms-A"](e)||Sn["Arabic Presentation Forms-B"](e)}function zn(e,t){return!(!t&&Hn(e)||e>=2304&&e<=3583||e>=3840&&e<=4255||Sn.Khmer(e))}function Rn(e){for(const t of e)if(Hn(t.charCodeAt(0)))return!0;return!1}const On="deferred",Kn="loading",Vn="loaded";let $n=null,Nn="unavailable",Gn=null;const qn=function(e){e&&"string"==typeof e&&e.indexOf("NetworkError")>-1&&(Nn="error"),$n&&$n(e)};function Xn(){jn.fire(new ee("pluginStateChange",{pluginStatus:Nn,pluginURL:Gn}))}const jn=new re,Zn=function(){return Nn},Jn=function(){if(Nn!==On||!Gn)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Nn=Kn,Xn(),Gn&&G({url:Gn},(e=>{e?qn(e):(Nn=Vn,Xn())}))},Wn={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Nn===Vn||null!=Wn.applyArabicShaping,isLoading:()=>Nn===Kn,setState(e){if(!g())throw new Error("Cannot set the state of the rtl-text-plugin when not in the web-worker context");Nn=e.pluginStatus,Gn=e.pluginURL},isParsed(){if(!g())throw new Error("rtl-text-plugin is only parsed on the worker-threads");return null!=Wn.applyArabicShaping&&null!=Wn.processBidirectionalText&&null!=Wn.processStyledBidirectionalText},getPluginURL(){if(!g())throw new Error("rtl-text-plugin url can only be queried from the worker threads");return Gn}};class Yn{constructor(e,t){this.zoom=e,t?(this.now=t.now,this.fadeDuration=t.fadeDuration,this.zoomHistory=t.zoomHistory,this.transition=t.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Tn,this.transition={})}isSupportedScript(e){return function(e,t){for(const r of e)if(!zn(r.charCodeAt(0),t))return!1;return!0}(e,Wn.isLoaded())}crossFadingFactor(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const e=this.zoom,t=e-Math.floor(e),r=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:t+(1-t)*r}:{fromScale:.5,toScale:1,t:1-(1-r)*t}}}class ei{constructor(e,t){this.property=e,this.value=t,this.expression=function(e,t){if(br(e))return new Hr(e,t);if(Mr(e)){const r=Pr(e,t);if("error"===r.result)throw new Error(r.value.map((e=>`${e.key}: ${e.message}`)).join(", "));return r.value}{let r=e;return"color"===t.type&&"string"==typeof e?r=ke.parse(e):"padding"!==t.type||"number"!=typeof e&&!Array.isArray(e)||(r=He.parse(e)),{kind:"constant",evaluate:()=>r}}}(void 0===t?e.specification.default:t,e.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(e,t,r){return this.property.possiblyEvaluate(this,e,t,r)}}class ti{constructor(e){this.property=e,this.value=new ei(e,void 0)}transitioned(e,t){return new ni(this.property,this.value,t,s({},e.transition,this.transition),e.now)}untransitioned(){return new ni(this.property,this.value,null,{},0)}}class ri{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return h(this._values[e].value.value)}setValue(e,t){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new ti(this._values[e].property)),this._values[e].value=new ei(this._values[e].property,null===t?void 0:h(t))}getTransition(e){return h(this._values[e].transition)}setTransition(e,t){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new ti(this._values[e].property)),this._values[e].transition=h(t)||void 0}serialize(){const e={};for(const t of Object.keys(this._values)){const r=this.getValue(t);void 0!==r&&(e[t]=r);const n=this.getTransition(t);void 0!==n&&(e[`${t}-transition`]=n)}return e}transitioned(e,t){const r=new ii(this._properties);for(const n of Object.keys(this._values))r._values[n]=this._values[n].transitioned(e,t._values[n]);return r}untransitioned(){const e=new ii(this._properties);for(const t of Object.keys(this._values))e._values[t]=this._values[t].untransitioned();return e}}class ni{constructor(e,t,r,n,i){this.property=e,this.value=t,this.begin=i+n.delay||0,this.end=this.begin+n.duration||0,e.specification.transition&&(n.delay||n.duration)&&(this.prior=r)}possiblyEvaluate(e,t,r){const n=e.now||0,i=this.value.possiblyEvaluate(e,t,r),A=this.prior;if(A){if(n>this.end)return this.prior=null,i;if(this.value.isDataDriven())return this.prior=null,i;if(n<this.begin)return A.possiblyEvaluate(e,t,r);{const o=(n-this.begin)/(this.end-this.begin);return this.property.interpolate(A.possiblyEvaluate(e,t,r),i,function(e){if(e<=0)return 0;if(e>=1)return 1;const t=e*e,r=t*e;return 4*(e<.5?r:3*(e-t)+r-.75)}(o))}}return i}}class ii{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,t,r){const n=new si(this._properties);for(const i of Object.keys(this._values))n._values[i]=this._values[i].possiblyEvaluate(e,t,r);return n}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class Ai{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}getValue(e){return h(this._values[e].value)}setValue(e,t){this._values[e]=new ei(this._values[e].property,null===t?void 0:h(t))}serialize(){const e={};for(const t of Object.keys(this._values)){const r=this.getValue(t);void 0!==r&&(e[t]=r)}return e}possiblyEvaluate(e,t,r){const n=new si(this._properties);for(const i of Object.keys(this._values))n._values[i]=this._values[i].possiblyEvaluate(e,t,r);return n}}class oi{constructor(e,t,r){this.property=e,this.value=t,this.parameters=r}isConstant(){return"constant"===this.value.kind}constantOr(e){return"constant"===this.value.kind?this.value.value:e}evaluate(e,t,r,n){return this.property.evaluate(this.value,this.parameters,e,t,r,n)}}class si{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class ai{constructor(e){this.specification=e}possiblyEvaluate(e,t){if(e.isDataDriven())throw new Error("Value should not be data driven");return e.expression.evaluate(t)}interpolate(e,t,r){const n=Ft[this.specification.type];return n?n(e,t,r):e}}class li{constructor(e,t){this.specification=e,this.overrides=t}possiblyEvaluate(e,t,r,n){return new oi(this,"constant"===e.expression.kind||"camera"===e.expression.kind?{kind:"constant",value:e.expression.evaluate(t,null,{},r,n)}:e.expression,t)}interpolate(e,t,r){if("constant"!==e.value.kind||"constant"!==t.value.kind)return e;if(void 0===e.value.value||void 0===t.value.value)return new oi(this,{kind:"constant",value:void 0},e.parameters);const n=Ft[this.specification.type];return n?new oi(this,{kind:"constant",value:n(e.value.value,t.value.value,r)},e.parameters):e}evaluate(e,t,r,n,i,A){return"constant"===e.kind?e.value:e.evaluate(t,r,n,i,A)}}class ci extends li{possiblyEvaluate(e,t,r,n){if(void 0===e.value)return new oi(this,{kind:"constant",value:void 0},t);if("constant"===e.expression.kind){const i=e.expression.evaluate(t,null,{},r,n),A="resolvedImage"===e.property.specification.type&&"string"!=typeof i?i.name:i,o=this._calculate(A,A,A,t);return new oi(this,{kind:"constant",value:o},t)}if("camera"===e.expression.kind){const r=this._calculate(e.expression.evaluate({zoom:t.zoom-1}),e.expression.evaluate({zoom:t.zoom}),e.expression.evaluate({zoom:t.zoom+1}),t);return new oi(this,{kind:"constant",value:r},t)}return new oi(this,e.expression,t)}evaluate(e,t,r,n,i,A){if("source"===e.kind){const o=e.evaluate(t,r,n,i,A);return this._calculate(o,o,o,t)}return"composite"===e.kind?this._calculate(e.evaluate({zoom:Math.floor(t.zoom)-1},r,n),e.evaluate({zoom:Math.floor(t.zoom)},r,n),e.evaluate({zoom:Math.floor(t.zoom)+1},r,n),t):e.value}_calculate(e,t,r,n){return n.zoom>n.zoomHistory.lastIntegerZoom?{from:e,to:t}:{from:r,to:t}}interpolate(e){return e}}class ui{constructor(e){this.specification=e}possiblyEvaluate(e,t,r,n){if(void 0!==e.value){if("constant"===e.expression.kind){const i=e.expression.evaluate(t,null,{},r,n);return this._calculate(i,i,i,t)}return this._calculate(e.expression.evaluate(new Yn(Math.floor(t.zoom-1),t)),e.expression.evaluate(new Yn(Math.floor(t.zoom),t)),e.expression.evaluate(new Yn(Math.floor(t.zoom+1),t)),t)}}_calculate(e,t,r,n){return n.zoom>n.zoomHistory.lastIntegerZoom?{from:e,to:t}:{from:r,to:t}}interpolate(e){return e}}class hi{constructor(e){this.specification=e}possiblyEvaluate(e,t,r,n){return!!e.expression.evaluate(t,null,{},r,n)}interpolate(){return!1}}class di{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const t in e){const r=e[t];r.specification.overridable&&this.overridableProperties.push(t);const n=this.defaultPropertyValues[t]=new ei(r,void 0),i=this.defaultTransitionablePropertyValues[t]=new ti(r);this.defaultTransitioningPropertyValues[t]=i.untransitioned(),this.defaultPossiblyEvaluatedValues[t]=n.possiblyEvaluate({})}}}En("DataDrivenProperty",li),En("DataConstantProperty",ai),En("CrossFadedDataDrivenProperty",ci),En("CrossFadedProperty",ui),En("ColorRampProperty",hi);const pi="-transition";class fi extends re{constructor(e,t){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1},"custom"!==e.type&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,"background"!==e.type&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),t.layout&&(this._unevaluatedLayout=new Ai(t.layout)),t.paint)){this._transitionablePaint=new ri(t.paint);for(const t in e.paint)this.setPaintProperty(t,e.paint[t],{validate:!1});for(const t in e.layout)this.setLayoutProperty(t,e.layout[t],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new si(t.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(e){return"visibility"===e?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,t,r={}){null!=t&&this._validate(vn,`layers.${this.id}.layout.${e}`,e,t,r)||("visibility"!==e?this._unevaluatedLayout.setValue(e,t):this.visibility=t)}getPaintProperty(e){return e.endsWith(pi)?this._transitionablePaint.getTransition(e.slice(0,-pi.length)):this._transitionablePaint.getValue(e)}setPaintProperty(e,t,r={}){if(null!=t&&this._validate(Bn,`layers.${this.id}.paint.${e}`,e,t,r))return!1;if(e.endsWith(pi))return this._transitionablePaint.setTransition(e.slice(0,-pi.length),t||void 0),!1;{const r=this._transitionablePaint._values[e],n="cross-faded-data-driven"===r.property.specification["property-type"],i=r.value.isDataDriven(),A=r.value;this._transitionablePaint.setValue(e,t),this._handleSpecialPaintPropertyUpdate(e);const o=this._transitionablePaint._values[e].value;return o.isDataDriven()||i||n||this._handleOverridablePaintPropertyUpdate(e,A,o)}}_handleSpecialPaintPropertyUpdate(e){}_handleOverridablePaintPropertyUpdate(e,t,r){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||"none"===this.visibility}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,t){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,t)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,t)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),u(e,((e,t)=>!(void 0===e||"layout"===t&&!Object.keys(e).length||"paint"===t&&!Object.keys(e).length)))}_validate(e,t,r,n,i={}){return(!i||!1!==i.validate)&&bn(this,e.call(wn,{key:t,layerType:this.type,objectKey:r,value:n,styleSpec:ne,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const t=this.paint.get(e);if(t instanceof oi&&wr(t.property.specification)&&("source"===t.value.kind||"composite"===t.value.kind)&&t.value.isStateDependent)return!0}return!1}}const mi={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class gi{constructor(e,t){this._structArray=e,this._pos1=t*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class yi{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,t){return e._trim(),t&&(e.isTransferred=!0,t.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const t=Object.create(this.prototype);return t.arrayBuffer=e.arrayBuffer,t.length=e.length,t.capacity=e.arrayBuffer.byteLength/t.bytesPerElement,t._refreshViews(),t}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const t=this.uint8;this._refreshViews(),t&&this.uint8.set(t)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function _i(e,t=1){let r=0,n=0;return{members:e.map((e=>{const i=mi[e.type].BYTES_PER_ELEMENT,A=r=wi(r,Math.max(t,i)),o=e.components||1;return n=Math.max(n,i),r+=i*o,{name:e.name,type:e.type,components:o,offset:A}})),size:wi(r,Math.max(n,t)),alignment:t}}function wi(e,t){return Math.ceil(e/t)*t}class xi extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t){const r=this.length;return this.resize(r+1),this.emplace(r,e,t)}emplace(e,t,r){const n=2*e;return this.int16[n+0]=t,this.int16[n+1]=r,e}}xi.prototype.bytesPerElement=4,En("StructArrayLayout2i4",xi);class Bi extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,r,n){const i=this.length;return this.resize(i+1),this.emplace(i,e,t,r,n)}emplace(e,t,r,n,i){const A=4*e;return this.int16[A+0]=t,this.int16[A+1]=r,this.int16[A+2]=n,this.int16[A+3]=i,e}}Bi.prototype.bytesPerElement=8,En("StructArrayLayout4i8",Bi);class vi extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i,A){const o=this.length;return this.resize(o+1),this.emplace(o,e,t,r,n,i,A)}emplace(e,t,r,n,i,A,o){const s=6*e;return this.int16[s+0]=t,this.int16[s+1]=r,this.int16[s+2]=n,this.int16[s+3]=i,this.int16[s+4]=A,this.int16[s+5]=o,e}}vi.prototype.bytesPerElement=12,En("StructArrayLayout2i4i12",vi);class bi extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i,A){const o=this.length;return this.resize(o+1),this.emplace(o,e,t,r,n,i,A)}emplace(e,t,r,n,i,A,o){const s=4*e,a=8*e;return this.int16[s+0]=t,this.int16[s+1]=r,this.uint8[a+4]=n,this.uint8[a+5]=i,this.uint8[a+6]=A,this.uint8[a+7]=o,e}}bi.prototype.bytesPerElement=8,En("StructArrayLayout2i4ub8",bi);class Ci extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t){const r=this.length;return this.resize(r+1),this.emplace(r,e,t)}emplace(e,t,r){const n=2*e;return this.float32[n+0]=t,this.float32[n+1]=r,e}}Ci.prototype.bytesPerElement=8,En("StructArrayLayout2f8",Ci);class Fi extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i,A,o,s,a,l){const c=this.length;return this.resize(c+1),this.emplace(c,e,t,r,n,i,A,o,s,a,l)}emplace(e,t,r,n,i,A,o,s,a,l,c){const u=10*e;return this.uint16[u+0]=t,this.uint16[u+1]=r,this.uint16[u+2]=n,this.uint16[u+3]=i,this.uint16[u+4]=A,this.uint16[u+5]=o,this.uint16[u+6]=s,this.uint16[u+7]=a,this.uint16[u+8]=l,this.uint16[u+9]=c,e}}Fi.prototype.bytesPerElement=20,En("StructArrayLayout10ui20",Fi);class Ei extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i,A,o,s,a,l,c,u){const h=this.length;return this.resize(h+1),this.emplace(h,e,t,r,n,i,A,o,s,a,l,c,u)}emplace(e,t,r,n,i,A,o,s,a,l,c,u,h){const d=12*e;return this.int16[d+0]=t,this.int16[d+1]=r,this.int16[d+2]=n,this.int16[d+3]=i,this.uint16[d+4]=A,this.uint16[d+5]=o,this.uint16[d+6]=s,this.uint16[d+7]=a,this.int16[d+8]=l,this.int16[d+9]=c,this.int16[d+10]=u,this.int16[d+11]=h,e}}Ei.prototype.bytesPerElement=24,En("StructArrayLayout4i4ui4i24",Ei);class Ui extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,r){const n=this.length;return this.resize(n+1),this.emplace(n,e,t,r)}emplace(e,t,r,n){const i=3*e;return this.float32[i+0]=t,this.float32[i+1]=r,this.float32[i+2]=n,e}}Ui.prototype.bytesPerElement=12,En("StructArrayLayout3f12",Ui);class Qi extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const t=this.length;return this.resize(t+1),this.emplace(t,e)}emplace(e,t){return this.uint32[1*e+0]=t,e}}Qi.prototype.bytesPerElement=4,En("StructArrayLayout1ul4",Qi);class Ii extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i,A,o,s,a){const l=this.length;return this.resize(l+1),this.emplace(l,e,t,r,n,i,A,o,s,a)}emplace(e,t,r,n,i,A,o,s,a,l){const c=10*e,u=5*e;return this.int16[c+0]=t,this.int16[c+1]=r,this.int16[c+2]=n,this.int16[c+3]=i,this.int16[c+4]=A,this.int16[c+5]=o,this.uint32[u+3]=s,this.uint16[c+8]=a,this.uint16[c+9]=l,e}}Ii.prototype.bytesPerElement=20,En("StructArrayLayout6i1ul2ui20",Ii);class Ti extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i,A){const o=this.length;return this.resize(o+1),this.emplace(o,e,t,r,n,i,A)}emplace(e,t,r,n,i,A,o){const s=6*e;return this.int16[s+0]=t,this.int16[s+1]=r,this.int16[s+2]=n,this.int16[s+3]=i,this.int16[s+4]=A,this.int16[s+5]=o,e}}Ti.prototype.bytesPerElement=12,En("StructArrayLayout2i2i2i12",Ti);class Si extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i){const A=this.length;return this.resize(A+1),this.emplace(A,e,t,r,n,i)}emplace(e,t,r,n,i,A){const o=4*e,s=8*e;return this.float32[o+0]=t,this.float32[o+1]=r,this.float32[o+2]=n,this.int16[s+6]=i,this.int16[s+7]=A,e}}Si.prototype.bytesPerElement=16,En("StructArrayLayout2f1f2i16",Si);class Mi extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,r,n){const i=this.length;return this.resize(i+1),this.emplace(i,e,t,r,n)}emplace(e,t,r,n,i){const A=12*e,o=3*e;return this.uint8[A+0]=t,this.uint8[A+1]=r,this.float32[o+1]=n,this.float32[o+2]=i,e}}Mi.prototype.bytesPerElement=12,En("StructArrayLayout2ub2f12",Mi);class ki extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,r){const n=this.length;return this.resize(n+1),this.emplace(n,e,t,r)}emplace(e,t,r,n){const i=3*e;return this.uint16[i+0]=t,this.uint16[i+1]=r,this.uint16[i+2]=n,e}}ki.prototype.bytesPerElement=6,En("StructArrayLayout3ui6",ki);class Di extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i,A,o,s,a,l,c,u,h,d,p,f,m){const g=this.length;return this.resize(g+1),this.emplace(g,e,t,r,n,i,A,o,s,a,l,c,u,h,d,p,f,m)}emplace(e,t,r,n,i,A,o,s,a,l,c,u,h,d,p,f,m,g){const y=24*e,_=12*e,w=48*e;return this.int16[y+0]=t,this.int16[y+1]=r,this.uint16[y+2]=n,this.uint16[y+3]=i,this.uint32[_+2]=A,this.uint32[_+3]=o,this.uint32[_+4]=s,this.uint16[y+10]=a,this.uint16[y+11]=l,this.uint16[y+12]=c,this.float32[_+7]=u,this.float32[_+8]=h,this.uint8[w+36]=d,this.uint8[w+37]=p,this.uint8[w+38]=f,this.uint32[_+10]=m,this.int16[y+22]=g,e}}Di.prototype.bytesPerElement=48,En("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Di);class Li extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i,A,o,s,a,l,c,u,h,d,p,f,m,g,y,_,w,x,B,v,b,C,F,E){const U=this.length;return this.resize(U+1),this.emplace(U,e,t,r,n,i,A,o,s,a,l,c,u,h,d,p,f,m,g,y,_,w,x,B,v,b,C,F,E)}emplace(e,t,r,n,i,A,o,s,a,l,c,u,h,d,p,f,m,g,y,_,w,x,B,v,b,C,F,E,U){const Q=34*e,I=17*e;return this.int16[Q+0]=t,this.int16[Q+1]=r,this.int16[Q+2]=n,this.int16[Q+3]=i,this.int16[Q+4]=A,this.int16[Q+5]=o,this.int16[Q+6]=s,this.int16[Q+7]=a,this.uint16[Q+8]=l,this.uint16[Q+9]=c,this.uint16[Q+10]=u,this.uint16[Q+11]=h,this.uint16[Q+12]=d,this.uint16[Q+13]=p,this.uint16[Q+14]=f,this.uint16[Q+15]=m,this.uint16[Q+16]=g,this.uint16[Q+17]=y,this.uint16[Q+18]=_,this.uint16[Q+19]=w,this.uint16[Q+20]=x,this.uint16[Q+21]=B,this.uint16[Q+22]=v,this.uint32[I+12]=b,this.float32[I+13]=C,this.float32[I+14]=F,this.float32[I+15]=E,this.float32[I+16]=U,e}}Li.prototype.bytesPerElement=68,En("StructArrayLayout8i15ui1ul4f68",Li);class Pi extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const t=this.length;return this.resize(t+1),this.emplace(t,e)}emplace(e,t){return this.float32[1*e+0]=t,e}}Pi.prototype.bytesPerElement=4,En("StructArrayLayout1f4",Pi);class Hi extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,r){const n=this.length;return this.resize(n+1),this.emplace(n,e,t,r)}emplace(e,t,r,n){const i=3*e;return this.int16[i+0]=t,this.int16[i+1]=r,this.int16[i+2]=n,e}}Hi.prototype.bytesPerElement=6,En("StructArrayLayout3i6",Hi);class zi extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,r){const n=this.length;return this.resize(n+1),this.emplace(n,e,t,r)}emplace(e,t,r,n){const i=4*e;return this.uint32[2*e+0]=t,this.uint16[i+2]=r,this.uint16[i+3]=n,e}}zi.prototype.bytesPerElement=8,En("StructArrayLayout1ul2ui8",zi);class Ri extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t){const r=this.length;return this.resize(r+1),this.emplace(r,e,t)}emplace(e,t,r){const n=2*e;return this.uint16[n+0]=t,this.uint16[n+1]=r,e}}Ri.prototype.bytesPerElement=4,En("StructArrayLayout2ui4",Ri);class Oi extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const t=this.length;return this.resize(t+1),this.emplace(t,e)}emplace(e,t){return this.uint16[1*e+0]=t,e}}Oi.prototype.bytesPerElement=2,En("StructArrayLayout1ui2",Oi);class Ki extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,r,n){const i=this.length;return this.resize(i+1),this.emplace(i,e,t,r,n)}emplace(e,t,r,n,i){const A=4*e;return this.float32[A+0]=t,this.float32[A+1]=r,this.float32[A+2]=n,this.float32[A+3]=i,e}}Ki.prototype.bytesPerElement=16,En("StructArrayLayout4f16",Ki);class Vi extends gi{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new C(this.anchorPointX,this.anchorPointY)}}Vi.prototype.size=20;class $i extends Ii{get(e){return new Vi(this,e)}}En("CollisionBoxArray",$i);class Ni extends gi{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(e){this._structArray.uint8[this._pos1+37]=e}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(e){this._structArray.uint8[this._pos1+38]=e}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(e){this._structArray.uint32[this._pos4+10]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}Ni.prototype.size=48;class Gi extends Di{get(e){return new Ni(this,e)}}En("PlacedSymbolArray",Gi);class qi extends gi{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(e){this._structArray.uint32[this._pos4+12]=e}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get textOffset0(){return this._structArray.float32[this._pos4+14]}get textOffset1(){return this._structArray.float32[this._pos4+15]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+16]}}qi.prototype.size=68;class Xi extends Li{get(e){return new qi(this,e)}}En("SymbolInstanceArray",Xi);class ji extends Pi{getoffsetX(e){return this.float32[1*e+0]}}En("GlyphOffsetArray",ji);class Zi extends Hi{getx(e){return this.int16[3*e+0]}gety(e){return this.int16[3*e+1]}gettileUnitDistanceFromAnchor(e){return this.int16[3*e+2]}}En("SymbolLineVertexArray",Zi);class Ji extends gi{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}Ji.prototype.size=8;class Wi extends zi{get(e){return new Ji(this,e)}}En("FeatureIndexArray",Wi);class Yi extends xi{}class eA extends xi{}class tA extends xi{}class rA extends vi{}class nA extends bi{}class iA extends Ci{}class AA extends Fi{}class oA extends Ei{}class sA extends Ui{}class aA extends Qi{}class lA extends Ti{}class cA extends Mi{}class uA extends ki{}class hA extends Ri{}const dA=_i([{name:"a_pos",components:2,type:"Int16"}],4),{members:pA}=dA;class fA{constructor(e=[]){this.segments=e}prepareSegment(e,t,r,n){let i=this.segments[this.segments.length-1];return e>fA.MAX_VERTEX_ARRAY_LENGTH&&p(`Max vertices per segment is ${fA.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!i||i.vertexLength+e>fA.MAX_VERTEX_ARRAY_LENGTH||i.sortKey!==n)&&(i={vertexOffset:t.length,primitiveOffset:r.length,vertexLength:0,primitiveLength:0},void 0!==n&&(i.sortKey=n),this.segments.push(i)),i}get(){return this.segments}destroy(){for(const e of this.segments)for(const t in e.vaos)e.vaos[t].destroy()}static simpleSegment(e,t,r,n){return new fA([{vertexOffset:e,primitiveOffset:t,vertexLength:r,primitiveLength:n,vaos:{},sortKey:0}])}}function mA(e,t){return 256*(e=A(Math.floor(e),0,255))+A(Math.floor(t),0,255)}fA.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,En("SegmentVector",fA);const gA=_i([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var yA={exports:{}},_A={exports:{}};_A.exports=function(e,t){var r,n,i,A,o,s,a,l;for(n=e.length-(r=3&e.length),i=t,o=3432918353,s=461845907,l=0;l<n;)a=255&e.charCodeAt(l)|(255&e.charCodeAt(++l))<<8|(255&e.charCodeAt(++l))<<16|(255&e.charCodeAt(++l))<<24,++l,i=27492+(65535&(A=5*(65535&(i=(i^=a=(65535&(a=(a=(65535&a)*o+(((a>>>16)*o&65535)<<16)&4294967295)<<15|a>>>17))*s+(((a>>>16)*s&65535)<<16)&4294967295)<<13|i>>>19))+((5*(i>>>16)&65535)<<16)&4294967295))+((58964+(A>>>16)&65535)<<16);switch(a=0,r){case 3:a^=(255&e.charCodeAt(l+2))<<16;case 2:a^=(255&e.charCodeAt(l+1))<<8;case 1:i^=a=(65535&(a=(a=(65535&(a^=255&e.charCodeAt(l)))*o+(((a>>>16)*o&65535)<<16)&4294967295)<<15|a>>>17))*s+(((a>>>16)*s&65535)<<16)&4294967295}return i^=e.length,i=2246822507*(65535&(i^=i>>>16))+((2246822507*(i>>>16)&65535)<<16)&4294967295,i=3266489909*(65535&(i^=i>>>13))+((3266489909*(i>>>16)&65535)<<16)&4294967295,(i^=i>>>16)>>>0};var wA={exports:{}};wA.exports=function(e,t){for(var r,n=e.length,i=t^n,A=0;n>=4;)r=1540483477*(65535&(r=255&e.charCodeAt(A)|(255&e.charCodeAt(++A))<<8|(255&e.charCodeAt(++A))<<16|(255&e.charCodeAt(++A))<<24))+((1540483477*(r>>>16)&65535)<<16),i=1540483477*(65535&i)+((1540483477*(i>>>16)&65535)<<16)^(r=1540483477*(65535&(r^=r>>>24))+((1540483477*(r>>>16)&65535)<<16)),n-=4,++A;switch(n){case 3:i^=(255&e.charCodeAt(A+2))<<16;case 2:i^=(255&e.charCodeAt(A+1))<<8;case 1:i=1540483477*(65535&(i^=255&e.charCodeAt(A)))+((1540483477*(i>>>16)&65535)<<16)}return i=1540483477*(65535&(i^=i>>>13))+((1540483477*(i>>>16)&65535)<<16),(i^=i>>>15)>>>0};var xA=_A.exports,BA=wA.exports;yA.exports=xA,yA.exports.murmur3=xA,yA.exports.murmur2=BA;class vA{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,t,r,n){this.ids.push(bA(e)),this.positions.push(t,r,n)}getPositions(e){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const t=bA(e);let r=0,n=this.ids.length-1;for(;r<n;){const e=r+n>>1;this.ids[e]>=t?n=e:r=e+1}const i=[];for(;this.ids[r]===t;)i.push({index:this.positions[3*r],start:this.positions[3*r+1],end:this.positions[3*r+2]}),r++;return i}static serialize(e,t){const r=new Float64Array(e.ids),n=new Uint32Array(e.positions);return CA(r,n,0,r.length-1),t&&t.push(r.buffer,n.buffer),{ids:r,positions:n}}static deserialize(e){const t=new vA;return t.ids=e.ids,t.positions=e.positions,t.indexed=!0,t}}function bA(e){const t=+e;return!isNaN(t)&&t<=Number.MAX_SAFE_INTEGER?t:yA.exports(String(e))}function CA(e,t,r,n){for(;r<n;){const i=e[r+n>>1];let A=r-1,o=n+1;for(;;){do{A++}while(e[A]<i);do{o--}while(e[o]>i);if(A>=o)break;FA(e,A,o),FA(t,3*A,3*o),FA(t,3*A+1,3*o+1),FA(t,3*A+2,3*o+2)}o-r<n-o?(CA(e,t,r,o),r=o+1):(CA(e,t,o+1,n),n=o)}}function FA(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}En("FeaturePositionMap",vA);class EA{constructor(e,t){this.gl=e.gl,this.location=t}}class UA extends EA{constructor(e,t){super(e,t),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1f(this.location,e))}}class QA extends EA{constructor(e,t){super(e,t),this.current=[0,0,0,0]}set(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]&&e[3]===this.current[3]||(this.current=e,this.gl.uniform4f(this.location,e[0],e[1],e[2],e[3]))}}class IA extends EA{constructor(e,t){super(e,t),this.current=ke.transparent}set(e){e.r===this.current.r&&e.g===this.current.g&&e.b===this.current.b&&e.a===this.current.a||(this.current=e,this.gl.uniform4f(this.location,e.r,e.g,e.b,e.a))}}const TA=new Float32Array(16);function SA(e){return[mA(255*e.r,255*e.g),mA(255*e.b,255*e.a)]}class MA{constructor(e,t,r){this.value=e,this.uniformNames=t.map((e=>`u_${e}`)),this.type=r}setUniform(e,t,r){e.set(r.constantOr(this.value))}getBinding(e,t,r){return"color"===this.type?new IA(e,t):new UA(e,t)}}class kA{constructor(e,t){this.uniformNames=t.map((e=>`u_${e}`)),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(e,t){this.pixelRatioFrom=t.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=t.tlbr,this.patternTo=e.tlbr}setUniform(e,t,r,n){const i="u_pattern_to"===n?this.patternTo:"u_pattern_from"===n?this.patternFrom:"u_pixel_ratio_to"===n?this.pixelRatioTo:"u_pixel_ratio_from"===n?this.pixelRatioFrom:null;i&&e.set(i)}getBinding(e,t,r){return"u_pattern"===r.substr(0,9)?new QA(e,t):new UA(e,t)}}class DA{constructor(e,t,r,n){this.expression=e,this.type=r,this.maxValue=0,this.paintVertexAttributes=t.map((e=>({name:`a_${e}`,type:"Float32",components:"color"===r?2:1,offset:0}))),this.paintVertexArray=new n}populatePaintArray(e,t,r,n,i){const A=this.paintVertexArray.length,o=this.expression.evaluate(new Yn(0),t,{},n,[],i);this.paintVertexArray.resize(e),this._setPaintValue(A,e,o)}updatePaintArray(e,t,r,n){const i=this.expression.evaluate({zoom:0},r,n);this._setPaintValue(e,t,i)}_setPaintValue(e,t,r){if("color"===this.type){const n=SA(r);for(let r=e;r<t;r++)this.paintVertexArray.emplace(r,n[0],n[1])}else{for(let n=e;n<t;n++)this.paintVertexArray.emplace(n,r);this.maxValue=Math.max(this.maxValue,Math.abs(r))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class LA{constructor(e,t,r,n,i,A){this.expression=e,this.uniformNames=t.map((e=>`u_${e}_t`)),this.type=r,this.useIntegerZoom=n,this.zoom=i,this.maxValue=0,this.paintVertexAttributes=t.map((e=>({name:`a_${e}`,type:"Float32",components:"color"===r?4:2,offset:0}))),this.paintVertexArray=new A}populatePaintArray(e,t,r,n,i){const A=this.expression.evaluate(new Yn(this.zoom),t,{},n,[],i),o=this.expression.evaluate(new Yn(this.zoom+1),t,{},n,[],i),s=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(s,e,A,o)}updatePaintArray(e,t,r,n){const i=this.expression.evaluate({zoom:this.zoom},r,n),A=this.expression.evaluate({zoom:this.zoom+1},r,n);this._setPaintValue(e,t,i,A)}_setPaintValue(e,t,r,n){if("color"===this.type){const i=SA(r),A=SA(n);for(let r=e;r<t;r++)this.paintVertexArray.emplace(r,i[0],i[1],A[0],A[1])}else{for(let i=e;i<t;i++)this.paintVertexArray.emplace(i,r,n);this.maxValue=Math.max(this.maxValue,Math.abs(r),Math.abs(n))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,t){const r=this.useIntegerZoom?Math.floor(t.zoom):t.zoom,n=A(this.expression.interpolationFactor(r,this.zoom,this.zoom+1),0,1);e.set(n)}getBinding(e,t,r){return new UA(e,t)}}class PA{constructor(e,t,r,n,i,A){this.expression=e,this.type=t,this.useIntegerZoom=r,this.zoom=n,this.layerId=A,this.zoomInPaintVertexArray=new i,this.zoomOutPaintVertexArray=new i}populatePaintArray(e,t,r){const n=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(n,e,t.patterns&&t.patterns[this.layerId],r)}updatePaintArray(e,t,r,n,i){this._setPaintValues(e,t,r.patterns&&r.patterns[this.layerId],i)}_setPaintValues(e,t,r,n){if(!n||!r)return;const{min:i,mid:A,max:o}=r,s=n[i],a=n[A],l=n[o];if(s&&a&&l)for(let r=e;r<t;r++)this.zoomInPaintVertexArray.emplace(r,a.tl[0],a.tl[1],a.br[0],a.br[1],s.tl[0],s.tl[1],s.br[0],s.br[1],a.pixelRatio,s.pixelRatio),this.zoomOutPaintVertexArray.emplace(r,a.tl[0],a.tl[1],a.br[0],a.br[1],l.tl[0],l.tl[1],l.br[0],l.br[1],a.pixelRatio,l.pixelRatio)}upload(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,gA.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,gA.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class HA{constructor(e,t,r){this.binders={},this._buffers=[];const n=[];for(const i in e.paint._values){if(!r(i))continue;const A=e.paint.get(i);if(!(A instanceof oi&&wr(A.property.specification)))continue;const o=RA(i,e.type),s=A.value,a=A.property.specification.type,l=A.property.useIntegerZoom,c=A.property.specification["property-type"],u="cross-faded"===c||"cross-faded-data-driven"===c;if("constant"===s.kind)this.binders[i]=u?new kA(s.value,o):new MA(s.value,o,a),n.push(`/u_${i}`);else if("source"===s.kind||u){const r=OA(i,a,"source");this.binders[i]=u?new PA(s,a,l,t,r,e.id):new DA(s,o,a,r),n.push(`/a_${i}`)}else{const e=OA(i,a,"composite");this.binders[i]=new LA(s,o,a,l,t,e),n.push(`/z_${i}`)}}this.cacheKey=n.sort().join("")}getMaxValue(e){const t=this.binders[e];return t instanceof DA||t instanceof LA?t.maxValue:0}populatePaintArrays(e,t,r,n,i){for(const A in this.binders){const o=this.binders[A];(o instanceof DA||o instanceof LA||o instanceof PA)&&o.populatePaintArray(e,t,r,n,i)}}setConstantPatternPositions(e,t){for(const r in this.binders){const n=this.binders[r];n instanceof kA&&n.setConstantPatternPositions(e,t)}}updatePaintArrays(e,t,r,n,i){let A=!1;for(const o in e){const s=t.getPositions(o);for(const t of s){const s=r.feature(t.index);for(const r in this.binders){const a=this.binders[r];if((a instanceof DA||a instanceof LA||a instanceof PA)&&!0===a.expression.isStateDependent){const l=n.paint.get(r);a.expression=l.value,a.updatePaintArray(t.start,t.end,s,e[o],i),A=!0}}}}return A}defines(){const e=[];for(const t in this.binders){const r=this.binders[t];(r instanceof MA||r instanceof kA)&&e.push(...r.uniformNames.map((e=>`#define HAS_UNIFORM_${e}`)))}return e}getBinderAttributes(){const e=[];for(const t in this.binders){const r=this.binders[t];if(r instanceof DA||r instanceof LA)for(let t=0;t<r.paintVertexAttributes.length;t++)e.push(r.paintVertexAttributes[t].name);else if(r instanceof PA)for(let t=0;t<gA.members.length;t++)e.push(gA.members[t].name)}return e}getBinderUniforms(){const e=[];for(const t in this.binders){const r=this.binders[t];if(r instanceof MA||r instanceof kA||r instanceof LA)for(const t of r.uniformNames)e.push(t)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e,t){const r=[];for(const n in this.binders){const i=this.binders[n];if(i instanceof MA||i instanceof kA||i instanceof LA)for(const A of i.uniformNames)if(t[A]){const o=i.getBinding(e,t[A],A);r.push({name:A,property:n,binding:o})}}return r}setUniforms(e,t,r,n){for(const{name:e,property:i,binding:A}of t)this.binders[i].setUniform(A,n,r.get(i),e)}updatePaintBuffers(e){this._buffers=[];for(const t in this.binders){const r=this.binders[t];if(e&&r instanceof PA){const t=2===e.fromScale?r.zoomInPaintVertexBuffer:r.zoomOutPaintVertexBuffer;t&&this._buffers.push(t)}else(r instanceof DA||r instanceof LA)&&r.paintVertexBuffer&&this._buffers.push(r.paintVertexBuffer)}}upload(e){for(const t in this.binders){const r=this.binders[t];(r instanceof DA||r instanceof LA||r instanceof PA)&&r.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const t=this.binders[e];(t instanceof DA||t instanceof LA||t instanceof PA)&&t.destroy()}}}class zA{constructor(e,t,r=(()=>!0)){this.programConfigurations={};for(const n of e)this.programConfigurations[n.id]=new HA(n,t,r);this.needsUpload=!1,this._featureMap=new vA,this._bufferOffset=0}populatePaintArrays(e,t,r,n,i,A){for(const r in this.programConfigurations)this.programConfigurations[r].populatePaintArrays(e,t,n,i,A);void 0!==t.id&&this._featureMap.add(t.id,r,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,t,r,n){for(const i of r)this.needsUpload=this.programConfigurations[i.id].updatePaintArrays(e,this._featureMap,t,i,n)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const t in this.programConfigurations)this.programConfigurations[t].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}function RA(e,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[e]||[e.replace(`${t}-`,"").replace(/-/g,"_")]}function OA(e,t,r){const n={color:{source:Ci,composite:Ki},number:{source:Pi,composite:Ci}},i=function(e){return{"line-pattern":{source:AA,composite:AA},"fill-pattern":{source:AA,composite:AA},"fill-extrusion-pattern":{source:AA,composite:AA}}[e]}(e);return i&&i[r]||n[t][r]}En("ConstantBinder",MA),En("CrossFadedConstantBinder",kA),En("SourceExpressionBinder",DA),En("CrossFadedCompositeBinder",PA),En("CompositeExpressionBinder",LA),En("ProgramConfiguration",HA,{omit:["_buffers"]}),En("ProgramConfigurationSet",zA);var KA=8192;const VA=Math.pow(2,14)-1,$A=-VA-1;function NA(e){const t=KA/e.extent,r=e.loadGeometry();for(let e=0;e<r.length;e++){const n=r[e];for(let e=0;e<n.length;e++){const r=n[e],i=Math.round(r.x*t),o=Math.round(r.y*t);r.x=A(i,$A,VA),r.y=A(o,$A,VA),(i<r.x||i>r.x+1||o<r.y||o>r.y+1)&&p("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return r}function GA(e,t){return{type:e.type,id:e.id,properties:e.properties,geometry:t?NA(e):[]}}function qA(e,t,r,n,i){e.emplaceBack(2*t+(n+1)/2,2*r+(i+1)/2)}class XA{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((e=>e.id)),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new eA,this.indexArray=new uA,this.segments=new fA,this.programConfigurations=new zA(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter((e=>e.isStateDependent())).map((e=>e.id))}populate(e,t,r){const n=this.layers[0],i=[];let A=null,o=!1;"circle"===n.type&&(A=n.layout.get("circle-sort-key"),o=!A.isConstant());for(const{feature:t,id:n,index:s,sourceLayerIndex:a}of e){const e=this.layers[0]._featureFilter.needGeometry,l=GA(t,e);if(!this.layers[0]._featureFilter.filter(new Yn(this.zoom),l,r))continue;const c=o?A.evaluate(l,{},r):void 0,u={id:n,properties:t.properties,type:t.type,sourceLayerIndex:a,index:s,geometry:e?l.geometry:NA(t),patterns:{},sortKey:c};i.push(u)}o&&i.sort(((e,t)=>e.sortKey-t.sortKey));for(const n of i){const{geometry:i,index:A,sourceLayerIndex:o}=n,s=e[A].feature;this.addFeature(n,i,A,r),t.featureIndex.insert(s,i,A,o,this.index)}}update(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,pA),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,t,r,n){for(const r of t)for(const t of r){const r=t.x,n=t.y;if(r<0||r>=KA||n<0||n>=KA)continue;const i=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),A=i.vertexLength;qA(this.layoutVertexArray,r,n,-1,-1),qA(this.layoutVertexArray,r,n,1,-1),qA(this.layoutVertexArray,r,n,1,1),qA(this.layoutVertexArray,r,n,-1,1),this.indexArray.emplaceBack(A,A+1,A+2),this.indexArray.emplaceBack(A,A+3,A+2),i.vertexLength+=4,i.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,{},n)}}function jA(e,t){for(let r=0;r<e.length;r++)if(io(t,e[r]))return!0;for(let r=0;r<t.length;r++)if(io(e,t[r]))return!0;return!!YA(e,t)}function ZA(e,t,r){return!!io(e,t)||!!to(t,e,r)}function JA(e,t){if(1===e.length)return no(t,e[0]);for(let r=0;r<t.length;r++){const n=t[r];for(let t=0;t<n.length;t++)if(io(e,n[t]))return!0}for(let r=0;r<e.length;r++)if(no(t,e[r]))return!0;for(let r=0;r<t.length;r++)if(YA(e,t[r]))return!0;return!1}function WA(e,t,r){if(e.length>1){if(YA(e,t))return!0;for(let n=0;n<t.length;n++)if(to(t[n],e,r))return!0}for(let n=0;n<e.length;n++)if(to(e[n],t,r))return!0;return!1}function YA(e,t){if(0===e.length||0===t.length)return!1;for(let r=0;r<e.length-1;r++){const n=e[r],i=e[r+1];for(let e=0;e<t.length-1;e++)if(eo(n,i,t[e],t[e+1]))return!0}return!1}function eo(e,t,r,n){return f(e,r,n)!==f(t,r,n)&&f(e,t,r)!==f(e,t,n)}function to(e,t,r){const n=r*r;if(1===t.length)return e.distSqr(t[0])<n;for(let r=1;r<t.length;r++)if(ro(e,t[r-1],t[r])<n)return!0;return!1}function ro(e,t,r){const n=t.distSqr(r);if(0===n)return e.distSqr(t);const i=((e.x-t.x)*(r.x-t.x)+(e.y-t.y)*(r.y-t.y))/n;return e.distSqr(i<0?t:i>1?r:r.sub(t)._mult(i)._add(t))}function no(e,t){let r,n,i,A=!1;for(let o=0;o<e.length;o++){r=e[o];for(let e=0,o=r.length-1;e<r.length;o=e++)n=r[e],i=r[o],n.y>t.y!=i.y>t.y&&t.x<(i.x-n.x)*(t.y-n.y)/(i.y-n.y)+n.x&&(A=!A)}return A}function io(e,t){let r=!1;for(let n=0,i=e.length-1;n<e.length;i=n++){const A=e[n],o=e[i];A.y>t.y!=o.y>t.y&&t.x<(o.x-A.x)*(t.y-A.y)/(o.y-A.y)+A.x&&(r=!r)}return r}function Ao(e,t,r){const n=r[0],i=r[2];if(e.x<n.x&&t.x<n.x||e.x>i.x&&t.x>i.x||e.y<n.y&&t.y<n.y||e.y>i.y&&t.y>i.y)return!1;const A=f(e,t,r[0]);return A!==f(e,t,r[1])||A!==f(e,t,r[2])||A!==f(e,t,r[3])}function oo(e,t,r){const n=t.paint.get(e).value;return"constant"===n.kind?n.value:r.programConfigurations.get(t.id).getMaxValue(e)}function so(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function ao(e,t,r,n,i){if(!t[0]&&!t[1])return e;const A=C.convert(t)._mult(i);"viewport"===r&&A._rotate(-n);const o=[];for(let t=0;t<e.length;t++)o.push(e[t].sub(A));return o}En("CircleBucket",XA,{omit:["layers"]});const lo=new di({"circle-sort-key":new li(ne.layout_circle["circle-sort-key"])});var co={paint:new di({"circle-radius":new li(ne.paint_circle["circle-radius"]),"circle-color":new li(ne.paint_circle["circle-color"]),"circle-blur":new li(ne.paint_circle["circle-blur"]),"circle-opacity":new li(ne.paint_circle["circle-opacity"]),"circle-translate":new ai(ne.paint_circle["circle-translate"]),"circle-translate-anchor":new ai(ne.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new ai(ne.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new ai(ne.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new li(ne.paint_circle["circle-stroke-width"]),"circle-stroke-color":new li(ne.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new li(ne.paint_circle["circle-stroke-opacity"])}),layout:lo},uo=1e-6,ho="undefined"!=typeof Float32Array?Float32Array:Array;function po(){var e=new ho(9);return ho!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function fo(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function mo(e,t,r){var n=t[0],i=t[1],A=t[2],o=t[3],s=t[4],a=t[5],l=t[6],c=t[7],u=t[8],h=t[9],d=t[10],p=t[11],f=t[12],m=t[13],g=t[14],y=t[15],_=r[0],w=r[1],x=r[2],B=r[3];return e[0]=_*n+w*s+x*u+B*f,e[1]=_*i+w*a+x*h+B*m,e[2]=_*A+w*l+x*d+B*g,e[3]=_*o+w*c+x*p+B*y,e[4]=(_=r[4])*n+(w=r[5])*s+(x=r[6])*u+(B=r[7])*f,e[5]=_*i+w*a+x*h+B*m,e[6]=_*A+w*l+x*d+B*g,e[7]=_*o+w*c+x*p+B*y,e[8]=(_=r[8])*n+(w=r[9])*s+(x=r[10])*u+(B=r[11])*f,e[9]=_*i+w*a+x*h+B*m,e[10]=_*A+w*l+x*d+B*g,e[11]=_*o+w*c+x*p+B*y,e[12]=(_=r[12])*n+(w=r[13])*s+(x=r[14])*u+(B=r[15])*f,e[13]=_*i+w*a+x*h+B*m,e[14]=_*A+w*l+x*d+B*g,e[15]=_*o+w*c+x*p+B*y,e}Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});var go,yo=mo;function _o(){var e=new ho(3);return ho!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function wo(e,t,r){var n=new ho(3);return n[0]=e,n[1]=t,n[2]=r,n}function xo(e,t,r){var n=t[0],i=t[1],A=t[2],o=t[3];return e[0]=r[0]*n+r[4]*i+r[8]*A+r[12]*o,e[1]=r[1]*n+r[5]*i+r[9]*A+r[13]*o,e[2]=r[2]*n+r[6]*i+r[10]*A+r[14]*o,e[3]=r[3]*n+r[7]*i+r[11]*A+r[15]*o,e}function Bo(){var e=new ho(4);return ho!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function vo(e,t){const r=xo([],[e.x,e.y,0,1],t);return new C(r[0]/r[3],r[1]/r[3])}_o(),go=new ho(4),ho!=Float32Array&&(go[0]=0,go[1]=0,go[2]=0,go[3]=0),_o(),wo(1,0,0),wo(0,1,0),Bo(),Bo(),po(),function(){var e;e=new ho(2),ho!=Float32Array&&(e[0]=0,e[1]=0)}();class bo extends XA{}En("HeatmapBucket",bo,{omit:["layers"]});var Co={paint:new di({"heatmap-radius":new li(ne.paint_heatmap["heatmap-radius"]),"heatmap-weight":new li(ne.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new ai(ne.paint_heatmap["heatmap-intensity"]),"heatmap-color":new hi(ne.paint_heatmap["heatmap-color"]),"heatmap-opacity":new ai(ne.paint_heatmap["heatmap-opacity"])})};function Fo(e,{width:t,height:r},n,i){if(i){if(i instanceof Uint8ClampedArray)i=new Uint8Array(i.buffer);else if(i.length!==t*r*n)throw new RangeError(`mismatched image size. expected: ${i.length} but got: ${t*r*n}`)}else i=new Uint8Array(t*r*n);return e.width=t,e.height=r,e.data=i,e}function Eo(e,{width:t,height:r},n){if(t===e.width&&r===e.height)return;const i=Fo({},{width:t,height:r},n);Uo(e,i,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,t),height:Math.min(e.height,r)},n),e.width=t,e.height=r,e.data=i.data}function Uo(e,t,r,n,i,A){if(0===i.width||0===i.height)return t;if(i.width>e.width||i.height>e.height||r.x>e.width-i.width||r.y>e.height-i.height)throw new RangeError("out of range source coordinates for image copy");if(i.width>t.width||i.height>t.height||n.x>t.width-i.width||n.y>t.height-i.height)throw new RangeError("out of range destination coordinates for image copy");const o=e.data,s=t.data;if(o===s)throw new Error("srcData equals dstData, so image is already copied");for(let a=0;a<i.height;a++){const l=((r.y+a)*e.width+r.x)*A,c=((n.y+a)*t.width+n.x)*A;for(let e=0;e<i.width*A;e++)s[c+e]=o[l+e]}return t}class Qo{constructor(e,t){Fo(this,e,1,t)}resize(e){Eo(this,e,1)}clone(){return new Qo({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,t,r,n,i){Uo(e,t,r,n,i,1)}}class Io{constructor(e,t){Fo(this,e,4,t)}resize(e){Eo(this,e,4)}replace(e,t){t?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new Io({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,t,r,n,i){Uo(e,t,r,n,i,4)}}function To(e){const t={},r=e.resolution||256,n=e.clips?e.clips.length:1,i=e.image||new Io({width:r,height:n});if(Math.log(r)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${r}`);const A=(r,n,A)=>{t[e.evaluationKey]=A;const o=e.expression.evaluate(t);i.data[r+n+0]=Math.floor(255*o.r/o.a),i.data[r+n+1]=Math.floor(255*o.g/o.a),i.data[r+n+2]=Math.floor(255*o.b/o.a),i.data[r+n+3]=Math.floor(255*o.a)};if(e.clips)for(let t=0,i=0;t<n;++t,i+=4*r)for(let n=0,o=0;n<r;n++,o+=4){const s=n/(r-1),{start:a,end:l}=e.clips[t];A(i,o,a*(1-s)+l*s)}else for(let e=0,t=0;e<r;e++,t+=4)A(0,t,e/(r-1));return i}En("AlphaImage",Qo),En("RGBAImage",Io);var So={paint:new di({"hillshade-illumination-direction":new ai(ne.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new ai(ne.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new ai(ne.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new ai(ne.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new ai(ne.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new ai(ne.paint_hillshade["hillshade-accent-color"])})};const Mo=_i([{name:"a_pos",components:2,type:"Int16"}],4),{members:ko}=Mo;var Do={exports:{}};function Lo(e,t,r){r=r||2;var n,i,A,o,s,a,l,c=t&&t.length,u=c?t[0]*r:e.length,h=Po(e,0,u,r,!0),d=[];if(!h||h.next===h.prev)return d;if(c&&(h=function(e,t,r,n){var i,A,o,s=[];for(i=0,A=t.length;i<A;i++)(o=Po(e,t[i]*n,i<A-1?t[i+1]*n:e.length,n,!1))===o.next&&(o.steiner=!0),s.push(Xo(o));for(s.sort($o),i=0;i<s.length;i++)r=No(s[i],r);return r}(e,t,h,r)),e.length>80*r){n=A=e[0],i=o=e[1];for(var p=r;p<u;p+=r)(s=e[p])<n&&(n=s),(a=e[p+1])<i&&(i=a),s>A&&(A=s),a>o&&(o=a);l=0!==(l=Math.max(A-n,o-i))?32767/l:0}return zo(h,d,r,n,i,l,0),d}function Po(e,t,r,n,i){var A,o;if(i===ss(e,t,r,n)>0)for(A=t;A<r;A+=n)o=is(A,e[A],e[A+1],o);else for(A=r-n;A>=t;A-=n)o=is(A,e[A],e[A+1],o);return o&&Wo(o,o.next)&&(As(o),o=o.next),o}function Ho(e,t){if(!e)return e;t||(t=e);var r,n=e;do{if(r=!1,n.steiner||!Wo(n,n.next)&&0!==Jo(n.prev,n,n.next))n=n.next;else{if(As(n),(n=t=n.prev)===n.next)break;r=!0}}while(r||n!==t);return t}function zo(e,t,r,n,i,A,o){if(e){!o&&A&&function(e,t,r,n){var i=e;do{0===i.z&&(i.z=qo(i.x,i.y,t,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function(e){var t,r,n,i,A,o,s,a,l=1;do{for(r=e,e=null,A=null,o=0;r;){for(o++,n=r,s=0,t=0;t<l&&(s++,n=n.nextZ);t++);for(a=l;s>0||a>0&&n;)0!==s&&(0===a||!n||r.z<=n.z)?(i=r,r=r.nextZ,s--):(i=n,n=n.nextZ,a--),A?A.nextZ=i:e=i,i.prevZ=A,A=i;r=n}A.nextZ=null,l*=2}while(o>1)}(i)}(e,n,i,A);for(var s,a,l=e;e.prev!==e.next;)if(s=e.prev,a=e.next,A?Oo(e,n,i,A):Ro(e))t.push(s.i/r|0),t.push(e.i/r|0),t.push(a.i/r|0),As(e),e=a.next,l=a.next;else if((e=a)===l){o?1===o?zo(e=Ko(Ho(e),t,r),t,r,n,i,A,2):2===o&&Vo(e,t,r,n,i,A):zo(Ho(e),t,r,n,i,A,1);break}}}function Ro(e){var t=e.prev,r=e,n=e.next;if(Jo(t,r,n)>=0)return!1;for(var i=t.x,A=r.x,o=n.x,s=t.y,a=r.y,l=n.y,c=i<A?i<o?i:o:A<o?A:o,u=s<a?s<l?s:l:a<l?a:l,h=i>A?i>o?i:o:A>o?A:o,d=s>a?s>l?s:l:a>l?a:l,p=n.next;p!==t;){if(p.x>=c&&p.x<=h&&p.y>=u&&p.y<=d&&jo(i,s,A,a,o,l,p.x,p.y)&&Jo(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function Oo(e,t,r,n){var i=e.prev,A=e,o=e.next;if(Jo(i,A,o)>=0)return!1;for(var s=i.x,a=A.x,l=o.x,c=i.y,u=A.y,h=o.y,d=s<a?s<l?s:l:a<l?a:l,p=c<u?c<h?c:h:u<h?u:h,f=s>a?s>l?s:l:a>l?a:l,m=c>u?c>h?c:h:u>h?u:h,g=qo(d,p,t,r,n),y=qo(f,m,t,r,n),_=e.prevZ,w=e.nextZ;_&&_.z>=g&&w&&w.z<=y;){if(_.x>=d&&_.x<=f&&_.y>=p&&_.y<=m&&_!==i&&_!==o&&jo(s,c,a,u,l,h,_.x,_.y)&&Jo(_.prev,_,_.next)>=0)return!1;if(_=_.prevZ,w.x>=d&&w.x<=f&&w.y>=p&&w.y<=m&&w!==i&&w!==o&&jo(s,c,a,u,l,h,w.x,w.y)&&Jo(w.prev,w,w.next)>=0)return!1;w=w.nextZ}for(;_&&_.z>=g;){if(_.x>=d&&_.x<=f&&_.y>=p&&_.y<=m&&_!==i&&_!==o&&jo(s,c,a,u,l,h,_.x,_.y)&&Jo(_.prev,_,_.next)>=0)return!1;_=_.prevZ}for(;w&&w.z<=y;){if(w.x>=d&&w.x<=f&&w.y>=p&&w.y<=m&&w!==i&&w!==o&&jo(s,c,a,u,l,h,w.x,w.y)&&Jo(w.prev,w,w.next)>=0)return!1;w=w.nextZ}return!0}function Ko(e,t,r){var n=e;do{var i=n.prev,A=n.next.next;!Wo(i,A)&&Yo(i,n,n.next,A)&&rs(i,A)&&rs(A,i)&&(t.push(i.i/r|0),t.push(n.i/r|0),t.push(A.i/r|0),As(n),As(n.next),n=e=A),n=n.next}while(n!==e);return Ho(n)}function Vo(e,t,r,n,i,A){var o=e;do{for(var s=o.next.next;s!==o.prev;){if(o.i!==s.i&&Zo(o,s)){var a=ns(o,s);return o=Ho(o,o.next),a=Ho(a,a.next),zo(o,t,r,n,i,A,0),void zo(a,t,r,n,i,A,0)}s=s.next}o=o.next}while(o!==e)}function $o(e,t){return e.x-t.x}function No(e,t){var r=function(e,t){var r,n=t,i=e.x,A=e.y,o=-1/0;do{if(A<=n.y&&A>=n.next.y&&n.next.y!==n.y){var s=n.x+(A-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(s<=i&&s>o&&(o=s,r=n.x<n.next.x?n:n.next,s===i))return r}n=n.next}while(n!==t);if(!r)return null;var a,l=r,c=r.x,u=r.y,h=1/0;n=r;do{i>=n.x&&n.x>=c&&i!==n.x&&jo(A<u?i:o,A,c,u,A<u?o:i,A,n.x,n.y)&&(a=Math.abs(A-n.y)/(i-n.x),rs(n,e)&&(a<h||a===h&&(n.x>r.x||n.x===r.x&&Go(r,n)))&&(r=n,h=a)),n=n.next}while(n!==l);return r}(e,t);if(!r)return t;var n=ns(r,e);return Ho(n,n.next),Ho(r,r.next)}function Go(e,t){return Jo(e.prev,e,t.prev)<0&&Jo(t.next,e,e.next)<0}function qo(e,t,r,n,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-r)*i|0)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*i|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Xo(e){var t=e,r=e;do{(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next}while(t!==e);return r}function jo(e,t,r,n,i,A,o,s){return(i-o)*(t-s)>=(e-o)*(A-s)&&(e-o)*(n-s)>=(r-o)*(t-s)&&(r-o)*(A-s)>=(i-o)*(n-s)}function Zo(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&Yo(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}(e,t)&&(rs(e,t)&&rs(t,e)&&function(e,t){var r=e,n=!1,i=(e.x+t.x)/2,A=(e.y+t.y)/2;do{r.y>A!=r.next.y>A&&r.next.y!==r.y&&i<(r.next.x-r.x)*(A-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next}while(r!==e);return n}(e,t)&&(Jo(e.prev,e,t.prev)||Jo(e,t.prev,t))||Wo(e,t)&&Jo(e.prev,e,e.next)>0&&Jo(t.prev,t,t.next)>0)}function Jo(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function Wo(e,t){return e.x===t.x&&e.y===t.y}function Yo(e,t,r,n){var i=ts(Jo(e,t,r)),A=ts(Jo(e,t,n)),o=ts(Jo(r,n,e)),s=ts(Jo(r,n,t));return i!==A&&o!==s||!(0!==i||!es(e,r,t))||!(0!==A||!es(e,n,t))||!(0!==o||!es(r,e,n))||!(0!==s||!es(r,t,n))}function es(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function ts(e){return e>0?1:e<0?-1:0}function rs(e,t){return Jo(e.prev,e,e.next)<0?Jo(e,t,e.next)>=0&&Jo(e,e.prev,t)>=0:Jo(e,t,e.prev)<0||Jo(e,e.next,t)<0}function ns(e,t){var r=new os(e.i,e.x,e.y),n=new os(t.i,t.x,t.y),i=e.next,A=t.prev;return e.next=t,t.prev=e,r.next=i,i.prev=r,n.next=r,r.prev=n,A.next=n,n.prev=A,n}function is(e,t,r,n){var i=new os(e,t,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function As(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function os(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function ss(e,t,r,n){for(var i=0,A=t,o=r-n;A<r;A+=n)i+=(e[o]-e[A])*(e[A+1]+e[o+1]),o=A;return i}function as(e,t,r,n,i){ls(e,t,r||0,n||e.length-1,i||us)}function ls(e,t,r,n,i){for(;n>r;){if(n-r>600){var A=n-r+1,o=t-r+1,s=Math.log(A),a=.5*Math.exp(2*s/3),l=.5*Math.sqrt(s*a*(A-a)/A)*(o-A/2<0?-1:1);ls(e,t,Math.max(r,Math.floor(t-o*a/A+l)),Math.min(n,Math.floor(t+(A-o)*a/A+l)),i)}var c=e[t],u=r,h=n;for(cs(e,r,t),i(e[n],c)>0&&cs(e,r,n);u<h;){for(cs(e,u,h),u++,h--;i(e[u],c)<0;)u++;for(;i(e[h],c)>0;)h--}0===i(e[r],c)?cs(e,r,h):cs(e,++h,n),h<=t&&(r=h+1),t<=h&&(n=h-1)}}function cs(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function us(e,t){return e<t?-1:e>t?1:0}function hs(e,t){const r=e.length;if(r<=1)return[e];const n=[];let i,A;for(let t=0;t<r;t++){const r=m(e[t]);0!==r&&(e[t].area=Math.abs(r),void 0===A&&(A=r<0),A===r<0?(i&&n.push(i),i=[e[t]]):i.push(e[t]))}if(i&&n.push(i),t>1)for(let e=0;e<n.length;e++)n[e].length<=t||(as(n[e],t,1,n[e].length-1,ds),n[e]=n[e].slice(0,t));return n}function ds(e,t){return t.area-e.area}function ps(e,t,r){const n=r.patternDependencies;let i=!1;for(const r of t){const t=r.paint.get(`${e}-pattern`);t.isConstant()||(i=!0);const A=t.constantOr(null);A&&(i=!0,n[A.to]=!0,n[A.from]=!0)}return i}function fs(e,t,r,n,i){const A=i.patternDependencies;for(const o of t){const t=o.paint.get(`${e}-pattern`).value;if("constant"!==t.kind){let e=t.evaluate({zoom:n-1},r,{},i.availableImages),s=t.evaluate({zoom:n},r,{},i.availableImages),a=t.evaluate({zoom:n+1},r,{},i.availableImages);e=e&&e.name?e.name:e,s=s&&s.name?s.name:s,a=a&&a.name?a.name:a,A[e]=!0,A[s]=!0,A[a]=!0,r.patterns[o.id]={min:e,mid:s,max:a}}}return r}Do.exports=Lo,Do.exports.default=Lo,Lo.deviation=function(e,t,r,n){var i=t&&t.length,A=Math.abs(ss(e,0,i?t[0]*r:e.length,r));if(i)for(var o=0,s=t.length;o<s;o++)A-=Math.abs(ss(e,t[o]*r,o<s-1?t[o+1]*r:e.length,r));var a=0;for(o=0;o<n.length;o+=3){var l=n[o]*r,c=n[o+1]*r,u=n[o+2]*r;a+=Math.abs((e[l]-e[u])*(e[c+1]-e[l+1])-(e[l]-e[c])*(e[u+1]-e[l+1]))}return 0===A&&0===a?0:Math.abs((a-A)/A)},Lo.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},n=0,i=0;i<e.length;i++){for(var A=0;A<e[i].length;A++)for(var o=0;o<t;o++)r.vertices.push(e[i][A][o]);i>0&&r.holes.push(n+=e[i-1].length)}return r};class ms{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((e=>e.id)),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new tA,this.indexArray=new uA,this.indexArray2=new hA,this.programConfigurations=new zA(e.layers,e.zoom),this.segments=new fA,this.segments2=new fA,this.stateDependentLayerIds=this.layers.filter((e=>e.isStateDependent())).map((e=>e.id))}populate(e,t,r){this.hasPattern=ps("fill",this.layers,t);const n=this.layers[0].layout.get("fill-sort-key"),i=!n.isConstant(),A=[];for(const{feature:o,id:s,index:a,sourceLayerIndex:l}of e){const e=this.layers[0]._featureFilter.needGeometry,c=GA(o,e);if(!this.layers[0]._featureFilter.filter(new Yn(this.zoom),c,r))continue;const u=i?n.evaluate(c,{},r,t.availableImages):void 0,h={id:s,properties:o.properties,type:o.type,sourceLayerIndex:l,index:a,geometry:e?c.geometry:NA(o),patterns:{},sortKey:u};A.push(h)}i&&A.sort(((e,t)=>e.sortKey-t.sortKey));for(const n of A){const{geometry:i,index:A,sourceLayerIndex:o}=n;if(this.hasPattern){const e=fs("fill",this.layers,n,this.zoom,t);this.patternFeatures.push(e)}else this.addFeature(n,i,A,r,{});t.featureIndex.insert(e[A].feature,i,A,o,this.index)}}update(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)}addFeatures(e,t,r){for(const e of this.patternFeatures)this.addFeature(e,e.geometry,e.index,t,r)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,ko),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,t,r,n,i){for(const e of hs(t,500)){let t=0;for(const r of e)t+=r.length;const r=this.segments.prepareSegment(t,this.layoutVertexArray,this.indexArray),n=r.vertexLength,i=[],A=[];for(const t of e){if(0===t.length)continue;t!==e[0]&&A.push(i.length/2);const r=this.segments2.prepareSegment(t.length,this.layoutVertexArray,this.indexArray2),n=r.vertexLength;this.layoutVertexArray.emplaceBack(t[0].x,t[0].y),this.indexArray2.emplaceBack(n+t.length-1,n),i.push(t[0].x),i.push(t[0].y);for(let e=1;e<t.length;e++)this.layoutVertexArray.emplaceBack(t[e].x,t[e].y),this.indexArray2.emplaceBack(n+e-1,n+e),i.push(t[e].x),i.push(t[e].y);r.vertexLength+=t.length,r.primitiveLength+=t.length}const o=Do.exports(i,A);for(let e=0;e<o.length;e+=3)this.indexArray.emplaceBack(n+o[e],n+o[e+1],n+o[e+2]);r.vertexLength+=t,r.primitiveLength+=o.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,i,n)}}En("FillBucket",ms,{omit:["layers","patternFeatures"]});const gs=new di({"fill-sort-key":new li(ne.layout_fill["fill-sort-key"])});var ys={paint:new di({"fill-antialias":new ai(ne.paint_fill["fill-antialias"]),"fill-opacity":new li(ne.paint_fill["fill-opacity"]),"fill-color":new li(ne.paint_fill["fill-color"]),"fill-outline-color":new li(ne.paint_fill["fill-outline-color"]),"fill-translate":new ai(ne.paint_fill["fill-translate"]),"fill-translate-anchor":new ai(ne.paint_fill["fill-translate-anchor"]),"fill-pattern":new ci(ne.paint_fill["fill-pattern"])}),layout:gs};const _s=_i([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),ws=_i([{name:"a_centroid",components:2,type:"Int16"}],4),{members:xs}=_s;var Bs={},vs=C,bs=Cs;function Cs(e,t,r,n,i){this.properties={},this.extent=r,this.type=0,this._pbf=e,this._geometry=-1,this._keys=n,this._values=i,e.readFields(Fs,this,t)}function Fs(e,t,r){1==e?t.id=r.readVarint():2==e?function(e,t){for(var r=e.readVarint()+e.pos;e.pos<r;){var n=t._keys[e.readVarint()],i=t._values[e.readVarint()];t.properties[n]=i}}(r,t):3==e?t.type=r.readVarint():4==e&&(t._geometry=r.pos)}function Es(e){for(var t,r,n=0,i=0,A=e.length,o=A-1;i<A;o=i++)n+=((r=e[o]).x-(t=e[i]).x)*(t.y+r.y);return n}Cs.types=["Unknown","Point","LineString","Polygon"],Cs.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t,r=e.readVarint()+e.pos,n=1,i=0,A=0,o=0,s=[];e.pos<r;){if(i<=0){var a=e.readVarint();n=7&a,i=a>>3}if(i--,1===n||2===n)A+=e.readSVarint(),o+=e.readSVarint(),1===n&&(t&&s.push(t),t=[]),t.push(new vs(A,o));else{if(7!==n)throw new Error("unknown command "+n);t&&t.push(t[0].clone())}}return t&&s.push(t),s},Cs.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,r=1,n=0,i=0,A=0,o=1/0,s=-1/0,a=1/0,l=-1/0;e.pos<t;){if(n<=0){var c=e.readVarint();r=7&c,n=c>>3}if(n--,1===r||2===r)(i+=e.readSVarint())<o&&(o=i),i>s&&(s=i),(A+=e.readSVarint())<a&&(a=A),A>l&&(l=A);else if(7!==r)throw new Error("unknown command "+r)}return[o,a,s,l]},Cs.prototype.toGeoJSON=function(e,t,r){var n,i,A=this.extent*Math.pow(2,r),o=this.extent*e,s=this.extent*t,a=this.loadGeometry(),l=Cs.types[this.type];function c(e){for(var t=0;t<e.length;t++){var r=e[t];e[t]=[360*(r.x+o)/A-180,360/Math.PI*Math.atan(Math.exp((180-360*(r.y+s)/A)*Math.PI/180))-90]}}switch(this.type){case 1:var u=[];for(n=0;n<a.length;n++)u[n]=a[n][0];c(a=u);break;case 2:for(n=0;n<a.length;n++)c(a[n]);break;case 3:for(a=function(e){var t=e.length;if(t<=1)return[e];for(var r,n,i=[],A=0;A<t;A++){var o=Es(e[A]);0!==o&&(void 0===n&&(n=o<0),n===o<0?(r&&i.push(r),r=[e[A]]):r.push(e[A]))}return r&&i.push(r),i}(a),n=0;n<a.length;n++)for(i=0;i<a[n].length;i++)c(a[n][i])}1===a.length?a=a[0]:l="Multi"+l;var h={type:"Feature",geometry:{type:l,coordinates:a},properties:this.properties};return"id"in this&&(h.id=this.id),h};var Us=bs,Qs=Is;function Is(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(Ts,this,t),this.length=this._features.length}function Ts(e,t,r){15===e?t.version=r.readVarint():1===e?t.name=r.readString():5===e?t.extent=r.readVarint():2===e?t._features.push(r.pos):3===e?t._keys.push(r.readString()):4===e&&t._values.push(function(e){for(var t=null,r=e.readVarint()+e.pos;e.pos<r;){var n=e.readVarint()>>3;t=1===n?e.readString():2===n?e.readFloat():3===n?e.readDouble():4===n?e.readVarint64():5===n?e.readVarint():6===n?e.readSVarint():7===n?e.readBoolean():null}return t}(r))}Is.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new Us(this._pbf,t,this.extent,this._keys,this._values)};var Ss=Qs;function Ms(e,t,r){if(3===e){var n=new Ss(r,r.readVarint()+r.pos);n.length&&(t[n.name]=n)}}Bs.VectorTile=function(e,t){this.layers=e.readFields(Ms,{},t)},Bs.VectorTileFeature=bs,Bs.VectorTileLayer=Qs;const ks=Bs.VectorTileFeature.types,Ds=Math.pow(2,13);function Ls(e,t,r,n,i,A,o,s){e.emplaceBack(t,r,2*Math.floor(n*Ds)+o,i*Ds*2,A*Ds*2,Math.round(s))}class Ps{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((e=>e.id)),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new rA,this.centroidVertexArray=new Yi,this.indexArray=new uA,this.programConfigurations=new zA(e.layers,e.zoom),this.segments=new fA,this.stateDependentLayerIds=this.layers.filter((e=>e.isStateDependent())).map((e=>e.id))}populate(e,t,r){this.features=[],this.hasPattern=ps("fill-extrusion",this.layers,t);for(const{feature:n,id:i,index:A,sourceLayerIndex:o}of e){const e=this.layers[0]._featureFilter.needGeometry,s=GA(n,e);if(!this.layers[0]._featureFilter.filter(new Yn(this.zoom),s,r))continue;const a={id:i,sourceLayerIndex:o,index:A,geometry:e?s.geometry:NA(n),properties:n.properties,type:n.type,patterns:{}};this.hasPattern?this.features.push(fs("fill-extrusion",this.layers,a,this.zoom,t)):this.addFeature(a,a.geometry,A,r,{}),t.featureIndex.insert(n,a.geometry,A,o,this.index,!0)}}addFeatures(e,t,r){for(const e of this.features){const{geometry:n}=e;this.addFeature(e,n,e.index,t,r)}}update(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.centroidVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,xs),this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,ws.members,!0),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(e,t,r,n,i){const A={x:0,y:0,vertexCount:0};for(const r of hs(t,500)){let t=0;for(const e of r)t+=e.length;let n=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const e of r){if(0===e.length)continue;if(zs(e))continue;let t=0;for(let r=0;r<e.length;r++){const i=e[r];if(r>=1){const o=e[r-1];if(!Hs(i,o)){n.vertexLength+4>fA.MAX_VERTEX_ARRAY_LENGTH&&(n=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const e=i.sub(o)._perp()._unit(),r=o.dist(i);t+r>32768&&(t=0),Ls(this.layoutVertexArray,i.x,i.y,e.x,e.y,0,0,t),Ls(this.layoutVertexArray,i.x,i.y,e.x,e.y,0,1,t),A.x+=2*i.x,A.y+=2*i.y,A.vertexCount+=2,t+=r,Ls(this.layoutVertexArray,o.x,o.y,e.x,e.y,0,0,t),Ls(this.layoutVertexArray,o.x,o.y,e.x,e.y,0,1,t),A.x+=2*o.x,A.y+=2*o.y,A.vertexCount+=2;const s=n.vertexLength;this.indexArray.emplaceBack(s,s+2,s+1),this.indexArray.emplaceBack(s+1,s+2,s+3),n.vertexLength+=4,n.primitiveLength+=2}}}}if(n.vertexLength+t>fA.MAX_VERTEX_ARRAY_LENGTH&&(n=this.segments.prepareSegment(t,this.layoutVertexArray,this.indexArray)),"Polygon"!==ks[e.type])continue;const i=[],o=[],s=n.vertexLength;for(const e of r)if(0!==e.length){e!==r[0]&&o.push(i.length/2);for(let t=0;t<e.length;t++){const r=e[t];Ls(this.layoutVertexArray,r.x,r.y,0,0,1,1,0),A.x+=r.x,A.y+=r.y,A.vertexCount+=1,i.push(r.x),i.push(r.y)}}const a=Do.exports(i,o);for(let e=0;e<a.length;e+=3)this.indexArray.emplaceBack(s+a[e],s+a[e+2],s+a[e+1]);n.primitiveLength+=a.length/3,n.vertexLength+=t}for(let e=0;e<A.vertexCount;e++)this.centroidVertexArray.emplaceBack(Math.floor(A.x/A.vertexCount),Math.floor(A.y/A.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,i,n)}}function Hs(e,t){return e.x===t.x&&(e.x<0||e.x>KA)||e.y===t.y&&(e.y<0||e.y>KA)}function zs(e){return e.every((e=>e.x<0))||e.every((e=>e.x>KA))||e.every((e=>e.y<0))||e.every((e=>e.y>KA))}En("FillExtrusionBucket",Ps,{omit:["layers","features"]});var Rs={paint:new di({"fill-extrusion-opacity":new ai(ne["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new li(ne["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new ai(ne["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new ai(ne["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new ci(ne["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new li(ne["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new li(ne["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new ai(ne["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})};function Os(e,t){return e.x*t.x+e.y*t.y}function Ks(e,t){if(1===e.length){let r=0;const n=t[r++];let i;for(;!i||n.equals(i);)if(i=t[r++],!i)return 1/0;for(;r<t.length;r++){const A=t[r],o=e[0],s=i.sub(n),a=A.sub(n),l=o.sub(n),c=Os(s,s),u=Os(s,a),h=Os(a,a),d=Os(l,s),p=Os(l,a),f=c*h-u*u,m=(h*d-u*p)/f,g=(c*p-u*d)/f,y=n.z*(1-m-g)+i.z*m+A.z*g;if(isFinite(y))return y}return 1/0}{let e=1/0;for(const r of t)e=Math.min(e,r.z);return e}}const Vs=_i([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:$s}=Vs,Ns=_i([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Gs}=Ns,qs=Bs.VectorTileFeature.types,Xs=Math.cos(Math.PI/180*37.5),js=Math.pow(2,14)/.5;class Zs{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((e=>e.id)),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((e=>{this.gradients[e.id]={}})),this.layoutVertexArray=new nA,this.layoutVertexArray2=new iA,this.indexArray=new uA,this.programConfigurations=new zA(e.layers,e.zoom),this.segments=new fA,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter((e=>e.isStateDependent())).map((e=>e.id))}populate(e,t,r){this.hasPattern=ps("line",this.layers,t);const n=this.layers[0].layout.get("line-sort-key"),i=!n.isConstant(),A=[];for(const{feature:t,id:o,index:s,sourceLayerIndex:a}of e){const e=this.layers[0]._featureFilter.needGeometry,l=GA(t,e);if(!this.layers[0]._featureFilter.filter(new Yn(this.zoom),l,r))continue;const c=i?n.evaluate(l,{},r):void 0,u={id:o,properties:t.properties,type:t.type,sourceLayerIndex:a,index:s,geometry:e?l.geometry:NA(t),patterns:{},sortKey:c};A.push(u)}i&&A.sort(((e,t)=>e.sortKey-t.sortKey));for(const n of A){const{geometry:i,index:A,sourceLayerIndex:o}=n;if(this.hasPattern){const e=fs("line",this.layers,n,this.zoom,t);this.patternFeatures.push(e)}else this.addFeature(n,i,A,r,{});t.featureIndex.insert(e[A].feature,i,A,o,this.index)}}update(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)}addFeatures(e,t,r){for(const e of this.patternFeatures)this.addFeature(e,e.geometry,e.index,t,r)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,Gs)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,$s),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,t,r,n,i){const A=this.layers[0].layout,o=A.get("line-join").evaluate(e,{}),s=A.get("line-cap"),a=A.get("line-miter-limit"),l=A.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const r of t)this.addLine(r,e,o,s,a,l);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,i,n)}addLine(e,t,r,n,i,A){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let t=0;t<e.length-1;t++)this.totalDistance+=e[t].dist(e[t+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const o="Polygon"===qs[t.type];let s=e.length;for(;s>=2&&e[s-1].equals(e[s-2]);)s--;let a=0;for(;a<s-1&&e[a].equals(e[a+1]);)a++;if(s<(o?3:2))return;"bevel"===r&&(i=1.05);const l=this.overscaling<=16?122880/(512*this.overscaling):0,c=this.segments.prepareSegment(10*s,this.layoutVertexArray,this.indexArray);let u,h,d,p,f;this.e1=this.e2=-1,o&&(u=e[s-2],f=e[a].sub(u)._unit()._perp());for(let t=a;t<s;t++){if(d=t===s-1?o?e[a+1]:void 0:e[t+1],d&&e[t].equals(d))continue;f&&(p=f),u&&(h=u),u=e[t],f=d?d.sub(u)._unit()._perp():p,p=p||f;let m=p.add(f);0===m.x&&0===m.y||m._unit();const g=p.x*f.x+p.y*f.y,y=m.x*f.x+m.y*f.y,_=0!==y?1/y:1/0,w=2*Math.sqrt(2-2*y),x=y<Xs&&h&&d,B=p.x*f.y-p.y*f.x>0;if(x&&t>a){const e=u.dist(h);if(e>2*l){const t=u.sub(u.sub(h)._mult(l/e)._round());this.updateDistance(h,t),this.addCurrentVertex(t,p,0,0,c),h=t}}const v=h&&d;let b=v?r:o?"butt":n;if(v&&"round"===b&&(_<A?b="miter":_<=2&&(b="fakeround")),"miter"===b&&_>i&&(b="bevel"),"bevel"===b&&(_>2&&(b="flipbevel"),_<i&&(b="miter")),h&&this.updateDistance(h,u),"miter"===b)m._mult(_),this.addCurrentVertex(u,m,0,0,c);else if("flipbevel"===b){if(_>100)m=f.mult(-1);else{const e=_*p.add(f).mag()/p.sub(f).mag();m._perp()._mult(e*(B?-1:1))}this.addCurrentVertex(u,m,0,0,c),this.addCurrentVertex(u,m.mult(-1),0,0,c)}else if("bevel"===b||"fakeround"===b){const e=-Math.sqrt(_*_-1),t=B?e:0,r=B?0:e;if(h&&this.addCurrentVertex(u,p,t,r,c),"fakeround"===b){const e=Math.round(180*w/Math.PI/20);for(let t=1;t<e;t++){let r=t/e;if(.5!==r){const e=r-.5;r+=r*e*(r-1)*((1.0904+g*(g*(3.55645-1.43519*g)-3.2452))*e*e+(.848013+g*(.215638*g-1.06021)))}const n=f.sub(p)._mult(r)._add(p)._unit()._mult(B?-1:1);this.addHalfVertex(u,n.x,n.y,!1,B,0,c)}}d&&this.addCurrentVertex(u,f,-t,-r,c)}else if("butt"===b)this.addCurrentVertex(u,m,0,0,c);else if("square"===b){const e=h?1:-1;this.addCurrentVertex(u,m,e,e,c)}else"round"===b&&(h&&(this.addCurrentVertex(u,p,0,0,c),this.addCurrentVertex(u,p,1,1,c,!0)),d&&(this.addCurrentVertex(u,f,-1,-1,c,!0),this.addCurrentVertex(u,f,0,0,c)));if(x&&t<s-1){const e=u.dist(d);if(e>2*l){const t=u.add(d.sub(u)._mult(l/e)._round());this.updateDistance(u,t),this.addCurrentVertex(t,f,0,0,c),u=t}}}}addCurrentVertex(e,t,r,n,i,A=!1){const o=t.y*n-t.x,s=-t.y-t.x*n;this.addHalfVertex(e,t.x+t.y*r,t.y-t.x*r,A,!1,r,i),this.addHalfVertex(e,o,s,A,!0,-n,i),this.distance>js/2&&0===this.totalDistance&&(this.distance=0,this.addCurrentVertex(e,t,r,n,i,A))}addHalfVertex({x:e,y:t},r,n,i,A,o,s){const a=.5*(this.lineClips?this.scaledDistance*(js-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e<<1)+(i?1:0),(t<<1)+(A?1:0),Math.round(63*r)+128,Math.round(63*n)+128,1+(0===o?0:o<0?-1:1)|(63&a)<<2,a>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const l=s.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,l),s.primitiveLength++),A?this.e2=l:this.e1=l}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(e,t){this.distance+=e.dist(t),this.updateScaledDistance()}}En("LineBucket",Zs,{omit:["layers","patternFeatures"]});const Js=new di({"line-cap":new ai(ne.layout_line["line-cap"]),"line-join":new li(ne.layout_line["line-join"]),"line-miter-limit":new ai(ne.layout_line["line-miter-limit"]),"line-round-limit":new ai(ne.layout_line["line-round-limit"]),"line-sort-key":new li(ne.layout_line["line-sort-key"])});var Ws={paint:new di({"line-opacity":new li(ne.paint_line["line-opacity"]),"line-color":new li(ne.paint_line["line-color"]),"line-translate":new ai(ne.paint_line["line-translate"]),"line-translate-anchor":new ai(ne.paint_line["line-translate-anchor"]),"line-width":new li(ne.paint_line["line-width"]),"line-gap-width":new li(ne.paint_line["line-gap-width"]),"line-offset":new li(ne.paint_line["line-offset"]),"line-blur":new li(ne.paint_line["line-blur"]),"line-dasharray":new ui(ne.paint_line["line-dasharray"]),"line-pattern":new ci(ne.paint_line["line-pattern"]),"line-gradient":new hi(ne.paint_line["line-gradient"])}),layout:Js};const Ys=new class extends li{possiblyEvaluate(e,t){return t=new Yn(Math.floor(t.zoom),{now:t.now,fadeDuration:t.fadeDuration,zoomHistory:t.zoomHistory,transition:t.transition}),super.possiblyEvaluate(e,t)}evaluate(e,t,r,n){return t=s({},t,{zoom:Math.floor(t.zoom)}),super.evaluate(e,t,r,n)}}(Ws.paint.properties["line-width"].specification);function ea(e,t){return t>0?t+2*e:e}Ys.useIntegerZoom=!0;const ta=_i([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),ra=_i([{name:"a_projected_pos",components:3,type:"Float32"}],4);_i([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const na=_i([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);_i([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const ia=_i([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Aa=_i([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function oa(e,t,r){return e.sections.forEach((e=>{e.text=function(e,t,r){const n=t.layout.get("text-transform").evaluate(r,{});return"uppercase"===n?e=e.toLocaleUpperCase():"lowercase"===n&&(e=e.toLocaleLowerCase()),Wn.applyArabicShaping&&(e=Wn.applyArabicShaping(e)),e}(e.text,t,r)})),e}_i([{name:"triangle",components:3,type:"Uint16"}]),_i([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),_i([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),_i([{type:"Float32",name:"offsetX"}]),_i([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);const sa={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};var aa=24,la=ha,ca=function(e,t,r,n,i){var A,o,s=8*i-n-1,a=(1<<s)-1,l=a>>1,c=-7,u=r?i-1:0,h=r?-1:1,d=e[t+u];for(u+=h,A=d&(1<<-c)-1,d>>=-c,c+=s;c>0;A=256*A+e[t+u],u+=h,c-=8);for(o=A&(1<<-c)-1,A>>=-c,c+=n;c>0;o=256*o+e[t+u],u+=h,c-=8);if(0===A)A=1-l;else{if(A===a)return o?NaN:1/0*(d?-1:1);o+=Math.pow(2,n),A-=l}return(d?-1:1)*o*Math.pow(2,A-n)},ua=function(e,t,r,n,i,A){var o,s,a,l=8*A-i-1,c=(1<<l)-1,u=c>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=n?0:A-1,p=n?1:-1,f=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,o=c):(o=Math.floor(Math.log(t)/Math.LN2),t*(a=Math.pow(2,-o))<1&&(o--,a*=2),(t+=o+u>=1?h/a:h*Math.pow(2,1-u))*a>=2&&(o++,a/=2),o+u>=c?(s=0,o=c):o+u>=1?(s=(t*a-1)*Math.pow(2,i),o+=u):(s=t*Math.pow(2,u-1)*Math.pow(2,i),o=0));i>=8;e[r+d]=255&s,d+=p,s/=256,i-=8);for(o=o<<i|s,l+=i;l>0;e[r+d]=255&o,d+=p,o/=256,l-=8);e[r+d-p]|=128*f};function ha(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}ha.Varint=0,ha.Fixed64=1,ha.Bytes=2,ha.Fixed32=5;var da,pa=4294967296,fa=1/pa,ma="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function ga(e){return e.type===ha.Bytes?e.readVarint()+e.pos:e.pos+1}function ya(e,t,r){return r?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}function _a(e,t,r){var n=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));r.realloc(n);for(var i=r.pos-1;i>=e;i--)r.buf[i+n]=r.buf[i]}function wa(e,t){for(var r=0;r<e.length;r++)t.writeVarint(e[r])}function xa(e,t){for(var r=0;r<e.length;r++)t.writeSVarint(e[r])}function Ba(e,t){for(var r=0;r<e.length;r++)t.writeFloat(e[r])}function va(e,t){for(var r=0;r<e.length;r++)t.writeDouble(e[r])}function ba(e,t){for(var r=0;r<e.length;r++)t.writeBoolean(e[r])}function Ca(e,t){for(var r=0;r<e.length;r++)t.writeFixed32(e[r])}function Fa(e,t){for(var r=0;r<e.length;r++)t.writeSFixed32(e[r])}function Ea(e,t){for(var r=0;r<e.length;r++)t.writeFixed64(e[r])}function Ua(e,t){for(var r=0;r<e.length;r++)t.writeSFixed64(e[r])}function Qa(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function Ia(e,t,r){e[r]=t,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24}function Ta(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}function Sa(e,t,r){1===e&&r.readMessage(Ma,t)}function Ma(e,t,r){if(3===e){const{id:e,bitmap:n,width:i,height:A,left:o,top:s,advance:a}=r.readMessage(ka,{});t.push({id:e,bitmap:new Qo({width:i+6,height:A+6},n),metrics:{width:i,height:A,left:o,top:s,advance:a}})}}function ka(e,t,r){1===e?t.id=r.readVarint():2===e?t.bitmap=r.readBytes():3===e?t.width=r.readVarint():4===e?t.height=r.readVarint():5===e?t.left=r.readSVarint():6===e?t.top=r.readSVarint():7===e&&(t.advance=r.readVarint())}function Da(e){let t=0,r=0;for(const n of e)t+=n.w*n.h,r=Math.max(r,n.w);e.sort(((e,t)=>t.h-e.h));const n=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),r),h:1/0}];let i=0,A=0;for(const t of e)for(let e=n.length-1;e>=0;e--){const r=n[e];if(!(t.w>r.w||t.h>r.h)){if(t.x=r.x,t.y=r.y,A=Math.max(A,t.y+t.h),i=Math.max(i,t.x+t.w),t.w===r.w&&t.h===r.h){const t=n.pop();e<n.length&&(n[e]=t)}else t.h===r.h?(r.x+=t.w,r.w-=t.w):t.w===r.w?(r.y+=t.h,r.h-=t.h):(n.push({x:r.x+t.w,y:r.y,w:r.w-t.w,h:t.h}),r.y+=t.h,r.h-=t.h);break}}return{w:i,h:A,fill:t/(i*A)||0}}ha.prototype={destroy:function(){this.buf=null},readFields:function(e,t,r){for(r=r||this.length;this.pos<r;){var n=this.readVarint(),i=n>>3,A=this.pos;this.type=7&n,e(i,t,this),this.pos===A&&this.skip(n)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=Qa(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=Ta(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=Qa(this.buf,this.pos)+Qa(this.buf,this.pos+4)*pa;return this.pos+=8,e},readSFixed64:function(){var e=Qa(this.buf,this.pos)+Ta(this.buf,this.pos+4)*pa;return this.pos+=8,e},readFloat:function(){var e=ca(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=ca(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var t,r,n=this.buf;return t=127&(r=n[this.pos++]),r<128?t:(t|=(127&(r=n[this.pos++]))<<7,r<128?t:(t|=(127&(r=n[this.pos++]))<<14,r<128?t:(t|=(127&(r=n[this.pos++]))<<21,r<128?t:function(e,t,r){var n,i,A=r.buf;if(n=(112&(i=A[r.pos++]))>>4,i<128)return ya(e,n,t);if(n|=(127&(i=A[r.pos++]))<<3,i<128)return ya(e,n,t);if(n|=(127&(i=A[r.pos++]))<<10,i<128)return ya(e,n,t);if(n|=(127&(i=A[r.pos++]))<<17,i<128)return ya(e,n,t);if(n|=(127&(i=A[r.pos++]))<<24,i<128)return ya(e,n,t);if(n|=(1&(i=A[r.pos++]))<<31,i<128)return ya(e,n,t);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(r=n[this.pos]))<<28,e,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2==1?(e+1)/-2:e/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var e=this.readVarint()+this.pos,t=this.pos;return this.pos=e,e-t>=12&&ma?function(e,t,r){return ma.decode(e.subarray(t,r))}(this.buf,t,e):function(e,t,r){for(var n="",i=t;i<r;){var A,o,s,a=e[i],l=null,c=a>239?4:a>223?3:a>191?2:1;if(i+c>r)break;1===c?a<128&&(l=a):2===c?128==(192&(A=e[i+1]))&&(l=(31&a)<<6|63&A)<=127&&(l=null):3===c?(o=e[i+2],128==(192&(A=e[i+1]))&&128==(192&o)&&((l=(15&a)<<12|(63&A)<<6|63&o)<=2047||l>=55296&&l<=57343)&&(l=null)):4===c&&(o=e[i+2],s=e[i+3],128==(192&(A=e[i+1]))&&128==(192&o)&&128==(192&s)&&((l=(15&a)<<18|(63&A)<<12|(63&o)<<6|63&s)<=65535||l>=1114112)&&(l=null)),null===l?(l=65533,c=1):l>65535&&(l-=65536,n+=String.fromCharCode(l>>>10&1023|55296),l=56320|1023&l),n+=String.fromCharCode(l),i+=c}return n}(this.buf,t,e)},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t},readPackedVarint:function(e,t){if(this.type!==ha.Bytes)return e.push(this.readVarint(t));var r=ga(this);for(e=e||[];this.pos<r;)e.push(this.readVarint(t));return e},readPackedSVarint:function(e){if(this.type!==ha.Bytes)return e.push(this.readSVarint());var t=ga(this);for(e=e||[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==ha.Bytes)return e.push(this.readBoolean());var t=ga(this);for(e=e||[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==ha.Bytes)return e.push(this.readFloat());var t=ga(this);for(e=e||[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==ha.Bytes)return e.push(this.readDouble());var t=ga(this);for(e=e||[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==ha.Bytes)return e.push(this.readFixed32());var t=ga(this);for(e=e||[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==ha.Bytes)return e.push(this.readSFixed32());var t=ga(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==ha.Bytes)return e.push(this.readFixed64());var t=ga(this);for(e=e||[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==ha.Bytes)return e.push(this.readSFixed64());var t=ga(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(e){var t=7&e;if(t===ha.Varint)for(;this.buf[this.pos++]>127;);else if(t===ha.Bytes)this.pos=this.readVarint()+this.pos;else if(t===ha.Fixed32)this.pos+=4;else{if(t!==ha.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t=this.length||16;t<this.pos+e;)t*=2;if(t!==this.length){var r=new Uint8Array(t);r.set(this.buf),this.buf=r,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),Ia(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),Ia(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),Ia(this.buf,-1&e,this.pos),Ia(this.buf,Math.floor(e*fa),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),Ia(this.buf,-1&e,this.pos),Ia(this.buf,Math.floor(e*fa),this.pos+4),this.pos+=8},writeVarint:function(e){(e=+e||0)>268435455||e<0?function(e,t){var r,n;if(e>=0?(r=e%4294967296|0,n=e/4294967296|0):(n=~(-e/4294967296),4294967295^(r=~(-e%4294967296))?r=r+1|0:(r=0,n=n+1|0)),e>=0x10000000000000000||e<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");t.realloc(10),function(e,t,r){r.buf[r.pos++]=127&e|128,e>>>=7,r.buf[r.pos++]=127&e|128,e>>>=7,r.buf[r.pos++]=127&e|128,e>>>=7,r.buf[r.pos++]=127&e|128,r.buf[r.pos]=127&(e>>>=7)}(r,0,t),function(e,t){var r=(7&e)<<4;t.buf[t.pos++]|=r|((e>>>=3)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e)))))}(n,t)}(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))},writeSVarint:function(e){this.writeVarint(e<0?2*-e-1:2*e)},writeBoolean:function(e){this.writeVarint(Boolean(e))},writeString:function(e){e=String(e),this.realloc(4*e.length),this.pos++;var t=this.pos;this.pos=function(e,t,r){for(var n,i,A=0;A<t.length;A++){if((n=t.charCodeAt(A))>55295&&n<57344){if(!i){n>56319||A+1===t.length?(e[r++]=239,e[r++]=191,e[r++]=189):i=n;continue}if(n<56320){e[r++]=239,e[r++]=191,e[r++]=189,i=n;continue}n=i-55296<<10|n-56320|65536,i=null}else i&&(e[r++]=239,e[r++]=191,e[r++]=189,i=null);n<128?e[r++]=n:(n<2048?e[r++]=n>>6|192:(n<65536?e[r++]=n>>12|224:(e[r++]=n>>18|240,e[r++]=n>>12&63|128),e[r++]=n>>6&63|128),e[r++]=63&n|128)}return r}(this.buf,e,this.pos);var r=this.pos-t;r>=128&&_a(t,r,this),this.pos=t-1,this.writeVarint(r),this.pos+=r},writeFloat:function(e){this.realloc(4),ua(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),ua(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t),this.realloc(t);for(var r=0;r<t;r++)this.buf[this.pos++]=e[r]},writeRawMessage:function(e,t){this.pos++;var r=this.pos;e(t,this);var n=this.pos-r;n>=128&&_a(r,n,this),this.pos=r-1,this.writeVarint(n),this.pos+=n},writeMessage:function(e,t,r){this.writeTag(e,ha.Bytes),this.writeRawMessage(t,r)},writePackedVarint:function(e,t){t.length&&this.writeMessage(e,wa,t)},writePackedSVarint:function(e,t){t.length&&this.writeMessage(e,xa,t)},writePackedBoolean:function(e,t){t.length&&this.writeMessage(e,ba,t)},writePackedFloat:function(e,t){t.length&&this.writeMessage(e,Ba,t)},writePackedDouble:function(e,t){t.length&&this.writeMessage(e,va,t)},writePackedFixed32:function(e,t){t.length&&this.writeMessage(e,Ca,t)},writePackedSFixed32:function(e,t){t.length&&this.writeMessage(e,Fa,t)},writePackedFixed64:function(e,t){t.length&&this.writeMessage(e,Ea,t)},writePackedSFixed64:function(e,t){t.length&&this.writeMessage(e,Ua,t)},writeBytesField:function(e,t){this.writeTag(e,ha.Bytes),this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,ha.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,ha.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,ha.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,ha.Fixed64),this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,ha.Varint),this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,ha.Varint),this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,ha.Bytes),this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,ha.Fixed32),this.writeFloat(t)},writeDoubleField:function(e,t){this.writeTag(e,ha.Fixed64),this.writeDouble(t)},writeBooleanField:function(e,t){this.writeVarintField(e,Boolean(t))}};class La{constructor(e,{pixelRatio:t,version:r,stretchX:n,stretchY:i,content:A}){this.paddedRect=e,this.pixelRatio=t,this.stretchX=n,this.stretchY=i,this.content=A,this.version=r}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class Pa{constructor(e,t){const r={},n={};this.haveRenderCallbacks=[];const i=[];this.addImages(e,r,i),this.addImages(t,n,i);const{w:A,h:o}=Da(i),s=new Io({width:A||1,height:o||1});for(const t in e){const n=e[t],i=r[t].paddedRect;Io.copy(n.data,s,{x:0,y:0},{x:i.x+1,y:i.y+1},n.data)}for(const e in t){const r=t[e],i=n[e].paddedRect,A=i.x+1,o=i.y+1,a=r.data.width,l=r.data.height;Io.copy(r.data,s,{x:0,y:0},{x:A,y:o},r.data),Io.copy(r.data,s,{x:0,y:l-1},{x:A,y:o-1},{width:a,height:1}),Io.copy(r.data,s,{x:0,y:0},{x:A,y:o+l},{width:a,height:1}),Io.copy(r.data,s,{x:a-1,y:0},{x:A-1,y:o},{width:1,height:l}),Io.copy(r.data,s,{x:0,y:0},{x:A+a,y:o},{width:1,height:l})}this.image=s,this.iconPositions=r,this.patternPositions=n}addImages(e,t,r){for(const n in e){const i=e[n],A={x:0,y:0,w:i.data.width+2,h:i.data.height+2};r.push(A),t[n]=new La(A,i),i.hasRenderCallback&&this.haveRenderCallbacks.push(n)}}patchUpdatedImages(e,t){e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const r in e.updatedImages)this.patchUpdatedImage(this.iconPositions[r],e.getImage(r),t),this.patchUpdatedImage(this.patternPositions[r],e.getImage(r),t)}patchUpdatedImage(e,t,r){if(!e||!t)return;if(e.version===t.version)return;e.version=t.version;const[n,i]=e.tl;r.update(t.data,void 0,{x:n,y:i})}}En("ImagePosition",La),En("ImageAtlas",Pa),e.WritingMode=void 0,(da=e.WritingMode||(e.WritingMode={}))[da.none=0]="none",da[da.horizontal=1]="horizontal",da[da.vertical=2]="vertical",da[da.horizontalOnly=3]="horizontalOnly";const Ha=-17;class za{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,t){const r=new za;return r.scale=e||1,r.fontStack=t,r}static forImage(e){const t=new za;return t.imageName=e,t}}class Ra{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,t){const r=new Ra;for(let n=0;n<e.sections.length;n++){const i=e.sections[n];i.image?r.addImageSection(i):r.addTextSection(i,t)}return r}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(){this.text=function(e){let t="";for(let r=0;r<e.length;r++){const n=e.charCodeAt(r+1)||null,i=e.charCodeAt(r-1)||null;t+=n&&Pn(n)&&!sa[e[r+1]]||i&&Pn(i)&&!sa[e[r-1]]||!sa[e[r]]?e[r]:sa[e[r]]}return t}(this.text)}trim(){let e=0;for(let t=0;t<this.text.length&&Ka[this.text.charCodeAt(t)];t++)e++;let t=this.text.length;for(let r=this.text.length-1;r>=0&&r>=e&&Ka[this.text.charCodeAt(r)];r--)t--;this.text=this.text.substring(e,t),this.sectionIndex=this.sectionIndex.slice(e,t)}substring(e,t){const r=new Ra;return r.text=this.text.substring(e,t),r.sectionIndex=this.sectionIndex.slice(e,t),r.sections=this.sections,r}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce(((e,t)=>Math.max(e,this.sections[t].scale)),0)}addTextSection(e,t){this.text+=e.text,this.sections.push(za.forText(e.scale,e.fontStack||t));const r=this.sections.length-1;for(let t=0;t<e.text.length;++t)this.sectionIndex.push(r)}addImageSection(e){const t=e.image?e.image.name:"";if(0===t.length)return void p("Can't add FormattedSection with an empty image.");const r=this.getNextImageSectionCharCode();r?(this.text+=String.fromCharCode(r),this.sections.push(za.forImage(t)),this.sectionIndex.push(this.sections.length-1)):p("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Oa(t,r,n,i,A,o,s,a,l,c,u,h,d,p,f,m){const g=Ra.fromFeature(t,A);let y;h===e.WritingMode.vertical&&g.verticalizePunctuation();const{processBidirectionalText:_,processStyledBidirectionalText:w}=Wn;if(_&&1===g.sections.length){y=[];const e=_(g.toString(),ja(g,c,o,r,i,p,f));for(const t of e){const e=new Ra;e.text=t,e.sections=g.sections;for(let r=0;r<t.length;r++)e.sectionIndex.push(0);y.push(e)}}else if(w){y=[];const e=w(g.text,g.sectionIndex,ja(g,c,o,r,i,p,f));for(const t of e){const e=new Ra;e.text=t[0],e.sectionIndex=t[1],e.sections=g.sections,y.push(e)}}else y=function(e,t){const r=[],n=e.text;let i=0;for(const n of t)r.push(e.substring(i,n)),i=n;return i<n.length&&r.push(e.substring(i,n.length)),r}(g,ja(g,c,o,r,i,p,f));const x=[],B={positionedLines:x,text:g.toString(),top:u[1],bottom:u[1],left:u[0],right:u[0],writingMode:h,iconsInText:!1,verticalizable:!1};return function(t,r,n,i,A,o,s,a,l,c,u,h){let d=0,p=Ha,f=0,m=0;const g="right"===a?1:"left"===a?0:.5;let y=0;for(const s of A){s.trim();const A=s.getMaxScale(),a=(A-1)*aa,w={positionedGlyphs:[],lineOffset:0};t.positionedLines[y]=w;const x=w.positionedGlyphs;let B=0;if(!s.length()){p+=o,++y;continue}for(let o=0;o<s.length();o++){const f=s.getSection(o),m=s.getSectionIndex(o),g=s.getCharCode(o);let y=0,w=null,v=null,b=null,C=aa;const F=!(l===e.WritingMode.horizontal||!u&&!Ln(g)||u&&(Ka[g]||(_=g,Sn.Arabic(_)||Sn["Arabic Supplement"](_)||Sn["Arabic Extended-A"](_)||Sn["Arabic Presentation Forms-A"](_)||Sn["Arabic Presentation Forms-B"](_))));if(f.imageName){const e=i[f.imageName];if(!e)continue;b=f.imageName,t.iconsInText=t.iconsInText||!0,v=e.paddedRect;const r=e.displaySize;f.scale=f.scale*aa/h,w={width:r[0],height:r[1],left:1,top:-3,advance:F?r[1]:r[0]},y=a+(aa-r[1]*f.scale),C=w.advance;const n=F?r[0]*f.scale-aa*A:r[1]*f.scale-aa*A;n>0&&n>B&&(B=n)}else{const e=n[f.fontStack],t=e&&e[g];if(t&&t.rect)v=t.rect,w=t.metrics;else{const e=r[f.fontStack],t=e&&e[g];if(!t)continue;w=t.metrics}y=(A-f.scale)*aa}F?(t.verticalizable=!0,x.push({glyph:g,imageName:b,x:d,y:p+y,vertical:F,scale:f.scale,fontStack:f.fontStack,sectionIndex:m,metrics:w,rect:v}),d+=C*f.scale+c):(x.push({glyph:g,imageName:b,x:d,y:p+y,vertical:F,scale:f.scale,fontStack:f.fontStack,sectionIndex:m,metrics:w,rect:v}),d+=w.advance*f.scale+c)}0!==x.length&&(f=Math.max(d-c,f),Ja(x,0,x.length-1,g,B)),d=0;const v=o*A+B;w.lineOffset=Math.max(B,a),p+=v,m=Math.max(v,m),++y}var _;const w=p-Ha,{horizontalAlign:x,verticalAlign:B}=Za(s);(function(e,t,r,n,i,A,o,s,a){const l=(t-r)*i;let c=0;c=A!==o?-s*n-Ha:(-n*a+.5)*o;for(const t of e)for(const e of t.positionedGlyphs)e.x+=l,e.y+=c})(t.positionedLines,g,x,B,f,m,o,w,A.length),t.top+=-B*w,t.bottom=t.top+w,t.left+=-x*f,t.right=t.left+f}(B,r,n,i,y,s,a,l,h,c,d,m),!function(e){for(const t of e)if(0!==t.positionedGlyphs.length)return!1;return!0}(x)&&B}const Ka={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Va={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function $a(e,t,r,n,i,A){if(t.imageName){const e=n[t.imageName];return e?e.displaySize[0]*t.scale*aa/A+i:0}{const n=r[t.fontStack],A=n&&n[e];return A?A.metrics.advance*t.scale+i:0}}function Na(e,t,r,n){const i=Math.pow(e-t,2);return n?e<t?i/2:2*i:i+Math.abs(r)*r}function Ga(e,t,r){let n=0;return 10===e&&(n-=1e4),r&&(n+=150),40!==e&&65288!==e||(n+=50),41!==t&&65289!==t||(n+=50),n}function qa(e,t,r,n,i,A){let o=null,s=Na(t,r,i,A);for(const e of n){const n=Na(t-e.x,r,i,A)+e.badness;n<=s&&(o=e,s=n)}return{index:e,x:t,priorBreak:o,badness:s}}function Xa(e){return e?Xa(e.priorBreak).concat(e.index):[]}function ja(e,t,r,n,i,A,o){if("point"!==A)return[];if(!e)return[];const s=[],a=function(e,t,r,n,i,A){let o=0;for(let r=0;r<e.length();r++){const s=e.getSection(r);o+=$a(e.getCharCode(r),s,n,i,t,A)}return o/Math.max(1,Math.ceil(o/r))}(e,t,r,n,i,o),l=e.text.indexOf("​")>=0;let c=0;for(let r=0;r<e.length();r++){const A=e.getSection(r),h=e.getCharCode(r);if(Ka[h]||(c+=$a(h,A,n,i,t,o)),r<e.length()-1){const t=!((u=h)<11904||!(Sn["Bopomofo Extended"](u)||Sn.Bopomofo(u)||Sn["CJK Compatibility Forms"](u)||Sn["CJK Compatibility Ideographs"](u)||Sn["CJK Compatibility"](u)||Sn["CJK Radicals Supplement"](u)||Sn["CJK Strokes"](u)||Sn["CJK Symbols and Punctuation"](u)||Sn["CJK Unified Ideographs Extension A"](u)||Sn["CJK Unified Ideographs"](u)||Sn["Enclosed CJK Letters and Months"](u)||Sn["Halfwidth and Fullwidth Forms"](u)||Sn.Hiragana(u)||Sn["Ideographic Description Characters"](u)||Sn["Kangxi Radicals"](u)||Sn["Katakana Phonetic Extensions"](u)||Sn.Katakana(u)||Sn["Vertical Forms"](u)||Sn["Yi Radicals"](u)||Sn["Yi Syllables"](u)));(Va[h]||t||A.imageName)&&s.push(qa(r+1,c,a,s,Ga(h,e.getCharCode(r+1),t&&l),!1))}}var u;return Xa(qa(e.length(),c,a,s,0,!0))}function Za(e){let t=.5,r=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(e){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:t,verticalAlign:r}}function Ja(e,t,r,n,i){if(!n&&!i)return;const A=e[r],o=(e[r].x+A.metrics.advance*A.scale)*n;for(let n=t;n<=r;n++)e[n].x-=o,e[n].y+=i}function Wa(e,t,r){const{horizontalAlign:n,verticalAlign:i}=Za(r),A=t[0]-e.displaySize[0]*n,o=t[1]-e.displaySize[1]*i;return{image:e,top:o,bottom:o+e.displaySize[1],left:A,right:A+e.displaySize[0]}}function Ya(e,t,r,n,i,A){const o=e.image;let s;if(o.content){const e=o.content,t=o.pixelRatio||1;s=[e[0]/t,e[1]/t,o.displaySize[0]-e[2]/t,o.displaySize[1]-e[3]/t]}const a=t.left*A,l=t.right*A;let c,u,h,d;"width"===r||"both"===r?(d=i[0]+a-n[3],u=i[0]+l+n[1]):(d=i[0]+(a+l-o.displaySize[0])/2,u=d+o.displaySize[0]);const p=t.top*A,f=t.bottom*A;return"height"===r||"both"===r?(c=i[1]+p-n[0],h=i[1]+f+n[2]):(c=i[1]+(p+f-o.displaySize[1])/2,h=c+o.displaySize[1]),{image:o,top:c,right:u,bottom:h,left:d,collisionPadding:s}}const el=128;function tl(e,t){const{expression:r}=t;if("constant"===r.kind)return{kind:"constant",layoutSize:r.evaluate(new Yn(e+1))};if("source"===r.kind)return{kind:"source"};{const{zoomStops:t,interpolationType:n}=r;let i=0;for(;i<t.length&&t[i]<=e;)i++;i=Math.max(0,i-1);let A=i;for(;A<t.length&&t[A]<e+1;)A++;A=Math.min(t.length-1,A);const o=t[i],s=t[A];return"composite"===r.kind?{kind:"composite",minZoom:o,maxZoom:s,interpolationType:n}:{kind:"camera",minZoom:o,maxZoom:s,minSize:r.evaluate(new Yn(o)),maxSize:r.evaluate(new Yn(s)),interpolationType:n}}}class rl extends C{constructor(e,t,r,n){super(e,t),this.angle=r,void 0!==n&&(this.segment=n)}clone(){return new rl(this.x,this.y,this.angle,this.segment)}}function nl(e,t,r,n,i){if(void 0===t.segment)return!0;let A=t,o=t.segment+1,s=0;for(;s>-r/2;){if(o--,o<0)return!1;s-=e[o].dist(A),A=e[o]}s+=e[o].dist(e[o+1]),o++;const a=[];let l=0;for(;s<r/2;){const t=e[o],r=e[o+1];if(!r)return!1;let A=e[o-1].angleTo(t)-t.angleTo(r);for(A=Math.abs((A+3*Math.PI)%(2*Math.PI)-Math.PI),a.push({distance:s,angleDelta:A}),l+=A;s-a[0].distance>n;)l-=a.shift().angleDelta;if(l>i)return!1;o++,s+=t.dist(r)}return!0}function il(e){let t=0;for(let r=0;r<e.length-1;r++)t+=e[r].dist(e[r+1]);return t}function Al(e,t,r){return e?.6*t*r:0}function ol(e,t){return Math.max(e?e.right-e.left:0,t?t.right-t.left:0)}function sl(e,t,r,n,i,A){const o=Al(r,i,A),s=ol(r,n)*A;let a=0;const l=il(e)/2;for(let r=0;r<e.length-1;r++){const n=e[r],i=e[r+1],A=n.dist(i);if(a+A>l){const c=(l-a)/A,u=Ct(n.x,i.x,c),h=Ct(n.y,i.y,c),d=new rl(u,h,i.angleTo(n),r);return d._round(),!o||nl(e,d,s,o,t)?d:void 0}a+=A}}function al(e,t,r,n,i,A,o,s,a){const l=Al(n,A,o),c=ol(n,i),u=c*o,h=0===e[0].x||e[0].x===a||0===e[0].y||e[0].y===a;return t-u<t/4&&(t=u+t/4),ll(e,h?t/2*s%t:(c/2+2*A)*o*s%t,t,l,r,u,h,!1,a)}function ll(e,t,r,n,i,A,o,s,a){const l=A/2,c=il(e);let u=0,h=t-r,d=[];for(let t=0;t<e.length-1;t++){const o=e[t],s=e[t+1],p=o.dist(s),f=s.angleTo(o);for(;h+r<u+p;){h+=r;const m=(h-u)/p,g=Ct(o.x,s.x,m),y=Ct(o.y,s.y,m);if(g>=0&&g<a&&y>=0&&y<a&&h-l>=0&&h+l<=c){const r=new rl(g,y,f,t);r._round(),n&&!nl(e,r,A,n,i)||d.push(r)}}u+=p}return s||d.length||o||(d=ll(e,u/2,r,n,i,A,o,!0,a)),d}function cl(e,t,r,n,i){const A=[];for(let o=0;o<e.length;o++){const s=e[o];let a;for(let e=0;e<s.length-1;e++){let o=s[e],l=s[e+1];o.x<t&&l.x<t||(o.x<t?o=new C(t,o.y+(t-o.x)/(l.x-o.x)*(l.y-o.y))._round():l.x<t&&(l=new C(t,o.y+(t-o.x)/(l.x-o.x)*(l.y-o.y))._round()),o.y<r&&l.y<r||(o.y<r?o=new C(o.x+(r-o.y)/(l.y-o.y)*(l.x-o.x),r)._round():l.y<r&&(l=new C(o.x+(r-o.y)/(l.y-o.y)*(l.x-o.x),r)._round()),o.x>=n&&l.x>=n||(o.x>=n?o=new C(n,o.y+(n-o.x)/(l.x-o.x)*(l.y-o.y))._round():l.x>=n&&(l=new C(n,o.y+(n-o.x)/(l.x-o.x)*(l.y-o.y))._round()),o.y>=i&&l.y>=i||(o.y>=i?o=new C(o.x+(i-o.y)/(l.y-o.y)*(l.x-o.x),i)._round():l.y>=i&&(l=new C(o.x+(i-o.y)/(l.y-o.y)*(l.x-o.x),i)._round()),a&&o.equals(a[a.length-1])||(a=[o],A.push(a)),a.push(l)))))}}return A}function ul(e,t,r,n){const i=[],A=e.image,o=A.pixelRatio,s=A.paddedRect.w-2,a=A.paddedRect.h-2,l=e.right-e.left,c=e.bottom-e.top,u=A.stretchX||[[0,s]],h=A.stretchY||[[0,a]],d=(e,t)=>e+t[1]-t[0],p=u.reduce(d,0),f=h.reduce(d,0),m=s-p,g=a-f;let y=0,_=p,w=0,x=f,B=0,v=m,b=0,F=g;if(A.content&&n){const e=A.content;y=hl(u,0,e[0]),w=hl(h,0,e[1]),_=hl(u,e[0],e[2]),x=hl(h,e[1],e[3]),B=e[0]-y,b=e[1]-w,v=e[2]-e[0]-_,F=e[3]-e[1]-x}const E=(n,i,s,a)=>{const u=pl(n.stretch-y,_,l,e.left),h=fl(n.fixed-B,v,n.stretch,p),d=pl(i.stretch-w,x,c,e.top),m=fl(i.fixed-b,F,i.stretch,f),g=pl(s.stretch-y,_,l,e.left),E=fl(s.fixed-B,v,s.stretch,p),U=pl(a.stretch-w,x,c,e.top),Q=fl(a.fixed-b,F,a.stretch,f),I=new C(u,d),T=new C(g,d),S=new C(g,U),M=new C(u,U),k=new C(h/o,m/o),D=new C(E/o,Q/o),L=t*Math.PI/180;if(L){const e=Math.sin(L),t=Math.cos(L),r=[t,-e,e,t];I._matMult(r),T._matMult(r),M._matMult(r),S._matMult(r)}const P=n.stretch+n.fixed,H=i.stretch+i.fixed;return{tl:I,tr:T,bl:M,br:S,tex:{x:A.paddedRect.x+1+P,y:A.paddedRect.y+1+H,w:s.stretch+s.fixed-P,h:a.stretch+a.fixed-H},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:k,pixelOffsetBR:D,minFontScaleX:v/o/l,minFontScaleY:F/o/c,isSDF:r}};if(n&&(A.stretchX||A.stretchY)){const e=dl(u,m,p),t=dl(h,g,f);for(let r=0;r<e.length-1;r++){const n=e[r],A=e[r+1];for(let e=0;e<t.length-1;e++)i.push(E(n,t[e],A,t[e+1]))}}else i.push(E({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:s+1},{fixed:0,stretch:a+1}));return i}function hl(e,t,r){let n=0;for(const i of e)n+=Math.max(t,Math.min(r,i[1]))-Math.max(t,Math.min(r,i[0]));return n}function dl(e,t,r){const n=[{fixed:-1,stretch:0}];for(const[t,r]of e){const e=n[n.length-1];n.push({fixed:t-e.stretch,stretch:e.stretch}),n.push({fixed:t-e.stretch,stretch:e.stretch+(r-t)})}return n.push({fixed:t+1,stretch:r}),n}function pl(e,t,r,n){return e/t*r+n}function fl(e,t,r,n){return e-t*r/n}En("Anchor",rl);class ml{constructor(e,t,r,n,i,A,o,s,a,l){if(this.boxStartIndex=e.length,a){let e=A.top,t=A.bottom;const r=A.collisionPadding;r&&(e-=r[1],t+=r[3]);let n=t-e;n>0&&(n=Math.max(10,n),this.circleDiameter=n)}else{let a=A.top*o-s[0],c=A.bottom*o+s[2],u=A.left*o-s[3],h=A.right*o+s[1];const d=A.collisionPadding;if(d&&(u-=d[0]*o,a-=d[1]*o,h+=d[2]*o,c+=d[3]*o),l){const e=new C(u,a),t=new C(h,a),r=new C(u,c),n=new C(h,c),i=l*Math.PI/180;e._rotate(i),t._rotate(i),r._rotate(i),n._rotate(i),u=Math.min(e.x,t.x,r.x,n.x),h=Math.max(e.x,t.x,r.x,n.x),a=Math.min(e.y,t.y,r.y,n.y),c=Math.max(e.y,t.y,r.y,n.y)}e.emplaceBack(t.x,t.y,u,a,h,c,r,n,i)}this.boxEndIndex=e.length}}class gl{constructor(e=[],t=yl){if(this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(let e=(this.length>>1)-1;e>=0;e--)this._down(e)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const e=this.data[0],t=this.data.pop();return this.length--,this.length>0&&(this.data[0]=t,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:t,compare:r}=this,n=t[e];for(;e>0;){const i=e-1>>1,A=t[i];if(r(n,A)>=0)break;t[e]=A,e=i}t[e]=n}_down(e){const{data:t,compare:r}=this,n=this.length>>1,i=t[e];for(;e<n;){let n=1+(e<<1),A=t[n];const o=n+1;if(o<this.length&&r(t[o],A)<0&&(n=o,A=t[o]),r(A,i)>=0)break;t[e]=A,e=n}t[e]=i}}function yl(e,t){return e<t?-1:e>t?1:0}function _l(e,t=1,r=!1){let n=1/0,i=1/0,A=-1/0,o=-1/0;const s=e[0];for(let e=0;e<s.length;e++){const t=s[e];(!e||t.x<n)&&(n=t.x),(!e||t.y<i)&&(i=t.y),(!e||t.x>A)&&(A=t.x),(!e||t.y>o)&&(o=t.y)}const a=Math.min(A-n,o-i);let l=a/2;const c=new gl([],wl);if(0===a)return new C(n,i);for(let t=n;t<A;t+=a)for(let r=i;r<o;r+=a)c.push(new xl(t+l,r+l,l,e));let u=function(e){let t=0,r=0,n=0;const i=e[0];for(let e=0,A=i.length,o=A-1;e<A;o=e++){const A=i[e],s=i[o],a=A.x*s.y-s.x*A.y;r+=(A.x+s.x)*a,n+=(A.y+s.y)*a,t+=3*a}return new xl(r/t,n/t,0,e)}(e),h=c.length;for(;c.length;){const n=c.pop();(n.d>u.d||!u.d)&&(u=n,r&&console.log("found best %d after %d probes",Math.round(1e4*n.d)/1e4,h)),n.max-u.d<=t||(l=n.h/2,c.push(new xl(n.p.x-l,n.p.y-l,l,e)),c.push(new xl(n.p.x+l,n.p.y-l,l,e)),c.push(new xl(n.p.x-l,n.p.y+l,l,e)),c.push(new xl(n.p.x+l,n.p.y+l,l,e)),h+=4)}return r&&(console.log(`num probes: ${h}`),console.log(`best distance: ${u.d}`)),u.p}function wl(e,t){return t.max-e.max}function xl(e,t,r,n){this.p=new C(e,t),this.h=r,this.d=function(e,t){let r=!1,n=1/0;for(let i=0;i<t.length;i++){const A=t[i];for(let t=0,i=A.length,o=i-1;t<i;o=t++){const i=A[t],s=A[o];i.y>e.y!=s.y>e.y&&e.x<(s.x-i.x)*(e.y-i.y)/(s.y-i.y)+i.x&&(r=!r),n=Math.min(n,ro(e,i,s))}}return(r?1:-1)*Math.sqrt(n)}(this.p,n),this.max=this.d+this.h*Math.SQRT2}const Bl=Number.POSITIVE_INFINITY;function vl(e,t){return t[1]!==Bl?function(e,t,r){let n=0,i=0;switch(t=Math.abs(t),r=Math.abs(r),e){case"top-right":case"top-left":case"top":i=r-7;break;case"bottom-right":case"bottom-left":case"bottom":i=7-r}switch(e){case"top-right":case"bottom-right":case"right":n=-t;break;case"top-left":case"bottom-left":case"left":n=t}return[n,i]}(e,t[0],t[1]):function(e,t){let r=0,n=0;t<0&&(t=0);const i=t/Math.sqrt(2);switch(e){case"top-right":case"top-left":n=i-7;break;case"bottom-right":case"bottom-left":n=7-i;break;case"bottom":n=7-t;break;case"top":n=t-7}switch(e){case"top-right":case"bottom-right":r=-i;break;case"top-left":case"bottom-left":r=i;break;case"left":r=t;break;case"right":r=-t}return[r,n]}(e,t[0])}function bl(e){switch(e){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Cl(t,r,n,i,A,o,s,a,l,c,u){let h=o.textMaxSize.evaluate(r,{});void 0===h&&(h=s);const d=t.layers[0].layout,f=d.get("icon-offset").evaluate(r,{},u),m=Ul(n.horizontal),g=s/24,y=t.tilePixelRatio*g,_=t.tilePixelRatio*h/24,w=t.tilePixelRatio*a,x=t.tilePixelRatio*d.get("symbol-spacing"),B=d.get("text-padding")*t.tilePixelRatio,v=function(e,t,r,n=1){const i=e.get("icon-padding").evaluate(t,{},r),A=i&&i.values;return[A[0]*n,A[1]*n,A[2]*n,A[3]*n]}(d,r,u,t.tilePixelRatio),b=d.get("text-max-angle")/180*Math.PI,C="viewport"!==d.get("text-rotation-alignment")&&"point"!==d.get("symbol-placement"),F="map"===d.get("icon-rotation-alignment")&&"point"!==d.get("symbol-placement"),E=d.get("symbol-placement"),U=x/2,Q=d.get("icon-text-fit");let I;i&&"none"!==Q&&(t.allowVerticalPlacement&&n.vertical&&(I=Ya(i,n.vertical,Q,d.get("icon-text-fit-padding"),f,g)),m&&(i=Ya(i,m,Q,d.get("icon-text-fit-padding"),f,g)));const T=(a,h)=>{h.x<0||h.x>=KA||h.y<0||h.y>=KA||function(t,r,n,i,A,o,s,a,l,c,u,h,d,f,m,g,y,_,w,x,B,v,b,C,F){const E=t.addToLineVertexArray(r,n);let U,Q,I,T,S=0,M=0,k=0,D=0,L=-1,P=-1;const H={};let z=yA.exports(""),R=0,O=0;if(void 0===a._unevaluatedLayout.getValue("text-radial-offset")?[R,O]=a.layout.get("text-offset").evaluate(B,{},C).map((e=>e*aa)):(R=a.layout.get("text-radial-offset").evaluate(B,{},C)*aa,O=Bl),t.allowVerticalPlacement&&i.vertical){const e=a.layout.get("text-rotate").evaluate(B,{},C)+90;I=new ml(l,r,c,u,h,i.vertical,d,f,m,e),s&&(T=new ml(l,r,c,u,h,s,y,_,m,e))}if(A){const n=a.layout.get("icon-rotate").evaluate(B,{}),i="none"!==a.layout.get("icon-text-fit"),o=ul(A,n,b,i),d=s?ul(s,n,b,i):void 0;Q=new ml(l,r,c,u,h,A,y,_,!1,n),S=4*o.length;const f=t.iconSizeData;let m=null;"source"===f.kind?(m=[el*a.layout.get("icon-size").evaluate(B,{})],m[0]>Fl&&p(`${t.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):"composite"===f.kind&&(m=[el*v.compositeIconSizes[0].evaluate(B,{},C),el*v.compositeIconSizes[1].evaluate(B,{},C)],(m[0]>Fl||m[1]>Fl)&&p(`${t.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),t.addSymbols(t.icon,o,m,x,w,B,e.WritingMode.none,r,E.lineStartIndex,E.lineLength,-1,C),L=t.icon.placedSymbolArray.length-1,d&&(M=4*d.length,t.addSymbols(t.icon,d,m,x,w,B,e.WritingMode.vertical,r,E.lineStartIndex,E.lineLength,-1,C),P=t.icon.placedSymbolArray.length-1)}const K=Object.keys(i.horizontal);for(const n of K){const A=i.horizontal[n];if(!U){z=yA.exports(A.text);const e=a.layout.get("text-rotate").evaluate(B,{},C);U=new ml(l,r,c,u,h,A,d,f,m,e)}const s=1===A.positionedLines.length;if(k+=El(t,r,A,o,a,m,B,g,E,i.vertical?e.WritingMode.horizontal:e.WritingMode.horizontalOnly,s?K:[n],H,L,v,C),s)break}i.vertical&&(D+=El(t,r,i.vertical,o,a,m,B,g,E,e.WritingMode.vertical,["vertical"],H,P,v,C));const V=U?U.boxStartIndex:t.collisionBoxArray.length,$=U?U.boxEndIndex:t.collisionBoxArray.length,N=I?I.boxStartIndex:t.collisionBoxArray.length,G=I?I.boxEndIndex:t.collisionBoxArray.length,q=Q?Q.boxStartIndex:t.collisionBoxArray.length,X=Q?Q.boxEndIndex:t.collisionBoxArray.length,j=T?T.boxStartIndex:t.collisionBoxArray.length,Z=T?T.boxEndIndex:t.collisionBoxArray.length;let J=-1;const W=(e,t)=>e&&e.circleDiameter?Math.max(e.circleDiameter,t):t;J=W(U,J),J=W(I,J),J=W(Q,J),J=W(T,J);const Y=J>-1?1:0;Y&&(J*=F/aa),t.glyphOffsetArray.length>=Pl.MAX_GLYPHS&&p("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==B.sortKey&&t.addToSortKeyRanges(t.symbolInstances.length,B.sortKey),t.symbolInstances.emplaceBack(r.x,r.y,H.right>=0?H.right:-1,H.center>=0?H.center:-1,H.left>=0?H.left:-1,H.vertical||-1,L,P,z,V,$,N,G,q,X,j,Z,c,k,D,S,M,Y,0,d,R,O,J)}(t,h,a,n,i,A,I,t.layers[0],t.collisionBoxArray,r.index,r.sourceLayerIndex,t.index,y,[B,B,B,B],C,l,w,v,F,f,r,o,c,u,s)};if("line"===E)for(const e of cl(r.geometry,0,0,KA,KA)){const r=al(e,x,b,n.vertical||m,i,24,_,t.overscaling,KA);for(const n of r)m&&Ql(t,m.text,U,n)||T(e,n)}else if("line-center"===E){for(const e of r.geometry)if(e.length>1){const t=sl(e,b,n.vertical||m,i,24,_);t&&T(e,t)}}else if("Polygon"===r.type)for(const e of hs(r.geometry,0)){const t=_l(e,16);T(e[0],new rl(t.x,t.y,0))}else if("LineString"===r.type)for(const e of r.geometry)T(e,new rl(e[0].x,e[0].y,0));else if("Point"===r.type)for(const e of r.geometry)for(const t of e)T([t],new rl(t.x,t.y,0))}const Fl=32640;function El(e,t,r,n,i,A,o,s,a,l,c,u,h,d,f){const m=function(e,t,r,n,i,A,o,s){const a=n.layout.get("text-rotate").evaluate(A,{})*Math.PI/180,l=[];for(const e of t.positionedLines)for(const n of e.positionedGlyphs){if(!n.rect)continue;const A=n.rect||{};let c=4,u=!0,h=1,d=0;const p=(i||s)&&n.vertical,f=n.metrics.advance*n.scale/2;if(s&&t.verticalizable){const t=(n.scale-1)*aa,r=(aa-n.metrics.width*n.scale)/2;d=e.lineOffset/2-(n.imageName?-r:t)}if(n.imageName){const e=o[n.imageName];u=e.sdf,h=e.pixelRatio,c=1/h}const m=i?[n.x+f,n.y]:[0,0];let g=i?[0,0]:[n.x+f+r[0],n.y+r[1]-d],y=[0,0];p&&(y=g,g=[0,0]);const _=(n.metrics.left-c)*n.scale-f+g[0],w=(-n.metrics.top-c)*n.scale+g[1],x=_+A.w*n.scale/h,B=w+A.h*n.scale/h,v=new C(_,w),b=new C(x,w),F=new C(_,B),E=new C(x,B);if(p){const e=new C(-f,f-Ha),t=-Math.PI/2,r=12-f,i=new C(22-r,-(n.imageName?r:0)),A=new C(...y);v._rotateAround(t,e)._add(i)._add(A),b._rotateAround(t,e)._add(i)._add(A),F._rotateAround(t,e)._add(i)._add(A),E._rotateAround(t,e)._add(i)._add(A)}if(a){const e=Math.sin(a),t=Math.cos(a),r=[t,-e,e,t];v._matMult(r),b._matMult(r),F._matMult(r),E._matMult(r)}const U=new C(0,0),Q=new C(0,0);l.push({tl:v,tr:b,bl:F,br:E,tex:A,writingMode:t.writingMode,glyphOffset:m,sectionIndex:n.sectionIndex,isSDF:u,pixelOffsetTL:U,pixelOffsetBR:Q,minFontScaleX:0,minFontScaleY:0})}return l}(0,r,s,i,A,o,n,e.allowVerticalPlacement),g=e.textSizeData;let y=null;"source"===g.kind?(y=[el*i.layout.get("text-size").evaluate(o,{})],y[0]>Fl&&p(`${e.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):"composite"===g.kind&&(y=[el*d.compositeTextSizes[0].evaluate(o,{},f),el*d.compositeTextSizes[1].evaluate(o,{},f)],(y[0]>Fl||y[1]>Fl)&&p(`${e.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),e.addSymbols(e.text,m,y,s,A,o,l,t,a.lineStartIndex,a.lineLength,h,f);for(const t of c)u[t]=e.text.placedSymbolArray.length-1;return 4*m.length}function Ul(e){for(const t in e)return e[t];return null}function Ql(e,t,r,n){const i=e.compareText;if(t in i){const e=i[t];for(let t=e.length-1;t>=0;t--)if(n.dist(e[t])<r)return!0}else i[t]=[];return i[t].push(n),!1}const Il=Bs.VectorTileFeature.types,Tl=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Sl(e,t,r,n,i,A,o,s,a,l,c,u,h){const d=s?Math.min(Fl,Math.round(s[0])):0,p=s?Math.min(Fl,Math.round(s[1])):0;e.emplaceBack(t,r,Math.round(32*n),Math.round(32*i),A,o,(d<<1)+(a?1:0),p,16*l,16*c,256*u,256*h)}function Ml(e,t,r){e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r)}function kl(e){for(const t of e.sections)if(Rn(t.text))return!0;return!1}class Dl{constructor(e){this.layoutVertexArray=new oA,this.indexArray=new uA,this.programConfigurations=e,this.segments=new fA,this.dynamicLayoutVertexArray=new sA,this.opacityVertexArray=new aA,this.placedSymbolArray=new Gi}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(e,t,r,n){this.isEmpty()||(r&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,ta.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,t),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,ra.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,Tl,!0),this.opacityVertexBuffer.itemSize=1),(r||n)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}En("SymbolBuffers",Dl);class Ll{constructor(e,t,r){this.layoutVertexArray=new e,this.layoutAttributes=t,this.indexArray=new r,this.segments=new fA,this.collisionVertexArray=new cA}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,na.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}En("CollisionBuffers",Ll);class Pl{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((e=>e.id)),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=fo([]),this.placementViewportMatrix=fo([]);const r=this.layers[0]._unevaluatedLayout._values;this.textSizeData=tl(this.zoom,r["text-size"]),this.iconSizeData=tl(this.zoom,r["icon-size"]);const n=this.layers[0].layout,i=n.get("symbol-sort-key"),A=n.get("symbol-z-order");this.canOverlap="never"!==Kl(n,"text-overlap","text-allow-overlap")||"never"!==Kl(n,"icon-overlap","icon-allow-overlap")||n.get("text-ignore-placement")||n.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==A&&!i.isConstant(),this.sortFeaturesByY=("viewport-y"===A||"auto"===A&&!this.sortFeaturesByKey)&&this.canOverlap,"point"===n.get("symbol-placement")&&(this.writingModes=n.get("text-writing-mode").map((t=>e.WritingMode[t]))),this.stateDependentLayerIds=this.layers.filter((e=>e.isStateDependent())).map((e=>e.id)),this.sourceID=t.sourceID}createArrays(){this.text=new Dl(new zA(this.layers,this.zoom,(e=>/^text/.test(e)))),this.icon=new Dl(new zA(this.layers,this.zoom,(e=>/^icon/.test(e)))),this.glyphOffsetArray=new ji,this.lineVertexArray=new Zi,this.symbolInstances=new Xi}calculateGlyphDependencies(e,t,r,n,i){for(let A=0;A<e.length;A++)if(t[e.charCodeAt(A)]=!0,(r||n)&&i){const r=sa[e.charAt(A)];r&&(t[r.charCodeAt(0)]=!0)}}populate(t,r,n){const i=this.layers[0],A=i.layout,o=A.get("text-font"),s=A.get("text-field"),a=A.get("icon-image"),l=("constant"!==s.value.kind||s.value.value instanceof Pe&&!s.value.value.isEmpty()||s.value.value.toString().length>0)&&("constant"!==o.value.kind||o.value.value.length>0),c="constant"!==a.value.kind||!!a.value.value||Object.keys(a.parameters).length>0,u=A.get("symbol-sort-key");if(this.features=[],!l&&!c)return;const h=r.iconDependencies,d=r.glyphDependencies,p=r.availableImages,f=new Yn(this.zoom);for(const{feature:r,id:s,index:a,sourceLayerIndex:m}of t){const t=i._featureFilter.needGeometry,g=GA(r,t);if(!i._featureFilter.filter(f,g,n))continue;let y,_;if(t||(g.geometry=NA(r)),l){const e=i.getValueAndResolveTokens("text-field",g,n,p),t=Pe.factory(e);kl(t)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===Zn()||this.hasRTLText&&Wn.isParsed())&&(y=oa(t,i,g))}if(c){const e=i.getValueAndResolveTokens("icon-image",g,n,p);_=e instanceof ze?e:ze.fromString(e)}if(!y&&!_)continue;const w=this.sortFeaturesByKey?u.evaluate(g,{},n):void 0;if(this.features.push({id:s,text:y,icon:_,index:a,sourceLayerIndex:m,geometry:g.geometry,properties:r.properties,type:Il[r.type],sortKey:w}),_&&(h[_.name]=!0),y){const t=o.evaluate(g,{},n).join(","),r="viewport"!==A.get("text-rotation-alignment")&&"point"!==A.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(e.WritingMode.vertical)>=0;for(const e of y.sections)if(e.image)h[e.image.name]=!0;else{const n=Mn(y.toString()),i=e.fontStack||t,A=d[i]=d[i]||{};this.calculateGlyphDependencies(e.text,A,r,this.allowVerticalPlacement,n)}}}"line"===A.get("symbol-placement")&&(this.features=function(e){const t={},r={},n=[];let i=0;function A(t){n.push(e[t]),i++}function o(e,t,i){const A=r[e];return delete r[e],r[t]=A,n[A].geometry[0].pop(),n[A].geometry[0]=n[A].geometry[0].concat(i[0]),A}function s(e,r,i){const A=t[r];return delete t[r],t[e]=A,n[A].geometry[0].shift(),n[A].geometry[0]=i[0].concat(n[A].geometry[0]),A}function a(e,t,r){const n=r?t[0][t[0].length-1]:t[0][0];return`${e}:${n.x}:${n.y}`}for(let l=0;l<e.length;l++){const c=e[l],u=c.geometry,h=c.text?c.text.toString():null;if(!h){A(l);continue}const d=a(h,u),p=a(h,u,!0);if(d in r&&p in t&&r[d]!==t[p]){const e=s(d,p,u),i=o(d,p,n[e].geometry);delete t[d],delete r[p],r[a(h,n[i].geometry,!0)]=i,n[e].geometry=null}else d in r?o(d,p,u):p in t?s(d,p,u):(A(l),t[d]=i-1,r[p]=i-1)}return n.filter((e=>e.geometry))}(this.features)),this.sortFeaturesByKey&&this.features.sort(((e,t)=>e.sortKey-t.sortKey))}update(e,t,r){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,t,this.layers,r),this.icon.programConfigurations.updatePaintArrays(e,t,this.layers,r))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,t){const r=this.lineVertexArray.length;if(void 0!==e.segment){let r=e.dist(t[e.segment+1]),n=e.dist(t[e.segment]);const i={};for(let n=e.segment+1;n<t.length;n++)i[n]={x:t[n].x,y:t[n].y,tileUnitDistanceFromAnchor:r},n<t.length-1&&(r+=t[n+1].dist(t[n]));for(let r=e.segment||0;r>=0;r--)i[r]={x:t[r].x,y:t[r].y,tileUnitDistanceFromAnchor:n},r>0&&(n+=t[r-1].dist(t[r]));for(let e=0;e<t.length;e++){const t=i[e];this.lineVertexArray.emplaceBack(t.x,t.y,t.tileUnitDistanceFromAnchor)}}return{lineStartIndex:r,lineLength:this.lineVertexArray.length-r}}addSymbols(t,r,n,i,A,o,s,a,l,c,u,h){const d=t.indexArray,p=t.layoutVertexArray,f=t.segments.prepareSegment(4*r.length,p,d,this.canOverlap?o.sortKey:void 0),m=this.glyphOffsetArray.length,g=f.vertexLength,y=this.allowVerticalPlacement&&s===e.WritingMode.vertical?Math.PI/2:0,_=o.text&&o.text.sections;for(let e=0;e<r.length;e++){const{tl:i,tr:A,bl:s,br:l,tex:c,pixelOffsetTL:u,pixelOffsetBR:m,minFontScaleX:g,minFontScaleY:w,glyphOffset:x,isSDF:B,sectionIndex:v}=r[e],b=f.vertexLength,C=x[1];Sl(p,a.x,a.y,i.x,C+i.y,c.x,c.y,n,B,u.x,u.y,g,w),Sl(p,a.x,a.y,A.x,C+A.y,c.x+c.w,c.y,n,B,m.x,u.y,g,w),Sl(p,a.x,a.y,s.x,C+s.y,c.x,c.y+c.h,n,B,u.x,m.y,g,w),Sl(p,a.x,a.y,l.x,C+l.y,c.x+c.w,c.y+c.h,n,B,m.x,m.y,g,w),Ml(t.dynamicLayoutVertexArray,a,y),d.emplaceBack(b,b+1,b+2),d.emplaceBack(b+1,b+2,b+3),f.vertexLength+=4,f.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(x[0]),e!==r.length-1&&v===r[e+1].sectionIndex||t.programConfigurations.populatePaintArrays(p.length,o,o.index,{},h,_&&_[v])}t.placedSymbolArray.emplaceBack(a.x,a.y,m,this.glyphOffsetArray.length-m,g,l,c,a.segment,n?n[0]:0,n?n[1]:0,i[0],i[1],s,0,!1,0,u)}_addCollisionDebugVertex(e,t,r,n,i,A){return t.emplaceBack(0,0),e.emplaceBack(r.x,r.y,n,i,Math.round(A.x),Math.round(A.y))}addCollisionDebugVertices(e,t,r,n,i,A,o){const s=i.segments.prepareSegment(4,i.layoutVertexArray,i.indexArray),a=s.vertexLength,l=i.layoutVertexArray,c=i.collisionVertexArray,u=o.anchorX,h=o.anchorY;this._addCollisionDebugVertex(l,c,A,u,h,new C(e,t)),this._addCollisionDebugVertex(l,c,A,u,h,new C(r,t)),this._addCollisionDebugVertex(l,c,A,u,h,new C(r,n)),this._addCollisionDebugVertex(l,c,A,u,h,new C(e,n)),s.vertexLength+=4;const d=i.indexArray;d.emplaceBack(a,a+1),d.emplaceBack(a+1,a+2),d.emplaceBack(a+2,a+3),d.emplaceBack(a+3,a),s.primitiveLength+=4}addDebugCollisionBoxes(e,t,r,n){for(let i=e;i<t;i++){const e=this.collisionBoxArray.get(i);this.addCollisionDebugVertices(e.x1,e.y1,e.x2,e.y2,n?this.textCollisionBox:this.iconCollisionBox,e.anchorPoint,r)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Ll(lA,ia.members,hA),this.iconCollisionBox=new Ll(lA,ia.members,hA);for(let e=0;e<this.symbolInstances.length;e++){const t=this.symbolInstances.get(e);this.addDebugCollisionBoxes(t.textBoxStartIndex,t.textBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.verticalTextBoxStartIndex,t.verticalTextBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.iconBoxStartIndex,t.iconBoxEndIndex,t,!1),this.addDebugCollisionBoxes(t.verticalIconBoxStartIndex,t.verticalIconBoxEndIndex,t,!1)}}_deserializeCollisionBoxesForSymbol(e,t,r,n,i,A,o,s,a){const l={};for(let n=t;n<r;n++){const t=e.get(n);l.textBox={x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2,anchorPointX:t.anchorPointX,anchorPointY:t.anchorPointY},l.textFeatureIndex=t.featureIndex;break}for(let t=n;t<i;t++){const r=e.get(t);l.verticalTextBox={x1:r.x1,y1:r.y1,x2:r.x2,y2:r.y2,anchorPointX:r.anchorPointX,anchorPointY:r.anchorPointY},l.verticalTextFeatureIndex=r.featureIndex;break}for(let t=A;t<o;t++){const r=e.get(t);l.iconBox={x1:r.x1,y1:r.y1,x2:r.x2,y2:r.y2,anchorPointX:r.anchorPointX,anchorPointY:r.anchorPointY},l.iconFeatureIndex=r.featureIndex;break}for(let t=s;t<a;t++){const r=e.get(t);l.verticalIconBox={x1:r.x1,y1:r.y1,x2:r.x2,y2:r.y2,anchorPointX:r.anchorPointX,anchorPointY:r.anchorPointY},l.verticalIconFeatureIndex=r.featureIndex;break}return l}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let t=0;t<this.symbolInstances.length;t++){const r=this.symbolInstances.get(t);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,r.textBoxStartIndex,r.textBoxEndIndex,r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r.iconBoxStartIndex,r.iconBoxEndIndex,r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,t){const r=e.placedSymbolArray.get(t),n=r.vertexStartIndex+4*r.numGlyphs;for(let t=r.vertexStartIndex;t<n;t+=4)e.indexArray.emplaceBack(t,t+1,t+2),e.indexArray.emplaceBack(t+1,t+2,t+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const t=Math.sin(e),r=Math.cos(e),n=[],i=[],A=[];for(let e=0;e<this.symbolInstances.length;++e){A.push(e);const o=this.symbolInstances.get(e);n.push(0|Math.round(t*o.anchorX+r*o.anchorY)),i.push(o.featureIndex)}return A.sort(((e,t)=>n[e]-n[t]||i[t]-i[e])),A}addToSortKeyRanges(e,t){const r=this.sortKeyRanges[this.sortKeyRanges.length-1];r&&r.sortKey===t?r.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:t,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const e of this.symbolInstanceIndexes){const t=this.symbolInstances.get(e);this.featureSortOrder.push(t.featureIndex),[t.rightJustifiedTextSymbolIndex,t.centerJustifiedTextSymbolIndex,t.leftJustifiedTextSymbolIndex].forEach(((e,t,r)=>{e>=0&&r.indexOf(e)===t&&this.addIndicesForPlacedSymbol(this.text,e)})),t.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,t.verticalPlacedTextSymbolIndex),t.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,t.placedIconSymbolIndex),t.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,t.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}En("SymbolBucket",Pl,{omit:["layers","collisionBoxArray","features","compareText"]}),Pl.MAX_GLYPHS=65535,Pl.addDynamicAttributes=Ml;const Hl=new di({"symbol-placement":new ai(ne.layout_symbol["symbol-placement"]),"symbol-spacing":new ai(ne.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new ai(ne.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new li(ne.layout_symbol["symbol-sort-key"]),"symbol-z-order":new ai(ne.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new ai(ne.layout_symbol["icon-allow-overlap"]),"icon-overlap":new ai(ne.layout_symbol["icon-overlap"]),"icon-ignore-placement":new ai(ne.layout_symbol["icon-ignore-placement"]),"icon-optional":new ai(ne.layout_symbol["icon-optional"]),"icon-rotation-alignment":new ai(ne.layout_symbol["icon-rotation-alignment"]),"icon-size":new li(ne.layout_symbol["icon-size"]),"icon-text-fit":new ai(ne.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new ai(ne.layout_symbol["icon-text-fit-padding"]),"icon-image":new li(ne.layout_symbol["icon-image"]),"icon-rotate":new li(ne.layout_symbol["icon-rotate"]),"icon-padding":new li(ne.layout_symbol["icon-padding"]),"icon-keep-upright":new ai(ne.layout_symbol["icon-keep-upright"]),"icon-offset":new li(ne.layout_symbol["icon-offset"]),"icon-anchor":new li(ne.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new ai(ne.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new ai(ne.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new ai(ne.layout_symbol["text-rotation-alignment"]),"text-field":new li(ne.layout_symbol["text-field"]),"text-font":new li(ne.layout_symbol["text-font"]),"text-size":new li(ne.layout_symbol["text-size"]),"text-max-width":new li(ne.layout_symbol["text-max-width"]),"text-line-height":new ai(ne.layout_symbol["text-line-height"]),"text-letter-spacing":new li(ne.layout_symbol["text-letter-spacing"]),"text-justify":new li(ne.layout_symbol["text-justify"]),"text-radial-offset":new li(ne.layout_symbol["text-radial-offset"]),"text-variable-anchor":new ai(ne.layout_symbol["text-variable-anchor"]),"text-anchor":new li(ne.layout_symbol["text-anchor"]),"text-max-angle":new ai(ne.layout_symbol["text-max-angle"]),"text-writing-mode":new ai(ne.layout_symbol["text-writing-mode"]),"text-rotate":new li(ne.layout_symbol["text-rotate"]),"text-padding":new ai(ne.layout_symbol["text-padding"]),"text-keep-upright":new ai(ne.layout_symbol["text-keep-upright"]),"text-transform":new li(ne.layout_symbol["text-transform"]),"text-offset":new li(ne.layout_symbol["text-offset"]),"text-allow-overlap":new ai(ne.layout_symbol["text-allow-overlap"]),"text-overlap":new ai(ne.layout_symbol["text-overlap"]),"text-ignore-placement":new ai(ne.layout_symbol["text-ignore-placement"]),"text-optional":new ai(ne.layout_symbol["text-optional"])});var zl={paint:new di({"icon-opacity":new li(ne.paint_symbol["icon-opacity"]),"icon-color":new li(ne.paint_symbol["icon-color"]),"icon-halo-color":new li(ne.paint_symbol["icon-halo-color"]),"icon-halo-width":new li(ne.paint_symbol["icon-halo-width"]),"icon-halo-blur":new li(ne.paint_symbol["icon-halo-blur"]),"icon-translate":new ai(ne.paint_symbol["icon-translate"]),"icon-translate-anchor":new ai(ne.paint_symbol["icon-translate-anchor"]),"text-opacity":new li(ne.paint_symbol["text-opacity"]),"text-color":new li(ne.paint_symbol["text-color"],{runtimeType:fe,getOverride:e=>e.textColor,hasOverride:e=>!!e.textColor}),"text-halo-color":new li(ne.paint_symbol["text-halo-color"]),"text-halo-width":new li(ne.paint_symbol["text-halo-width"]),"text-halo-blur":new li(ne.paint_symbol["text-halo-blur"]),"text-translate":new ai(ne.paint_symbol["text-translate"]),"text-translate-anchor":new ai(ne.paint_symbol["text-translate-anchor"])}),layout:Hl};class Rl{constructor(e){if(void 0===e.property.overrides)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=e.property.overrides?e.property.overrides.runtimeType:ue,this.defaultValue=e}evaluate(e){if(e.formattedSection){const t=this.defaultValue.property.overrides;if(t&&t.hasOverride(e.formattedSection))return t.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}En("FormatSectionOverride",Rl,{omit:["defaultValue"]});class Ol extends fi{constructor(e){super(e,zl)}recalculate(e,t){if(super.recalculate(e,t),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]="map"===this.layout.get("text-rotation-alignment")?"map":"viewport"),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),"point"===this.layout.get("symbol-placement")){const e=this.layout.get("text-writing-mode");if(e){const t=[];for(const r of e)t.indexOf(r)<0&&t.push(r);this.layout._values["text-writing-mode"]=t}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(e,t,r,n){const i=this.layout.get(e).evaluate(t,{},r,n),A=this._unevaluatedLayout._values[e];return A.isDataDriven()||Mr(A.value)||!i?i:function(e,t){return t.replace(/{([^{}]+)}/g,((t,r)=>r in e?String(e[r]):""))}(t.properties,i)}createBucket(e){return new Pl(e)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const e of zl.paint.overridableProperties){if(!Ol.hasPaintOverride(this.layout,e))continue;const t=this.paint.get(e),r=new Rl(t),n=new Sr(r,t.property.specification);let i=null;i="constant"===t.value.kind||"source"===t.value.kind?new Dr("source",n):new Lr("composite",n,t.value.zoomStops),this.paint._values[e]=new oi(t.property,i,t.parameters)}}_handleOverridablePaintPropertyUpdate(e,t,r){return!(!this.layout||t.isDataDriven()||r.isDataDriven())&&Ol.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,t){const r=e.get("text-field"),n=zl.paint.properties[t];let i=!1;const A=e=>{for(const t of e)if(n.overrides&&n.overrides.hasOverride(t))return void(i=!0)};if("constant"===r.value.kind&&r.value.value instanceof Pe)A(r.value.value.sections);else if("source"===r.value.kind){const e=t=>{i||(t instanceof $e&&Ke(t.value)===_e?A(t.value.sections):t instanceof cr?A(t.sections):t.eachChild(e))},t=r.value;t._styleExpression&&e(t._styleExpression.expression)}return i}}function Kl(e,t,r){let n="never";const i=e.get(t);return i?n=i:e.get(r)&&(n="always"),n}var Vl={paint:new di({"background-color":new ai(ne.paint_background["background-color"]),"background-pattern":new ui(ne.paint_background["background-pattern"]),"background-opacity":new ai(ne.paint_background["background-opacity"])})},$l={paint:new di({"raster-opacity":new ai(ne.paint_raster["raster-opacity"]),"raster-hue-rotate":new ai(ne.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new ai(ne.paint_raster["raster-brightness-min"]),"raster-brightness-max":new ai(ne.paint_raster["raster-brightness-max"]),"raster-saturation":new ai(ne.paint_raster["raster-saturation"]),"raster-contrast":new ai(ne.paint_raster["raster-contrast"]),"raster-resampling":new ai(ne.paint_raster["raster-resampling"]),"raster-fade-duration":new ai(ne.paint_raster["raster-fade-duration"])})};class Nl extends fi{constructor(e){super(e,{}),this.onAdd=e=>{this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)},this.onRemove=e=>{this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)},this.implementation=e}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}const Gl={circle:class extends fi{constructor(e){super(e,co)}createBucket(e){return new XA(e)}queryRadius(e){const t=e;return oo("circle-radius",this,t)+oo("circle-stroke-width",this,t)+so(this.paint.get("circle-translate"))}queryIntersectsFeature(e,t,r,n,i,A,o,s){const a=ao(e,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),A.angle,o),l=this.paint.get("circle-radius").evaluate(t,r)+this.paint.get("circle-stroke-width").evaluate(t,r),c="map"===this.paint.get("circle-pitch-alignment"),u=c?a:function(e,t){return e.map((e=>vo(e,t)))}(a,s),h=c?l*o:l;for(const e of n)for(const t of e){const e=c?t:vo(t,s);let r=h;const n=xo([],[t.x,t.y,0,1],s);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?r*=n[3]/A.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(r*=A.cameraToCenterDistance/n[3]),ZA(u,e,r))return!0}return!1}},heatmap:class extends fi{constructor(e){super(e,Co),this._updateColorRamp()}createBucket(e){return new bo(e)}_handleSpecialPaintPropertyUpdate(e){"heatmap-color"===e&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=To({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}},hillshade:class extends fi{constructor(e){super(e,So)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}},fill:class extends fi{constructor(e){super(e,ys)}recalculate(e,t){super.recalculate(e,t);const r=this.paint._values["fill-outline-color"];"constant"===r.value.kind&&void 0===r.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(e){return new ms(e)}queryRadius(){return so(this.paint.get("fill-translate"))}queryIntersectsFeature(e,t,r,n,i,A,o){return JA(ao(e,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),A.angle,o),n)}isTileClipped(){return!0}},"fill-extrusion":class extends fi{constructor(e){super(e,Rs)}createBucket(e){return new Ps(e)}queryRadius(){return so(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(e,t,r,n,i,A,o,s){const a=ao(e,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),A.angle,o),l=this.paint.get("fill-extrusion-height").evaluate(t,r),c=this.paint.get("fill-extrusion-base").evaluate(t,r),u=function(e,t,r,n){const i=[];for(const r of e){const e=[r.x,r.y,0,1];xo(e,e,t),i.push(new C(e[0]/e[3],e[1]/e[3]))}return i}(a,s),h=function(e,t,r,n){const i=[],A=[],o=n[8]*t,s=n[9]*t,a=n[10]*t,l=n[11]*t,c=n[8]*r,u=n[9]*r,h=n[10]*r,d=n[11]*r;for(const t of e){const e=[],r=[];for(const i of t){const t=i.x,A=i.y,p=n[0]*t+n[4]*A+n[12],f=n[1]*t+n[5]*A+n[13],m=n[2]*t+n[6]*A+n[14],g=n[3]*t+n[7]*A+n[15],y=m+a,_=g+l,w=p+c,x=f+u,B=m+h,v=g+d,b=new C((p+o)/_,(f+s)/_);b.z=y/_,e.push(b);const F=new C(w/v,x/v);F.z=B/v,r.push(F)}i.push(e),A.push(r)}return[i,A]}(n,c,l,s);return function(e,t,r){let n=1/0;JA(r,t)&&(n=Ks(r,t[0]));for(let i=0;i<t.length;i++){const A=t[i],o=e[i];for(let e=0;e<A.length-1;e++){const t=A[e],i=[t,A[e+1],o[e+1],o[e],t];jA(r,i)&&(n=Math.min(n,Ks(r,i)))}}return n!==1/0&&n}(h[0],h[1],u)}},line:class extends fi{constructor(e){super(e,Ws),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(e){"line-gradient"===e&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof bt,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER)}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(e,t){super.recalculate(e,t),this.paint._values["line-floorwidth"]=Ys.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,e)}createBucket(e){return new Zs(e)}queryRadius(e){const t=e,r=ea(oo("line-width",this,t),oo("line-gap-width",this,t)),n=oo("line-offset",this,t);return r/2+Math.abs(n)+so(this.paint.get("line-translate"))}queryIntersectsFeature(e,t,r,n,i,A,o){const s=ao(e,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),A.angle,o),a=o/2*ea(this.paint.get("line-width").evaluate(t,r),this.paint.get("line-gap-width").evaluate(t,r)),l=this.paint.get("line-offset").evaluate(t,r);return l&&(n=function(e,t){const r=[];for(let n=0;n<e.length;n++){const i=e[n],A=[];for(let e=0;e<i.length;e++){const r=i[e-1],n=i[e],o=i[e+1],s=0===e?new C(0,0):n.sub(r)._unit()._perp(),a=e===i.length-1?new C(0,0):o.sub(n)._unit()._perp(),l=s._add(a)._unit(),c=l.x*a.x+l.y*a.y;0!==c&&l._mult(1/c),A.push(l._mult(t)._add(n))}r.push(A)}return r}(n,l*o)),function(e,t,r){for(let n=0;n<t.length;n++){const i=t[n];if(e.length>=3)for(let t=0;t<i.length;t++)if(io(e,i[t]))return!0;if(WA(e,i,r))return!0}return!1}(s,n,a)}isTileClipped(){return!0}},symbol:Ol,background:class extends fi{constructor(e){super(e,Vl)}},raster:class extends fi{constructor(e){super(e,$l)}}};class ql{constructor(e){this._callback=e,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._callback()}),0))}remove(){delete this._channel,this._callback=()=>{}}}const Xl=6371008.8;class jl{constructor(e,t){if(isNaN(e)||isNaN(t))throw new Error(`Invalid LngLat object: (${e}, ${t})`);if(this.lng=+e,this.lat=+t,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new jl(o(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const t=Math.PI/180,r=this.lat*t,n=e.lat*t,i=Math.sin(r)*Math.sin(n)+Math.cos(r)*Math.cos(n)*Math.cos((e.lng-this.lng)*t);return Xl*Math.acos(Math.min(i,1))}toBounds(e=0){const t=360*e/40075017,r=t/Math.cos(Math.PI/180*this.lat);return new Zl(new jl(this.lng-r,this.lat-t),new jl(this.lng+r,this.lat+t))}static convert(e){if(e instanceof jl)return e;if(Array.isArray(e)&&(2===e.length||3===e.length))return new jl(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&"object"==typeof e&&null!==e)return new jl(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class Zl{constructor(e,t){e&&(t?this.setSouthWest(e).setNorthEast(t):4===e.length?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))}setNorthEast(e){return this._ne=e instanceof jl?new jl(e.lng,e.lat):jl.convert(e),this}setSouthWest(e){return this._sw=e instanceof jl?new jl(e.lng,e.lat):jl.convert(e),this}extend(e){const t=this._sw,r=this._ne;let n,i;if(e instanceof jl)n=e,i=e;else{if(!(e instanceof Zl))return Array.isArray(e)?4===e.length||e.every(Array.isArray)?this.extend(Zl.convert(e)):this.extend(jl.convert(e)):this;if(n=e._sw,i=e._ne,!n||!i)return this}return t||r?(t.lng=Math.min(n.lng,t.lng),t.lat=Math.min(n.lat,t.lat),r.lng=Math.max(i.lng,r.lng),r.lat=Math.max(i.lat,r.lat)):(this._sw=new jl(n.lng,n.lat),this._ne=new jl(i.lng,i.lat)),this}getCenter(){return new jl((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new jl(this.getWest(),this.getNorth())}getSouthEast(){return new jl(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:t,lat:r}=jl.convert(e);let n=this._sw.lng<=t&&t<=this._ne.lng;return this._sw.lng>this._ne.lng&&(n=this._sw.lng>=t&&t>=this._ne.lng),this._sw.lat<=r&&r<=this._ne.lat&&n}static convert(e){return e instanceof Zl?e:e?new Zl(e):e}}const Jl=2*Math.PI*Xl;function Wl(e){return Jl*Math.cos(e*Math.PI/180)}function Yl(e){return(180+e)/360}function ec(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function tc(e,t){return e/Wl(t)}function rc(e){return 360/Math.PI*Math.atan(Math.exp((180-360*e)*Math.PI/180))-90}class nc{constructor(e,t,r=0){this.x=+e,this.y=+t,this.z=+r}static fromLngLat(e,t=0){const r=jl.convert(e);return new nc(Yl(r.lng),ec(r.lat),tc(t,r.lat))}toLngLat(){return new jl(360*this.x-180,rc(this.y))}toAltitude(){return this.z*Wl(rc(this.y))}meterInMercatorCoordinateUnits(){return 1/Jl*(e=rc(this.y),1/Math.cos(e*Math.PI/180));var e}}function ic(e,t,r){var n=2*Math.PI*6378137/256/Math.pow(2,r);return[e*n-2*Math.PI*6378137/2,t*n-2*Math.PI*6378137/2]}class Ac{constructor(e,t,r){if(e<0||e>25||r<0||r>=Math.pow(2,e)||t<0||t>=Math.pow(2,e))throw new Error(`x=${t}, y=${r}, z=${e} outside of bounds. 0<=x<${Math.pow(2,e)}, 0<=y<${Math.pow(2,e)} 0<=z<=25 `);this.z=e,this.x=t,this.y=r,this.key=ac(0,e,e,t,r)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,t,r){const n=(A=this.y,o=this.z,s=ic(256*(i=this.x),256*(A=Math.pow(2,o)-A-1),o),a=ic(256*(i+1),256*(A+1),o),s[0]+","+s[1]+","+a[0]+","+a[1]);var i,A,o,s,a;const l=function(e,t,r){let n,i="";for(let A=e;A>0;A--)n=1<<A-1,i+=(t&n?1:0)+(r&n?2:0);return i}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===r?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,t>1?"@2x":"").replace(/{quadkey}/g,l).replace(/{bbox-epsg-3857}/g,n)}isChildOf(e){const t=this.z-e.z;return t>0&&e.x===this.x>>t&&e.y===this.y>>t}getTilePoint(e){const t=Math.pow(2,this.z);return new C((e.x*t-this.x)*KA,(e.y*t-this.y)*KA)}toString(){return`${this.z}/${this.x}/${this.y}`}}class oc{constructor(e,t){this.wrap=e,this.canonical=t,this.key=ac(e,t.z,t.z,t.x,t.y)}}class sc{constructor(e,t,r,n,i){if(e<r)throw new Error(`overscaledZ should be >= z; overscaledZ = ${e}; z = ${r}`);this.overscaledZ=e,this.wrap=t,this.canonical=new Ac(r,+n,+i),this.key=ac(t,e,r,n,i)}clone(){return new sc(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);const t=this.canonical.z-e;return e>this.canonical.z?new sc(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new sc(e,this.wrap,e,this.canonical.x>>t,this.canonical.y>>t)}calculateScaledKey(e,t){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);const r=this.canonical.z-e;return e>this.canonical.z?ac(this.wrap*+t,e,this.canonical.z,this.canonical.x,this.canonical.y):ac(this.wrap*+t,e,e,this.canonical.x>>r,this.canonical.y>>r)}isChildOf(e){if(e.wrap!==this.wrap)return!1;const t=this.canonical.z-e.canonical.z;return 0===e.overscaledZ||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>t&&e.canonical.y===this.canonical.y>>t}children(e){if(this.overscaledZ>=e)return[new sc(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const t=this.canonical.z+1,r=2*this.canonical.x,n=2*this.canonical.y;return[new sc(t,this.wrap,t,r,n),new sc(t,this.wrap,t,r+1,n),new sc(t,this.wrap,t,r,n+1),new sc(t,this.wrap,t,r+1,n+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new sc(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new sc(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new oc(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(e){return this.canonical.getTilePoint(new nc(e.x-this.wrap,e.y))}}function ac(e,t,r,n,i){(e*=2)<0&&(e=-1*e-1);const A=1<<r;return(A*A*e+A*i+n).toString(36)+r.toString(36)+t.toString(36)}En("CanonicalTileID",Ac),En("OverscaledTileID",sc,{omit:["posMatrix"]});class lc{constructor(e,t,r){if(this.uid=e,t.height!==t.width)throw new RangeError("DEM tiles must be square");if(r&&"mapbox"!==r&&"terrarium"!==r)return void p(`"${r}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=t.height;const n=this.dim=t.height-2;this.data=new Uint32Array(t.data.buffer),this.encoding=r||"mapbox";for(let e=0;e<n;e++)this.data[this._idx(-1,e)]=this.data[this._idx(0,e)],this.data[this._idx(n,e)]=this.data[this._idx(n-1,e)],this.data[this._idx(e,-1)]=this.data[this._idx(e,0)],this.data[this._idx(e,n)]=this.data[this._idx(e,n-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(n,-1)]=this.data[this._idx(n-1,0)],this.data[this._idx(-1,n)]=this.data[this._idx(0,n-1)],this.data[this._idx(n,n)]=this.data[this._idx(n-1,n-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let e=0;e<n;e++)for(let t=0;t<n;t++){const r=this.get(e,t);r>this.max&&(this.max=r),r<this.min&&(this.min=r)}}get(e,t){const r=new Uint8Array(this.data.buffer),n=4*this._idx(e,t);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(r[n],r[n+1],r[n+2])}getUnpackVector(){return"terrarium"===this.encoding?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]}_idx(e,t){if(e<-1||e>=this.dim+1||t<-1||t>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(t+1)*this.stride+(e+1)}_unpackMapbox(e,t,r){return(256*e*256+256*t+r)/10-1e4}_unpackTerrarium(e,t,r){return 256*e+t+r/256-32768}getPixels(){return new Io({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(e,t,r){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let n=t*this.dim,i=t*this.dim+this.dim,A=r*this.dim,o=r*this.dim+this.dim;switch(t){case-1:n=i-1;break;case 1:i=n+1}switch(r){case-1:A=o-1;break;case 1:o=A+1}const s=-t*this.dim,a=-r*this.dim;for(let t=A;t<o;t++)for(let r=n;r<i;r++)this.data[this._idx(r,t)]=e.data[this._idx(r+s,t+a)]}}En("DEMData",lc);class cc{constructor(e){this._stringToNumber={},this._numberToString=[];for(let t=0;t<e.length;t++){const r=e[t];this._stringToNumber[r]=t,this._numberToString[t]=r}}encode(e){return this._stringToNumber[e]}decode(e){if(e>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${e} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[e]}}class uc{constructor(e,t,r,n,i){this.type="Feature",this._vectorTileFeature=e,e._z=t,e._x=r,e._y=n,this.properties=e.properties,this.id=i}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={geometry:this.geometry};for(const t in this)"_geometry"!==t&&"_vectorTileFeature"!==t&&(e[t]=this[t]);return e}}class hc{constructor(e,t){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new Cn(KA,16,0),this.grid3D=new Cn(KA,16,0),this.featureIndexArray=new Wi,this.promoteId=t}insert(e,t,r,n,i,A){const o=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(r,n,i);const s=A?this.grid3D:this.grid;for(let e=0;e<t.length;e++){const r=t[e],n=[1/0,1/0,-1/0,-1/0];for(let e=0;e<r.length;e++){const t=r[e];n[0]=Math.min(n[0],t.x),n[1]=Math.min(n[1],t.y),n[2]=Math.max(n[2],t.x),n[3]=Math.max(n[3],t.y)}n[0]<KA&&n[1]<KA&&n[2]>=0&&n[3]>=0&&s.insert(o,n[0],n[1],n[2],n[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Bs.VectorTile(new la(this.rawTileData)).layers,this.sourceLayerCoder=new cc(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(e,t,r,n){this.loadVTLayers();const i=e.params||{},A=KA/e.tileSize/e.scale,o=Xr(i.filter),s=e.queryGeometry,a=e.queryPadding*A,l=pc(s),c=this.grid.query(l.minX-a,l.minY-a,l.maxX+a,l.maxY+a),u=pc(e.cameraQueryGeometry),h=this.grid3D.query(u.minX-a,u.minY-a,u.maxX+a,u.maxY+a,((t,r,n,i)=>function(e,t,r,n,i){for(const A of e)if(t<=A.x&&r<=A.y&&n>=A.x&&i>=A.y)return!0;const A=[new C(t,r),new C(t,i),new C(n,i),new C(n,r)];if(e.length>2)for(const t of A)if(io(e,t))return!0;for(let t=0;t<e.length-1;t++)if(Ao(e[t],e[t+1],A))return!0;return!1}(e.cameraQueryGeometry,t-a,r-a,n+a,i+a)));for(const e of h)c.push(e);c.sort(fc);const d={};let p;for(let a=0;a<c.length;a++){const l=c[a];if(l===p)continue;p=l;const u=this.featureIndexArray.get(l);let h=null;this.loadMatchingFeature(d,u.bucketIndex,u.sourceLayerIndex,u.featureIndex,o,i.layers,i.availableImages,t,r,n,((t,r,n)=>(h||(h=NA(t)),r.queryIntersectsFeature(s,t,n,h,this.z,e.transform,A,e.pixelPosMatrix))))}return d}loadMatchingFeature(e,t,r,n,i,A,o,a,l,c,u){const h=this.bucketLayerIDs[t];if(A&&!function(e,t){for(let r=0;r<e.length;r++)if(t.indexOf(e[r])>=0)return!0;return!1}(A,h))return;const d=this.sourceLayerCoder.decode(r),p=this.vtLayers[d].feature(n);if(i.needGeometry){const e=GA(p,!0);if(!i.filter(new Yn(this.tileID.overscaledZ),e,this.tileID.canonical))return}else if(!i.filter(new Yn(this.tileID.overscaledZ),p))return;const f=this.getId(p,d);for(let t=0;t<h.length;t++){const r=h[t];if(A&&A.indexOf(r)<0)continue;const i=a[r];if(!i)continue;let d={};f&&c&&(d=c.getState(i.sourceLayer||"_geojsonTileLayer",f));const m=s({},l[r]);m.paint=dc(m.paint,i.paint,p,d,o),m.layout=dc(m.layout,i.layout,p,d,o);const g=!u||u(p,i,d);if(!g)continue;const y=new uc(p,this.z,this.x,this.y,f);y.layer=m;let _=e[r];void 0===_&&(_=e[r]=[]),_.push({featureIndex:n,feature:y,intersectionZ:g})}}lookupSymbolFeatures(e,t,r,n,i,A,o,s){const a={};this.loadVTLayers();const l=Xr(i);for(const i of e)this.loadMatchingFeature(a,r,n,i,l,A,o,s,t);return a}hasLayer(e){for(const t of this.bucketLayerIDs)for(const r of t)if(e===r)return!0;return!1}getId(e,t){let r=e.id;return this.promoteId&&(r=e.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[t]],"boolean"==typeof r&&(r=Number(r))),r}}function dc(e,t,r,n,i){return c(e,((e,A)=>{const o=t instanceof si?t.get(A):null;return o&&o.evaluate?o.evaluate(r,n,i):o}))}function pc(e){let t=1/0,r=1/0,n=-1/0,i=-1/0;for(const A of e)t=Math.min(t,A.x),r=Math.min(r,A.y),n=Math.max(n,A.x),i=Math.max(i,A.y);return{minX:t,minY:r,maxX:n,maxY:i}}function fc(e,t){return t-e}var mc;En("FeatureIndex",hc,{omit:["rawTileData","sourceLayerCoder"]}),e.PerformanceMarkers=void 0,(mc=e.PerformanceMarkers||(e.PerformanceMarkers={})).create="create",mc.load="load",mc.fullLoad="fullLoad";let gc=null,yc=[];const _c=1e3/30,wc={mark(e){performance.mark(e)},frame(e){const t=e;null!=gc&&yc.push(t-gc),gc=t},clearMetrics(){gc=null,yc=[],performance.clearMeasures("loadTime"),performance.clearMeasures("fullLoadTime");for(const t in e.PerformanceMarkers)performance.clearMarks(e.PerformanceMarkers[t])},getPerformanceMetrics(){performance.measure("loadTime",e.PerformanceMarkers.create,e.PerformanceMarkers.load),performance.measure("fullLoadTime",e.PerformanceMarkers.create,e.PerformanceMarkers.fullLoad);const t=performance.getEntriesByName("loadTime")[0].duration,r=performance.getEntriesByName("fullLoadTime")[0].duration,n=yc.length,i=1/(yc.reduce(((e,t)=>e+t),0)/n/1e3),A=yc.filter((e=>e>_c)).reduce(((e,t)=>e+(t-_c)/_c),0);return{loadTime:t,fullLoadTime:r,fps:i,percentDroppedFrames:A/(n+A)*100}}};e.AJAXError=K,e.ARRAY_TYPE=ho,e.Actor=class{constructor(e,t,r){this.target=e,this.parent=t,this.mapId=r,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},l(["receive","process"],this),this.invoker=new ql(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=g()?e:window}send(e,t,r,n,i=!1){const A=Math.round(1e18*Math.random()).toString(36).substring(0,10);r&&(this.callbacks[A]=r);const o=B(this.globalScope)?void 0:[];return this.target.postMessage({id:A,type:e,hasCallback:!!r,targetMapId:n,mustQueue:i,sourceMapId:this.mapId,data:Qn(t,o)},o),{cancel:()=>{r&&delete this.callbacks[A],this.target.postMessage({id:A,type:"<cancel>",targetMapId:n,sourceMapId:this.mapId})}}}receive(e){const t=e.data,r=t.id;if(r&&(!t.targetMapId||this.mapId===t.targetMapId))if("<cancel>"===t.type){delete this.tasks[r];const e=this.cancelCallbacks[r];delete this.cancelCallbacks[r],e&&e()}else g()||t.mustQueue?(this.tasks[r]=t,this.taskQueue.push(r),this.invoker.trigger()):this.processTask(r,t)}process(){if(!this.taskQueue.length)return;const e=this.taskQueue.shift(),t=this.tasks[e];delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),t&&this.processTask(e,t)}processTask(e,t){if("<response>"===t.type){const r=this.callbacks[e];delete this.callbacks[e],r&&(t.error?r(In(t.error)):r(null,In(t.data)))}else{let r=!1;const n=B(this.globalScope)?void 0:[],i=t.hasCallback?(t,i)=>{r=!0,delete this.cancelCallbacks[e],this.target.postMessage({id:e,type:"<response>",sourceMapId:this.mapId,error:t?Qn(t):null,data:Qn(i,n)},n)}:e=>{r=!0};let A=null;const o=In(t.data);if(this.parent[t.type])A=this.parent[t.type](t.sourceMapId,o,i);else if(this.parent.getWorkerSource){const e=t.type.split(".");A=this.parent.getWorkerSource(t.sourceMapId,e[0],o.source)[e[1]](o,i)}else i(new Error(`Could not find function ${t.type}`));!r&&A&&A.cancel&&(this.cancelCallbacks[e]=A.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}},e.AlphaImage=Qo,e.CanonicalTileID=Ac,e.CollisionBoxArray=$i,e.CollisionCircleLayoutArray=class extends Si{},e.Color=ke,e.DEMData=lc,e.DataConstantProperty=ai,e.DictionaryCoder=cc,e.EXTENT=KA,e.ErrorEvent=te,e.EvaluationParameters=Yn,e.Event=ee,e.Evented=re,e.FeatureIndex=hc,e.FillBucket=ms,e.FillExtrusionBucket=Ps,e.GeoJSONFeature=uc,e.ImageAtlas=Pa,e.ImagePosition=La,e.LineBucket=Zs,e.LineStripIndexArray=class extends Oi{},e.LngLat=jl,e.LngLatBounds=Zl,e.MercatorCoordinate=nc,e.ONE_EM=aa,e.OverscaledTileID=sc,e.PerformanceUtils=wc,e.PosArray=Yi,e.Properties=di,e.QuadTriangleArray=class extends ki{},e.RGBAImage=Io,e.RasterBoundsArray=class extends Bi{},e.RequestPerformance=class{constructor(e){this._marks={start:[e.url,"start"].join("#"),end:[e.url,"end"].join("#"),measure:e.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let e=performance.getEntriesByName(this._marks.measure);return 0===e.length&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),e=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),e}},e.ResourceType=O,e.SegmentVector=fA,e.SymbolBucket=Pl,e.Transitionable=ri,e.TriangleIndexArray=uA,e.Uniform1f=UA,e.Uniform1i=class extends EA{constructor(e,t){super(e,t),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1i(this.location,e))}},e.Uniform2f=class extends EA{constructor(e,t){super(e,t),this.current=[0,0]}set(e){e[0]===this.current[0]&&e[1]===this.current[1]||(this.current=e,this.gl.uniform2f(this.location,e[0],e[1]))}},e.Uniform3f=class extends EA{constructor(e,t){super(e,t),this.current=[0,0,0]}set(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]||(this.current=e,this.gl.uniform3f(this.location,e[0],e[1],e[2]))}},e.Uniform4f=QA,e.UniformColor=IA,e.UniformMatrix4f=class extends EA{constructor(e,t){super(e,t),this.current=TA}set(e){if(e[12]!==this.current[12]||e[0]!==this.current[0])return this.current=e,void this.gl.uniformMatrix4fv(this.location,!1,e);for(let t=1;t<16;t++)if(e[t]!==this.current[t]){this.current=e,this.gl.uniformMatrix4fv(this.location,!1,e);break}}},e.UnwrappedTileID=oc,e.ValidationError=ie,e.ZoomHistory=Tn,e.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e},e.addDynamicAttributes=Ml,e.asyncAll=function(e,t,r){if(!e.length)return r(null,[]);let n=e.length;const i=new Array(e.length);let A=null;e.forEach(((e,o)=>{t(e,((e,t)=>{e&&(A=e),i[o]=t,0==--n&&r(A,i)}))}))},e.bezier=n,e.bindAll=l,e.cacheEntryPossiblyAdded=function(e){k++,k>S&&(e.getActor().send("enforceCacheSizeLimit",T),k=0)},e.clamp=A,e.clearTileCache=function(e){const t=caches.delete(U);e&&t.catch(e).then((()=>e()))},e.clipLine=cl,e.clone=function(e){var t=new ho(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},e.clone$1=h,e.clone$2=function(e){var t=new ho(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},e.collisionCircleLayout=Aa,e.config=E,e.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},e.create=function(){var e=new ho(16);return ho!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},e.create$1=po,e.createExpression=kr,e.createFilter=Xr,e.createLayout=_i,e.createStyleLayer=function(e){return"custom"===e.type?new Nl(e):new Gl[e.type](e)},e.cross=function(e,t,r){var n=t[0],i=t[1],A=t[2],o=r[0],s=r[1],a=r[2];return e[0]=i*a-A*s,e[1]=A*o-n*a,e[2]=n*s-i*o,e},e.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},e.dot$1=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},e.ease=i,e.emitValidationErrors=bn,e.enforceCacheSizeLimit=function(e){M(),Q&&Q.then((t=>{t.keys().then((r=>{for(let n=0;n<r.length-e;n++)t.delete(r[n])}))}))},e.equals=function(e,t){var r=e[0],n=e[1],i=e[2],A=e[3],o=e[4],s=e[5],a=e[6],l=e[7],c=e[8],u=e[9],h=e[10],d=e[11],p=e[12],f=e[13],m=e[14],g=e[15],y=t[0],_=t[1],w=t[2],x=t[3],B=t[4],v=t[5],b=t[6],C=t[7],F=t[8],E=t[9],U=t[10],Q=t[11],I=t[12],T=t[13],S=t[14],M=t[15];return Math.abs(r-y)<=uo*Math.max(1,Math.abs(r),Math.abs(y))&&Math.abs(n-_)<=uo*Math.max(1,Math.abs(n),Math.abs(_))&&Math.abs(i-w)<=uo*Math.max(1,Math.abs(i),Math.abs(w))&&Math.abs(A-x)<=uo*Math.max(1,Math.abs(A),Math.abs(x))&&Math.abs(o-B)<=uo*Math.max(1,Math.abs(o),Math.abs(B))&&Math.abs(s-v)<=uo*Math.max(1,Math.abs(s),Math.abs(v))&&Math.abs(a-b)<=uo*Math.max(1,Math.abs(a),Math.abs(b))&&Math.abs(l-C)<=uo*Math.max(1,Math.abs(l),Math.abs(C))&&Math.abs(c-F)<=uo*Math.max(1,Math.abs(c),Math.abs(F))&&Math.abs(u-E)<=uo*Math.max(1,Math.abs(u),Math.abs(E))&&Math.abs(h-U)<=uo*Math.max(1,Math.abs(h),Math.abs(U))&&Math.abs(d-Q)<=uo*Math.max(1,Math.abs(d),Math.abs(Q))&&Math.abs(p-I)<=uo*Math.max(1,Math.abs(p),Math.abs(I))&&Math.abs(f-T)<=uo*Math.max(1,Math.abs(f),Math.abs(T))&&Math.abs(m-S)<=uo*Math.max(1,Math.abs(m),Math.abs(S))&&Math.abs(g-M)<=uo*Math.max(1,Math.abs(g),Math.abs(M))},e.evaluateSizeForFeature=function(e,{uSize:t,uSizeT:r},{lowerSize:n,upperSize:i}){return"source"===e.kind?n/el:"composite"===e.kind?Ct(n/el,i/el,r):t},e.evaluateSizeForZoom=function(e,t){let r=0,n=0;if("constant"===e.kind)n=e.layoutSize;else if("source"!==e.kind){const{interpolationType:i,minZoom:o,maxZoom:s}=e,a=i?A($t.interpolationFactor(i,t,o,s),0,1):0;"camera"===e.kind?n=Ct(e.minSize,e.maxSize,a):r=a}return{uSizeT:r,uSize:n}},e.evaluateVariableOffset=vl,e.evented=jn,e.exported=b,e.exported$1=D,e.extend=s,e.filterObject=u,e.fromRotation=function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=0,e[3]=-r,e[4]=n,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},e.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},e.getAnchorAlignment=Za,e.getAnchorJustification=bl,e.getArrayBuffer=G,e.getImage=J,e.getJSON=function(e,t){return N(s(e,{type:"json"}),t)},e.getOverlapMode=Kl,e.getRTLTextPluginStatus=Zn,e.getReferrer=V,e.getVideo=function(e,t){const r=window.document.createElement("video");r.muted=!0,r.onloadstart=function(){t(null,r)};for(let t=0;t<e.length;t++){const n=window.document.createElement("source");q(e[t])||(r.crossOrigin="Anonymous"),n.src=e[t],r.appendChild(n)}return{cancel:()=>{}}},e.identity=fo,e.invert=function(e,t){var r=t[0],n=t[1],i=t[2],A=t[3],o=t[4],s=t[5],a=t[6],l=t[7],c=t[8],u=t[9],h=t[10],d=t[11],p=t[12],f=t[13],m=t[14],g=t[15],y=r*s-n*o,_=r*a-i*o,w=r*l-A*o,x=n*a-i*s,B=n*l-A*s,v=i*l-A*a,b=c*f-u*p,C=c*m-h*p,F=c*g-d*p,E=u*m-h*f,U=u*g-d*f,Q=h*g-d*m,I=y*Q-_*U+w*E+x*F-B*C+v*b;return I?(e[0]=(s*Q-a*U+l*E)*(I=1/I),e[1]=(i*U-n*Q-A*E)*I,e[2]=(f*v-m*B+g*x)*I,e[3]=(h*B-u*v-d*x)*I,e[4]=(a*F-o*Q-l*C)*I,e[5]=(r*Q-i*F+A*C)*I,e[6]=(m*w-p*v-g*_)*I,e[7]=(c*v-h*w+d*_)*I,e[8]=(o*U-s*F+l*b)*I,e[9]=(n*F-r*U-A*b)*I,e[10]=(p*B-f*w+g*y)*I,e[11]=(u*w-c*B-d*y)*I,e[12]=(s*C-o*E-a*b)*I,e[13]=(r*E-n*C+i*b)*I,e[14]=(f*_-p*x-m*y)*I,e[15]=(c*x-u*_+h*y)*I,e):null},e.isImageBitmap=v,e.isSafari=B,e.isWorker=g,e.keysDifference=function(e,t){const r=[];for(const n in e)n in t||r.push(n);return r},e.lazyLoadRTLTextPlugin=function(){Wn.isLoading()||Wn.isLoaded()||"deferred"!==Zn()||Jn()},e.makeRequest=N,e.mapObject=c,e.mercatorXfromLng=Yl,e.mercatorYfromLat=ec,e.mercatorZfromAltitude=tc,e.mul=yo,e.mul$1=function(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e[3]=t[3]*r[3],e},e.multiply=mo,e.nextPowerOfTwo=function(e){return e<=1?1:Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},e.normalize=function(e,t){var r=t[0],n=t[1],i=t[2],A=r*r+n*n+i*i;return A>0&&(A=1/Math.sqrt(A)),e[0]=t[0]*A,e[1]=t[1]*A,e[2]=t[2]*A,e},e.number=Ct,e.ortho=function(e,t,r,n,i,A,o){var s=1/(t-r),a=1/(n-i),l=1/(A-o);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*l,e[11]=0,e[12]=(t+r)*s,e[13]=(i+n)*a,e[14]=(o+A)*l,e[15]=1,e},e.parseCacheControl=y,e.parseGlyphPbf=function(e){return new la(e).readFields(Sa,[])},e.pbf=la,e.performSymbolLayout=function(t){t.bucket.createArrays(),t.bucket.tilePixelRatio=KA/(512*t.bucket.overscaling),t.bucket.compareText={},t.bucket.iconsNeedLinear=!1;const r=t.bucket.layers[0].layout,n=t.bucket.layers[0]._unevaluatedLayout._values,i={layoutIconSize:n["icon-size"].possiblyEvaluate(new Yn(t.bucket.zoom+1),t.canonical),layoutTextSize:n["text-size"].possiblyEvaluate(new Yn(t.bucket.zoom+1),t.canonical),textMaxSize:n["text-size"].possiblyEvaluate(new Yn(18))};if("composite"===t.bucket.textSizeData.kind){const{minZoom:e,maxZoom:r}=t.bucket.textSizeData;i.compositeTextSizes=[n["text-size"].possiblyEvaluate(new Yn(e),t.canonical),n["text-size"].possiblyEvaluate(new Yn(r),t.canonical)]}if("composite"===t.bucket.iconSizeData.kind){const{minZoom:e,maxZoom:r}=t.bucket.iconSizeData;i.compositeIconSizes=[n["icon-size"].possiblyEvaluate(new Yn(e),t.canonical),n["icon-size"].possiblyEvaluate(new Yn(r),t.canonical)]}const A=r.get("text-line-height")*aa,o="viewport"!==r.get("text-rotation-alignment")&&"point"!==r.get("symbol-placement"),s=r.get("text-keep-upright"),a=r.get("text-size");for(const n of t.bucket.features){const l=r.get("text-font").evaluate(n,{},t.canonical).join(","),c=a.evaluate(n,{},t.canonical),u=i.layoutTextSize.evaluate(n,{},t.canonical),h=i.layoutIconSize.evaluate(n,{},t.canonical),d={horizontal:{},vertical:void 0},f=n.text;let m,g=[0,0];if(f){const i=f.toString(),a=r.get("text-letter-spacing").evaluate(n,{},t.canonical)*aa,h=kn(i)?a:0,p=r.get("text-anchor").evaluate(n,{},t.canonical),m=r.get("text-variable-anchor");if(!m){const e=r.get("text-radial-offset").evaluate(n,{},t.canonical);g=e?vl(p,[e*aa,Bl]):r.get("text-offset").evaluate(n,{},t.canonical).map((e=>e*aa))}let y=o?"center":r.get("text-justify").evaluate(n,{},t.canonical);const _=r.get("symbol-placement"),w="point"===_?r.get("text-max-width").evaluate(n,{},t.canonical)*aa:0,x=()=>{t.bucket.allowVerticalPlacement&&Mn(i)&&(d.vertical=Oa(f,t.glyphMap,t.glyphPositions,t.imagePositions,l,w,A,p,"left",h,g,e.WritingMode.vertical,!0,_,u,c))};if(!o&&m){const r="auto"===y?m.map((e=>bl(e))):[y];let n=!1;for(let i=0;i<r.length;i++){const o=r[i];if(!d.horizontal[o])if(n)d.horizontal[o]=d.horizontal[0];else{const r=Oa(f,t.glyphMap,t.glyphPositions,t.imagePositions,l,w,A,"center",o,h,g,e.WritingMode.horizontal,!1,_,u,c);r&&(d.horizontal[o]=r,n=1===r.positionedLines.length)}}x()}else{"auto"===y&&(y=bl(p));const r=Oa(f,t.glyphMap,t.glyphPositions,t.imagePositions,l,w,A,p,y,h,g,e.WritingMode.horizontal,!1,_,u,c);r&&(d.horizontal[y]=r),x(),Mn(i)&&o&&s&&(d.vertical=Oa(f,t.glyphMap,t.glyphPositions,t.imagePositions,l,w,A,p,y,h,g,e.WritingMode.vertical,!1,_,u,c))}}let y=!1;if(n.icon&&n.icon.name){const e=t.imageMap[n.icon.name];e&&(m=Wa(t.imagePositions[n.icon.name],r.get("icon-offset").evaluate(n,{},t.canonical),r.get("icon-anchor").evaluate(n,{},t.canonical)),y=!!e.sdf,void 0===t.bucket.sdfIcons?t.bucket.sdfIcons=y:t.bucket.sdfIcons!==y&&p("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(e.pixelRatio!==t.bucket.pixelRatio||0!==r.get("icon-rotate").constantOr(1))&&(t.bucket.iconsNeedLinear=!0))}const _=Ul(d.horizontal)||d.vertical;t.bucket.iconsInText=!!_&&_.iconsInText,(_||m)&&Cl(t.bucket,n,d,m,t.imageMap,i,u,h,g,y,t.canonical)}t.showCollisionBoxes&&t.bucket.generateCollisionDebugBuffers()},e.perspective=function(e,t,r,n,i){var A,o=1/Math.tan(t/2);return e[0]=o/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=i&&i!==1/0?(e[10]=(i+n)*(A=1/(n-i)),e[14]=2*i*n*A):(e[10]=-1,e[14]=-2*n),e},e.pick=function(e,t){const r={};for(let n=0;n<t.length;n++){const i=t[n];i in e&&(r[i]=e[i])}return r},e.plugin=Wn,e.pointGeometry=C,e.polygonIntersectsPolygon=jA,e.potpack=Da,e.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],e.register=En,e.registerForPluginStateChange=function(e){return e({pluginStatus:Nn,pluginURL:Gn}),jn.on("pluginStateChange",e),e},e.renderColorRamp=To,e.rotateX=function(e,t,r){var n=Math.sin(r),i=Math.cos(r),A=t[4],o=t[5],s=t[6],a=t[7],l=t[8],c=t[9],u=t[10],h=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=A*i+l*n,e[5]=o*i+c*n,e[6]=s*i+u*n,e[7]=a*i+h*n,e[8]=l*i-A*n,e[9]=c*i-o*n,e[10]=u*i-s*n,e[11]=h*i-a*n,e},e.rotateZ=function(e,t,r){var n=Math.sin(r),i=Math.cos(r),A=t[0],o=t[1],s=t[2],a=t[3],l=t[4],c=t[5],u=t[6],h=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=A*i+l*n,e[1]=o*i+c*n,e[2]=s*i+u*n,e[3]=a*i+h*n,e[4]=l*i-A*n,e[5]=c*i-o*n,e[6]=u*i-s*n,e[7]=h*i-a*n,e},e.scale=function(e,t,r){var n=r[0],i=r[1],A=r[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*A,e[9]=t[9]*A,e[10]=t[10]*A,e[11]=t[11]*A,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},e.scale$1=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e},e.setCacheLimits=function(e,t){T=e,S=t},e.setRTLTextPlugin=function(e,t,r=!1){if(Nn===On||Nn===Kn||Nn===Vn)throw new Error("setRTLTextPlugin cannot be called multiple times.");Gn=b.resolveURL(e),Nn=On,$n=t,Xn(),r||Jn()},e.spec=ne,e.sphericalToCartesian=function([e,t,r]){return t+=90,t*=Math.PI/180,r*=Math.PI/180,{x:e*Math.cos(t)*Math.sin(r),y:e*Math.sin(t)*Math.sin(r),z:e*Math.cos(r)}},e.sqrLen=function(e){var t=e[0],r=e[1];return t*t+r*r},e.sub=function(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e},e.toEvaluationFeature=GA,e.transformMat3=function(e,t,r){var n=t[0],i=t[1],A=t[2];return e[0]=n*r[0]+i*r[3]+A*r[6],e[1]=n*r[1]+i*r[4]+A*r[7],e[2]=n*r[2]+i*r[5]+A*r[8],e},e.transformMat4=xo,e.transformMat4$1=function(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[4]*i+r[12],e[1]=r[1]*n+r[5]*i+r[13],e},e.translate=function(e,t,r){var n,i,A,o,s,a,l,c,u,h,d,p,f=r[0],m=r[1],g=r[2];return t===e?(e[12]=t[0]*f+t[4]*m+t[8]*g+t[12],e[13]=t[1]*f+t[5]*m+t[9]*g+t[13],e[14]=t[2]*f+t[6]*m+t[10]*g+t[14],e[15]=t[3]*f+t[7]*m+t[11]*g+t[15]):(i=t[1],A=t[2],o=t[3],s=t[4],a=t[5],l=t[6],c=t[7],u=t[8],h=t[9],d=t[10],p=t[11],e[0]=n=t[0],e[1]=i,e[2]=A,e[3]=o,e[4]=s,e[5]=a,e[6]=l,e[7]=c,e[8]=u,e[9]=h,e[10]=d,e[11]=p,e[12]=n*f+s*m+u*g+t[12],e[13]=i*f+a*m+h*g+t[13],e[14]=A*f+l*m+d*g+t[14],e[15]=o*f+c*m+p*g+t[15]),e},e.triggerPluginCompletionEvent=qn,e.unicodeBlockLookup=Sn,e.uniqueId=function(){return a++},e.validateCustomStyleLayer=function(e){const t=[],r=e.id;return void 0===r&&t.push({message:`layers.${r}: missing required property "id"`}),void 0===e.render&&t.push({message:`layers.${r}: missing required method "render"`}),e.renderingMode&&"2d"!==e.renderingMode&&"3d"!==e.renderingMode&&t.push({message:`layers.${r}: property "renderingMode" must be either "2d" or "3d"`}),t},e.validateLight=xn,e.validateStyle=wn,e.vectorTile=Bs,e.warnOnce=p,e.wrap=o})),n(["./shared"],(function(e){function t(e){const r=typeof e;if("number"===r||"boolean"===r||"string"===r||null==e)return JSON.stringify(e);if(Array.isArray(e)){let r="[";for(const n of e)r+=`${t(n)},`;return`${r}]`}const n=Object.keys(e).sort();let i="{";for(let r=0;r<n.length;r++)i+=`${JSON.stringify(n[r])}:${t(e[n[r]])},`;return`${i}}`}function r(r){let n="";for(const i of e.refProperties)n+=`/${t(r[i])}`;return n}class n{constructor(e){this.keyCache={},e&&this.replace(e)}replace(e){this._layerConfigs={},this._layers={},this.update(e,[])}update(t,n){for(const r of t){this._layerConfigs[r.id]=r;const t=this._layers[r.id]=e.createStyleLayer(r);t._featureFilter=e.createFilter(t.filter),this.keyCache[r.id]&&delete this.keyCache[r.id]}for(const e of n)delete this.keyCache[e],delete this._layerConfigs[e],delete this._layers[e];this.familiesBySource={};const i=function(e,t){const n={};for(let i=0;i<e.length;i++){const A=t&&t[e[i].id]||r(e[i]);t&&(t[e[i].id]=A);let o=n[A];o||(o=n[A]=[]),o.push(e[i])}const i=[];for(const e in n)i.push(n[e]);return i}(Object.values(this._layerConfigs),this.keyCache);for(const e of i){const t=e.map((e=>this._layers[e.id])),r=t[0];if("none"===r.visibility)continue;const n=r.source||"";let i=this.familiesBySource[n];i||(i=this.familiesBySource[n]={});const A=r.sourceLayer||"_geojsonTileLayer";let o=i[A];o||(o=i[A]=[]),o.push(t)}}}class i{constructor(t){const r={},n=[];for(const e in t){const i=t[e],A=r[e]={};for(const e in i){const t=i[+e];if(!t||0===t.bitmap.width||0===t.bitmap.height)continue;const r={x:0,y:0,w:t.bitmap.width+2,h:t.bitmap.height+2};n.push(r),A[e]={rect:r,metrics:t.metrics}}}const{w:i,h:A}=e.potpack(n),o=new e.AlphaImage({width:i||1,height:A||1});for(const n in t){const i=t[n];for(const t in i){const A=i[+t];if(!A||0===A.bitmap.width||0===A.bitmap.height)continue;const s=r[n][t].rect;e.AlphaImage.copy(A.bitmap,o,{x:0,y:0},{x:s.x+1,y:s.y+1},A.bitmap)}}this.image=o,this.positions=r}}e.register("GlyphAtlas",i);class A{constructor(t){this.tileID=new e.OverscaledTileID(t.tileID.overscaledZ,t.tileID.wrap,t.tileID.canonical.z,t.tileID.canonical.x,t.tileID.canonical.y),this.uid=t.uid,this.zoom=t.zoom,this.pixelRatio=t.pixelRatio,this.tileSize=t.tileSize,this.source=t.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=t.showCollisionBoxes,this.collectResourceTiming=!!t.collectResourceTiming,this.returnDependencies=!!t.returnDependencies,this.promoteId=t.promoteId}parse(t,r,n,A,s){this.status="parsing",this.data=t,this.collisionBoxArray=new e.CollisionBoxArray;const a=new e.DictionaryCoder(Object.keys(t.layers).sort()),l=new e.FeatureIndex(this.tileID,this.promoteId);l.bucketLayerIDs=[];const c={},u={featureIndex:l,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:n},h=r.familiesBySource[this.source];for(const r in h){const i=t.layers[r];if(!i)continue;1===i.version&&e.warnOnce(`Vector tile source "${this.source}" layer "${r}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const A=a.encode(r),s=[];for(let e=0;e<i.length;e++){const t=i.feature(e),n=l.getId(t,r);s.push({feature:t,id:n,index:e,sourceLayerIndex:A})}for(const t of h[r]){const r=t[0];r.source!==this.source&&e.warnOnce(`layer.source = ${r.source} does not equal this.source = ${this.source}`),r.minzoom&&this.zoom<Math.floor(r.minzoom)||r.maxzoom&&this.zoom>=r.maxzoom||"none"!==r.visibility&&(o(t,this.zoom,n),(c[r.id]=r.createBucket({index:l.bucketLayerIDs.length,layers:t,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:A,sourceID:this.source})).populate(s,u,this.tileID.canonical),l.bucketLayerIDs.push(t.map((e=>e.id))))}}let d,p,f,m;const g=e.mapObject(u.glyphDependencies,(e=>Object.keys(e).map(Number)));Object.keys(g).length?A.send("getGlyphs",{uid:this.uid,stacks:g},((e,t)=>{d||(d=e,p=t,w.call(this))})):p={};const y=Object.keys(u.iconDependencies);y.length?A.send("getImages",{icons:y,source:this.source,tileID:this.tileID,type:"icons"},((e,t)=>{d||(d=e,f=t,w.call(this))})):f={};const _=Object.keys(u.patternDependencies);function w(){if(d)return s(d);if(p&&f&&m){const t=new i(p),r=new e.ImageAtlas(f,m);for(const i in c){const A=c[i];A instanceof e.SymbolBucket?(o(A.layers,this.zoom,n),e.performSymbolLayout({bucket:A,glyphMap:p,glyphPositions:t.positions,imageMap:f,imagePositions:r.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):A.hasPattern&&(A instanceof e.LineBucket||A instanceof e.FillBucket||A instanceof e.FillExtrusionBucket)&&(o(A.layers,this.zoom,n),A.addFeatures(u,this.tileID.canonical,r.patternPositions))}this.status="done",s(null,{buckets:Object.values(c).filter((e=>!e.isEmpty())),featureIndex:l,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:t.image,imageAtlas:r,glyphMap:this.returnDependencies?p:null,iconMap:this.returnDependencies?f:null,glyphPositions:this.returnDependencies?t.positions:null})}}_.length?A.send("getImages",{icons:_,source:this.source,tileID:this.tileID,type:"patterns"},((e,t)=>{d||(d=e,m=t,w.call(this))})):m={},w.call(this)}}function o(t,r,n){const i=new e.EvaluationParameters(r);for(const e of t)e.recalculate(i,n)}function s(t,r){const n=e.getArrayBuffer(t.request,((t,n,i,A)=>{t?r(t):n&&r(null,{vectorTile:new e.vectorTile.VectorTile(new e.pbf(n)),rawData:n,cacheControl:i,expires:A})}));return()=>{n.cancel(),r()}}class a{constructor(e,t,r,n){this.actor=e,this.layerIndex=t,this.availableImages=r,this.loadVectorData=n||s,this.loading={},this.loaded={}}loadTile(t,r){const n=t.uid;this.loading||(this.loading={});const i=!!(t&&t.request&&t.request.collectResourceTiming)&&new e.RequestPerformance(t.request),o=this.loading[n]=new A(t);o.abort=this.loadVectorData(t,((t,A)=>{if(delete this.loading[n],t||!A)return o.status="done",this.loaded[n]=o,r(t);const s=A.rawData,a={};A.expires&&(a.expires=A.expires),A.cacheControl&&(a.cacheControl=A.cacheControl);const l={};if(i){const e=i.finish();e&&(l.resourceTiming=JSON.parse(JSON.stringify(e)))}o.vectorTile=A.vectorTile,o.parse(A.vectorTile,this.layerIndex,this.availableImages,this.actor,((t,n)=>{if(t||!n)return r(t);r(null,e.extend({rawTileData:s.slice(0)},n,a,l))})),this.loaded=this.loaded||{},this.loaded[n]=o}))}reloadTile(e,t){const r=this.loaded,n=e.uid,i=this;if(r&&r[n]){const A=r[n];A.showCollisionBoxes=e.showCollisionBoxes;const o=(e,r)=>{const n=A.reloadCallback;n&&(delete A.reloadCallback,A.parse(A.vectorTile,i.layerIndex,this.availableImages,i.actor,n)),t(e,r)};"parsing"===A.status?A.reloadCallback=o:"done"===A.status&&(A.vectorTile?A.parse(A.vectorTile,this.layerIndex,this.availableImages,this.actor,o):o())}}abortTile(e,t){const r=this.loading,n=e.uid;r&&r[n]&&r[n].abort&&(r[n].abort(),delete r[n]),t()}removeTile(e,t){const r=this.loaded,n=e.uid;r&&r[n]&&delete r[n],t()}}class l{constructor(){this.loaded={}}loadTile(t,r){const{uid:n,encoding:i,rawImageData:A}=t,o=e.isImageBitmap(A)?this.getImageData(A):A,s=new e.DEMData(n,o,i);this.loaded=this.loaded||{},this.loaded[n]=s,r(null,s)}getImageData(t){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(t.width,t.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=t.width,this.offscreenCanvas.height=t.height,this.offscreenCanvasContext.drawImage(t,0,0,t.width,t.height);const r=this.offscreenCanvasContext.getImageData(-1,-1,t.width+2,t.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new e.RGBAImage({width:r.width,height:r.height},r.data)}removeTile(e){const t=this.loaded,r=e.uid;t&&t[r]&&delete t[r]}}var c=function e(t,r){var n,i=t&&t.type;if("FeatureCollection"===i)for(n=0;n<t.features.length;n++)e(t.features[n],r);else if("GeometryCollection"===i)for(n=0;n<t.geometries.length;n++)e(t.geometries[n],r);else if("Feature"===i)e(t.geometry,r);else if("Polygon"===i)u(t.coordinates,r);else if("MultiPolygon"===i)for(n=0;n<t.coordinates.length;n++)u(t.coordinates[n],r);return t};function u(e,t){if(0!==e.length){h(e[0],t);for(var r=1;r<e.length;r++)h(e[r],!t)}}function h(e,t){for(var r=0,n=0,i=0,A=e.length,o=A-1;i<A;o=i++){var s=(e[i][0]-e[o][0])*(e[o][1]+e[i][1]),a=r+s;n+=Math.abs(r)>=Math.abs(s)?r-a+s:s-a+r,r=a}r+n>=0!=!!t&&e.reverse()}const d=e.vectorTile.VectorTileFeature.prototype.toGeoJSON;class p{constructor(t){this._feature=t,this.extent=e.EXTENT,this.type=t.type,this.properties=t.tags,"id"in t&&!isNaN(t.id)&&(this.id=parseInt(t.id,10))}loadGeometry(){if(1===this._feature.type){const t=[];for(const r of this._feature.geometry)t.push([new e.pointGeometry(r[0],r[1])]);return t}{const t=[];for(const r of this._feature.geometry){const n=[];for(const t of r)n.push(new e.pointGeometry(t[0],t[1]));t.push(n)}return t}}toGeoJSON(e,t,r){return d.call(this,e,t,r)}}class f{constructor(t){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=e.EXTENT,this.length=t.length,this._features=t}feature(e){return new p(this._features[e])}}var m={exports:{}},g=e.pointGeometry,y=e.vectorTile.VectorTileFeature,_=w;function w(e,t){this.options=t||{},this.features=e,this.length=e.length}function x(e,t){this.id="number"==typeof e.id?e.id:void 0,this.type=e.type,this.rawGeometry=1===e.type?[e.geometry]:e.geometry,this.properties=e.tags,this.extent=t||4096}w.prototype.feature=function(e){return new x(this.features[e],this.options.extent)},x.prototype.loadGeometry=function(){var e=this.rawGeometry;this.geometry=[];for(var t=0;t<e.length;t++){for(var r=e[t],n=[],i=0;i<r.length;i++)n.push(new g(r[i][0],r[i][1]));this.geometry.push(n)}return this.geometry},x.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var e=this.geometry,t=1/0,r=-1/0,n=1/0,i=-1/0,A=0;A<e.length;A++)for(var o=e[A],s=0;s<o.length;s++){var a=o[s];t=Math.min(t,a.x),r=Math.max(r,a.x),n=Math.min(n,a.y),i=Math.max(i,a.y)}return[t,n,r,i]},x.prototype.toGeoJSON=y.prototype.toGeoJSON;var B=e.pbf,v=_;function b(e){var t=new B;return function(e,t){for(var r in e.layers)t.writeMessage(3,C,e.layers[r])}(e,t),t.finish()}function C(e,t){var r;t.writeVarintField(15,e.version||1),t.writeStringField(1,e.name||""),t.writeVarintField(5,e.extent||4096);var n={keys:[],values:[],keycache:{},valuecache:{}};for(r=0;r<e.length;r++)n.feature=e.feature(r),t.writeMessage(2,F,n);var i=n.keys;for(r=0;r<i.length;r++)t.writeStringField(3,i[r]);var A=n.values;for(r=0;r<A.length;r++)t.writeMessage(4,T,A[r])}function F(e,t){var r=e.feature;void 0!==r.id&&t.writeVarintField(1,r.id),t.writeMessage(2,E,e),t.writeVarintField(3,r.type),t.writeMessage(4,I,r)}function E(e,t){var r=e.feature,n=e.keys,i=e.values,A=e.keycache,o=e.valuecache;for(var s in r.properties){var a=r.properties[s],l=A[s];if(null!==a){void 0===l&&(n.push(s),A[s]=l=n.length-1),t.writeVarint(l);var c=typeof a;"string"!==c&&"boolean"!==c&&"number"!==c&&(a=JSON.stringify(a));var u=c+":"+a,h=o[u];void 0===h&&(i.push(a),o[u]=h=i.length-1),t.writeVarint(h)}}}function U(e,t){return(t<<3)+(7&e)}function Q(e){return e<<1^e>>31}function I(e,t){for(var r=e.loadGeometry(),n=e.type,i=0,A=0,o=r.length,s=0;s<o;s++){var a=r[s],l=1;1===n&&(l=a.length),t.writeVarint(U(1,l));for(var c=3===n?a.length-1:a.length,u=0;u<c;u++){1===u&&1!==n&&t.writeVarint(U(2,c-1));var h=a[u].x-i,d=a[u].y-A;t.writeVarint(Q(h)),t.writeVarint(Q(d)),i+=h,A+=d}3===n&&t.writeVarint(U(7,1))}}function T(e,t){var r=typeof e;"string"===r?t.writeStringField(1,e):"boolean"===r?t.writeBooleanField(7,e):"number"===r&&(e%1!=0?t.writeDoubleField(3,e):e<0?t.writeSVarintField(6,e):t.writeVarintField(5,e))}function S(e,t,r,n,i,A){if(i-n<=r)return;const o=n+i>>1;M(e,t,o,n,i,A%2),S(e,t,r,n,o-1,A+1),S(e,t,r,o+1,i,A+1)}function M(e,t,r,n,i,A){for(;i>n;){if(i-n>600){const o=i-n+1,s=r-n+1,a=Math.log(o),l=.5*Math.exp(2*a/3),c=.5*Math.sqrt(a*l*(o-l)/o)*(s-o/2<0?-1:1);M(e,t,r,Math.max(n,Math.floor(r-s*l/o+c)),Math.min(i,Math.floor(r+(o-s)*l/o+c)),A)}const o=t[2*r+A];let s=n,a=i;for(k(e,t,n,r),t[2*i+A]>o&&k(e,t,n,i);s<a;){for(k(e,t,s,a),s++,a--;t[2*s+A]<o;)s++;for(;t[2*a+A]>o;)a--}t[2*n+A]===o?k(e,t,n,a):(a++,k(e,t,a,i)),a<=r&&(n=a+1),r<=a&&(i=a-1)}}function k(e,t,r,n){D(e,r,n),D(t,2*r,2*n),D(t,2*r+1,2*n+1)}function D(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function L(e,t,r,n){const i=e-r,A=t-n;return i*i+A*A}m.exports=b,m.exports.fromVectorTileJs=b,m.exports.fromGeojsonVt=function(e,t){t=t||{};var r={};for(var n in e)r[n]=new v(e[n].features,t),r[n].name=n,r[n].version=t.version,r[n].extent=t.extent;return b({layers:r})},m.exports.GeoJSONWrapper=v;const P=e=>e[0],H=e=>e[1];class z{constructor(e,t=P,r=H,n=64,i=Float64Array){this.nodeSize=n,this.points=e;const A=e.length<65536?Uint16Array:Uint32Array,o=this.ids=new A(e.length),s=this.coords=new i(2*e.length);for(let n=0;n<e.length;n++)o[n]=n,s[2*n]=t(e[n]),s[2*n+1]=r(e[n]);S(o,s,n,0,o.length-1,0)}range(e,t,r,n){return function(e,t,r,n,i,A,o){const s=[0,e.length-1,0],a=[];let l,c;for(;s.length;){const u=s.pop(),h=s.pop(),d=s.pop();if(h-d<=o){for(let o=d;o<=h;o++)l=t[2*o],c=t[2*o+1],l>=r&&l<=i&&c>=n&&c<=A&&a.push(e[o]);continue}const p=Math.floor((d+h)/2);l=t[2*p],c=t[2*p+1],l>=r&&l<=i&&c>=n&&c<=A&&a.push(e[p]);const f=(u+1)%2;(0===u?r<=l:n<=c)&&(s.push(d),s.push(p-1),s.push(f)),(0===u?i>=l:A>=c)&&(s.push(p+1),s.push(h),s.push(f))}return a}(this.ids,this.coords,e,t,r,n,this.nodeSize)}within(e,t,r){return function(e,t,r,n,i,A){const o=[0,e.length-1,0],s=[],a=i*i;for(;o.length;){const l=o.pop(),c=o.pop(),u=o.pop();if(c-u<=A){for(let i=u;i<=c;i++)L(t[2*i],t[2*i+1],r,n)<=a&&s.push(e[i]);continue}const h=Math.floor((u+c)/2),d=t[2*h],p=t[2*h+1];L(d,p,r,n)<=a&&s.push(e[h]);const f=(l+1)%2;(0===l?r-i<=d:n-i<=p)&&(o.push(u),o.push(h-1),o.push(f)),(0===l?r+i>=d:n+i>=p)&&(o.push(h+1),o.push(c),o.push(f))}return s}(this.ids,this.coords,e,t,r,this.nodeSize)}}const R={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:e=>e},O=Math.fround||(K=new Float32Array(1),e=>(K[0]=+e,K[0]));var K;class V{constructor(e){this.options=J(Object.create(R),e),this.trees=new Array(this.options.maxZoom+1)}load(e){const{log:t,minZoom:r,maxZoom:n,nodeSize:i}=this.options;t&&console.time("total time");const A=`prepare ${e.length} points`;t&&console.time(A),this.points=e;let o=[];for(let t=0;t<e.length;t++)e[t].geometry&&o.push(N(e[t],t));this.trees[n+1]=new z(o,W,Y,i,Float32Array),t&&console.timeEnd(A);for(let e=n;e>=r;e--){const r=+Date.now();o=this._cluster(o,e),this.trees[e]=new z(o,W,Y,i,Float32Array),t&&console.log("z%d: %d clusters in %dms",e,o.length,+Date.now()-r)}return t&&console.timeEnd("total time"),this}getClusters(e,t){let r=((e[0]+180)%360+360)%360-180;const n=Math.max(-90,Math.min(90,e[1]));let i=180===e[2]?180:((e[2]+180)%360+360)%360-180;const A=Math.max(-90,Math.min(90,e[3]));if(e[2]-e[0]>=360)r=-180,i=180;else if(r>i){const e=this.getClusters([r,n,180,A],t),o=this.getClusters([-180,n,i,A],t);return e.concat(o)}const o=this.trees[this._limitZoom(t)],s=o.range(X(r),j(A),X(i),j(n)),a=[];for(const e of s){const t=o.points[e];a.push(t.numPoints?G(t):this.points[t.index])}return a}getChildren(e){const t=this._getOriginId(e),r=this._getOriginZoom(e),n="No cluster with the specified id.",i=this.trees[r];if(!i)throw new Error(n);const A=i.points[t];if(!A)throw new Error(n);const o=this.options.radius/(this.options.extent*Math.pow(2,r-1)),s=i.within(A.x,A.y,o),a=[];for(const t of s){const r=i.points[t];r.parentId===e&&a.push(r.numPoints?G(r):this.points[r.index])}if(0===a.length)throw new Error(n);return a}getLeaves(e,t,r){const n=[];return this._appendLeaves(n,e,t=t||10,r=r||0,0),n}getTile(e,t,r){const n=this.trees[this._limitZoom(e)],i=Math.pow(2,e),{extent:A,radius:o}=this.options,s=o/A,a=(r-s)/i,l=(r+1+s)/i,c={features:[]};return this._addTileFeatures(n.range((t-s)/i,a,(t+1+s)/i,l),n.points,t,r,i,c),0===t&&this._addTileFeatures(n.range(1-s/i,a,1,l),n.points,i,r,i,c),t===i-1&&this._addTileFeatures(n.range(0,a,s/i,l),n.points,-1,r,i,c),c.features.length?c:null}getClusterExpansionZoom(e){let t=this._getOriginZoom(e)-1;for(;t<=this.options.maxZoom;){const r=this.getChildren(e);if(t++,1!==r.length)break;e=r[0].properties.cluster_id}return t}_appendLeaves(e,t,r,n,i){const A=this.getChildren(t);for(const t of A){const A=t.properties;if(A&&A.cluster?i+A.point_count<=n?i+=A.point_count:i=this._appendLeaves(e,A.cluster_id,r,n,i):i<n?i++:e.push(t),e.length===r)break}return i}_addTileFeatures(e,t,r,n,i,A){for(const o of e){const e=t[o],s=e.numPoints;let a,l,c;if(s)a=q(e),l=e.x,c=e.y;else{const t=this.points[e.index];a=t.properties,l=X(t.geometry.coordinates[0]),c=j(t.geometry.coordinates[1])}const u={type:1,geometry:[[Math.round(this.options.extent*(l*i-r)),Math.round(this.options.extent*(c*i-n))]],tags:a};let h;s?h=e.id:this.options.generateId?h=e.index:this.points[e.index].id&&(h=this.points[e.index].id),void 0!==h&&(u.id=h),A.features.push(u)}}_limitZoom(e){return Math.max(this.options.minZoom,Math.min(Math.floor(+e),this.options.maxZoom+1))}_cluster(e,t){const r=[],{radius:n,extent:i,reduce:A,minPoints:o}=this.options,s=n/(i*Math.pow(2,t));for(let n=0;n<e.length;n++){const i=e[n];if(i.zoom<=t)continue;i.zoom=t;const a=this.trees[t+1],l=a.within(i.x,i.y,s),c=i.numPoints||1;let u=c;for(const e of l){const r=a.points[e];r.zoom>t&&(u+=r.numPoints||1)}if(u>c&&u>=o){let e=i.x*c,o=i.y*c,s=A&&c>1?this._map(i,!0):null;const h=(n<<5)+(t+1)+this.points.length;for(const r of l){const n=a.points[r];if(n.zoom<=t)continue;n.zoom=t;const l=n.numPoints||1;e+=n.x*l,o+=n.y*l,n.parentId=h,A&&(s||(s=this._map(i,!0)),A(s,this._map(n)))}i.parentId=h,r.push($(e/u,o/u,h,u,s))}else if(r.push(i),u>1)for(const e of l){const n=a.points[e];n.zoom<=t||(n.zoom=t,r.push(n))}}return r}_getOriginId(e){return e-this.points.length>>5}_getOriginZoom(e){return(e-this.points.length)%32}_map(e,t){if(e.numPoints)return t?J({},e.properties):e.properties;const r=this.points[e.index].properties,n=this.options.map(r);return t&&n===r?J({},n):n}}function $(e,t,r,n,i){return{x:O(e),y:O(t),zoom:1/0,id:r,parentId:-1,numPoints:n,properties:i}}function N(e,t){const[r,n]=e.geometry.coordinates;return{x:O(X(r)),y:O(j(n)),zoom:1/0,index:t,parentId:-1}}function G(e){return{type:"Feature",id:e.id,properties:q(e),geometry:{type:"Point",coordinates:[(t=e.x,360*(t-.5)),Z(e.y)]}};var t}function q(e){const t=e.numPoints,r=t>=1e4?`${Math.round(t/1e3)}k`:t>=1e3?Math.round(t/100)/10+"k":t;return J(J({},e.properties),{cluster:!0,cluster_id:e.id,point_count:t,point_count_abbreviated:r})}function X(e){return e/360+.5}function j(e){const t=Math.sin(e*Math.PI/180),r=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return r<0?0:r>1?1:r}function Z(e){const t=(180-360*e)*Math.PI/180;return 360*Math.atan(Math.exp(t))/Math.PI-90}function J(e,t){for(const r in t)e[r]=t[r];return e}function W(e){return e.x}function Y(e){return e.y}function ee(e,t,r,n){for(var i,A=n,o=r-t>>1,s=r-t,a=e[t],l=e[t+1],c=e[r],u=e[r+1],h=t+3;h<r;h+=3){var d=te(e[h],e[h+1],a,l,c,u);if(d>A)i=h,A=d;else if(d===A){var p=Math.abs(h-o);p<s&&(i=h,s=p)}}A>n&&(i-t>3&&ee(e,t,i,n),e[i+2]=A,r-i>3&&ee(e,i,r,n))}function te(e,t,r,n,i,A){var o=i-r,s=A-n;if(0!==o||0!==s){var a=((e-r)*o+(t-n)*s)/(o*o+s*s);a>1?(r=i,n=A):a>0&&(r+=o*a,n+=s*a)}return(o=e-r)*o+(s=t-n)*s}function re(e,t,r,n){var i={id:void 0===e?null:e,type:t,geometry:r,tags:n,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(e){var t=e.geometry,r=e.type;if("Point"===r||"MultiPoint"===r||"LineString"===r)ne(e,t);else if("Polygon"===r||"MultiLineString"===r)for(var n=0;n<t.length;n++)ne(e,t[n]);else if("MultiPolygon"===r)for(n=0;n<t.length;n++)for(var i=0;i<t[n].length;i++)ne(e,t[n][i])}(i),i}function ne(e,t){for(var r=0;r<t.length;r+=3)e.minX=Math.min(e.minX,t[r]),e.minY=Math.min(e.minY,t[r+1]),e.maxX=Math.max(e.maxX,t[r]),e.maxY=Math.max(e.maxY,t[r+1])}function ie(e,t,r,n){if(t.geometry){var i=t.geometry.coordinates,A=t.geometry.type,o=Math.pow(r.tolerance/((1<<r.maxZoom)*r.extent),2),s=[],a=t.id;if(r.promoteId?a=t.properties[r.promoteId]:r.generateId&&(a=n||0),"Point"===A)Ae(i,s);else if("MultiPoint"===A)for(var l=0;l<i.length;l++)Ae(i[l],s);else if("LineString"===A)oe(i,s,o,!1);else if("MultiLineString"===A){if(r.lineMetrics){for(l=0;l<i.length;l++)oe(i[l],s=[],o,!1),e.push(re(a,"LineString",s,t.properties));return}se(i,s,o,!1)}else if("Polygon"===A)se(i,s,o,!0);else{if("MultiPolygon"!==A){if("GeometryCollection"===A){for(l=0;l<t.geometry.geometries.length;l++)ie(e,{id:a,geometry:t.geometry.geometries[l],properties:t.properties},r,n);return}throw new Error("Input data is not a valid GeoJSON object.")}for(l=0;l<i.length;l++){var c=[];se(i[l],c,o,!0),s.push(c)}}e.push(re(a,A,s,t.properties))}}function Ae(e,t){t.push(ae(e[0])),t.push(le(e[1])),t.push(0)}function oe(e,t,r,n){for(var i,A,o=0,s=0;s<e.length;s++){var a=ae(e[s][0]),l=le(e[s][1]);t.push(a),t.push(l),t.push(0),s>0&&(o+=n?(i*l-a*A)/2:Math.sqrt(Math.pow(a-i,2)+Math.pow(l-A,2))),i=a,A=l}var c=t.length-3;t[2]=1,ee(t,0,c,r),t[c+2]=1,t.size=Math.abs(o),t.start=0,t.end=t.size}function se(e,t,r,n){for(var i=0;i<e.length;i++){var A=[];oe(e[i],A,r,n),t.push(A)}}function ae(e){return e/360+.5}function le(e){var t=Math.sin(e*Math.PI/180),r=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return r<0?0:r>1?1:r}function ce(e,t,r,n,i,A,o,s){if(n/=t,A>=(r/=t)&&o<n)return e;if(o<r||A>=n)return null;for(var a=[],l=0;l<e.length;l++){var c=e[l],u=c.geometry,h=c.type,d=0===i?c.minX:c.minY,p=0===i?c.maxX:c.maxY;if(d>=r&&p<n)a.push(c);else if(!(p<r||d>=n)){var f=[];if("Point"===h||"MultiPoint"===h)ue(u,f,r,n,i);else if("LineString"===h)he(u,f,r,n,i,!1,s.lineMetrics);else if("MultiLineString"===h)pe(u,f,r,n,i,!1);else if("Polygon"===h)pe(u,f,r,n,i,!0);else if("MultiPolygon"===h)for(var m=0;m<u.length;m++){var g=[];pe(u[m],g,r,n,i,!0),g.length&&f.push(g)}if(f.length){if(s.lineMetrics&&"LineString"===h){for(m=0;m<f.length;m++)a.push(re(c.id,h,f[m],c.tags));continue}"LineString"!==h&&"MultiLineString"!==h||(1===f.length?(h="LineString",f=f[0]):h="MultiLineString"),"Point"!==h&&"MultiPoint"!==h||(h=3===f.length?"Point":"MultiPoint"),a.push(re(c.id,h,f,c.tags))}}}return a.length?a:null}function ue(e,t,r,n,i){for(var A=0;A<e.length;A+=3){var o=e[A+i];o>=r&&o<=n&&(t.push(e[A]),t.push(e[A+1]),t.push(e[A+2]))}}function he(e,t,r,n,i,A,o){for(var s,a,l=de(e),c=0===i?me:ge,u=e.start,h=0;h<e.length-3;h+=3){var d=e[h],p=e[h+1],f=e[h+2],m=e[h+3],g=e[h+4],y=0===i?d:p,_=0===i?m:g,w=!1;o&&(s=Math.sqrt(Math.pow(d-m,2)+Math.pow(p-g,2))),y<r?_>r&&(a=c(l,d,p,m,g,r),o&&(l.start=u+s*a)):y>n?_<n&&(a=c(l,d,p,m,g,n),o&&(l.start=u+s*a)):fe(l,d,p,f),_<r&&y>=r&&(a=c(l,d,p,m,g,r),w=!0),_>n&&y<=n&&(a=c(l,d,p,m,g,n),w=!0),!A&&w&&(o&&(l.end=u+s*a),t.push(l),l=de(e)),o&&(u+=s)}var x=e.length-3;d=e[x],p=e[x+1],f=e[x+2],(y=0===i?d:p)>=r&&y<=n&&fe(l,d,p,f),x=l.length-3,A&&x>=3&&(l[x]!==l[0]||l[x+1]!==l[1])&&fe(l,l[0],l[1],l[2]),l.length&&t.push(l)}function de(e){var t=[];return t.size=e.size,t.start=e.start,t.end=e.end,t}function pe(e,t,r,n,i,A){for(var o=0;o<e.length;o++)he(e[o],t,r,n,i,A,!1)}function fe(e,t,r,n){e.push(t),e.push(r),e.push(n)}function me(e,t,r,n,i,A){var o=(A-t)/(n-t);return e.push(A),e.push(r+(i-r)*o),e.push(1),o}function ge(e,t,r,n,i,A){var o=(A-r)/(i-r);return e.push(t+(n-t)*o),e.push(A),e.push(1),o}function ye(e,t){for(var r=[],n=0;n<e.length;n++){var i,A=e[n],o=A.type;if("Point"===o||"MultiPoint"===o||"LineString"===o)i=_e(A.geometry,t);else if("MultiLineString"===o||"Polygon"===o){i=[];for(var s=0;s<A.geometry.length;s++)i.push(_e(A.geometry[s],t))}else if("MultiPolygon"===o)for(i=[],s=0;s<A.geometry.length;s++){for(var a=[],l=0;l<A.geometry[s].length;l++)a.push(_e(A.geometry[s][l],t));i.push(a)}r.push(re(A.id,o,i,A.tags))}return r}function _e(e,t){var r=[];r.size=e.size,void 0!==e.start&&(r.start=e.start,r.end=e.end);for(var n=0;n<e.length;n+=3)r.push(e[n]+t,e[n+1],e[n+2]);return r}function we(e,t){if(e.transformed)return e;var r,n,i,A=1<<e.z,o=e.x,s=e.y;for(r=0;r<e.features.length;r++){var a=e.features[r],l=a.geometry,c=a.type;if(a.geometry=[],1===c)for(n=0;n<l.length;n+=2)a.geometry.push(xe(l[n],l[n+1],t,A,o,s));else for(n=0;n<l.length;n++){var u=[];for(i=0;i<l[n].length;i+=2)u.push(xe(l[n][i],l[n][i+1],t,A,o,s));a.geometry.push(u)}}return e.transformed=!0,e}function xe(e,t,r,n,i,A){return[Math.round(r*(e*n-i)),Math.round(r*(t*n-A))]}function Be(e,t,r,n,i){for(var A=t===i.maxZoom?0:i.tolerance/((1<<t)*i.extent),o={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:r,y:n,z:t,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},s=0;s<e.length;s++){o.numFeatures++,ve(o,e[s],A,i);var a=e[s].minX,l=e[s].minY,c=e[s].maxX,u=e[s].maxY;a<o.minX&&(o.minX=a),l<o.minY&&(o.minY=l),c>o.maxX&&(o.maxX=c),u>o.maxY&&(o.maxY=u)}return o}function ve(e,t,r,n){var i=t.geometry,A=t.type,o=[];if("Point"===A||"MultiPoint"===A)for(var s=0;s<i.length;s+=3)o.push(i[s]),o.push(i[s+1]),e.numPoints++,e.numSimplified++;else if("LineString"===A)be(o,i,e,r,!1,!1);else if("MultiLineString"===A||"Polygon"===A)for(s=0;s<i.length;s++)be(o,i[s],e,r,"Polygon"===A,0===s);else if("MultiPolygon"===A)for(var a=0;a<i.length;a++){var l=i[a];for(s=0;s<l.length;s++)be(o,l[s],e,r,!0,0===s)}if(o.length){var c=t.tags||null;if("LineString"===A&&n.lineMetrics){for(var u in c={},t.tags)c[u]=t.tags[u];c.mapbox_clip_start=i.start/i.size,c.mapbox_clip_end=i.end/i.size}var h={geometry:o,type:"Polygon"===A||"MultiPolygon"===A?3:"LineString"===A||"MultiLineString"===A?2:1,tags:c};null!==t.id&&(h.id=t.id),e.features.push(h)}}function be(e,t,r,n,i,A){var o=n*n;if(n>0&&t.size<(i?o:n))r.numPoints+=t.length/3;else{for(var s=[],a=0;a<t.length;a+=3)(0===n||t[a+2]>o)&&(r.numSimplified++,s.push(t[a]),s.push(t[a+1])),r.numPoints++;i&&function(e,t){for(var r=0,n=0,i=e.length,A=i-2;n<i;A=n,n+=2)r+=(e[n]-e[A])*(e[n+1]+e[A+1]);if(r>0===t)for(n=0,i=e.length;n<i/2;n+=2){var o=e[n],s=e[n+1];e[n]=e[i-2-n],e[n+1]=e[i-1-n],e[i-2-n]=o,e[i-1-n]=s}}(s,A),e.push(s)}}function Ce(e,t){var r=(t=this.options=function(e,t){for(var r in t)e[r]=t[r];return e}(Object.create(this.options),t)).debug;if(r&&console.time("preprocess data"),t.maxZoom<0||t.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(t.promoteId&&t.generateId)throw new Error("promoteId and generateId cannot be used together.");var n=function(e,t){var r=[];if("FeatureCollection"===e.type)for(var n=0;n<e.features.length;n++)ie(r,e.features[n],t,n);else ie(r,"Feature"===e.type?e:{geometry:e},t);return r}(e,t);this.tiles={},this.tileCoords=[],r&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",t.indexMaxZoom,t.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),n=function(e,t){var r=t.buffer/t.extent,n=e,i=ce(e,1,-1-r,r,0,-1,2,t),A=ce(e,1,1-r,2+r,0,-1,2,t);return(i||A)&&(n=ce(e,1,-r,1+r,0,-1,2,t)||[],i&&(n=ye(i,1).concat(n)),A&&(n=n.concat(ye(A,-1)))),n}(n,t),n.length&&this.splitTile(n,0,0,0),r&&(n.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Fe(e,t,r){return 32*((1<<e)*r+t)+e}function Ee(e,t){const r=e.tileID.canonical;if(!this._geoJSONIndex)return t(null,null);const n=this._geoJSONIndex.getTile(r.z,r.x,r.y);if(!n)return t(null,null);const i=new f(n.features);let A=m.exports(i);0===A.byteOffset&&A.byteLength===A.buffer.byteLength||(A=new Uint8Array(A)),t(null,{vectorTile:i,rawData:A.buffer})}Ce.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Ce.prototype.splitTile=function(e,t,r,n,i,A,o){for(var s=[e,t,r,n],a=this.options,l=a.debug;s.length;){n=s.pop(),r=s.pop(),t=s.pop(),e=s.pop();var c=1<<t,u=Fe(t,r,n),h=this.tiles[u];if(!h&&(l>1&&console.time("creation"),h=this.tiles[u]=Be(e,t,r,n,a),this.tileCoords.push({z:t,x:r,y:n}),l)){l>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",t,r,n,h.numFeatures,h.numPoints,h.numSimplified),console.timeEnd("creation"));var d="z"+t;this.stats[d]=(this.stats[d]||0)+1,this.total++}if(h.source=e,i){if(t===a.maxZoom||t===i)continue;var p=1<<i-t;if(r!==Math.floor(A/p)||n!==Math.floor(o/p))continue}else if(t===a.indexMaxZoom||h.numPoints<=a.indexMaxPoints)continue;if(h.source=null,0!==e.length){l>1&&console.time("clipping");var f,m,g,y,_,w,x=.5*a.buffer/a.extent,B=.5-x,v=.5+x,b=1+x;f=m=g=y=null,_=ce(e,c,r-x,r+v,0,h.minX,h.maxX,a),w=ce(e,c,r+B,r+b,0,h.minX,h.maxX,a),e=null,_&&(f=ce(_,c,n-x,n+v,1,h.minY,h.maxY,a),m=ce(_,c,n+B,n+b,1,h.minY,h.maxY,a),_=null),w&&(g=ce(w,c,n-x,n+v,1,h.minY,h.maxY,a),y=ce(w,c,n+B,n+b,1,h.minY,h.maxY,a),w=null),l>1&&console.timeEnd("clipping"),s.push(f||[],t+1,2*r,2*n),s.push(m||[],t+1,2*r,2*n+1),s.push(g||[],t+1,2*r+1,2*n),s.push(y||[],t+1,2*r+1,2*n+1)}}},Ce.prototype.getTile=function(e,t,r){var n=this.options,i=n.extent,A=n.debug;if(e<0||e>24)return null;var o=1<<e,s=Fe(e,t=(t%o+o)%o,r);if(this.tiles[s])return we(this.tiles[s],i);A>1&&console.log("drilling down to z%d-%d-%d",e,t,r);for(var a,l=e,c=t,u=r;!a&&l>0;)l--,c=Math.floor(c/2),u=Math.floor(u/2),a=this.tiles[Fe(l,c,u)];return a&&a.source?(A>1&&console.log("found parent tile z%d-%d-%d",l,c,u),A>1&&console.time("drilling down"),this.splitTile(a.source,l,c,u,e,t,r),A>1&&console.timeEnd("drilling down"),this.tiles[s]?we(this.tiles[s],i):null):null};class Ue extends a{constructor(e,t,r,n){super(e,t,r,Ee),n&&(this.loadGeoJSON=n)}loadData(t,r){var n;null===(n=this._pendingRequest)||void 0===n||n.cancel(),this._pendingCallback&&this._pendingCallback(null,{abandoned:!0});const i=!!(t&&t.request&&t.request.collectResourceTiming)&&new e.RequestPerformance(t.request);this._pendingCallback=r,this._pendingRequest=this.loadGeoJSON(t,((n,A)=>{if(delete this._pendingCallback,delete this._pendingRequest,n||!A)return r(n);if("object"!=typeof A)return r(new Error(`Input data given to '${t.source}' is not a valid GeoJSON object.`));{c(A,!0);try{if(t.filter){const r=e.createExpression(t.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===r.result)throw new Error(r.value.map((e=>`${e.key}: ${e.message}`)).join(", "));const n=A.features.filter((e=>r.value.evaluate({zoom:0},e)));A={type:"FeatureCollection",features:n}}this._geoJSONIndex=t.cluster?new V(function({superclusterOptions:t,clusterProperties:r}){if(!r||!t)return t;const n={},i={},A={accumulated:null,zoom:0},o={properties:null},s=Object.keys(r);for(const t of s){const[A,o]=r[t],s=e.createExpression(o),a=e.createExpression("string"==typeof A?[A,["accumulated"],["get",t]]:A);n[t]=s.value,i[t]=a.value}return t.map=e=>{o.properties=e;const t={};for(const e of s)t[e]=n[e].evaluate(A,o);return t},t.reduce=(e,t)=>{o.properties=t;for(const t of s)A.accumulated=e[t],e[t]=i[t].evaluate(A,o)},t}(t)).load(A.features):function(e,t){return new Ce(e,t)}(A,t.geojsonVtOptions)}catch(n){return r(n)}this.loaded={};const o={};if(i){const e=i.finish();e&&(o.resourceTiming={},o.resourceTiming[t.source]=JSON.parse(JSON.stringify(e)))}r(null,o)}}))}reloadTile(e,t){const r=this.loaded;return r&&r[e.uid]?super.reloadTile(e,t):this.loadTile(e,t)}loadGeoJSON(t,r){if(t.request)return e.getJSON(t.request,r);if("string"==typeof t.data)try{r(null,JSON.parse(t.data))}catch(e){r(new Error(`Input data given to '${t.source}' is not a valid GeoJSON object.`))}else r(new Error(`Input data given to '${t.source}' is not a valid GeoJSON object.`));return{cancel:()=>{}}}removeSource(e,t){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),t()}getClusterExpansionZoom(e,t){try{t(null,this._geoJSONIndex.getClusterExpansionZoom(e.clusterId))}catch(e){t(e)}}getClusterChildren(e,t){try{t(null,this._geoJSONIndex.getChildren(e.clusterId))}catch(e){t(e)}}getClusterLeaves(e,t){try{t(null,this._geoJSONIndex.getLeaves(e.clusterId,e.limit,e.offset))}catch(e){t(e)}}}class Qe{constructor(t){this.self=t,this.actor=new e.Actor(t,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:a,geojson:Ue},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(e,t)=>{if(this.workerSourceTypes[e])throw new Error(`Worker source with name "${e}" already registered.`);this.workerSourceTypes[e]=t},this.self.registerRTLTextPlugin=t=>{if(e.plugin.isParsed())throw new Error("RTL text plugin already registered.");e.plugin.applyArabicShaping=t.applyArabicShaping,e.plugin.processBidirectionalText=t.processBidirectionalText,e.plugin.processStyledBidirectionalText=t.processStyledBidirectionalText}}setReferrer(e,t){this.referrer=t}setImages(e,t,r){this.availableImages[e]=t;for(const r in this.workerSources[e]){const n=this.workerSources[e][r];for(const e in n)n[e].availableImages=t}r()}setLayers(e,t,r){this.getLayerIndex(e).replace(t),r()}updateLayers(e,t,r){this.getLayerIndex(e).update(t.layers,t.removedIds),r()}loadTile(e,t,r){this.getWorkerSource(e,t.type,t.source).loadTile(t,r)}loadDEMTile(e,t,r){this.getDEMWorkerSource(e,t.source).loadTile(t,r)}reloadTile(e,t,r){this.getWorkerSource(e,t.type,t.source).reloadTile(t,r)}abortTile(e,t,r){this.getWorkerSource(e,t.type,t.source).abortTile(t,r)}removeTile(e,t,r){this.getWorkerSource(e,t.type,t.source).removeTile(t,r)}removeDEMTile(e,t){this.getDEMWorkerSource(e,t.source).removeTile(t)}removeSource(e,t,r){if(!this.workerSources[e]||!this.workerSources[e][t.type]||!this.workerSources[e][t.type][t.source])return;const n=this.workerSources[e][t.type][t.source];delete this.workerSources[e][t.type][t.source],void 0!==n.removeSource?n.removeSource(t,r):r()}loadWorkerSource(e,t,r){try{this.self.importScripts(t.url),r()}catch(e){r(e.toString())}}syncRTLPluginState(t,r,n){try{e.plugin.setState(r);const t=e.plugin.getPluginURL();if(e.plugin.isLoaded()&&!e.plugin.isParsed()&&null!=t){this.self.importScripts(t);const r=e.plugin.isParsed();n(r?void 0:new Error(`RTL Text Plugin failed to import scripts from ${t}`),r)}}catch(e){n(e.toString())}}getAvailableImages(e){let t=this.availableImages[e];return t||(t=[]),t}getLayerIndex(e){let t=this.layerIndexes[e];return t||(t=this.layerIndexes[e]=new n),t}getWorkerSource(e,t,r){if(this.workerSources[e]||(this.workerSources[e]={}),this.workerSources[e][t]||(this.workerSources[e][t]={}),!this.workerSources[e][t][r]){const n={send:(t,r,n)=>{this.actor.send(t,r,n,e)}};this.workerSources[e][t][r]=new this.workerSourceTypes[t](n,this.getLayerIndex(e),this.getAvailableImages(e))}return this.workerSources[e][t][r]}getDEMWorkerSource(e,t){return this.demWorkerSources[e]||(this.demWorkerSources[e]={}),this.demWorkerSources[e][t]||(this.demWorkerSources[e][t]=new l),this.demWorkerSources[e][t]}enforceCacheSizeLimit(t,r){e.enforceCacheSizeLimit(r)}}return e.isWorker()&&(self.worker=new Qe(self)),Qe})),n(["./shared"],(function(e){var t=r;function r(e){return!function(e){return"undefined"==typeof window||"undefined"==typeof document?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var e,t,r=new Blob([""],{type:"text/javascript"}),n=URL.createObjectURL(r);try{t=new Worker(n),e=!0}catch(t){e=!1}return t&&t.terminate(),URL.revokeObjectURL(n),e}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var e=document.createElement("canvas");e.width=e.height=1;var t=e.getContext("2d");if(!t)return!1;var r=t.getImageData(0,0,1,1);return r&&r.width===e.width}()?(void 0===n[t=e&&e.failIfMajorPerformanceCaveat]&&(n[t]=function(e){var t,n=function(e){var t=document.createElement("canvas"),n=Object.create(r.webGLContextAttributes);return n.failIfMajorPerformanceCaveat=e,t.getContext("webgl",n)||t.getContext("experimental-webgl",n)}(e);if(!n)return!1;try{t=n.createShader(n.VERTEX_SHADER)}catch(e){return!1}return!(!t||n.isContextLost())&&(n.shaderSource(t,"void main() {}"),n.compileShader(t),!0===n.getShaderParameter(t,n.COMPILE_STATUS))}(t)),n[t]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var t}(e)}var n={};function i(e,t){if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(!i(e[r],t[r]))return!1;return!0}if("object"==typeof e&&null!==e&&null!==t){if("object"!=typeof t)return!1;if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(!i(e[r],t[r]))return!1;return!0}return e===t}r.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};class A{static testProp(e){if(!A.docStyle)return e[0];for(let t=0;t<e.length;t++)if(e[t]in A.docStyle)return e[t];return e[0]}static create(e,t,r){const n=window.document.createElement(e);return void 0!==t&&(n.className=t),r&&r.appendChild(n),n}static createNS(e,t){return window.document.createElementNS(e,t)}static disableDrag(){A.docStyle&&A.selectProp&&(A.userSelect=A.docStyle[A.selectProp],A.docStyle[A.selectProp]="none")}static enableDrag(){A.docStyle&&A.selectProp&&(A.docStyle[A.selectProp]=A.userSelect)}static setTransform(e,t){e.style[A.transformProp]=t}static addEventListener(e,t,r,n={}){e.addEventListener(t,r,"passive"in n?n:n.capture)}static removeEventListener(e,t,r,n={}){e.removeEventListener(t,r,"passive"in n?n:n.capture)}static suppressClickInternal(e){e.preventDefault(),e.stopPropagation(),window.removeEventListener("click",A.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",A.suppressClickInternal,!0),window.setTimeout((()=>{window.removeEventListener("click",A.suppressClickInternal,!0)}),0)}static mousePos(t,r){const n=t.getBoundingClientRect();return new e.pointGeometry(r.clientX-n.left-t.clientLeft,r.clientY-n.top-t.clientTop)}static touchPos(t,r){const n=t.getBoundingClientRect(),i=[];for(let A=0;A<r.length;A++)i.push(new e.pointGeometry(r[A].clientX-n.left-t.clientLeft,r[A].clientY-n.top-t.clientTop));return i}static mouseButton(e){return e.button}static remove(e){e.parentNode&&e.parentNode.removeChild(e)}}A.docStyle="undefined"!=typeof window&&window.document&&window.document.documentElement.style,A.selectProp=A.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),A.transformProp=A.testProp(["transform","WebkitTransform"]);class o{constructor(e){this._transformRequestFn=e}transformRequest(e,t){return this._transformRequestFn&&this._transformRequestFn(e,t)||{url:e}}normalizeSpriteURL(e,t,r){const n=function(e){const t=e.match(s);if(!t)throw new Error(`Unable to parse URL "${e}"`);return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}(e);return n.path+=`${t}${r}`,function(e){const t=e.params.length?`?${e.params.join("&")}`:"";return`${e.protocol}://${e.authority}${e.path}${t}`}(n)}setTransformRequest(e){this._transformRequestFn=e}}const s=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;class a{constructor(e,t,r,n){this.context=e,this.format=r,this.texture=e.gl.createTexture(),this.update(t,n)}update(t,r,n){const{width:i,height:A}=t,o=!(this.size&&this.size[0]===i&&this.size[1]===A||n),{context:s}=this,{gl:a}=s;if(this.useMipmap=Boolean(r&&r.useMipmap),a.bindTexture(a.TEXTURE_2D,this.texture),s.pixelStoreUnpackFlipY.set(!1),s.pixelStoreUnpack.set(1),s.pixelStoreUnpackPremultiplyAlpha.set(this.format===a.RGBA&&(!r||!1!==r.premultiply)),o)this.size=[i,A],t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||e.isImageBitmap(t)?a.texImage2D(a.TEXTURE_2D,0,this.format,this.format,a.UNSIGNED_BYTE,t):a.texImage2D(a.TEXTURE_2D,0,this.format,i,A,0,this.format,a.UNSIGNED_BYTE,t.data);else{const{x:r,y:o}=n||{x:0,y:0};t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||e.isImageBitmap(t)?a.texSubImage2D(a.TEXTURE_2D,0,r,o,a.RGBA,a.UNSIGNED_BYTE,t):a.texSubImage2D(a.TEXTURE_2D,0,r,o,i,A,a.RGBA,a.UNSIGNED_BYTE,t.data)}this.useMipmap&&this.isSizePowerOfTwo()&&a.generateMipmap(a.TEXTURE_2D)}bind(e,t,r){const{context:n}=this,{gl:i}=n;i.bindTexture(i.TEXTURE_2D,this.texture),r!==i.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(r=i.LINEAR),e!==this.filter&&(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,e),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,r||e),this.filter=e),t!==this.wrap&&(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,t),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,t),this.wrap=t)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}function l(e){const{userImage:t}=e;return!!(t&&t.render&&t.render())&&(e.data.replace(new Uint8Array(t.data.buffer)),!0)}class c extends e.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new e.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(e){if(this.loaded!==e&&(this.loaded=e,e)){for(const{ids:e,callback:t}of this.requestors)this._notify(e,t);this.requestors=[]}}getImage(e){return this.images[e]}addImage(e,t){if(this.images[e])throw new Error(`Image id ${e} already exist, use updateImage instead`);this._validate(e,t)&&(this.images[e]=t)}_validate(t,r){let n=!0;return this._validateStretch(r.stretchX,r.data&&r.data.width)||(this.fire(new e.ErrorEvent(new Error(`Image "${t}" has invalid "stretchX" value`))),n=!1),this._validateStretch(r.stretchY,r.data&&r.data.height)||(this.fire(new e.ErrorEvent(new Error(`Image "${t}" has invalid "stretchY" value`))),n=!1),this._validateContent(r.content,r)||(this.fire(new e.ErrorEvent(new Error(`Image "${t}" has invalid "content" value`))),n=!1),n}_validateStretch(e,t){if(!e)return!0;let r=0;for(const n of e){if(n[0]<r||n[1]<n[0]||t<n[1])return!1;r=n[1]}return!0}_validateContent(e,t){return!(e&&(4!==e.length||e[0]<0||t.data.width<e[0]||e[1]<0||t.data.height<e[1]||e[2]<0||t.data.width<e[2]||e[3]<0||t.data.height<e[3]||e[2]<e[0]||e[3]<e[1]))}updateImage(e,t){const r=this.images[e];if(r.data.width!==t.data.width||r.data.height!==t.data.height)throw new Error(`size mismatch between old image (${r.data.width}x${r.data.height}) and new image (${t.data.width}x${t.data.height}).`);t.version=r.version+1,this.images[e]=t,this.updatedImages[e]=!0}removeImage(e){const t=this.images[e];delete this.images[e],delete this.patterns[e],t.userImage&&t.userImage.onRemove&&t.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(e,t){let r=!0;if(!this.isLoaded())for(const t of e)this.images[t]||(r=!1);this.isLoaded()||r?this._notify(e,t):this.requestors.push({ids:e,callback:t})}_notify(t,r){const n={};for(const r of t){this.images[r]||this.fire(new e.Event("styleimagemissing",{id:r}));const t=this.images[r];t?n[r]={data:t.data.clone(),pixelRatio:t.pixelRatio,sdf:t.sdf,version:t.version,stretchX:t.stretchX,stretchY:t.stretchY,content:t.content,hasRenderCallback:Boolean(t.userImage&&t.userImage.render)}:e.warnOnce(`Image "${r}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}r(null,n)}getPixelSize(){const{width:e,height:t}=this.atlasImage;return{width:e,height:t}}getPattern(t){const r=this.patterns[t],n=this.getImage(t);if(!n)return null;if(r&&r.position.version===n.version)return r.position;if(r)r.position.version=n.version;else{const r={w:n.data.width+2,h:n.data.height+2,x:0,y:0},i=new e.ImagePosition(r,n);this.patterns[t]={bin:r,position:i}}return this._updatePatternAtlas(),this.patterns[t].position}bind(e){const t=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new a(e,this.atlasImage,t.RGBA),this.atlasTexture.bind(t.LINEAR,t.CLAMP_TO_EDGE)}_updatePatternAtlas(){const t=[];for(const e in this.patterns)t.push(this.patterns[e].bin);const{w:r,h:n}=e.potpack(t),i=this.atlasImage;i.resize({width:r||1,height:n||1});for(const t in this.patterns){const{bin:r}=this.patterns[t],n=r.x+1,A=r.y+1,o=this.images[t].data,s=o.width,a=o.height;e.RGBAImage.copy(o,i,{x:0,y:0},{x:n,y:A},{width:s,height:a}),e.RGBAImage.copy(o,i,{x:0,y:a-1},{x:n,y:A-1},{width:s,height:1}),e.RGBAImage.copy(o,i,{x:0,y:0},{x:n,y:A+a},{width:s,height:1}),e.RGBAImage.copy(o,i,{x:s-1,y:0},{x:n-1,y:A},{width:1,height:a}),e.RGBAImage.copy(o,i,{x:0,y:0},{x:n+s,y:A},{width:1,height:a})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(t){for(const r of t){if(this.callbackDispatchedThisFrame[r])continue;this.callbackDispatchedThisFrame[r]=!0;const t=this.images[r];t||e.warnOnce(`Image with ID: "${r}" was not found`),l(t)&&this.updateImage(r,t)}}}const u=1e20;function h(e,t,r,n,i,A,o,s,a){for(let l=t;l<t+n;l++)d(e,r*A+l,A,i,o,s,a);for(let l=r;l<r+i;l++)d(e,l*A+t,1,n,o,s,a)}function d(e,t,r,n,i,A,o){A[0]=0,o[0]=-u,o[1]=u,i[0]=e[t];for(let s=1,a=0,l=0;s<n;s++){i[s]=e[t+s*r];const n=s*s;do{const e=A[a];l=(i[s]-i[e]+n-e*e)/(s-e)/2}while(l<=o[a]&&--a>-1);a++,A[a]=s,o[a]=l,o[a+1]=u}for(let s=0,a=0;s<n;s++){for(;o[a+1]<s;)a++;const n=A[a],l=s-n;e[t+s*r]=i[n]+l*l}}class p{constructor(e,t){this.requestManager=e,this.localIdeographFontFamily=t,this.entries={}}setURL(e){this.url=e}getGlyphs(t,r){const n=[];for(const e in t)for(const r of t[e])n.push({stack:e,id:r});e.asyncAll(n,(({stack:e,id:t},r)=>{let n=this.entries[e];n||(n=this.entries[e]={glyphs:{},requests:{},ranges:{}});let i=n.glyphs[t];if(void 0!==i)return void r(null,{stack:e,id:t,glyph:i});if(i=this._tinySDF(n,e,t),i)return n.glyphs[t]=i,void r(null,{stack:e,id:t,glyph:i});const A=Math.floor(t/256);if(256*A>65535)return void r(new Error("glyphs > 65535 not supported"));if(n.ranges[A])return void r(null,{stack:e,id:t,glyph:i});let o=n.requests[A];o||(o=n.requests[A]=[],p.loadGlyphRange(e,A,this.url,this.requestManager,((e,t)=>{if(t){for(const e in t)this._doesCharSupportLocalGlyph(+e)||(n.glyphs[+e]=t[+e]);n.ranges[A]=!0}for(const r of o)r(e,t);delete n.requests[A]}))),o.push(((n,i)=>{n?r(n):i&&r(null,{stack:e,id:t,glyph:i[t]||null})}))}),((e,t)=>{if(e)r(e);else if(t){const e={};for(const{stack:r,id:n,glyph:i}of t)(e[r]||(e[r]={}))[n]=i&&{id:i.id,bitmap:i.bitmap.clone(),metrics:i.metrics};r(null,e)}}))}_doesCharSupportLocalGlyph(t){return!!this.localIdeographFontFamily&&(e.unicodeBlockLookup["CJK Unified Ideographs"](t)||e.unicodeBlockLookup["Hangul Syllables"](t)||e.unicodeBlockLookup.Hiragana(t)||e.unicodeBlockLookup.Katakana(t))}_tinySDF(t,r,n){const i=this.localIdeographFontFamily;if(!i)return;if(!this._doesCharSupportLocalGlyph(n))return;let A=t.tinySDF;if(!A){let e="400";/bold/i.test(r)?e="900":/medium/i.test(r)?e="500":/light/i.test(r)&&(e="200"),A=t.tinySDF=new p.TinySDF({fontSize:24,buffer:3,radius:8,cutoff:.25,fontFamily:i,fontWeight:e})}const o=A.draw(String.fromCharCode(n));return{id:n,bitmap:new e.AlphaImage({width:o.width||30,height:o.height||30},o.data),metrics:{width:o.glyphWidth||24,height:o.glyphHeight||24,left:o.glyphLeft||0,top:o.glyphTop-27||-8,advance:o.glyphAdvance||24}}}}p.loadGlyphRange=function(t,r,n,i,A){const o=256*r,s=o+255,a=i.transformRequest(n.replace("{fontstack}",t).replace("{range}",`${o}-${s}`),e.ResourceType.Glyphs);e.getArrayBuffer(a,((t,r)=>{if(t)A(t);else if(r){const t={};for(const n of e.parseGlyphPbf(r))t[n.id]=n;A(null,t)}}))},p.TinySDF=class{constructor({fontSize:e=24,buffer:t=3,radius:r=8,cutoff:n=.25,fontFamily:i="sans-serif",fontWeight:A="normal",fontStyle:o="normal"}={}){this.buffer=t,this.cutoff=n,this.radius=r;const s=this.size=e+4*t,a=this._createCanvas(s),l=this.ctx=a.getContext("2d",{willReadFrequently:!0});l.font=`${o} ${A} ${e}px ${i}`,l.textBaseline="alphabetic",l.textAlign="left",l.fillStyle="black",this.gridOuter=new Float64Array(s*s),this.gridInner=new Float64Array(s*s),this.f=new Float64Array(s),this.z=new Float64Array(s+1),this.v=new Uint16Array(s)}_createCanvas(e){const t=document.createElement("canvas");return t.width=t.height=e,t}draw(e){const{width:t,actualBoundingBoxAscent:r,actualBoundingBoxDescent:n,actualBoundingBoxLeft:i,actualBoundingBoxRight:A}=this.ctx.measureText(e),o=Math.ceil(r),s=Math.min(this.size-this.buffer,Math.ceil(A-i)),a=Math.min(this.size-this.buffer,o+Math.ceil(n)),l=s+2*this.buffer,c=a+2*this.buffer,d=Math.max(l*c,0),p=new Uint8ClampedArray(d),f={data:p,width:l,height:c,glyphWidth:s,glyphHeight:a,glyphTop:o,glyphLeft:0,glyphAdvance:t};if(0===s||0===a)return f;const{ctx:m,buffer:g,gridInner:y,gridOuter:_}=this;m.clearRect(g,g,s,a),m.fillText(e,g,g+o);const w=m.getImageData(g,g,s,a);_.fill(u,0,d),y.fill(0,0,d);for(let e=0;e<a;e++)for(let t=0;t<s;t++){const r=w.data[4*(e*s+t)+3]/255;if(0===r)continue;const n=(e+g)*l+t+g;if(1===r)_[n]=0,y[n]=u;else{const e=.5-r;_[n]=e>0?e*e:0,y[n]=e<0?e*e:0}}h(_,0,0,l,c,l,this.f,this.v,this.z),h(y,g,g,s,a,l,this.f,this.v,this.z);for(let e=0;e<d;e++){const t=Math.sqrt(_[e])-Math.sqrt(y[e]);p[e]=Math.round(255-255*(t/this.radius+this.cutoff))}return f}};const f=new e.Properties({anchor:new e.DataConstantProperty(e.spec.light.anchor),position:new class{constructor(){this.specification=e.spec.light.position}possiblyEvaluate(t,r){return e.sphericalToCartesian(t.expression.evaluate(r))}interpolate(t,r,n){return{x:e.number(t.x,r.x,n),y:e.number(t.y,r.y,n),z:e.number(t.z,r.z,n)}}},color:new e.DataConstantProperty(e.spec.light.color),intensity:new e.DataConstantProperty(e.spec.light.intensity)}),m="-transition";class g extends e.Evented{constructor(t){super(),this._transitionable=new e.Transitionable(f),this.setLight(t),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(t,r={}){if(!this._validate(e.validateLight,t,r))for(const e in t){const r=t[e];e.endsWith(m)?this._transitionable.setTransition(e.slice(0,-m.length),r):this._transitionable.setValue(e,r)}}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(t,r,n){return(!n||!1!==n.validate)&&e.emitValidationErrors(this,t.call(e.validateStyle,e.extend({value:r,style:{glyphs:!0,sprite:!0},styleSpec:e.spec})))}}class y{constructor(e,t){this.width=e,this.height=t,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(e,t){const r=e.join(",")+String(t);return this.dashEntry[r]||(this.dashEntry[r]=this.addDash(e,t)),this.dashEntry[r]}getDashRanges(e,t,r){const n=[];let i=e.length%2==1?-e[e.length-1]*r:0,A=e[0]*r,o=!0;n.push({left:i,right:A,isDash:o,zeroLength:0===e[0]});let s=e[0];for(let t=1;t<e.length;t++){o=!o;const a=e[t];i=s*r,s+=a,A=s*r,n.push({left:i,right:A,isDash:o,zeroLength:0===a})}return n}addRoundDash(e,t,r){const n=t/2;for(let t=-r;t<=r;t++){const i=this.width*(this.nextRow+r+t);let A=0,o=e[A];for(let s=0;s<this.width;s++){s/o.right>1&&(o=e[++A]);const a=Math.abs(s-o.left),l=Math.abs(s-o.right),c=Math.min(a,l);let u;const h=t/r*(n+1);if(o.isDash){const e=n-Math.abs(h);u=Math.sqrt(c*c+e*e)}else u=n-Math.sqrt(c*c+h*h);this.data[i+s]=Math.max(0,Math.min(255,u+128))}}}addRegularDash(e){for(let t=e.length-1;t>=0;--t){const r=e[t],n=e[t+1];r.zeroLength?e.splice(t,1):n&&n.isDash===r.isDash&&(n.left=r.left,e.splice(t,1))}const t=e[0],r=e[e.length-1];t.isDash===r.isDash&&(t.left=r.left-this.width,r.right=t.right+this.width);const n=this.width*this.nextRow;let i=0,A=e[i];for(let t=0;t<this.width;t++){t/A.right>1&&(A=e[++i]);const r=Math.abs(t-A.left),o=Math.abs(t-A.right),s=Math.min(r,o);this.data[n+t]=Math.max(0,Math.min(255,(A.isDash?s:-s)+128))}}addDash(t,r){const n=r?7:0,i=2*n+1;if(this.nextRow+i>this.height)return e.warnOnce("LineAtlas out of space"),null;let A=0;for(let e=0;e<t.length;e++)A+=t[e];if(0!==A){const e=this.width/A,i=this.getDashRanges(t,this.width,e);r?this.addRoundDash(i,e,n):this.addRegularDash(i)}const o={y:(this.nextRow+n+.5)/this.height,height:2*n/this.height,width:A};return this.nextRow+=i,this.dirty=!0,o}bind(e){const t=e.gl;this.texture?(t.bindTexture(t.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,t.texSubImage2D(t.TEXTURE_2D,0,0,0,this.width,this.height,t.ALPHA,t.UNSIGNED_BYTE,this.data))):(this.texture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texImage2D(t.TEXTURE_2D,0,t.ALPHA,this.width,this.height,0,t.ALPHA,t.UNSIGNED_BYTE,this.data))}}class _{constructor(t,r){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=e.uniqueId();const n=this.workerPool.acquire(this.id);for(let e=0;e<n.length;e++){const t=new _.Actor(n[e],r,this.id);t.name=`Worker ${e}`,this.actors.push(t)}if(!this.actors.length)throw new Error("No actors found")}broadcast(t,r,n){e.asyncAll(this.actors,((e,n)=>{e.send(t,r,n)}),n=n||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach((e=>{e.remove()})),this.actors=[],this.workerPool.release(this.id)}}function w(t,r,n){const i=function(r,i){if(r)return n(r);if(i){const r=e.pick(e.extend(i,t),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);i.vector_layers&&(r.vectorLayers=i.vector_layers,r.vectorLayerIds=r.vectorLayers.map((e=>e.id))),n(null,r)}};return t.url?e.getJSON(r.transformRequest(t.url,e.ResourceType.Source),i):e.exported.frame((()=>i(null,t)))}_.Actor=e.Actor;class x{constructor(t,r,n){this.bounds=e.LngLatBounds.convert(this.validateBounds(t)),this.minzoom=r||0,this.maxzoom=n||24}validateBounds(e){return Array.isArray(e)&&4===e.length?[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]:[-180,-90,180,90]}contains(t){const r=Math.pow(2,t.z),n=Math.floor(e.mercatorXfromLng(this.bounds.getWest())*r),i=Math.floor(e.mercatorYfromLat(this.bounds.getNorth())*r),A=Math.ceil(e.mercatorXfromLng(this.bounds.getEast())*r),o=Math.ceil(e.mercatorYfromLat(this.bounds.getSouth())*r);return t.x>=n&&t.x<A&&t.y>=i&&t.y<o}}class B extends e.Evented{constructor(t,r,n,i){if(super(),this.id=t,this.dispatcher=n,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,e.extend(this,e.pick(r,["url","scheme","tileSize","promoteId"])),this._options=e.extend({type:"vector"},r),this._collectResourceTiming=r.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(i)}load(){this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=w(this._options,this.map._requestManager,((t,r)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),t?this.fire(new e.ErrorEvent(t)):r&&(e.extend(this,r),r.bounds&&(this.tileBounds=new x(r.bounds,this.minzoom,this.maxzoom)),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})))}))}loaded(){return this._loaded}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}onAdd(e){this.map=e,this.load()}setSourceProperty(e){this._tileJSONRequest&&this._tileJSONRequest.cancel(),e(),this.load()}setTiles(e){return this.setSourceProperty((()=>{this._options.tiles=e})),this}setUrl(e){return this.setSourceProperty((()=>{this.url=e,this._options.url=e})),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return e.extend({},this._options)}loadTile(t,r){const n=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),i={request:this.map._requestManager.transformRequest(n,e.ResourceType.Tile),uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function A(n,i){return delete t.request,t.aborted?r(null):n&&404!==n.status?r(n):(i&&i.resourceTiming&&(t.resourceTiming=i.resourceTiming),this.map._refreshExpiredTiles&&i&&t.setExpiryData(i),t.loadVectorData(i,this.map.painter),e.cacheEntryPossiblyAdded(this.dispatcher),r(null),void(t.reloadCallback&&(this.loadTile(t,t.reloadCallback),t.reloadCallback=null)))}i.request.collectResourceTiming=this._collectResourceTiming,t.actor&&"expired"!==t.state?"loading"===t.state?t.reloadCallback=r:t.request=t.actor.send("reloadTile",i,A.bind(this)):(t.actor=this.dispatcher.getActor(),t.request=t.actor.send("loadTile",i,A.bind(this)))}abortTile(e){e.request&&(e.request.cancel(),delete e.request),e.actor&&e.actor.send("abortTile",{uid:e.uid,type:this.type,source:this.id},void 0)}unloadTile(e){e.unloadVectorData(),e.actor&&e.actor.send("removeTile",{uid:e.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class v extends e.Evented{constructor(t,r,n,i){super(),this.id=t,this.dispatcher=n,this.setEventedParent(i),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=e.extend({type:"raster"},r),e.extend(this,e.pick(r,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=w(this._options,this.map._requestManager,((t,r)=>{this._tileJSONRequest=null,this._loaded=!0,t?this.fire(new e.ErrorEvent(t)):r&&(e.extend(this,r),r.bounds&&(this.tileBounds=new x(r.bounds,this.minzoom,this.maxzoom)),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})))}))}loaded(){return this._loaded}onAdd(e){this.map=e,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return e.extend({},this._options)}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}loadTile(t,r){const n=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);t.request=e.getImage(this.map._requestManager.transformRequest(n,e.ResourceType.Tile),((n,i,A)=>{if(delete t.request,t.aborted)t.state="unloaded",r(null);else if(n)t.state="errored",r(n);else if(i){this.map._refreshExpiredTiles&&t.setExpiryData(A);const n=this.map.painter.context,o=n.gl;t.texture=this.map.painter.getTileTexture(i.width),t.texture?t.texture.update(i,{useMipmap:!0}):(t.texture=new a(n,i,o.RGBA,{useMipmap:!0}),t.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE,o.LINEAR_MIPMAP_NEAREST),n.extTextureFilterAnisotropic&&o.texParameterf(o.TEXTURE_2D,n.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,n.extTextureFilterAnisotropicMax)),t.state="loaded",e.cacheEntryPossiblyAdded(this.dispatcher),r(null)}}))}abortTile(e,t){e.request&&(e.request.cancel(),delete e.request),t()}unloadTile(e,t){e.texture&&this.map.painter.saveTileTexture(e.texture),t()}hasTransition(){return!1}}let b;class C extends v{constructor(t,r,n,i){super(t,r,n,i),this.type="raster-dem",this.maxzoom=22,this._options=e.extend({type:"raster-dem"},r),this.encoding=r.encoding||"mapbox"}serialize(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}}loadTile(t,r){const n=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);function i(e,n){e&&(t.state="errored",r(e)),n&&(t.dem=n,t.needsHillshadePrepare=!0,t.needsTerrainPrepare=!0,t.state="loaded",r(null))}t.request=e.getImage(this.map._requestManager.transformRequest(n,e.ResourceType.Tile),function(n,A){if(delete t.request,t.aborted)t.state="unloaded",r(null);else if(n)t.state="errored",r(n);else if(A){this.map._refreshExpiredTiles&&t.setExpiryData(A),delete A.cacheControl,delete A.expires;const r=e.isImageBitmap(A)&&(null==b&&(b="undefined"!=typeof OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof createImageBitmap),b)?A:e.exported.getImageData(A,1),n={uid:t.uid,coord:t.tileID,source:this.id,rawImageData:r,encoding:this.encoding};t.actor&&"expired"!==t.state||(t.actor=this.dispatcher.getActor(),t.actor.send("loadDEMTile",n,i.bind(this)))}}.bind(this)),t.neighboringTiles=this._getNeighboringTiles(t.tileID)}_getNeighboringTiles(t){const r=t.canonical,n=Math.pow(2,r.z),i=(r.x-1+n)%n,A=0===r.x?t.wrap-1:t.wrap,o=(r.x+1+n)%n,s=r.x+1===n?t.wrap+1:t.wrap,a={};return a[new e.OverscaledTileID(t.overscaledZ,A,r.z,i,r.y).key]={backfilled:!1},a[new e.OverscaledTileID(t.overscaledZ,s,r.z,o,r.y).key]={backfilled:!1},r.y>0&&(a[new e.OverscaledTileID(t.overscaledZ,A,r.z,i,r.y-1).key]={backfilled:!1},a[new e.OverscaledTileID(t.overscaledZ,t.wrap,r.z,r.x,r.y-1).key]={backfilled:!1},a[new e.OverscaledTileID(t.overscaledZ,s,r.z,o,r.y-1).key]={backfilled:!1}),r.y+1<n&&(a[new e.OverscaledTileID(t.overscaledZ,A,r.z,i,r.y+1).key]={backfilled:!1},a[new e.OverscaledTileID(t.overscaledZ,t.wrap,r.z,r.x,r.y+1).key]={backfilled:!1},a[new e.OverscaledTileID(t.overscaledZ,s,r.z,o,r.y+1).key]={backfilled:!1}),a}unloadTile(e){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded",e.actor&&e.actor.send("removeDEMTile",{uid:e.uid,source:this.id})}}class F extends e.Evented{constructor(t,r,n,i){super(),this.id=t,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=n.getActor(),this.setEventedParent(i),this._data=r.data,this._options=e.extend({},r),this._collectResourceTiming=r.collectResourceTiming,void 0!==r.maxzoom&&(this.maxzoom=r.maxzoom),r.type&&(this.type=r.type),r.attribution&&(this.attribution=r.attribution),this.promoteId=r.promoteId;const A=e.EXTENT/this.tileSize;this.workerOptions=e.extend({source:this.id,cluster:r.cluster||!1,geojsonVtOptions:{buffer:(void 0!==r.buffer?r.buffer:128)*A,tolerance:(void 0!==r.tolerance?r.tolerance:.375)*A,extent:e.EXTENT,maxZoom:this.maxzoom,lineMetrics:r.lineMetrics||!1,generateId:r.generateId||!1},superclusterOptions:{maxZoom:void 0!==r.clusterMaxZoom?r.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,r.clusterMinPoints||2),extent:e.EXTENT,radius:(r.clusterRadius||50)*A,log:!1,generateId:r.generateId||!1},clusterProperties:r.clusterProperties,filter:r.filter},r.workerOptions)}load(){this._updateWorkerData("metadata")}onAdd(e){this.map=e,this.load()}setData(e){return this._data=e,this._updateWorkerData("content"),this}getClusterExpansionZoom(e,t){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:e,source:this.id},t),this}getClusterChildren(e,t){return this.actor.send("geojson.getClusterChildren",{clusterId:e,source:this.id},t),this}getClusterLeaves(e,t,r,n){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:e,limit:t,offset:r},n),this}_updateWorkerData(t){const r=e.extend({},this.workerOptions),n=this._data;"string"==typeof n?(r.request=this.map._requestManager.transformRequest(e.exported.resolveURL(n),e.ResourceType.Source),r.request.collectResourceTiming=this._collectResourceTiming):r.data=JSON.stringify(n),this._pendingLoads++,this.fire(new e.Event("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,r,((r,n)=>{if(this._pendingLoads--,this._removed||n&&n.abandoned)return void this.fire(new e.Event("dataabort",{dataType:"source",sourceDataType:t}));let i=null;if(n&&n.resourceTiming&&n.resourceTiming[this.id]&&(i=n.resourceTiming[this.id].slice(0)),r)return void this.fire(new e.ErrorEvent(r));const A={dataType:"source",sourceDataType:t};this._collectResourceTiming&&i&&i.length>0&&e.extend(A,{resourceTiming:i}),this.fire(new e.Event("data",A))}))}loaded(){return 0===this._pendingLoads}loadTile(e,t){const r=e.actor?"reloadTile":"loadTile";e.actor=this.actor;const n={type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};e.request=this.actor.send(r,n,((n,i)=>(delete e.request,e.unloadVectorData(),e.aborted?t(null):n?t(n):(e.loadVectorData(i,this.map.painter,"reloadTile"===r),t(null)))))}abortTile(e){e.request&&(e.request.cancel(),delete e.request),e.aborted=!0}unloadTile(e){e.unloadVectorData(),this.actor.send("removeTile",{uid:e.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}serialize(){return e.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var E=e.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class U extends e.Evented{constructor(e,t,r,n){super(),this.id=e,this.dispatcher=r,this.coordinates=t.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(n),this.options=t}load(t,r){this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this.url=this.options.url,e.getImage(this.map._requestManager.transformRequest(this.url,e.ResourceType.Image),((n,i)=>{this._loaded=!0,n?this.fire(new e.ErrorEvent(n)):i&&(this.image=i,t&&(this.coordinates=t),r&&r(),this._finishLoading())}))}loaded(){return this._loaded}updateImage(e){return this.image&&e.url?(this.options.url=e.url,this.load(e.coordinates,(()=>{this.texture=null})),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}setCoordinates(t){this.coordinates=t;const r=t.map(e.MercatorCoordinate.fromLngLat);this.tileID=function(t){let r=1/0,n=1/0,i=-1/0,A=-1/0;for(const e of t)r=Math.min(r,e.x),n=Math.min(n,e.y),i=Math.max(i,e.x),A=Math.max(A,e.y);const o=Math.max(i-r,A-n),s=Math.max(0,Math.floor(-Math.log(o)/Math.LN2)),a=Math.pow(2,s);return new e.CanonicalTileID(s,Math.floor((r+i)/2*a),Math.floor((n+A)/2*a))}(r),this.minzoom=this.maxzoom=this.tileID.z;const n=r.map((e=>this.tileID.getTilePoint(e)._round()));return this._boundsArray=new e.RasterBoundsArray,this._boundsArray.emplaceBack(n[0].x,n[0].y,0,0),this._boundsArray.emplaceBack(n[1].x,n[1].y,e.EXTENT,0),this._boundsArray.emplaceBack(n[3].x,n[3].y,0,e.EXTENT),this._boundsArray.emplaceBack(n[2].x,n[2].y,e.EXTENT,e.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(0===Object.keys(this.tiles).length||!this.image)return;const t=this.map.painter.context,r=t.gl;this.boundsBuffer||(this.boundsBuffer=t.createVertexBuffer(this._boundsArray,E.members)),this.boundsSegments||(this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new a(t,this.image,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE));for(const e in this.tiles){const t=this.tiles[e];"loaded"!==t.state&&(t.state="loaded",t.texture=this.texture)}}loadTile(e,t){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={},t(null)):(e.state="errored",t(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class Q extends U{constructor(e,t,r,n){super(e,t,r,n),this.roundZoom=!0,this.type="video",this.options=t}load(){this._loaded=!1;const t=this.options;this.urls=[];for(const r of t.urls)this.urls.push(this.map._requestManager.transformRequest(r,e.ResourceType.Source).url);e.getVideo(this.urls,((t,r)=>{this._loaded=!0,t?this.fire(new e.ErrorEvent(t)):r&&(this.video=r,this.video.loop=!0,this.video.addEventListener("playing",(()=>{this.map.triggerRepaint()})),this.map&&this.video.play(),this._finishLoading())}))}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(t){if(this.video){const r=this.video.seekable;t<r.start(0)||t>r.end(0)?this.fire(new e.ErrorEvent(new e.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${r.start(0)} and ${r.end(0)}-second mark.`))):this.video.currentTime=t}}getVideo(){return this.video}onAdd(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const t=this.map.painter.context,r=t.gl;this.boundsBuffer||(this.boundsBuffer=t.createVertexBuffer(this._boundsArray,E.members)),this.boundsSegments||(this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),r.texSubImage2D(r.TEXTURE_2D,0,0,0,r.RGBA,r.UNSIGNED_BYTE,this.video)):(this.texture=new a(t,this.video,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE));for(const e in this.tiles){const t=this.tiles[e];"loaded"!==t.state&&(t.state="loaded",t.texture=this.texture)}}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class I extends U{constructor(t,r,n,i){super(t,r,n,i),r.coordinates?Array.isArray(r.coordinates)&&4===r.coordinates.length&&!r.coordinates.some((e=>!Array.isArray(e)||2!==e.length||e.some((e=>"number"!=typeof e))))||this.fire(new e.ErrorEvent(new e.ValidationError(`sources.${t}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new e.ErrorEvent(new e.ValidationError(`sources.${t}`,null,'missing required property "coordinates"'))),r.animate&&"boolean"!=typeof r.animate&&this.fire(new e.ErrorEvent(new e.ValidationError(`sources.${t}`,null,'optional "animate" property must be a boolean value'))),r.canvas?"string"==typeof r.canvas||r.canvas instanceof HTMLCanvasElement||this.fire(new e.ErrorEvent(new e.ValidationError(`sources.${t}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new e.ErrorEvent(new e.ValidationError(`sources.${t}`,null,'missing required property "canvas"'))),this.options=r,this.animate=void 0===r.animate||r.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new e.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let t=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,t=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,t=!0),this._hasInvalidDimensions())return;if(0===Object.keys(this.tiles).length)return;const r=this.map.painter.context,n=r.gl;this.boundsBuffer||(this.boundsBuffer=r.createVertexBuffer(this._boundsArray,E.members)),this.boundsSegments||(this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(t||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new a(r,this.canvas,n.RGBA,{premultiply:!0});for(const e in this.tiles){const t=this.tiles[e];"loaded"!==t.state&&(t.state="loaded",t.texture=this.texture)}}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const e of[this.canvas.width,this.canvas.height])if(isNaN(e)||e<=0)return!0;return!1}}const T={vector:B,raster:v,"raster-dem":C,geojson:F,video:Q,image:U,canvas:I};function S(t,r){const n=e.create();return e.translate(n,n,[1,1,0]),e.scale(n,n,[.5*t.width,.5*t.height,1]),e.multiply(n,n,t.calculatePosMatrix(r.toUnwrapped()))}function M(e,t,r,n,i,A){const o=function(e,t,r){if(e)for(const n of e){const e=t[n];if(e&&e.source===r&&"fill-extrusion"===e.type)return!0}else for(const e in t){const n=t[e];if(n.source===r&&"fill-extrusion"===n.type)return!0}return!1}(i&&i.layers,t,e.id),s=A.maxPitchScaleFactor(),a=e.tilesIn(n,s,o);a.sort(k);const l=[];for(const n of a)l.push({wrappedTileID:n.tileID.wrapped().key,queryResults:n.tile.queryRenderedFeatures(t,r,e._state,n.queryGeometry,n.cameraQueryGeometry,n.scale,i,A,s,S(e.transform,n.tileID))});const c=function(e){const t={},r={};for(const n of e){const e=n.queryResults,i=n.wrappedTileID,A=r[i]=r[i]||{};for(const r in e){const n=e[r],i=A[r]=A[r]||{},o=t[r]=t[r]||[];for(const e of n)i[e.featureIndex]||(i[e.featureIndex]=!0,o.push(e))}}return t}(l);for(const t in c)c[t].forEach((t=>{const r=t.feature,n=e.getFeatureState(r.layer["source-layer"],r.id);r.source=r.layer.source,r.layer["source-layer"]&&(r.sourceLayer=r.layer["source-layer"]),r.state=n}));return c}function k(e,t){const r=e.tileID,n=t.tileID;return r.overscaledZ-n.overscaledZ||r.canonical.y-n.canonical.y||r.wrap-n.wrap||r.canonical.x-n.canonical.x}class D{constructor(t,r){this.tileID=t,this.uid=e.uniqueId(),this.uses=0,this.tileSize=r,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.textures=[],this.textureCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(t){const r=t+this.timeAdded;r<e.exported.now()||this.fadeEndTime&&r<this.fadeEndTime||(this.fadeEndTime=r)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}clearTextures(e){this.demTexture&&e.saveTileTexture(this.demTexture),this.textures.forEach((t=>e.saveTileTexture(t))),this.demTexture=null,this.textures=[],this.textureCoords={}}loadVectorData(t,r,n){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(e,t){const r={};if(!t)return r;for(const n of e){const e=n.layerIds.map((e=>t.getLayer(e))).filter(Boolean);if(0!==e.length){n.layers=e,n.stateDependentLayerIds&&(n.stateDependentLayers=n.stateDependentLayerIds.map((t=>e.filter((e=>e.id===t))[0])));for(const t of e)r[t.id]=n}}return r}(t.buckets,r.style),this.hasSymbolBuckets=!1;for(const t in this.buckets){const r=this.buckets[t];if(r instanceof e.SymbolBucket){if(this.hasSymbolBuckets=!0,!n)break;r.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const t in this.buckets){const r=this.buckets[t];if(r instanceof e.SymbolBucket&&r.hasRTLText){this.hasRTLText=!0,e.lazyLoadRTLTextPlugin();break}}this.queryPadding=0;for(const e in this.buckets){const t=this.buckets[e];this.queryPadding=Math.max(this.queryPadding,r.style.getLayer(e).queryRadius(t))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage)}else this.collisionBoxArray=new e.CollisionBoxArray}unloadVectorData(){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(e){return this.buckets[e.id]}upload(e){for(const t in this.buckets){const r=this.buckets[t];r.uploadPending()&&r.upload(e)}const t=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new a(e,this.imageAtlas.image,t.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new a(e,this.glyphAtlasImage,t.ALPHA),this.glyphAtlasImage=null)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,t,r,n,i,A,o,s,a,l){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:n,cameraQueryGeometry:i,scale:A,tileSize:this.tileSize,pixelPosMatrix:l,transform:s,params:o,queryPadding:this.queryPadding*a},e,t,r):{}}querySourceFeatures(t,r){const n=this.latestFeatureIndex;if(!n||!n.rawTileData)return;const i=n.loadVTLayers(),A=r?r.sourceLayer:"",o=i._geojsonTileLayer||i[A];if(!o)return;const s=e.createFilter(r&&r.filter),{z:a,x:l,y:c}=this.tileID.canonical,u={z:a,x:l,y:c};for(let r=0;r<o.length;r++){const i=o.feature(r);if(s.needGeometry){const t=e.toEvaluationFeature(i,!0);if(!s.filter(new e.EvaluationParameters(this.tileID.overscaledZ),t,this.tileID.canonical))continue}else if(!s.filter(new e.EvaluationParameters(this.tileID.overscaledZ),i))continue;const h=n.getId(i,A),d=new e.GeoJSONFeature(i,a,l,c,h);d.tile=u,t.push(d)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){const r=this.expirationTime;if(t.cacheControl){const r=e.parseCacheControl(t.cacheControl);r["max-age"]&&(this.expirationTime=Date.now()+1e3*r["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const e=Date.now();let t=!1;if(this.expirationTime>e)t=!1;else if(r)if(this.expirationTime<r)t=!0;else{const n=this.expirationTime-r;n?this.expirationTime=e+Math.max(n,3e4):t=!0}else t=!0;t?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(e,t){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(e).length)return;const r=this.latestFeatureIndex.loadVTLayers();for(const n in this.buckets){if(!t.style.hasLayer(n))continue;const i=this.buckets[n],A=i.layers[0].sourceLayer||"_geojsonTileLayer",o=r[A],s=e[A];if(!o||!s||0===Object.keys(s).length)continue;i.update(s,o,this.imageAtlas&&this.imageAtlas.patternPositions||{});const a=t&&t.style&&t.style.getLayer(n);a&&(this.queryPadding=Math.max(this.queryPadding,a.queryRadius(i)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<e.exported.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(t){this.symbolFadeHoldUntil=e.exported.now()+t}setDependencies(e,t){const r={};for(const e of t)r[e]=!0;this.dependencies[e]=r}hasDependency(e,t){for(const r of e){const e=this.dependencies[r];if(e)for(const r of t)if(e[r])return!0}return!1}}class L{constructor(e,t){this.max=e,this.onRemove=t,this.reset()}reset(){for(const e in this.data)for(const t of this.data[e])t.timeout&&clearTimeout(t.timeout),this.onRemove(t.value);return this.data={},this.order=[],this}add(e,t,r){const n=e.wrapped().key;void 0===this.data[n]&&(this.data[n]=[]);const i={value:t,timeout:void 0};if(void 0!==r&&(i.timeout=setTimeout((()=>{this.remove(e,i)}),r)),this.data[n].push(i),this.order.push(n),this.order.length>this.max){const e=this._getAndRemoveByKey(this.order[0]);e&&this.onRemove(e)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const t=this.data[e].shift();return t.timeout&&clearTimeout(t.timeout),0===this.data[e].length&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),t.value}getByKey(e){const t=this.data[e];return t?t[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,t){if(!this.has(e))return this;const r=e.wrapped().key,n=void 0===t?0:this.data[r].indexOf(t),i=this.data[r][n];return this.data[r].splice(n,1),i.timeout&&clearTimeout(i.timeout),0===this.data[r].length&&delete this.data[r],this.onRemove(i.value),this.order.splice(this.order.indexOf(r),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const e=this._getAndRemoveByKey(this.order[0]);e&&this.onRemove(e)}return this}filter(e){const t=[];for(const r in this.data)for(const n of this.data[r])e(n.value)||t.push(n);for(const e of t)this.remove(e.value.tileID,e)}}class P{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,r,n){const i=String(r);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][i]=this.stateChanges[t][i]||{},e.extend(this.stateChanges[t][i],n),null===this.deletedStates[t]){this.deletedStates[t]={};for(const e in this.state[t])e!==i&&(this.deletedStates[t][e]=null)}else if(this.deletedStates[t]&&null===this.deletedStates[t][i]){this.deletedStates[t][i]={};for(const e in this.state[t][i])n[e]||(this.deletedStates[t][i][e]=null)}else for(const e in n)this.deletedStates[t]&&this.deletedStates[t][i]&&null===this.deletedStates[t][i][e]&&delete this.deletedStates[t][i][e]}removeFeatureState(e,t,r){if(null===this.deletedStates[e])return;const n=String(t);if(this.deletedStates[e]=this.deletedStates[e]||{},r&&void 0!==t)null!==this.deletedStates[e][n]&&(this.deletedStates[e][n]=this.deletedStates[e][n]||{},this.deletedStates[e][n][r]=null);else if(void 0!==t)if(this.stateChanges[e]&&this.stateChanges[e][n])for(r in this.deletedStates[e][n]={},this.stateChanges[e][n])this.deletedStates[e][n][r]=null;else this.deletedStates[e][n]=null;else this.deletedStates[e]=null}getState(t,r){const n=String(r),i=e.extend({},(this.state[t]||{})[n],(this.stateChanges[t]||{})[n]);if(null===this.deletedStates[t])return{};if(this.deletedStates[t]){const e=this.deletedStates[t][r];if(null===e)return{};for(const t in e)delete i[t]}return i}initializeTileState(e,t){e.setFeatureState(this.state,t)}coalesceChanges(t,r){const n={};for(const t in this.stateChanges){this.state[t]=this.state[t]||{};const r={};for(const n in this.stateChanges[t])this.state[t][n]||(this.state[t][n]={}),e.extend(this.state[t][n],this.stateChanges[t][n]),r[n]=this.state[t][n];n[t]=r}for(const t in this.deletedStates){this.state[t]=this.state[t]||{};const r={};if(null===this.deletedStates[t])for(const e in this.state[t])r[e]={},this.state[t][e]={};else for(const e in this.deletedStates[t]){if(null===this.deletedStates[t][e])this.state[t][e]={};else for(const r of Object.keys(this.deletedStates[t][e]))delete this.state[t][e][r];r[e]=this.state[t][e]}n[t]=n[t]||{},e.extend(n[t],r)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(n).length)for(const e in t)t[e].setFeatureState(n,r)}}class H extends e.Evented{constructor(t,r,n){super(),this.id=t,this.dispatcher=n,this.on("data",(e=>{"source"===e.dataType&&"metadata"===e.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===e.dataType&&"content"===e.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform,this.terrain))})),this.on("dataloading",(()=>{this._sourceErrored=!1})),this.on("error",(()=>{this._sourceErrored=this._source.loaded()})),this._source=function(t,r,n,i){const A=new T[r.type](t,r,n,i);if(A.id!==t)throw new Error(`Expected Source id to be ${t} instead of ${A.id}`);return e.bindAll(["load","abort","unload","serialize","prepare"],A),A}(t,r,n,this),this._tiles={},this._cache=new L(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new P}onAdd(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(e)}onRemove(e){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(e)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;if(!this._source.loaded())return!1;for(const e in this._tiles){const t=this._tiles[e];if("loaded"!==t.state&&"errored"!==t.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(e,t){return this._source.loadTile(e,t)}_unloadTile(e){if(this._source.unloadTile)return this._source.unloadTile(e,(()=>{}))}_abortTile(t){this._source.abortTile&&this._source.abortTile(t,(()=>{})),this._source.fire(new e.Event("dataabort",{tile:t,coord:t.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const t in this._tiles){const r=this._tiles[t];r.upload(e),r.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map((e=>e.tileID)).sort(z).map((e=>e.key))}getRenderableIds(t){const r=[];for(const e in this._tiles)this._isIdRenderable(e,t)&&r.push(this._tiles[e]);return t?r.sort(((t,r)=>{const n=t.tileID,i=r.tileID,A=new e.pointGeometry(n.canonical.x,n.canonical.y)._rotate(this.transform.angle),o=new e.pointGeometry(i.canonical.x,i.canonical.y)._rotate(this.transform.angle);return n.overscaledZ-i.overscaledZ||o.y-A.y||o.x-A.x})).map((e=>e.tileID.key)):r.map((e=>e.tileID)).sort(z).map((e=>e.key))}hasRenderableParent(e){const t=this.findLoadedParent(e,0);return!!t&&this._isIdRenderable(t.tileID.key)}_isIdRenderable(e,t){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(t||!this._tiles[e].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const e in this._tiles)"errored"!==this._tiles[e].state&&this._reloadTile(e,"reloading")}}_reloadTile(e,t){const r=this._tiles[e];r&&("loading"!==r.state&&(r.state=t),this._loadTile(r,this._tileLoaded.bind(this,r,e,t)))}_tileLoaded(t,r,n,i){if(i)return t.state="errored",void(404!==i.status?this._source.fire(new e.ErrorEvent(i,{tile:t})):this.update(this.transform,this.terrain));t.timeAdded=e.exported.now(),"expired"===n&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(r,t),"raster-dem"===this.getSource().type&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),t.aborted||this._source.fire(new e.Event("data",{dataType:"source",tile:t,coord:t.tileID}))}_backfillDEM(e){const t=this.getRenderableIds();for(let n=0;n<t.length;n++){const i=t[n];if(e.neighboringTiles&&e.neighboringTiles[i]){const t=this.getTileByID(i);r(e,t),r(t,e)}}function r(e,t){e.needsHillshadePrepare=!0,e.needsTerrainPrepare=!0;let r=t.tileID.canonical.x-e.tileID.canonical.x;const n=t.tileID.canonical.y-e.tileID.canonical.y,i=Math.pow(2,e.tileID.canonical.z),A=t.tileID.key;0===r&&0===n||Math.abs(n)>1||(Math.abs(r)>1&&(1===Math.abs(r+i)?r+=i:1===Math.abs(r-i)&&(r-=i)),t.dem&&e.dem&&(e.dem.backfillBorder(t.dem,r,n),e.neighboringTiles&&e.neighboringTiles[A]&&(e.neighboringTiles[A].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,t,r,n){for(const i in this._tiles){let A=this._tiles[i];if(n[i]||!A.hasData()||A.tileID.overscaledZ<=t||A.tileID.overscaledZ>r)continue;let o=A.tileID;for(;A&&A.tileID.overscaledZ>t+1;){const e=A.tileID.scaledTo(A.tileID.overscaledZ-1);A=this._tiles[e.key],A&&A.hasData()&&(o=e)}let s=o;for(;s.overscaledZ>t;)if(s=s.scaledTo(s.overscaledZ-1),e[s.key]){n[o.key]=o;break}}}findLoadedParent(e,t){if(e.key in this._loadedParentTiles){const r=this._loadedParentTiles[e.key];return r&&r.tileID.overscaledZ>=t?r:null}for(let r=e.overscaledZ-1;r>=t;r--){const t=e.scaledTo(r),n=this._getLoadedTile(t);if(n)return n}}_getLoadedTile(e){const t=this._tiles[e.key];return t&&t.hasData()?t:this._cache.getByKey(e.wrapped().key)}updateCacheSize(e){const t=Math.ceil(e.width/this._source.tileSize)+1,r=Math.ceil(e.height/this._source.tileSize)+1,n=Math.floor(t*r*5),i="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,n):n;this._cache.setMaxSize(i)}handleWrapJump(e){const t=Math.round((e-(void 0===this._prevLng?e:this._prevLng))/360);if(this._prevLng=e,t){const e={};for(const r in this._tiles){const n=this._tiles[r];n.tileID=n.tileID.unwrapTo(n.tileID.wrap+t),e[n.tileID.key]=n}this._tiles=e;for(const e in this._timers)clearTimeout(this._timers[e]),delete this._timers[e];for(const e in this._tiles)this._setTileReloadTimer(e,this._tiles[e])}}update(t,r){if(this.transform=t,this.terrain=r,!this._sourceLoaded||this._paused)return;let n;this.updateCacheSize(t),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?n=t.getVisibleUnwrappedCoordinates(this._source.tileID).map((t=>new e.OverscaledTileID(t.canonical.z,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y))):(n=t.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:r}),this._source.hasTile&&(n=n.filter((e=>this._source.hasTile(e))))):n=[];const i=t.coveringZoomLevel(this._source),A=Math.max(i-H.maxOverzooming,this._source.minzoom),o=Math.max(i+H.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const e={};for(const t of n)if(t.canonical.z>this._source.minzoom){const r=t.scaledTo(t.canonical.z-1);e[r.key]=r;const n=t.scaledTo(Math.max(this._source.minzoom,Math.min(t.canonical.z,5)));e[n.key]=n}n=n.concat(Object.values(e))}const s=this._updateRetainedTiles(n,i);if(R(this._source.type)){const t={},a={},l=Object.keys(s);for(const r of l){const n=s[r],i=this._tiles[r];if(!i||i.fadeEndTime&&i.fadeEndTime<=e.exported.now())continue;const o=this.findLoadedParent(n,A);o&&(this._addTile(o.tileID),t[o.tileID.key]=o.tileID),a[r]=n}this._retainLoadedChildren(a,i,o,s);for(const e in t)s[e]||(this._coveredTiles[e]=!0,s[e]=t[e]);if(r){const e={},t={};for(const r of n)this._tiles[r.key].hasData()?e[r.key]=r:t[r.key]=r;for(const r in t){const n=t[r].children(this._source.maxzoom);this._tiles[n[0].key]&&this._tiles[n[1].key]&&this._tiles[n[2].key]&&this._tiles[n[3].key]&&(e[n[0].key]=s[n[0].key]=n[0],e[n[1].key]=s[n[1].key]=n[1],e[n[2].key]=s[n[2].key]=n[2],e[n[3].key]=s[n[3].key]=n[3],delete t[r])}for(const r in t){const n=this.findLoadedParent(t[r],this._source.minzoom);if(n){e[n.tileID.key]=s[n.tileID.key]=n.tileID;for(const t in e)e[t].isChildOf(n.tileID)&&delete e[t]}}for(const t in this._tiles)e[t]||(this._coveredTiles[t]=!0)}}for(const e in s)this._tiles[e].clearFadeHold();const a=e.keysDifference(this._tiles,s);for(const e of a){const t=this._tiles[e];t.hasSymbolBuckets&&!t.holdingForFade()?t.setHoldDuration(this.map._fadeDuration):t.hasSymbolBuckets&&!t.symbolFadeFinished()||this._removeTile(e)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(e)}_updateRetainedTiles(e,t){const r={},n={},i=Math.max(t-H.maxOverzooming,this._source.minzoom),A=Math.max(t+H.maxUnderzooming,this._source.minzoom),o={};for(const n of e){const e=this._addTile(n);r[n.key]=n,e.hasData()||t<this._source.maxzoom&&(o[n.key]=n)}this._retainLoadedChildren(o,t,A,r);for(const A of e){let e=this._tiles[A.key];if(e.hasData())continue;if(t+1>this._source.maxzoom){const e=A.children(this._source.maxzoom)[0],t=this.getTile(e);if(t&&t.hasData()){r[e.key]=e;continue}}else{const e=A.children(this._source.maxzoom);if(r[e[0].key]&&r[e[1].key]&&r[e[2].key]&&r[e[3].key])continue}let o=e.wasRequested();for(let t=A.overscaledZ-1;t>=i;--t){const i=A.scaledTo(t);if(n[i.key])break;if(n[i.key]=!0,e=this.getTile(i),!e&&o&&(e=this._addTile(i)),e&&(r[i.key]=i,o=e.wasRequested(),e.hasData()))break}}return r}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const t=[];let r,n=this._tiles[e].tileID;for(;n.overscaledZ>0;){if(n.key in this._loadedParentTiles){r=this._loadedParentTiles[n.key];break}t.push(n.key);const e=n.scaledTo(n.overscaledZ-1);if(r=this._getLoadedTile(e),r)break;n=e}for(const e of t)this._loadedParentTiles[e]=r}}_addTile(t){let r=this._tiles[t.key];if(r)return r;r=this._cache.getAndRemove(t),r&&(this._setTileReloadTimer(t.key,r),r.tileID=t,this._state.initializeTileState(r,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,r)));const n=r;return r||(r=new D(t,this._source.tileSize*t.overscaleFactor()),this._loadTile(r,this._tileLoaded.bind(this,r,t.key,r.state))),r.uses++,this._tiles[t.key]=r,n||this._source.fire(new e.Event("dataloading",{tile:r,coord:r.tileID,dataType:"source"})),r}_setTileReloadTimer(e,t){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const r=t.getExpiryTimeout();r&&(this._timers[e]=setTimeout((()=>{this._reloadTile(e,"expired"),delete this._timers[e]}),r))}_removeTile(e){const t=this._tiles[e];t&&(t.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),t.uses>0||(t.hasData()&&"reloading"!==t.state?this._cache.add(t.tileID,t,t.getExpiryTimeout()):(t.aborted=!0,this._abortTile(t),this._unloadTile(t))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(e);this._cache.reset()}tilesIn(t,r,n){const i=[],A=this.transform;if(!A)return i;const o=n?A.getCameraQueryGeometry(t):t,s=t.map((e=>A.pointCoordinate(e,this.terrain))),a=o.map((e=>A.pointCoordinate(e,this.terrain))),l=this.getIds();let c=1/0,u=1/0,h=-1/0,d=-1/0;for(const e of a)c=Math.min(c,e.x),u=Math.min(u,e.y),h=Math.max(h,e.x),d=Math.max(d,e.y);for(let t=0;t<l.length;t++){const n=this._tiles[l[t]];if(n.holdingForFade())continue;const o=n.tileID,p=Math.pow(2,A.zoom-n.tileID.overscaledZ),f=r*n.queryPadding*e.EXTENT/n.tileSize/p,m=[o.getTilePoint(new e.MercatorCoordinate(c,u)),o.getTilePoint(new e.MercatorCoordinate(h,d))];if(m[0].x-f<e.EXTENT&&m[0].y-f<e.EXTENT&&m[1].x+f>=0&&m[1].y+f>=0){const e=s.map((e=>o.getTilePoint(e))),t=a.map((e=>o.getTilePoint(e)));i.push({tile:n,tileID:o,queryGeometry:e,cameraQueryGeometry:t,scale:p})}}return i}getVisibleCoordinates(e){const t=this.getRenderableIds(e).map((e=>this._tiles[e].tileID));for(const e of t)e.posMatrix=this.transform.calculatePosMatrix(e.toUnwrapped());return t}hasTransition(){if(this._source.hasTransition())return!0;if(R(this._source.type))for(const t in this._tiles){const r=this._tiles[t];if(void 0!==r.fadeEndTime&&r.fadeEndTime>=e.exported.now())return!0}return!1}setFeatureState(e,t,r){this._state.updateState(e=e||"_geojsonTileLayer",t,r)}removeFeatureState(e,t,r){this._state.removeFeatureState(e=e||"_geojsonTileLayer",t,r)}getFeatureState(e,t){return this._state.getState(e=e||"_geojsonTileLayer",t)}setDependencies(e,t,r){const n=this._tiles[e];n&&n.setDependencies(t,r)}reloadTilesForDependencies(e,t){for(const r in this._tiles)this._tiles[r].hasDependency(e,t)&&this._reloadTile(r,"reloading");this._cache.filter((r=>!r.hasDependency(e,t)))}}function z(e,t){const r=Math.abs(2*e.wrap)-+(e.wrap<0),n=Math.abs(2*t.wrap)-+(t.wrap<0);return e.overscaledZ-t.overscaledZ||n-r||t.canonical.y-e.canonical.y||t.canonical.x-e.canonical.x}function R(e){return"raster"===e||"image"===e||"video"===e}H.maxOverzooming=10,H.maxUnderzooming=3;const O="mapboxgl_preloaded_worker_pool";class K{constructor(){this.active={}}acquire(e){if(!this.workers)for(this.workers=[];this.workers.length<K.workerCount;)this.workers.push(new Worker(xi.workerUrl));return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],0===this.numActive()&&(this.workers.forEach((e=>{e.terminate()})),this.workers=null)}isPreloaded(){return!!this.active[O]}numActive(){return Object.keys(this.active).length}}const V=Math.floor(e.exported.hardwareConcurrency/2);let $;function N(){return $||($=new K),$}function G(t,r){const n={};for(const e in t)"ref"!==e&&(n[e]=t[e]);return e.refProperties.forEach((e=>{e in r&&(n[e]=r[e])})),n}function q(e){e=e.slice();const t=Object.create(null);for(let r=0;r<e.length;r++)t[e[r].id]=e[r];for(let r=0;r<e.length;r++)"ref"in e[r]&&(e[r]=G(e[r],t[e[r].ref]));return e}K.workerCount=Math.max(Math.min(V,6),1);const X={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function j(e,t,r){r.push({command:X.addSource,args:[e,t[e]]})}function Z(e,t,r){t.push({command:X.removeSource,args:[e]}),r[e]=!0}function J(e,t,r,n){Z(e,r,n),j(e,t,r)}function W(e,t,r){let n;for(n in e[r])if(Object.prototype.hasOwnProperty.call(e[r],n)&&"data"!==n&&!i(e[r][n],t[r][n]))return!1;for(n in t[r])if(Object.prototype.hasOwnProperty.call(t[r],n)&&"data"!==n&&!i(e[r][n],t[r][n]))return!1;return!0}function Y(e,t,r,n,A,o){let s;for(s in t=t||{},e=e||{})Object.prototype.hasOwnProperty.call(e,s)&&(i(e[s],t[s])||r.push({command:o,args:[n,s,t[s],A]}));for(s in t)Object.prototype.hasOwnProperty.call(t,s)&&!Object.prototype.hasOwnProperty.call(e,s)&&(i(e[s],t[s])||r.push({command:o,args:[n,s,t[s],A]}))}function ee(e){return e.id}function te(e,t){return e[t.id]=t,e}class re{constructor(e,t){this.reset(e,t)}reset(e,t){this.points=e||[],this._distances=[0];for(let e=1;e<this.points.length;e++)this._distances[e]=this._distances[e-1]+this.points[e].dist(this.points[e-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(t||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(t){if(1===this.points.length)return this.points[0];t=e.clamp(t,0,1);let r=1,n=this._distances[r];const i=t*this.paddedLength+this.padding;for(;n<i&&r<this._distances.length;)n=this._distances[++r];const A=r-1,o=this._distances[A],s=n-o,a=s>0?(i-o)/s:0;return this.points[A].mult(1-a).add(this.points[r].mult(a))}}function ne(e,t){let r=!0;return"always"===e||"never"!==e&&"never"!==t||(r=!1),r}class ie{constructor(e,t,r){const n=this.boxCells=[],i=this.circleCells=[];this.xCellCount=Math.ceil(e/r),this.yCellCount=Math.ceil(t/r);for(let e=0;e<this.xCellCount*this.yCellCount;e++)n.push([]),i.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=t,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/t,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(e,t,r,n,i){this._forEachCell(t,r,n,i,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(t),this.bboxes.push(r),this.bboxes.push(n),this.bboxes.push(i)}insertCircle(e,t,r,n){this._forEachCell(t-n,r-n,t+n,r+n,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(t),this.circles.push(r),this.circles.push(n)}_insertBoxCell(e,t,r,n,i,A){this.boxCells[i].push(A)}_insertCircleCell(e,t,r,n,i,A){this.circleCells[i].push(A)}_query(e,t,r,n,i,A,o){if(r<0||e>this.width||n<0||t>this.height)return[];const s=[];if(e<=0&&t<=0&&this.width<=r&&this.height<=n){if(i)return[{key:null,x1:e,y1:t,x2:r,y2:n}];for(let e=0;e<this.boxKeys.length;e++)s.push({key:this.boxKeys[e],x1:this.bboxes[4*e],y1:this.bboxes[4*e+1],x2:this.bboxes[4*e+2],y2:this.bboxes[4*e+3]});for(let e=0;e<this.circleKeys.length;e++){const t=this.circles[3*e],r=this.circles[3*e+1],n=this.circles[3*e+2];s.push({key:this.circleKeys[e],x1:t-n,y1:r-n,x2:t+n,y2:r+n})}}else this._forEachCell(e,t,r,n,this._queryCell,s,{hitTest:i,overlapMode:A,seenUids:{box:{},circle:{}}},o);return s}query(e,t,r,n){return this._query(e,t,r,n,!1,null)}hitTest(e,t,r,n,i,A){return this._query(e,t,r,n,!0,i,A).length>0}hitTestCircle(e,t,r,n,i){const A=e-r,o=e+r,s=t-r,a=t+r;if(o<0||A>this.width||a<0||s>this.height)return!1;const l=[];return this._forEachCell(A,s,o,a,this._queryCellCircle,l,{hitTest:!0,overlapMode:n,circle:{x:e,y:t,radius:r},seenUids:{box:{},circle:{}}},i),l.length>0}_queryCell(e,t,r,n,i,A,o,s){const{seenUids:a,hitTest:l,overlapMode:c}=o,u=this.boxCells[i];if(null!==u){const i=this.bboxes;for(const o of u)if(!a.box[o]){a.box[o]=!0;const u=4*o,h=this.boxKeys[o];if(e<=i[u+2]&&t<=i[u+3]&&r>=i[u+0]&&n>=i[u+1]&&(!s||s(h))&&(!l||!ne(c,h.overlapMode))&&(A.push({key:h,x1:i[u],y1:i[u+1],x2:i[u+2],y2:i[u+3]}),l))return!0}}const h=this.circleCells[i];if(null!==h){const i=this.circles;for(const o of h)if(!a.circle[o]){a.circle[o]=!0;const u=3*o,h=this.circleKeys[o];if(this._circleAndRectCollide(i[u],i[u+1],i[u+2],e,t,r,n)&&(!s||s(h))&&(!l||!ne(c,h.overlapMode))){const e=i[u],t=i[u+1],r=i[u+2];if(A.push({key:h,x1:e-r,y1:t-r,x2:e+r,y2:t+r}),l)return!0}}}return!1}_queryCellCircle(e,t,r,n,i,A,o,s){const{circle:a,seenUids:l,overlapMode:c}=o,u=this.boxCells[i];if(null!==u){const e=this.bboxes;for(const t of u)if(!l.box[t]){l.box[t]=!0;const r=4*t,n=this.boxKeys[t];if(this._circleAndRectCollide(a.x,a.y,a.radius,e[r+0],e[r+1],e[r+2],e[r+3])&&(!s||s(n))&&!ne(c,n.overlapMode))return A.push(!0),!0}}const h=this.circleCells[i];if(null!==h){const e=this.circles;for(const t of h)if(!l.circle[t]){l.circle[t]=!0;const r=3*t,n=this.circleKeys[t];if(this._circlesCollide(e[r],e[r+1],e[r+2],a.x,a.y,a.radius)&&(!s||s(n))&&!ne(c,n.overlapMode))return A.push(!0),!0}}}_forEachCell(e,t,r,n,i,A,o,s){const a=this._convertToXCellCoord(e),l=this._convertToYCellCoord(t),c=this._convertToXCellCoord(r),u=this._convertToYCellCoord(n);for(let h=a;h<=c;h++)for(let a=l;a<=u;a++)if(i.call(this,e,t,r,n,this.xCellCount*a+h,A,o,s))return}_convertToXCellCoord(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}_convertToYCellCoord(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}_circlesCollide(e,t,r,n,i,A){const o=n-e,s=i-t,a=r+A;return a*a>o*o+s*s}_circleAndRectCollide(e,t,r,n,i,A,o){const s=(A-n)/2,a=Math.abs(e-(n+s));if(a>s+r)return!1;const l=(o-i)/2,c=Math.abs(t-(i+l));if(c>l+r)return!1;if(a<=s||c<=l)return!0;const u=a-s,h=c-l;return u*u+h*h<=r*r}}function Ae(t,r,n,i,A){const o=e.create();return r?(e.scale(o,o,[1/A,1/A,1]),n||e.rotateZ(o,o,i.angle)):e.multiply(o,i.labelPlaneMatrix,t),o}function oe(t,r,n,i,A){if(r){const r=e.clone(t);return e.scale(r,r,[A,A,1]),n||e.rotateZ(r,r,-i.angle),r}return i.glCoordMatrix}function se(t,r,n){let i;n?(i=[t.x,t.y,n(t.x,t.y),1],e.transformMat4(i,i,r)):(i=[t.x,t.y,0,1],ye(i,i,r));const A=i[3];return{point:new e.pointGeometry(i[0]/A,i[1]/A),signedDistanceFromCamera:A}}function ae(e,t){return.5+e/t*.5}function le(e,t){const r=e[0]/e[3],n=e[1]/e[3];return r>=-t[0]&&r<=t[0]&&n>=-t[1]&&n<=t[1]}function ce(t,r,n,i,A,o,s,a,l,c){const u=i?t.textSizeData:t.iconSizeData,h=e.evaluateSizeForZoom(u,n.transform.zoom),d=[256/n.width*2+1,256/n.height*2+1],p=i?t.text.dynamicLayoutVertexArray:t.icon.dynamicLayoutVertexArray;p.clear();const f=t.lineVertexArray,m=i?t.text.placedSymbolArray:t.icon.placedSymbolArray,g=n.transform.width/n.transform.height;let y=!1;for(let i=0;i<m.length;i++){const _=m.get(i);if(_.hidden||_.writingMode===e.WritingMode.vertical&&!y){ge(_.numGlyphs,p);continue}let w;if(y=!1,c?(w=[_.anchorX,_.anchorY,c(_.anchorX,_.anchorY),1],e.transformMat4(w,w,r)):(w=[_.anchorX,_.anchorY,0,1],ye(w,w,r)),!le(w,d)){ge(_.numGlyphs,p);continue}const x=ae(n.transform.cameraToCenterDistance,w[3]),B=e.evaluateSizeForFeature(u,h,_),v=s?B/x:B*x,b=new e.pointGeometry(_.anchorX,_.anchorY),C=se(b,A,c).point,F={},E=de(_,v,!1,a,r,A,o,t.glyphOffsetArray,f,p,C,b,F,g,l,c);y=E.useVertical,(E.notEnoughRoom||y||E.needsFlipping&&de(_,v,!0,a,r,A,o,t.glyphOffsetArray,f,p,C,b,F,g,l,c).notEnoughRoom)&&ge(_.numGlyphs,p)}i?t.text.dynamicLayoutVertexBuffer.updateData(p):t.icon.dynamicLayoutVertexBuffer.updateData(p)}function ue(e,t,r,n,i,A,o,s,a,l,c,u,h){const d=s.glyphStartIndex+s.numGlyphs,p=s.lineStartIndex,f=s.lineStartIndex+s.lineLength,m=t.getoffsetX(s.glyphStartIndex),g=t.getoffsetX(d-1),y=fe(e*m,r,n,i,A,o,s.segment,p,f,a,l,c,u,h);if(!y)return null;const _=fe(e*g,r,n,i,A,o,s.segment,p,f,a,l,c,u,h);return _?{first:y,last:_}:null}function he(t,r,n,i){return t===e.WritingMode.horizontal&&Math.abs(n.y-r.y)>Math.abs(n.x-r.x)*i?{useVertical:!0}:(t===e.WritingMode.vertical?r.y<n.y:r.x>n.x)?{needsFlipping:!0}:null}function de(t,r,n,i,A,o,s,a,l,c,u,h,d,p,f,m){const g=r/24,y=t.lineOffsetX*g,_=t.lineOffsetY*g;let w;if(t.numGlyphs>1){const e=t.glyphStartIndex+t.numGlyphs,r=t.lineStartIndex,A=t.lineStartIndex+t.lineLength,c=ue(g,a,y,_,n,u,h,t,l,o,d,f,m);if(!c)return{notEnoughRoom:!0};const x=se(c.first.point,s,m).point,B=se(c.last.point,s,m).point;if(i&&!n){const e=he(t.writingMode,x,B,p);if(e)return e}w=[c.first];for(let i=t.glyphStartIndex+1;i<e-1;i++)w.push(fe(g*a.getoffsetX(i),y,_,n,u,h,t.segment,r,A,l,o,d,f,m));w.push(c.last)}else{if(i&&!n){const r=se(h,A,m).point,n=t.lineStartIndex+t.segment+1,i=new e.pointGeometry(l.getx(n),l.gety(n)),o=se(i,A,m),s=o.signedDistanceFromCamera>0?o.point:pe(h,i,r,1,A,m),a=he(t.writingMode,r,s,p);if(a)return a}const r=fe(g*a.getoffsetX(t.glyphStartIndex),y,_,n,u,h,t.segment,t.lineStartIndex,t.lineStartIndex+t.lineLength,l,o,d,f,m);if(!r)return{notEnoughRoom:!0};w=[r]}for(const t of w)e.addDynamicAttributes(c,t.point,t.angle);return{}}function pe(e,t,r,n,i,A){const o=se(e.add(e.sub(t)._unit()),i,A).point,s=r.sub(o);return r.add(s._mult(n/s.mag()))}function fe(t,r,n,i,A,o,s,a,l,c,u,h,d,p){const f=i?t-r:t+r;let m=f>0?1:-1,g=0;i&&(m*=-1,g=Math.PI),m<0&&(g+=Math.PI);let y=m>0?a+s:a+s+1,_=A,w=A,x=0,B=0;const v=Math.abs(f),b=[];for(;x+B<=v;){if(y+=m,y<a||y>=l)return null;if(w=_,b.push(_),_=h[y],void 0===_){const t=new e.pointGeometry(c.getx(y),c.gety(y)),r=se(t,u,p);if(r.signedDistanceFromCamera>0)_=h[y]=r.point;else{const r=y-m;_=pe(0===x?o:new e.pointGeometry(c.getx(r),c.gety(r)),t,w,v-x+1,u,p)}}x+=B,B=w.dist(_)}const C=(v-x)/B,F=_.sub(w),E=F.mult(C)._add(w);E._add(F._unit()._perp()._mult(n*m));const U=g+Math.atan2(_.y-w.y,_.x-w.x);return b.push(E),{point:E,angle:d?U:0,path:b}}const me=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function ge(e,t){for(let r=0;r<e;r++){const e=t.length;t.resize(e+4),t.float32.set(me,3*e)}}function ye(e,t,r){const n=t[0],i=t[1];return e[0]=r[0]*n+r[4]*i+r[12],e[1]=r[1]*n+r[5]*i+r[13],e[3]=r[3]*n+r[7]*i+r[15],e}const _e=100;class we{constructor(e,t=new ie(e.width+200,e.height+200,25),r=new ie(e.width+200,e.height+200,25)){this.transform=e,this.grid=t,this.ignoredGrid=r,this.pitchfactor=Math.cos(e._pitch)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+_e,this.screenBottomBoundary=e.height+_e,this.gridRightBoundary=e.width+200,this.gridBottomBoundary=e.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(e,t,r,n,i,A){const o=this.projectAndGetPerspectiveRatio(n,e.anchorPointX,e.anchorPointY,A),s=r*o.perspectiveRatio,a=e.x1*s+o.point.x,l=e.y1*s+o.point.y,c=e.x2*s+o.point.x,u=e.y2*s+o.point.y;return!this.isInsideGrid(a,l,c,u)||"always"!==t&&this.grid.hitTest(a,l,c,u,t,i)||o.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[a,l,c,u],offscreen:this.isOffscreen(a,l,c,u)}}placeCollisionCircles(t,r,n,i,A,o,s,a,l,c,u,h,d,p){const f=[],m=new e.pointGeometry(r.anchorX,r.anchorY),g=se(m,o,p),y=ae(this.transform.cameraToCenterDistance,g.signedDistanceFromCamera),_=(c?A/y:A*y)/e.ONE_EM,w=se(m,s,p).point,x=ue(_,i,r.lineOffsetX*_,r.lineOffsetY*_,!1,w,m,r,n,s,{},!1,p);let B=!1,v=!1,b=!0;if(x){const r=.5*h*y+d,n=new e.pointGeometry(-100,-100),i=new e.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),A=new re,o=x.first,s=x.last;let c=[];for(let e=o.path.length-1;e>=1;e--)c.push(o.path[e]);for(let e=1;e<s.path.length;e++)c.push(s.path[e]);const m=2.5*r;if(a){const e=c.map((e=>se(e,a,p)));c=e.some((e=>e.signedDistanceFromCamera<=0))?[]:e.map((e=>e.point))}let g=[];if(c.length>0){const t=c[0].clone(),r=c[0].clone();for(let e=1;e<c.length;e++)t.x=Math.min(t.x,c[e].x),t.y=Math.min(t.y,c[e].y),r.x=Math.max(r.x,c[e].x),r.y=Math.max(r.y,c[e].y);g=t.x>=n.x&&r.x<=i.x&&t.y>=n.y&&r.y<=i.y?[c]:r.x<n.x||t.x>i.x||r.y<n.y||t.y>i.y?[]:e.clipLine([c],n.x,n.y,i.x,i.y)}for(const e of g){A.reset(e,.25*r);let n=0;n=A.length<=.5*r?1:Math.ceil(A.paddedLength/m)+1;for(let e=0;e<n;e++){const i=e/Math.max(n-1,1),o=A.lerp(i),s=o.x+_e,a=o.y+_e;f.push(s,a,r,0);const c=s-r,h=a-r,d=s+r,p=a+r;if(b=b&&this.isOffscreen(c,h,d,p),v=v||this.isInsideGrid(c,h,d,p),"always"!==t&&this.grid.hitTestCircle(s,a,r,t,u)&&(B=!0,!l))return{circles:[],offscreen:!1,collisionDetected:B}}}}return{circles:!l&&B||!v||y<this.perspectiveRatioCutoff?[]:f,offscreen:b,collisionDetected:B}}queryRenderedSymbols(t){if(0===t.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const r=[];let n=1/0,i=1/0,A=-1/0,o=-1/0;for(const s of t){const t=new e.pointGeometry(s.x+_e,s.y+_e);n=Math.min(n,t.x),i=Math.min(i,t.y),A=Math.max(A,t.x),o=Math.max(o,t.y),r.push(t)}const s=this.grid.query(n,i,A,o).concat(this.ignoredGrid.query(n,i,A,o)),a={},l={};for(const t of s){const n=t.key;if(void 0===a[n.bucketInstanceId]&&(a[n.bucketInstanceId]={}),a[n.bucketInstanceId][n.featureIndex])continue;const i=[new e.pointGeometry(t.x1,t.y1),new e.pointGeometry(t.x2,t.y1),new e.pointGeometry(t.x2,t.y2),new e.pointGeometry(t.x1,t.y2)];e.polygonIntersectsPolygon(r,i)&&(a[n.bucketInstanceId][n.featureIndex]=!0,void 0===l[n.bucketInstanceId]&&(l[n.bucketInstanceId]=[]),l[n.bucketInstanceId].push(n.featureIndex))}return l}insertCollisionBox(e,t,r,n,i,A){(r?this.ignoredGrid:this.grid).insert({bucketInstanceId:n,featureIndex:i,collisionGroupID:A,overlapMode:t},e[0],e[1],e[2],e[3])}insertCollisionCircles(e,t,r,n,i,A){const o=r?this.ignoredGrid:this.grid,s={bucketInstanceId:n,featureIndex:i,collisionGroupID:A,overlapMode:t};for(let t=0;t<e.length;t+=4)o.insertCircle(s,e[t],e[t+1],e[t+2])}projectAndGetPerspectiveRatio(t,r,n,i){let A;return i?(A=[r,n,i(r,n),1],e.transformMat4(A,A,t)):(A=[r,n,0,1],ye(A,A,t)),{point:new e.pointGeometry((A[0]/A[3]+1)/2*this.transform.width+_e,(-A[1]/A[3]+1)/2*this.transform.height+_e),perspectiveRatio:.5+this.transform.cameraToCenterDistance/A[3]*.5}}isOffscreen(e,t,r,n){return r<_e||e>=this.screenRightBoundary||n<_e||t>this.screenBottomBoundary}isInsideGrid(e,t,r,n){return r>=0&&e<this.gridRightBoundary&&n>=0&&t<this.gridBottomBoundary}getViewportMatrix(){const t=e.identity([]);return e.translate(t,t,[-100,-100,0]),t}}function xe(t,r,n){return r*(e.EXTENT/(t.tileSize*Math.pow(2,n-t.tileID.overscaledZ)))}class Be{constructor(e,t,r,n){this.opacity=e?Math.max(0,Math.min(1,e.opacity+(e.placed?t:-t))):n&&r?1:0,this.placed=r}isHidden(){return 0===this.opacity&&!this.placed}}class ve{constructor(e,t,r,n,i){this.text=new Be(e?e.text:null,t,r,i),this.icon=new Be(e?e.icon:null,t,n,i)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class be{constructor(e,t,r){this.text=e,this.icon=t,this.skipFade=r}}class Ce{constructor(){this.invProjMatrix=e.create(),this.viewportMatrix=e.create(),this.circles=[]}}class Fe{constructor(e,t,r,n,i){this.bucketInstanceId=e,this.featureIndex=t,this.sourceLayerIndex=r,this.bucketIndex=n,this.tileID=i}}class Ee{constructor(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}}get(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){const t=++this.maxGroupID;this.collisionGroups[e]={ID:t,predicate:e=>e.collisionGroupID===t}}return this.collisionGroups[e]}}function Ue(t,r,n,i,A){const{horizontalAlign:o,verticalAlign:s}=e.getAnchorAlignment(t),a=-(o-.5)*r,l=-(s-.5)*n,c=e.evaluateVariableOffset(t,i);return new e.pointGeometry(a+c[0]*A,l+c[1]*A)}function Qe(t,r,n,i,A,o){const{x1:s,x2:a,y1:l,y2:c,anchorPointX:u,anchorPointY:h}=t,d=new e.pointGeometry(r,n);return i&&d._rotate(A?o:-o),{x1:s+d.x,y1:l+d.y,x2:a+d.x,y2:c+d.y,anchorPointX:u,anchorPointY:h}}class Ie{constructor(e,t,r,n,i){this.transform=e.clone(),this.terrain=t,this.collisionIndex=new we(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=r,this.retainedQueryData={},this.collisionGroups=new Ee(n),this.collisionCircleArrays={},this.prevPlacement=i,i&&(i.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(t,r,n,i){const A=n.getBucket(r),o=n.latestFeatureIndex;if(!A||!o||r.id!==A.layerIds[0])return;const s=n.collisionBoxArray,a=A.layers[0].layout,l=Math.pow(2,this.transform.zoom-n.tileID.overscaledZ),c=n.tileSize/e.EXTENT,u=this.transform.calculatePosMatrix(n.tileID.toUnwrapped()),h="map"===a.get("text-pitch-alignment"),d="map"===a.get("text-rotation-alignment"),p=xe(n,1,this.transform.zoom),f=Ae(u,h,d,this.transform,p);let m=null;if(h){const t=oe(u,h,d,this.transform,p);m=e.multiply([],this.transform.labelPlaneMatrix,t)}this.retainedQueryData[A.bucketInstanceId]=new Fe(A.bucketInstanceId,o,A.sourceLayerIndex,A.index,n.tileID);const g={bucket:A,layout:a,posMatrix:u,textLabelPlaneMatrix:f,labelToScreenMatrix:m,scale:l,textPixelRatio:c,holdingForFade:n.holdingForFade(),collisionBoxArray:s,partiallyEvaluatedTextSize:e.evaluateSizeForZoom(A.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(A.sourceID)};if(i)for(const e of A.sortKeyRanges){const{sortKey:r,symbolInstanceStart:n,symbolInstanceEnd:i}=e;t.push({sortKey:r,symbolInstanceStart:n,symbolInstanceEnd:i,parameters:g})}else t.push({symbolInstanceStart:0,symbolInstanceEnd:A.symbolInstances.length,parameters:g})}attemptAnchorPlacement(e,t,r,n,i,A,o,s,a,l,c,u,h,d,p,f){const m=[u.textOffset0,u.textOffset1],g=Ue(e,r,n,m,i),y=this.collisionIndex.placeCollisionBox(Qe(t,g.x,g.y,A,o,this.transform.angle),c,s,a,l.predicate,f);if((!p||0!==this.collisionIndex.placeCollisionBox(Qe(p,g.x,g.y,A,o,this.transform.angle),c,s,a,l.predicate,f).box.length)&&y.box.length>0){let t;if(this.prevPlacement&&this.prevPlacement.variableOffsets[u.crossTileID]&&this.prevPlacement.placements[u.crossTileID]&&this.prevPlacement.placements[u.crossTileID].text&&(t=this.prevPlacement.variableOffsets[u.crossTileID].anchor),0===u.crossTileID)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[u.crossTileID]={textOffset:m,width:r,height:n,anchor:e,textBoxScale:i,prevAnchor:t},this.markUsedJustification(h,e,u,d),h.allowVerticalPlacement&&(this.markUsedOrientation(h,d,u),this.placedOrientations[u.crossTileID]=d),{shift:g,placedGlyphBoxes:y}}}placeLayerBucketPart(t,r,n){const{bucket:i,layout:A,posMatrix:o,textLabelPlaneMatrix:s,labelToScreenMatrix:a,textPixelRatio:l,holdingForFade:c,collisionBoxArray:u,partiallyEvaluatedTextSize:h,collisionGroup:d}=t.parameters,p=A.get("text-optional"),f=A.get("icon-optional"),m=e.getOverlapMode(A,"text-overlap","text-allow-overlap"),g="always"===m,y=e.getOverlapMode(A,"icon-overlap","icon-allow-overlap"),_="always"===y,w="map"===A.get("text-rotation-alignment"),x="map"===A.get("text-pitch-alignment"),B="none"!==A.get("icon-text-fit"),v="viewport-y"===A.get("symbol-z-order"),b=g&&(_||!i.hasIconData()||f),C=_&&(g||!i.hasTextData()||p);!i.collisionArrays&&u&&i.deserializeCollisionBoxes(u);const F=(t,u)=>{if(r[t.crossTileID])return;if(c)return void(this.placements[t.crossTileID]=new be(!1,!1,!1));let _=!1,v=!1,F=!0,E=null,U={box:null,offscreen:null},Q={box:null,offscreen:null},I=null,T=null,S=null,M=0,k=0,D=0;u.textFeatureIndex?M=u.textFeatureIndex:t.useRuntimeCollisionCircles&&(M=t.featureIndex),u.verticalTextFeatureIndex&&(k=u.verticalTextFeatureIndex);const L=this.retainedQueryData[i.bucketInstanceId].tileID,P=this.terrain?(e,t)=>this.terrain.getElevation(L,e,t):null;for(const e of["textBox","verticalTextBox","iconBox","verticalIconBox"]){const t=u[e];t&&(t.elevation=P?P(t.anchorPointX,t.anchorPointY):0)}const H=u.textBox;if(H){const r=r=>{let n=e.WritingMode.horizontal;if(i.allowVerticalPlacement&&!r&&this.prevPlacement){const e=this.prevPlacement.placedOrientations[t.crossTileID];e&&(this.placedOrientations[t.crossTileID]=e,n=e,this.markUsedOrientation(i,n,t))}return n},n=(r,n)=>{if(i.allowVerticalPlacement&&t.numVerticalGlyphVertices>0&&u.verticalTextBox){for(const t of i.writingModes)if(t===e.WritingMode.vertical?(U=n(),Q=U):U=r(),U&&U.box&&U.box.length)break}else U=r()};if(A.get("text-variable-anchor")){let s=A.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[t.crossTileID]){const e=this.prevPlacement.variableOffsets[t.crossTileID];s.indexOf(e.anchor)>0&&(s=s.filter((t=>t!==e.anchor)),s.unshift(e.anchor))}const a=(e,r,n)=>{const A=e.x2-e.x1,a=e.y2-e.y1,c=t.textBoxScale,u=B&&"never"===y?r:null;let h={box:[],offscreen:!1};const p="never"!==m?2*s.length:s.length;for(let r=0;r<p;++r){const p=this.attemptAnchorPlacement(s[r%s.length],e,A,a,c,w,x,l,o,d,r>=s.length?m:"never",t,i,n,u,P);if(p&&(h=p.placedGlyphBoxes,h&&h.box&&h.box.length)){_=!0,E=p.shift;break}}return h};n((()=>a(H,u.iconBox,e.WritingMode.horizontal)),(()=>{const r=u.verticalTextBox;return i.allowVerticalPlacement&&!(U&&U.box&&U.box.length)&&t.numVerticalGlyphVertices>0&&r?a(r,u.verticalIconBox,e.WritingMode.vertical):{box:null,offscreen:null}})),U&&(_=U.box,F=U.offscreen);const c=r(U&&U.box);if(!_&&this.prevPlacement){const e=this.prevPlacement.variableOffsets[t.crossTileID];e&&(this.variableOffsets[t.crossTileID]=e,this.markUsedJustification(i,e.anchor,t,c))}}else{const A=(e,r)=>{const n=this.collisionIndex.placeCollisionBox(e,m,l,o,d.predicate,P);return n&&n.box&&n.box.length&&(this.markUsedOrientation(i,r,t),this.placedOrientations[t.crossTileID]=r),n};n((()=>A(H,e.WritingMode.horizontal)),(()=>{const r=u.verticalTextBox;return i.allowVerticalPlacement&&t.numVerticalGlyphVertices>0&&r?A(r,e.WritingMode.vertical):{box:null,offscreen:null}})),r(U&&U.box&&U.box.length)}}if(I=U,_=I&&I.box&&I.box.length>0,F=I&&I.offscreen,t.useRuntimeCollisionCircles){const r=i.text.placedSymbolArray.get(t.centerJustifiedTextSymbolIndex),l=e.evaluateSizeForFeature(i.textSizeData,h,r),c=A.get("text-padding");T=this.collisionIndex.placeCollisionCircles(m,r,i.lineVertexArray,i.glyphOffsetArray,l,o,s,a,n,x,d.predicate,t.collisionCircleDiameter,c,P),T.circles.length&&T.collisionDetected&&!n&&e.warnOnce("Collisions detected, but collision boxes are not shown"),_=g||T.circles.length>0&&!T.collisionDetected,F=F&&T.offscreen}if(u.iconFeatureIndex&&(D=u.iconFeatureIndex),u.iconBox){const e=e=>{const t=B&&E?Qe(e,E.x,E.y,w,x,this.transform.angle):e;return this.collisionIndex.placeCollisionBox(t,y,l,o,d.predicate,P)};Q&&Q.box&&Q.box.length&&u.verticalIconBox?(S=e(u.verticalIconBox),v=S.box.length>0):(S=e(u.iconBox),v=S.box.length>0),F=F&&S.offscreen}const z=p||0===t.numHorizontalGlyphVertices&&0===t.numVerticalGlyphVertices,R=f||0===t.numIconVertices;if(z||R?R?z||(v=v&&_):_=v&&_:v=_=v&&_,_&&I&&I.box&&this.collisionIndex.insertCollisionBox(I.box,m,A.get("text-ignore-placement"),i.bucketInstanceId,Q&&Q.box&&k?k:M,d.ID),v&&S&&this.collisionIndex.insertCollisionBox(S.box,y,A.get("icon-ignore-placement"),i.bucketInstanceId,D,d.ID),T&&(_&&this.collisionIndex.insertCollisionCircles(T.circles,m,A.get("text-ignore-placement"),i.bucketInstanceId,M,d.ID),n)){const e=i.bucketInstanceId;let t=this.collisionCircleArrays[e];void 0===t&&(t=this.collisionCircleArrays[e]=new Ce);for(let e=0;e<T.circles.length;e+=4)t.circles.push(T.circles[e+0]),t.circles.push(T.circles[e+1]),t.circles.push(T.circles[e+2]),t.circles.push(T.collisionDetected?1:0)}if(0===t.crossTileID)throw new Error("symbolInstance.crossTileID can't be 0");if(0===i.bucketInstanceId)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[t.crossTileID]=new be(_||b,v||C,F||i.justReloaded),r[t.crossTileID]=!0};if(v){if(0!==t.symbolInstanceStart)throw new Error("bucket.bucketInstanceId should be 0");const e=i.getSortedSymbolIndexes(this.transform.angle);for(let t=e.length-1;t>=0;--t){const r=e[t];F(i.symbolInstances.get(r),i.collisionArrays[r])}}else for(let e=t.symbolInstanceStart;e<t.symbolInstanceEnd;e++)F(i.symbolInstances.get(e),i.collisionArrays[e]);if(n&&i.bucketInstanceId in this.collisionCircleArrays){const t=this.collisionCircleArrays[i.bucketInstanceId];e.invert(t.invProjMatrix,o),t.viewportMatrix=this.collisionIndex.getViewportMatrix()}i.justReloaded=!1}markUsedJustification(t,r,n,i){let A;A=i===e.WritingMode.vertical?n.verticalPlacedTextSymbolIndex:{left:n.leftJustifiedTextSymbolIndex,center:n.centerJustifiedTextSymbolIndex,right:n.rightJustifiedTextSymbolIndex}[e.getAnchorJustification(r)];const o=[n.leftJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.rightJustifiedTextSymbolIndex,n.verticalPlacedTextSymbolIndex];for(const e of o)e>=0&&(t.text.placedSymbolArray.get(e).crossTileID=A>=0&&e!==A?0:n.crossTileID)}markUsedOrientation(t,r,n){const i=r===e.WritingMode.horizontal||r===e.WritingMode.horizontalOnly?r:0,A=r===e.WritingMode.vertical?r:0,o=[n.leftJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.rightJustifiedTextSymbolIndex];for(const e of o)t.text.placedSymbolArray.get(e).placedOrientation=i;n.verticalPlacedTextSymbolIndex&&(t.text.placedSymbolArray.get(n.verticalPlacedTextSymbolIndex).placedOrientation=A)}commit(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;const t=this.prevPlacement;let r=!1;this.prevZoomAdjustment=t?t.zoomAdjustment(this.transform.zoom):0;const n=t?t.symbolFadeChange(e):1,i=t?t.opacities:{},A=t?t.variableOffsets:{},o=t?t.placedOrientations:{};for(const e in this.placements){const t=this.placements[e],A=i[e];A?(this.opacities[e]=new ve(A,n,t.text,t.icon),r=r||t.text!==A.text.placed||t.icon!==A.icon.placed):(this.opacities[e]=new ve(null,n,t.text,t.icon,t.skipFade),r=r||t.text||t.icon)}for(const e in i){const t=i[e];if(!this.opacities[e]){const i=new ve(t,n,!1,!1);i.isHidden()||(this.opacities[e]=i,r=r||t.text.placed||t.icon.placed)}}for(const e in A)this.variableOffsets[e]||!this.opacities[e]||this.opacities[e].isHidden()||(this.variableOffsets[e]=A[e]);for(const e in o)this.placedOrientations[e]||!this.opacities[e]||this.opacities[e].isHidden()||(this.placedOrientations[e]=o[e]);if(t&&void 0===t.lastPlacementChangeTime)throw new Error("Last placement time for previous placement is not defined");r?this.lastPlacementChangeTime=e:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=t?t.lastPlacementChangeTime:e)}updateLayerOpacities(e,t){const r={};for(const n of t){const t=n.getBucket(e);t&&n.latestFeatureIndex&&e.id===t.layerIds[0]&&this.updateBucketOpacities(t,r,n.collisionBoxArray)}}updateBucketOpacities(t,r,n){t.hasTextData()&&t.text.opacityVertexArray.clear(),t.hasIconData()&&t.icon.opacityVertexArray.clear(),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear();const i=t.layers[0].layout,A=new ve(null,0,!1,!1,!0),o=i.get("text-allow-overlap"),s=i.get("icon-allow-overlap"),a=i.get("text-variable-anchor"),l="map"===i.get("text-rotation-alignment"),c="map"===i.get("text-pitch-alignment"),u="none"!==i.get("icon-text-fit"),h=new ve(null,0,o&&(s||!t.hasIconData()||i.get("icon-optional")),s&&(o||!t.hasTextData()||i.get("text-optional")),!0);!t.collisionArrays&&n&&(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData())&&t.deserializeCollisionBoxes(n);const d=(e,t,r)=>{for(let n=0;n<t/4;n++)e.opacityVertexArray.emplaceBack(r)};for(let n=0;n<t.symbolInstances.length;n++){const i=t.symbolInstances.get(n),{numHorizontalGlyphVertices:o,numVerticalGlyphVertices:s,crossTileID:p}=i;let f=this.opacities[p];r[p]?f=A:f||(f=h,this.opacities[p]=f),r[p]=!0;const m=i.numIconVertices>0,g=this.placedOrientations[i.crossTileID],y=g===e.WritingMode.vertical,_=g===e.WritingMode.horizontal||g===e.WritingMode.horizontalOnly;if(o>0||s>0){const e=ze(f.text);d(t.text,o,y?Re:e),d(t.text,s,_?Re:e);const r=f.text.isHidden();[i.rightJustifiedTextSymbolIndex,i.centerJustifiedTextSymbolIndex,i.leftJustifiedTextSymbolIndex].forEach((e=>{e>=0&&(t.text.placedSymbolArray.get(e).hidden=r||y?1:0)})),i.verticalPlacedTextSymbolIndex>=0&&(t.text.placedSymbolArray.get(i.verticalPlacedTextSymbolIndex).hidden=r||_?1:0);const n=this.variableOffsets[i.crossTileID];n&&this.markUsedJustification(t,n.anchor,i,g);const A=this.placedOrientations[i.crossTileID];A&&(this.markUsedJustification(t,"left",i,A),this.markUsedOrientation(t,A,i))}if(m){const e=ze(f.icon),r=!(u&&i.verticalPlacedIconSymbolIndex&&y);i.placedIconSymbolIndex>=0&&(d(t.icon,i.numIconVertices,r?e:Re),t.icon.placedSymbolArray.get(i.placedIconSymbolIndex).hidden=f.icon.isHidden()),i.verticalPlacedIconSymbolIndex>=0&&(d(t.icon,i.numVerticalIconVertices,r?Re:e),t.icon.placedSymbolArray.get(i.verticalPlacedIconSymbolIndex).hidden=f.icon.isHidden())}if(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData()){const r=t.collisionArrays[n];if(r){let n=new e.pointGeometry(0,0);if(r.textBox||r.verticalTextBox){let e=!0;if(a){const t=this.variableOffsets[p];t?(n=Ue(t.anchor,t.width,t.height,t.textOffset,t.textBoxScale),l&&n._rotate(c?this.transform.angle:-this.transform.angle)):e=!1}r.textBox&&Te(t.textCollisionBox.collisionVertexArray,f.text.placed,!e||y,n.x,n.y),r.verticalTextBox&&Te(t.textCollisionBox.collisionVertexArray,f.text.placed,!e||_,n.x,n.y)}const i=Boolean(!_&&r.verticalIconBox);r.iconBox&&Te(t.iconCollisionBox.collisionVertexArray,f.icon.placed,i,u?n.x:0,u?n.y:0),r.verticalIconBox&&Te(t.iconCollisionBox.collisionVertexArray,f.icon.placed,!i,u?n.x:0,u?n.y:0)}}}if(t.sortFeatures(this.transform.angle),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.text.opacityVertexArray.length!==t.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${t.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${t.text.layoutVertexArray.length}) / 4`);if(t.icon.opacityVertexArray.length!==t.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${t.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${t.icon.layoutVertexArray.length}) / 4`);if(t.bucketInstanceId in this.collisionCircleArrays){const e=this.collisionCircleArrays[t.bucketInstanceId];t.placementInvProjMatrix=e.invProjMatrix,t.placementViewportMatrix=e.viewportMatrix,t.collisionCircleArray=e.circles,delete this.collisionCircleArrays[t.bucketInstanceId]}}symbolFadeChange(e){return 0===this.fadeDuration?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(e){return Math.max(0,(this.transform.zoom-e)/1.5)}hasTransitions(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(e,t){const r=this.zoomAtLastRecencyCheck===t?1-this.zoomAdjustment(t):1;return this.zoomAtLastRecencyCheck=t,this.commitTime+this.fadeDuration*r>e}setStale(){this.stale=!0}}function Te(e,t,r,n,i){e.emplaceBack(t?1:0,r?1:0,n||0,i||0),e.emplaceBack(t?1:0,r?1:0,n||0,i||0),e.emplaceBack(t?1:0,r?1:0,n||0,i||0),e.emplaceBack(t?1:0,r?1:0,n||0,i||0)}const Se=Math.pow(2,25),Me=Math.pow(2,24),ke=Math.pow(2,17),De=Math.pow(2,16),Le=Math.pow(2,9),Pe=Math.pow(2,8),He=Math.pow(2,1);function ze(e){if(0===e.opacity&&!e.placed)return 0;if(1===e.opacity&&e.placed)return 4294967295;const t=e.placed?1:0,r=Math.floor(127*e.opacity);return r*Se+t*Me+r*ke+t*De+r*Le+t*Pe+r*He+t}const Re=0;class Oe{constructor(e){this._sortAcrossTiles="viewport-y"!==e.layout.get("symbol-z-order")&&!e.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(e,t,r,n,i){const A=this._bucketParts;for(;this._currentTileIndex<e.length;)if(t.getBucketParts(A,n,e[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,i())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,A.sort(((e,t)=>e.sortKey-t.sortKey)));this._currentPartIndex<A.length;)if(t.placeLayerBucketPart(A[this._currentPartIndex],this._seenCrossTileIDs,r),this._currentPartIndex++,i())return!0;return!1}}class Ke{constructor(e,t,r,n,i,A,o,s){this.placement=new Ie(e,t,A,o,s),this._currentPlacementIndex=r.length-1,this._forceFullPlacement=n,this._showCollisionBoxes=i,this._done=!1}isDone(){return this._done}continuePlacement(t,r,n){const i=e.exported.now(),A=()=>{const t=e.exported.now()-i;return!this._forceFullPlacement&&t>2};for(;this._currentPlacementIndex>=0;){const e=r[t[this._currentPlacementIndex]],i=this.placement.collisionIndex.transform.zoom;if("symbol"===e.type&&(!e.minzoom||e.minzoom<=i)&&(!e.maxzoom||e.maxzoom>i)){if(this._inProgressLayer||(this._inProgressLayer=new Oe(e)),this._inProgressLayer.continuePlacement(n[e.source],this.placement,this._showCollisionBoxes,e,A))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(e){return this.placement.commit(e),this.placement}}const Ve=512/e.EXTENT/2;class $e{constructor(e,t,r){this.tileID=e,this.indexedSymbolInstances={},this.bucketInstanceId=r;for(let r=0;r<t.length;r++){const n=t.get(r),i=n.key;this.indexedSymbolInstances[i]||(this.indexedSymbolInstances[i]=[]),this.indexedSymbolInstances[i].push({crossTileID:n.crossTileID,coord:this.getScaledCoordinates(n,e)})}}getScaledCoordinates(t,r){const n=Ve/Math.pow(2,r.canonical.z-this.tileID.canonical.z);return{x:Math.floor((r.canonical.x*e.EXTENT+t.anchorX)*n),y:Math.floor((r.canonical.y*e.EXTENT+t.anchorY)*n)}}findMatches(e,t,r){const n=this.tileID.canonical.z<t.canonical.z?1:Math.pow(2,this.tileID.canonical.z-t.canonical.z);for(let i=0;i<e.length;i++){const A=e.get(i);if(A.crossTileID)continue;const o=this.indexedSymbolInstances[A.key];if(!o)continue;const s=this.getScaledCoordinates(A,t);for(const e of o)if(Math.abs(e.coord.x-s.x)<=n&&Math.abs(e.coord.y-s.y)<=n&&!r[e.crossTileID]){r[e.crossTileID]=!0,A.crossTileID=e.crossTileID;break}}}}class Ne{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Ge{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(e){const t=Math.round((e-this.lng)/360);if(0!==t)for(const e in this.indexes){const r=this.indexes[e],n={};for(const e in r){const i=r[e];i.tileID=i.tileID.unwrapTo(i.tileID.wrap+t),n[i.tileID.key]=i}this.indexes[e]=n}this.lng=e}addBucket(e,t,r){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===t.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(let e=0;e<t.symbolInstances.length;e++)t.symbolInstances.get(e).crossTileID=0;this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]={});const n=this.usedCrossTileIDs[e.overscaledZ];for(const r in this.indexes){const i=this.indexes[r];if(Number(r)>e.overscaledZ)for(const r in i){const A=i[r];A.tileID.isChildOf(e)&&A.findMatches(t.symbolInstances,e,n)}else{const A=i[e.scaledTo(Number(r)).key];A&&A.findMatches(t.symbolInstances,e,n)}}for(let e=0;e<t.symbolInstances.length;e++){const i=t.symbolInstances.get(e);i.crossTileID||(i.crossTileID=r.generate(),n[i.crossTileID]=!0)}return void 0===this.indexes[e.overscaledZ]&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new $e(e,t.symbolInstances,t.bucketInstanceId),!0}removeBucketCrossTileIDs(e,t){for(const r in t.indexedSymbolInstances)for(const n of t.indexedSymbolInstances[r])delete this.usedCrossTileIDs[e][n.crossTileID]}removeStaleBuckets(e){let t=!1;for(const r in this.indexes){const n=this.indexes[r];for(const i in n)e[n[i].bucketInstanceId]||(this.removeBucketCrossTileIDs(r,n[i]),delete n[i],t=!0)}return t}}class qe{constructor(){this.layerIndexes={},this.crossTileIDs=new Ne,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(e,t,r){let n=this.layerIndexes[e.id];void 0===n&&(n=this.layerIndexes[e.id]=new Ge);let i=!1;const A={};n.handleWrapJump(r);for(const r of t){const t=r.getBucket(e);t&&e.id===t.layerIds[0]&&(t.bucketInstanceId||(t.bucketInstanceId=++this.maxBucketInstanceId),n.addBucket(r.tileID,t,this.crossTileIDs)&&(i=!0),A[t.bucketInstanceId]=!0)}return n.removeStaleBuckets(A)&&(i=!0),i}pruneUnusedLayers(e){const t={};e.forEach((e=>{t[e]=!0}));for(const e in this.layerIndexes)t[e]||delete this.layerIndexes[e]}}var Xe=e.createLayout([{name:"a_pos",type:"Int16",components:2}]);class je extends e.Evented{constructor(e){super(),this.sourceCache=e,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.renderHistory=[],this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,this.renderHistorySize=e._cache.max,e.usedForTerrain=!0,e.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null;for(const e in this._tiles){const t=this._tiles[e];t.textures.forEach((e=>e.destroy())),t.textures=[]}}update(t,r){this.sourceCache.update(t,r),this._renderableTilesKeys=[];for(const n of t.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:r}))this._renderableTilesKeys.push(n.key),this._tiles[n.key]||(n.posMatrix=new Float64Array(16),e.ortho(n.posMatrix,0,e.EXTENT,0,e.EXTENT,0,1),this._tiles[n.key]=new D(n,this.tileSize))}removeOutdated(e){const t={};this.renderHistory=this.renderHistory.filter(((e,t)=>this.renderHistory.indexOf(e)===t)).slice(0,this.renderHistorySize);for(const e of this._renderableTilesKeys)t[e]=!0;for(const e of this.renderHistory)t[e]=!0;for(const r in this._tiles)t[r]||(this._tiles[r].clearTextures(e),delete this._tiles[r])}getRenderableTiles(){return this._renderableTilesKeys.map((e=>this.getTileByID(e)))}getTileByID(e){return this._tiles[e]}getTerrainCoords(t){const r={};for(const n of this._renderableTilesKeys){const i=this._tiles[n].tileID;if(i.canonical.equals(t.canonical)){const i=t.clone();i.posMatrix=new Float64Array(16),e.ortho(i.posMatrix,0,e.EXTENT,0,e.EXTENT,0,1),r[n]=i}else if(i.canonical.isChildOf(t.canonical)){const A=t.clone();A.posMatrix=new Float64Array(16);const o=i.canonical.z-t.canonical.z,s=i.canonical.x-(i.canonical.x>>o<<o),a=i.canonical.y-(i.canonical.y>>o<<o),l=e.EXTENT>>o;e.ortho(A.posMatrix,0,l,0,l,0,1),e.translate(A.posMatrix,A.posMatrix,[-s*l,-a*l,0]),r[n]=A}else if(t.canonical.isChildOf(i.canonical)){const A=t.clone();A.posMatrix=new Float64Array(16);const o=t.canonical.z-i.canonical.z,s=t.canonical.x-(t.canonical.x>>o<<o),a=t.canonical.y-(t.canonical.y>>o<<o),l=e.EXTENT>>o;e.ortho(A.posMatrix,0,e.EXTENT,0,e.EXTENT,0,1),e.translate(A.posMatrix,A.posMatrix,[s*l,a*l,0]),e.scale(A.posMatrix,A.posMatrix,[1/2**o,1/2**o,0]),r[n]=A}}return r}getSourceTile(e,t){const r=this.sourceCache._source;let n=e.overscaledZ-this.deltaZoom;if(n>r.maxzoom&&(n=r.maxzoom),n<r.minzoom)return null;this._sourceTileCache[e.key]||(this._sourceTileCache[e.key]=e.scaledTo(n).key);let i=this.sourceCache.getTileByID(this._sourceTileCache[e.key]);if((!i||!i.dem)&&t)for(;n>=r.minzoom&&(!i||!i.dem);)i=this.sourceCache.getTileByID(e.scaledTo(n--).key);return i}tilesAfterTime(e=Date.now()){return Object.values(this._tiles).filter((t=>t.timeLoaded>=e))}}class Ze{constructor(e,t,r){this.style=e,this.sourceCache=new je(t),this.options=r,this.exaggeration="number"==typeof r.exaggeration?r.exaggeration:1,this.elevationOffset="number"==typeof r.elevationOffset?r.elevationOffset:450,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024,this.clearRerenderCache()}getDEMElevation(t,r,n,i=e.EXTENT){if(!(r>=0&&r<i&&n>=0&&n<i))return this.elevationOffset;let A=0;const o=this.getTerrainData(t);if(o.tile&&o.tile.dem){const t=e.transformMat4$1([],[r/i*e.EXTENT,n/i*e.EXTENT],o.u_terrain_matrix),s=[t[0]*o.tile.dem.dim,t[1]*o.tile.dem.dim],a=[Math.floor(s[0]),Math.floor(s[1])],l=o.tile.dem.get(a[0],a[1]),c=o.tile.dem.get(a[0],a[1]+1),u=o.tile.dem.get(a[0]+1,a[1]),h=o.tile.dem.get(a[0]+1,a[1]+1);A=e.number(e.number(l,c,s[0]-a[0]),e.number(u,h,s[0]-a[0]),s[1]-a[1])}return A}rememberForRerender(e,t){for(const r in this.sourceCache._tiles){const n=this.sourceCache._tiles[r];(n.tileID.equals(t)||n.tileID.isChildOf(t))&&(e===this.sourceCache.sourceCache.id&&(n.timeLoaded=Date.now()),this._rerender[e]=this._rerender[e]||{},this._rerender[e][n.tileID.key]=!0)}}needsRerender(e,t){return this._rerender[e]&&this._rerender[e][t.key]}clearRerenderCache(){this._rerender={}}getElevation(t,r,n,i=e.EXTENT){return(this.getDEMElevation(t,r,n,i)+this.elevationOffset)*this.exaggeration}getTerrainData(t){if(!this._emptyDemTexture){const t=this.style.map.painter.context,r=new e.RGBAImage({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new a(t,r,t.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new a(t,new e.RGBAImage({width:1,height:1}),t.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(t.gl.NEAREST,t.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=e.identity([])}const r=this.sourceCache.getSourceTile(t,!0);if(r&&r.dem&&(!r.demTexture||r.needsTerrainPrepare)){const e=this.style.map.painter.context;r.demTexture=this.style.map.painter.getTileTexture(r.dem.stride),r.demTexture?r.demTexture.update(r.dem.getPixels(),{premultiply:!1}):r.demTexture=new a(e,r.dem.getPixels(),e.gl.RGBA,{premultiply:!1}),r.demTexture.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),r.needsTerrainPrepare=!1}const n=r&&r+r.tileID.key+t.key;if(n&&!this._demMatrixCache[n]){const n=this.sourceCache.sourceCache._source.maxzoom;let i=t.canonical.z-r.tileID.canonical.z;t.overscaledZ>t.canonical.z&&(t.canonical.z>=n?i=t.canonical.z-n:e.warnOnce("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const A=t.canonical.x-(t.canonical.x>>i<<i),o=t.canonical.y-(t.canonical.y>>i<<i),s=e.fromScaling(new Float64Array(16),[1/(e.EXTENT<<i),1/(e.EXTENT<<i),0]);e.translate(s,s,[A*e.EXTENT,o*e.EXTENT,0]),this._demMatrixCache[t.key]={matrix:s,coord:t}}return{u_depth:2,u_terrain:3,u_terrain_dim:r&&r.dem&&r.dem.dim||1,u_terrain_matrix:n?this._demMatrixCache[t.key].matrix:this._emptyDemMatrix,u_terrain_unpack:r&&r.dem&&r.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_offset:this.elevationOffset,u_terrain_exaggeration:this.exaggeration,texture:(r&&r.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:r}}getRTTFramebuffer(){const e=this.style.map.painter;if(!this._rttFramebuffer){const t=this.sourceCache.tileSize*this.qualityFactor;this._rttFramebuffer=e.context.createFramebuffer(t,t,!0),this._rttFramebuffer.depthAttachment.set(e.context.createRenderbuffer(e.context.gl.DEPTH_COMPONENT16,t,t))}return this._rttFramebuffer}getFramebuffer(e){const t=this.style.map.painter,r=t.width/devicePixelRatio,n=t.height/devicePixelRatio;return!this._fbo||this._fbo.width===r&&this._fbo.height===n||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new a(t.context,{width:r,height:n,data:null},t.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(t.context.gl.NEAREST,t.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new a(t.context,{width:r,height:n,data:null},t.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(t.context.gl.NEAREST,t.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=t.context.createFramebuffer(r,n,!0),this._fbo.depthAttachment.set(t.context.createRenderbuffer(t.context.gl.DEPTH_COMPONENT16,r,n))),this._fbo.colorAttachment.set("coords"===e?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const t=this.style.map.painter.context;if(this._coordsTexture)return this._coordsTexture;const r=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let e=0,t=0;e<this._coordsTextureSize;e++)for(let n=0;n<this._coordsTextureSize;n++,t+=4)r[t+0]=255&n,r[t+1]=255&e,r[t+2]=n>>8<<4|e>>8,r[t+3]=0;const n=new e.RGBAImage({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(r.buffer)),i=new a(t,n,t.gl.RGBA,{premultiply:!1});return i.bind(t.gl.NEAREST,t.gl.CLAMP_TO_EDGE),this._coordsTexture=i,i}pointCoordinate(t){const r=new Uint8Array(4),n=this.style.map.painter,i=n.context,A=i.gl;i.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),A.readPixels(t.x,n.height/devicePixelRatio-t.y-1,1,1,A.RGBA,A.UNSIGNED_BYTE,r),i.bindFramebuffer.set(null);const o=r[0]+(r[2]>>4<<8),s=r[1]+((15&r[2])<<8),a=this.coordsIndex[255-r[3]],l=a&&this.sourceCache.getTileByID(a);if(!l)return null;const c=this._coordsTextureSize,u=(1<<l.tileID.canonical.z)*c;return new e.MercatorCoordinate((l.tileID.canonical.x*c+o)/u,(l.tileID.canonical.y*c+s)/u,this.getElevation(l.tileID,o,s,c))}getTerrainMesh(){if(this._mesh)return this._mesh;const t=this.style.map.painter.context,r=new e.PosArray,n=new e.TriangleIndexArray,i=this.meshSize,A=e.EXTENT/i,o=i*i;for(let e=0;e<=i;e++)for(let t=0;t<=i;t++)r.emplaceBack(t*A,e*A);for(let e=0;e<o;e+=i+1)for(let t=0;t<i;t++)n.emplaceBack(t+e,i+t+e+1,i+t+e+2),n.emplaceBack(t+e,i+t+e+2,t+e+1);return this._mesh={indexBuffer:t.createIndexBuffer(n),vertexBuffer:t.createVertexBuffer(r,Xe.members),segments:e.SegmentVector.simpleSegment(0,0,r.length,n.length)},this._mesh}getMinMaxElevation(e){const t=this.getTerrainData(e).tile,r={minElevation:null,maxElevation:null};return t&&t.dem&&(r.minElevation=(t.dem.min+this.elevationOffset)*this.exaggeration,r.maxElevation=(t.dem.max+this.elevationOffset)*this.exaggeration),r}}const Je=(t,r)=>e.emitValidationErrors(t,r&&r.filter((e=>"source.canvas"!==e.identifier))),We=e.pick(X,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Ye=e.pick(X,["setCenter","setZoom","setBearing","setPitch"]),et=function(){const t={},r=e.spec.$version;for(const n in e.spec.$root){const i=e.spec.$root[n];if(i.required){let e=null;e="version"===n?r:"array"===i.type?[]:{},null!=e&&(t[n]=e)}}return t}();class tt extends e.Evented{constructor(t,r={}){super(),this.map=t,this.dispatcher=new _(N(),this),this.imageManager=new c,this.imageManager.setEventedParent(this),this.glyphManager=new p(t._requestManager,r.localIdeographFontFamily),this.lineAtlas=new y(256,512),this.crossTileSymbolIndex=new qe,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new e.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",e.getReferrer());const n=this;this._rtlTextPluginCallback=tt.registerForPluginStateChange((t=>{n.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:t.pluginStatus,pluginURL:t.pluginURL},((t,r)=>{if(e.triggerPluginCompletionEvent(t),r&&r.every((e=>e)))for(const e in n.sourceCaches)n.sourceCaches[e].reload()}))})),this.on("data",(e=>{if("source"!==e.dataType||"metadata"!==e.sourceDataType)return;const t=this.sourceCaches[e.sourceId];if(!t)return;const r=t.getSource();if(r&&r.vectorLayerIds)for(const e in this._layers){const t=this._layers[e];t.source===r.id&&this._validateLayer(t)}}))}loadURL(t,r={}){this.fire(new e.Event("dataloading",{dataType:"style"}));const n="boolean"!=typeof r.validate||r.validate,i=this.map._requestManager.transformRequest(t,e.ResourceType.Style);this._request=e.getJSON(i,((t,r)=>{this._request=null,t?this.fire(new e.ErrorEvent(t)):r&&this._load(r,n)}))}loadJSON(t,r={}){this.fire(new e.Event("dataloading",{dataType:"style"})),this._request=e.exported.frame((()=>{this._request=null,this._load(t,!1!==r.validate)}))}loadEmpty(){this.fire(new e.Event("dataloading",{dataType:"style"})),this._load(et,!1)}_load(t,r){if(r&&Je(this,e.validateStyle(t)))return;this._loaded=!0,this.stylesheet=t;for(const e in t.sources)this.addSource(e,t.sources[e],{validate:!1});t.sprite?this._loadSprite(t.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(t.glyphs);const n=q(this.stylesheet.layers);this._order=n.map((e=>e.id)),this._layers={},this._serializedLayers={};for(let t of n)t=e.createStyleLayer(t),t.setEventedParent(this,{layer:{id:t.id}}),this._layers[t.id]=t,this._serializedLayers[t.id]=t.serialize();this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new g(this.stylesheet.light),this.setTerrain(this.stylesheet.terrain),this.fire(new e.Event("data",{dataType:"style"})),this.fire(new e.Event("style.load"))}_loadSprite(t){this._spriteRequest=function(t,r,n,i){let A,o,s;const a=n>1?"@2x":"";let l=e.getJSON(r.transformRequest(r.normalizeSpriteURL(t,a,".json"),e.ResourceType.SpriteJSON),((e,t)=>{l=null,s||(s=e,A=t,u())})),c=e.getImage(r.transformRequest(r.normalizeSpriteURL(t,a,".png"),e.ResourceType.SpriteImage),((e,t)=>{c=null,s||(s=e,o=t,u())}));function u(){if(s)i(s);else if(A&&o){const t=e.exported.getImageData(o),r={};for(const n in A){const{width:i,height:o,x:s,y:a,sdf:l,pixelRatio:c,stretchX:u,stretchY:h,content:d}=A[n],p=new e.RGBAImage({width:i,height:o});e.RGBAImage.copy(t,p,{x:s,y:a},{x:0,y:0},{width:i,height:o}),r[n]={data:p,pixelRatio:c,sdf:l,stretchX:u,stretchY:h,content:d}}i(null,r)}}return{cancel(){l&&(l.cancel(),l=null),c&&(c.cancel(),c=null)}}}(t,this.map._requestManager,this.map.getPixelRatio(),((t,r)=>{if(this._spriteRequest=null,t)this.fire(new e.ErrorEvent(t));else if(r)for(const e in r)this.imageManager.addImage(e,r[e]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new e.Event("data",{dataType:"style"}))}))}_validateLayer(t){const r=this.sourceCaches[t.source];if(!r)return;const n=t.sourceLayer;if(!n)return;const i=r.getSource();("geojson"===i.type||i.vectorLayerIds&&-1===i.vectorLayerIds.indexOf(n))&&this.fire(new e.ErrorEvent(new Error(`Source layer "${n}" does not exist on source "${i.id}" as specified by style layer "${t.id}".`)))}loaded(){if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(const e in this.sourceCaches)if(!this.sourceCaches[e].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(e){const t=[];for(const r of e){const e=this._layers[r];"custom"!==e.type&&t.push(e.serialize())}return t}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const e in this.sourceCaches)if(this.sourceCaches[e].hasTransition())return!0;for(const e in this._layers)if(this._layers[e].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(t){if(!this._loaded)return;const r=this._changed;if(this._changed){const e=Object.keys(this._updatedLayers),r=Object.keys(this._removedLayers);(e.length||r.length)&&this._updateWorkerLayers(e,r);for(const e in this._updatedSources){const t=this._updatedSources[e];if("reload"===t)this._reloadSource(e);else{if("clear"!==t)throw new Error(`Invalid action ${t}`);this._clearSource(e)}}this._updateTilesForChangedImages();for(const e in this._updatedPaintProps)this._layers[e].updateTransitions(t);this.light.updateTransitions(t),this._resetUpdates()}const n={};for(const e in this.sourceCaches){const t=this.sourceCaches[e];n[e]=t.used,t.used=!1}for(const e of this._order){const r=this._layers[e];r.recalculate(t,this._availableImages),!r.isHidden(t.zoom)&&r.source&&(this.sourceCaches[r.source].used=!0)}for(const t in n){const r=this.sourceCaches[t];n[t]!==r.used&&r.fire(new e.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:t}))}this.light.recalculate(t),this.z=t.zoom,r&&this.fire(new e.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const e=Object.keys(this._changedImages);if(e.length){for(const t in this.sourceCaches)this.sourceCaches[t].reloadTilesForDependencies(["icons","patterns"],e);this._changedImages={}}}_updateWorkerLayers(e,t){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(e),removedIds:t})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setTerrain(t){if(this._checkLoaded(),this._terrainDataCallback&&this.off("data",this._terrainDataCallback),this._terrainfreezeElevationCallback&&this.map.off("freezeElevation",this._terrainfreezeElevationCallback),t){const e=this.sourceCaches[t.source];if(!e)throw new Error(`cannot load terrain, because there exists no source with ID: ${t.source}`);this.terrain=new Ze(this,e,t),this.map.transform.updateElevation(this.terrain),this._terrainfreezeElevationCallback=e=>{e.freeze?this.map.transform.freezeElevation=!0:(this.map.transform.freezeElevation=!1,this.map.transform.recalculateZoom(this.terrain))},this._terrainDataCallback=e=>{e.tile&&(e.sourceId===t.source?(this.map.transform.updateElevation(this.terrain),this.terrain.rememberForRerender(e.sourceId,e.tile.tileID)):"geojson"===e.source.type&&this.terrain.rememberForRerender(e.sourceId,e.tile.tileID))},this.on("data",this._terrainDataCallback),this.map.on("freezeElevation",this._terrainfreezeElevationCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.map.transform.updateElevation(this.terrain);this.map.fire(new e.Event("terrain",{terrain:t}))}setState(t){if(this._checkLoaded(),Je(this,e.validateStyle(t)))return!1;(t=e.clone$1(t)).layers=q(t.layers);const r=function(e,t){if(!e)return[{command:X.setStyle,args:[t]}];let r=[];try{if(!i(e.version,t.version))return[{command:X.setStyle,args:[t]}];i(e.center,t.center)||r.push({command:X.setCenter,args:[t.center]}),i(e.zoom,t.zoom)||r.push({command:X.setZoom,args:[t.zoom]}),i(e.bearing,t.bearing)||r.push({command:X.setBearing,args:[t.bearing]}),i(e.pitch,t.pitch)||r.push({command:X.setPitch,args:[t.pitch]}),i(e.sprite,t.sprite)||r.push({command:X.setSprite,args:[t.sprite]}),i(e.glyphs,t.glyphs)||r.push({command:X.setGlyphs,args:[t.glyphs]}),i(e.transition,t.transition)||r.push({command:X.setTransition,args:[t.transition]}),i(e.light,t.light)||r.push({command:X.setLight,args:[t.light]});const n={},A=[];!function(e,t,r,n){let A;for(A in t=t||{},e=e||{})Object.prototype.hasOwnProperty.call(e,A)&&(Object.prototype.hasOwnProperty.call(t,A)||Z(A,r,n));for(A in t)Object.prototype.hasOwnProperty.call(t,A)&&(Object.prototype.hasOwnProperty.call(e,A)?i(e[A],t[A])||("geojson"===e[A].type&&"geojson"===t[A].type&&W(e,t,A)?r.push({command:X.setGeoJSONSourceData,args:[A,t[A].data]}):J(A,t,r,n)):j(A,t,r))}(e.sources,t.sources,A,n);const o=[];e.layers&&e.layers.forEach((e=>{n[e.source]?r.push({command:X.removeLayer,args:[e.id]}):o.push(e)})),r=r.concat(A),function(e,t,r){t=t||[];const n=(e=e||[]).map(ee),A=t.map(ee),o=e.reduce(te,{}),s=t.reduce(te,{}),a=n.slice(),l=Object.create(null);let c,u,h,d,p,f,m;for(c=0,u=0;c<n.length;c++)h=n[c],Object.prototype.hasOwnProperty.call(s,h)?u++:(r.push({command:X.removeLayer,args:[h]}),a.splice(a.indexOf(h,u),1));for(c=0,u=0;c<A.length;c++)h=A[A.length-1-c],a[a.length-1-c]!==h&&(Object.prototype.hasOwnProperty.call(o,h)?(r.push({command:X.removeLayer,args:[h]}),a.splice(a.lastIndexOf(h,a.length-u),1)):u++,f=a[a.length-c],r.push({command:X.addLayer,args:[s[h],f]}),a.splice(a.length-c,0,h),l[h]=!0);for(c=0;c<A.length;c++)if(h=A[c],d=o[h],p=s[h],!l[h]&&!i(d,p))if(i(d.source,p.source)&&i(d["source-layer"],p["source-layer"])&&i(d.type,p.type)){for(m in Y(d.layout,p.layout,r,h,null,X.setLayoutProperty),Y(d.paint,p.paint,r,h,null,X.setPaintProperty),i(d.filter,p.filter)||r.push({command:X.setFilter,args:[h,p.filter]}),i(d.minzoom,p.minzoom)&&i(d.maxzoom,p.maxzoom)||r.push({command:X.setLayerZoomRange,args:[h,p.minzoom,p.maxzoom]}),d)Object.prototype.hasOwnProperty.call(d,m)&&"layout"!==m&&"paint"!==m&&"filter"!==m&&"metadata"!==m&&"minzoom"!==m&&"maxzoom"!==m&&(0===m.indexOf("paint.")?Y(d[m],p[m],r,h,m.slice(6),X.setPaintProperty):i(d[m],p[m])||r.push({command:X.setLayerProperty,args:[h,m,p[m]]}));for(m in p)Object.prototype.hasOwnProperty.call(p,m)&&!Object.prototype.hasOwnProperty.call(d,m)&&"layout"!==m&&"paint"!==m&&"filter"!==m&&"metadata"!==m&&"minzoom"!==m&&"maxzoom"!==m&&(0===m.indexOf("paint.")?Y(d[m],p[m],r,h,m.slice(6),X.setPaintProperty):i(d[m],p[m])||r.push({command:X.setLayerProperty,args:[h,m,p[m]]}))}else r.push({command:X.removeLayer,args:[h]}),f=a[a.lastIndexOf(h)+1],r.push({command:X.addLayer,args:[p,f]})}(o,t.layers,r)}catch(e){console.warn("Unable to compute style diff:",e),r=[{command:X.setStyle,args:[t]}]}return r}(this.serialize(),t).filter((e=>!(e.command in Ye)));if(0===r.length)return!1;const n=r.filter((e=>!(e.command in We)));if(n.length>0)throw new Error(`Unimplemented: ${n.map((e=>e.command)).join(", ")}.`);return r.forEach((e=>{"setTransition"!==e.command&&this[e.command].apply(this,e.args)})),this.stylesheet=t,!0}addImage(t,r){if(this.getImage(t))return this.fire(new e.ErrorEvent(new Error(`An image named "${t}" already exists.`)));this.imageManager.addImage(t,r),this._afterImageUpdated(t)}updateImage(e,t){this.imageManager.updateImage(e,t)}getImage(e){return this.imageManager.getImage(e)}removeImage(t){if(!this.getImage(t))return this.fire(new e.ErrorEvent(new Error(`An image named "${t}" does not exist.`)));this.imageManager.removeImage(t),this._afterImageUpdated(t)}_afterImageUpdated(t){this._availableImages=this.imageManager.listImages(),this._changedImages[t]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new e.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(t,r,n={}){if(this._checkLoaded(),void 0!==this.sourceCaches[t])throw new Error(`Source "${t}" already exists.`);if(!r.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(r).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(r.type)>=0&&this._validate(e.validateStyle.source,`sources.${t}`,r,null,n))return;this.map&&this.map._collectResourceTiming&&(r.collectResourceTiming=!0);const i=this.sourceCaches[t]=new H(t,r,this.dispatcher);i.style=this,i.setEventedParent(this,(()=>({isSourceLoaded:this.loaded(),source:i.serialize(),sourceId:t}))),i.onAdd(this.map),this._changed=!0}removeSource(t){if(this._checkLoaded(),void 0===this.sourceCaches[t])throw new Error("There is no source with this ID");for(const r in this._layers)if(this._layers[r].source===t)return this.fire(new e.ErrorEvent(new Error(`Source "${t}" cannot be removed while layer "${r}" is using it.`)));const r=this.sourceCaches[t];delete this.sourceCaches[t],delete this._updatedSources[t],r.fire(new e.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:t})),r.setEventedParent(null),r.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(e,t){if(this._checkLoaded(),void 0===this.sourceCaches[e])throw new Error(`There is no source with this ID=${e}`);const r=this.sourceCaches[e].getSource();if("geojson"!==r.type)throw new Error(`geojsonSource.type is ${r.type}, which is !== 'geojson`);r.setData(t),this._changed=!0}getSource(e){return this.sourceCaches[e]&&this.sourceCaches[e].getSource()}addLayer(t,r,n={}){this._checkLoaded();const i=t.id;if(this.getLayer(i))return void this.fire(new e.ErrorEvent(new Error(`Layer "${i}" already exists on this map.`)));let A;if("custom"===t.type){if(Je(this,e.validateCustomStyleLayer(t)))return;A=e.createStyleLayer(t)}else{if("object"==typeof t.source&&(this.addSource(i,t.source),t=e.clone$1(t),t=e.extend(t,{source:i})),this._validate(e.validateStyle.layer,`layers.${i}`,t,{arrayIndex:-1},n))return;A=e.createStyleLayer(t),this._validateLayer(A),A.setEventedParent(this,{layer:{id:i}}),this._serializedLayers[A.id]=A.serialize()}const o=r?this._order.indexOf(r):this._order.length;if(r&&-1===o)this.fire(new e.ErrorEvent(new Error(`Cannot add layer "${i}" before non-existing layer "${r}".`)));else{if(this._order.splice(o,0,i),this._layerOrderChanged=!0,this._layers[i]=A,this._removedLayers[i]&&A.source&&"custom"!==A.type){const e=this._removedLayers[i];delete this._removedLayers[i],e.type!==A.type?this._updatedSources[A.source]="clear":(this._updatedSources[A.source]="reload",this.sourceCaches[A.source].pause())}this._updateLayer(A),A.onAdd&&A.onAdd(this.map)}}moveLayer(t,r){if(this._checkLoaded(),this._changed=!0,!this._layers[t])return void this.fire(new e.ErrorEvent(new Error(`The layer '${t}' does not exist in the map's style and cannot be moved.`)));if(t===r)return;const n=this._order.indexOf(t);this._order.splice(n,1);const i=r?this._order.indexOf(r):this._order.length;r&&-1===i?this.fire(new e.ErrorEvent(new Error(`Cannot move layer "${t}" before non-existing layer "${r}".`))):(this._order.splice(i,0,t),this._layerOrderChanged=!0)}removeLayer(t){this._checkLoaded();const r=this._layers[t];if(!r)return void this.fire(new e.ErrorEvent(new Error(`Cannot remove non-existing layer "${t}".`)));r.setEventedParent(null);const n=this._order.indexOf(t);this._order.splice(n,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[t]=r,delete this._layers[t],delete this._serializedLayers[t],delete this._updatedLayers[t],delete this._updatedPaintProps[t],r.onRemove&&r.onRemove(this.map)}getLayer(e){return this._layers[e]}hasLayer(e){return e in this._layers}setLayerZoomRange(t,r,n){this._checkLoaded();const i=this.getLayer(t);i?i.minzoom===r&&i.maxzoom===n||(null!=r&&(i.minzoom=r),null!=n&&(i.maxzoom=n),this._updateLayer(i)):this.fire(new e.ErrorEvent(new Error(`Cannot set the zoom range of non-existing layer "${t}".`)))}setFilter(t,r,n={}){this._checkLoaded();const A=this.getLayer(t);if(A){if(!i(A.filter,r))return null==r?(A.filter=void 0,void this._updateLayer(A)):void(this._validate(e.validateStyle.filter,`layers.${A.id}.filter`,r,null,n)||(A.filter=e.clone$1(r),this._updateLayer(A)))}else this.fire(new e.ErrorEvent(new Error(`Cannot filter non-existing layer "${t}".`)))}getFilter(t){return e.clone$1(this.getLayer(t).filter)}setLayoutProperty(t,r,n,A={}){this._checkLoaded();const o=this.getLayer(t);o?i(o.getLayoutProperty(r),n)||(o.setLayoutProperty(r,n,A),this._updateLayer(o)):this.fire(new e.ErrorEvent(new Error(`Cannot style non-existing layer "${t}".`)))}getLayoutProperty(t,r){const n=this.getLayer(t);if(n)return n.getLayoutProperty(r);this.fire(new e.ErrorEvent(new Error(`Cannot get style of non-existing layer "${t}".`)))}setPaintProperty(t,r,n,A={}){this._checkLoaded();const o=this.getLayer(t);o?i(o.getPaintProperty(r),n)||(o.setPaintProperty(r,n,A)&&this._updateLayer(o),this._changed=!0,this._updatedPaintProps[t]=!0):this.fire(new e.ErrorEvent(new Error(`Cannot style non-existing layer "${t}".`)))}getPaintProperty(e,t){return this.getLayer(e).getPaintProperty(t)}setFeatureState(t,r){this._checkLoaded();const n=t.source,i=t.sourceLayer,A=this.sourceCaches[n];if(void 0===A)return void this.fire(new e.ErrorEvent(new Error(`The source '${n}' does not exist in the map's style.`)));const o=A.getSource().type;"geojson"===o&&i?this.fire(new e.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):"vector"!==o||i?(void 0===t.id&&this.fire(new e.ErrorEvent(new Error("The feature id parameter must be provided."))),A.setFeatureState(i,t.id,r)):this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(t,r){this._checkLoaded();const n=t.source,i=this.sourceCaches[n];if(void 0===i)return void this.fire(new e.ErrorEvent(new Error(`The source '${n}' does not exist in the map's style.`)));const A=i.getSource().type,o="vector"===A?t.sourceLayer:void 0;"vector"!==A||o?r&&"string"!=typeof t.id&&"number"!=typeof t.id?this.fire(new e.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):i.removeFeatureState(o,t.id,r):this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(t){this._checkLoaded();const r=t.source,n=t.sourceLayer,i=this.sourceCaches[r];if(void 0!==i)return"vector"!==i.getSource().type||n?(void 0===t.id&&this.fire(new e.ErrorEvent(new Error("The feature id parameter must be provided."))),i.getFeatureState(n,t.id)):void this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new e.ErrorEvent(new Error(`The source '${r}' does not exist in the map's style.`)))}getTransition(){return e.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){return e.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:e.mapObject(this.sourceCaches,(e=>e.serialize())),layers:this._serializeLayers(this._order)},(e=>void 0!==e))}_updateLayer(e){this._updatedLayers[e.id]=!0,e.source&&!this._updatedSources[e.source]&&"raster"!==this.sourceCaches[e.source].getSource().type&&(this._updatedSources[e.source]="reload",this.sourceCaches[e.source].pause()),this._changed=!0}_flattenAndSortRenderedFeatures(e){const t=e=>"fill-extrusion"===this._layers[e].type,r={},n=[];for(let i=this._order.length-1;i>=0;i--){const A=this._order[i];if(t(A)){r[A]=i;for(const t of e){const e=t[A];if(e)for(const t of e)n.push(t)}}}n.sort(((e,t)=>t.intersectionZ-e.intersectionZ));const i=[];for(let A=this._order.length-1;A>=0;A--){const o=this._order[A];if(t(o))for(let e=n.length-1;e>=0;e--){const t=n[e].feature;if(r[t.layer.id]<A)break;i.push(t),n.pop()}else for(const t of e){const e=t[o];if(e)for(const t of e)i.push(t.feature)}}return i}queryRenderedFeatures(t,r,n){r&&r.filter&&this._validate(e.validateStyle.filter,"queryRenderedFeatures.filter",r.filter,null,r);const i={};if(r&&r.layers){if(!Array.isArray(r.layers))return this.fire(new e.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const t of r.layers){const r=this._layers[t];if(!r)return this.fire(new e.ErrorEvent(new Error(`The layer '${t}' does not exist in the map's style and cannot be queried for features.`))),[];i[r.source]=!0}}const A=[];r.availableImages=this._availableImages;for(const e in this.sourceCaches)r.layers&&!i[e]||A.push(M(this.sourceCaches[e],this._layers,this._serializedLayers,t,r,n));return this.placement&&A.push(function(e,t,r,n,i,A,o){const s={},a=A.queryRenderedSymbols(n),l=[];for(const e of Object.keys(a).map(Number))l.push(o[e]);l.sort(k);for(const r of l){const n=r.featureIndex.lookupSymbolFeatures(a[r.bucketInstanceId],t,r.bucketIndex,r.sourceLayerIndex,i.filter,i.layers,i.availableImages,e);for(const e in n){const t=s[e]=s[e]||[],i=n[e];i.sort(((e,t)=>{const n=r.featureSortOrder;if(n){const r=n.indexOf(e.featureIndex);return n.indexOf(t.featureIndex)-r}return t.featureIndex-e.featureIndex}));for(const e of i)t.push(e)}}for(const t in s)s[t].forEach((n=>{const i=n.feature,A=r[e[t].source].getFeatureState(i.layer["source-layer"],i.id);i.source=i.layer.source,i.layer["source-layer"]&&(i.sourceLayer=i.layer["source-layer"]),i.state=A}));return s}(this._layers,this._serializedLayers,this.sourceCaches,t,r,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(A)}querySourceFeatures(t,r){r&&r.filter&&this._validate(e.validateStyle.filter,"querySourceFeatures.filter",r.filter,null,r);const n=this.sourceCaches[t];return n?function(e,t){const r=e.getRenderableIds().map((t=>e.getTileByID(t))),n=[],i={};for(let e=0;e<r.length;e++){const A=r[e],o=A.tileID.canonical.key;i[o]||(i[o]=!0,A.querySourceFeatures(n,t))}return n}(n,r):[]}addSourceType(e,t,r){return tt.getSourceType(e)?r(new Error(`A source type called "${e}" already exists.`)):(tt.setSourceType(e,t),t.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:e,url:t.workerSourceURL},r):r(null,null))}getLight(){return this.light.getLight()}setLight(t,r={}){this._checkLoaded();const n=this.light.getLight();let A=!1;for(const e in t)if(!i(t[e],n[e])){A=!0;break}if(!A)return;const o={now:e.exported.now(),transition:e.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(t,r),this.light.updateTransitions(o)}_validate(t,r,n,i,A={}){return(!A||!1!==A.validate)&&Je(this,t.call(e.validateStyle,e.extend({key:r,style:this.serialize(),value:n,styleSpec:e.spec},i)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),e.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const e in this._layers)this._layers[e].setEventedParent(null);for(const e in this.sourceCaches){const t=this.sourceCaches[e];t.setEventedParent(null),t.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(e){this.sourceCaches[e].clearTiles()}_reloadSource(e){this.sourceCaches[e].resume(),this.sourceCaches[e].reload()}_updateSources(e){for(const t in this.sourceCaches)this.sourceCaches[t].update(e,this.terrain)}_generateCollisionBoxes(){for(const e in this.sourceCaches)this._reloadSource(e)}_updatePlacement(t,r,n,i,A=!1){let o=!1,s=!1;const a={};for(const e of this._order){const r=this._layers[e];if("symbol"!==r.type)continue;if(!a[r.source]){const e=this.sourceCaches[r.source];a[r.source]=e.getRenderableIds(!0).map((t=>e.getTileByID(t))).sort(((e,t)=>t.tileID.overscaledZ-e.tileID.overscaledZ||(e.tileID.isLessThan(t.tileID)?-1:1)))}const n=this.crossTileSymbolIndex.addLayer(r,a[r.source],t.center.lng);o=o||n}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((A=A||this._layerOrderChanged||0===n)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(e.exported.now(),t.zoom))&&(this.pauseablePlacement=new Ke(t,this.terrain,this._order,A,r,n,i,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,a),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(e.exported.now()),s=!0),o&&this.pauseablePlacement.placement.setStale()),s||o)for(const e of this._order){const t=this._layers[e];"symbol"===t.type&&this.placement.updateLayerOpacities(t,a[t.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(e.exported.now())}_releaseSymbolFadeTiles(){for(const e in this.sourceCaches)this.sourceCaches[e].releaseSymbolFadeTiles()}getImages(e,t,r){this.imageManager.getImages(t.icons,r),this._updateTilesForChangedImages();const n=this.sourceCaches[t.source];n&&n.setDependencies(t.tileID.key,t.type,t.icons)}getGlyphs(e,t,r){this.glyphManager.getGlyphs(t.stacks,r)}getResource(t,r,n){return e.makeRequest(r,n)}}tt.getSourceType=function(e){return T[e]},tt.setSourceType=function(e,t){T[e]=t},tt.registerForPluginStateChange=e.registerForPluginStateChange;var rt="attribute vec2 a_pos;uniform mat4 u_matrix;varying vec2 v_texture_pos;varying float v_depth;void main() {v_texture_pos=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);v_depth=gl_Position.z/gl_Position.w;}";const nt={prelude:it("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}\n#ifdef TERRAIN3D\nuniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_offset;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;\n#endif\nconst highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {\n#ifdef TERRAIN3D\nhighp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));\n#else\nreturn 1.0;\n#endif\n}float calculate_visibility(vec4 pos) {\n#ifdef TERRAIN3D\nvec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;\n#else\nreturn 1.0;\n#endif\n}float ele(vec2 pos) {\n#ifdef TERRAIN3D\nvec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;\n#else\nreturn 0.0;\n#endif\n}float get_elevation(vec2 pos) {\n#ifdef TERRAIN3D\nvec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return (elevation+u_terrain_offset)*u_terrain_exaggeration;\n#else\nreturn 0.0;\n#endif\n}"),background:it("uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:it("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:it("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),clippingMask:it("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:it("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}"),heatmapTexture:it("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:it("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:it("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:it("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:it("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}"),fillOutline:it("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),fillOutlinePattern:it("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),fillPattern:it("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),fillExtrusion:it("varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;\n#ifdef TERRAIN3D\nattribute vec2 a_centroid;\n#endif\nvarying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;\n#ifdef TERRAIN3D\nfloat baseDelta=10.0;float ele=get_elevation(a_centroid);\n#else\nfloat baseDelta=0.0;float ele=0.0;\n#endif\nbase=max(0.0,ele+base-baseDelta);height=max(0.0,ele+height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"),fillExtrusionPattern:it("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;\n#ifdef TERRAIN3D\nattribute vec2 a_centroid;\n#endif\nvarying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;\n#ifdef TERRAIN3D\nfloat baseDelta=10.0;float ele=get_elevation(a_centroid);\n#else\nfloat baseDelta=0.0;float ele=0.0;\n#endif\nbase=max(0.0,ele+base-baseDelta);height=max(0.0,ele+height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"),hillshadePrepare:it("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:it("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;\n#define PI 3.141592653589793\nvoid main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:it("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_width2=vec2(outset,inset);}"),lineGradient:it("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_width2=vec2(outset,inset);}"),linePattern:it("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}"),lineSDF:it("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"),raster:it("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:it("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}"),symbolSDF:it("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),symbolTextAndIcon:it("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}"),terrain:it("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",rt),terrainDepth:it("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",rt),terrainCoords:it("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",rt)};function it(e,t){const r=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,n=t.match(/attribute ([\w]+) ([\w]+)/g),i=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),A=t.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),o=A?A.concat(i):i,s={};return{fragmentSource:e=e.replace(r,((e,t,r,n,i)=>(s[i]=!0,"define"===t?`\n#ifndef HAS_UNIFORM_u_${i}\nvarying ${r} ${n} ${i};\n#else\nuniform ${r} ${n} u_${i};\n#endif\n`:`\n#ifdef HAS_UNIFORM_u_${i}\n    ${r} ${n} ${i} = u_${i};\n#endif\n`))),vertexSource:t=t.replace(r,((e,t,r,n,i)=>{const A="float"===n?"vec2":"vec4",o=i.match(/color/)?"color":A;return s[i]?"define"===t?`\n#ifndef HAS_UNIFORM_u_${i}\nuniform lowp float u_${i}_t;\nattribute ${r} ${A} a_${i};\nvarying ${r} ${n} ${i};\n#else\nuniform ${r} ${n} u_${i};\n#endif\n`:"vec4"===o?`\n#ifndef HAS_UNIFORM_u_${i}\n    ${i} = a_${i};\n#else\n    ${r} ${n} ${i} = u_${i};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${i}\n    ${i} = unpack_mix_${o}(a_${i}, u_${i}_t);\n#else\n    ${r} ${n} ${i} = u_${i};\n#endif\n`:"define"===t?`\n#ifndef HAS_UNIFORM_u_${i}\nuniform lowp float u_${i}_t;\nattribute ${r} ${A} a_${i};\n#else\nuniform ${r} ${n} u_${i};\n#endif\n`:"vec4"===o?`\n#ifndef HAS_UNIFORM_u_${i}\n    ${r} ${n} ${i} = a_${i};\n#else\n    ${r} ${n} ${i} = u_${i};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${i}\n    ${r} ${n} ${i} = unpack_mix_${o}(a_${i}, u_${i}_t);\n#else\n    ${r} ${n} ${i} = u_${i};\n#endif\n`})),staticAttributes:n,staticUniforms:o}}class At{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(e,t,r,n,i,A,o,s,a){this.context=e;let l=this.boundPaintVertexBuffers.length!==n.length;for(let e=0;!l&&e<n.length;e++)this.boundPaintVertexBuffers[e]!==n[e]&&(l=!0);e.extVertexArrayObject&&this.vao&&this.boundProgram===t&&this.boundLayoutVertexBuffer===r&&!l&&this.boundIndexBuffer===i&&this.boundVertexOffset===A&&this.boundDynamicVertexBuffer===o&&this.boundDynamicVertexBuffer2===s&&this.boundDynamicVertexBuffer3===a?(e.bindVertexArrayOES.set(this.vao),o&&o.bind(),i&&i.dynamicDraw&&i.bind(),s&&s.bind(),a&&a.bind()):this.freshBind(t,r,n,i,A,o,s,a)}freshBind(e,t,r,n,i,A,o,s){let a;const l=e.numAttributes,c=this.context,u=c.gl;if(c.extVertexArrayObject)this.vao&&this.destroy(),this.vao=c.extVertexArrayObject.createVertexArrayOES(),c.bindVertexArrayOES.set(this.vao),a=0,this.boundProgram=e,this.boundLayoutVertexBuffer=t,this.boundPaintVertexBuffers=r,this.boundIndexBuffer=n,this.boundVertexOffset=i,this.boundDynamicVertexBuffer=A,this.boundDynamicVertexBuffer2=o,this.boundDynamicVertexBuffer3=s;else{a=c.currentNumAttributes||0;for(let e=l;e<a;e++)u.disableVertexAttribArray(e)}t.enableAttributes(u,e);for(const t of r)t.enableAttributes(u,e);A&&A.enableAttributes(u,e),o&&o.enableAttributes(u,e),s&&s.enableAttributes(u,e),t.bind(),t.setVertexAttribPointers(u,e,i);for(const t of r)t.bind(),t.setVertexAttribPointers(u,e,i);A&&(A.bind(),A.setVertexAttribPointers(u,e,i)),n&&n.bind(),o&&(o.bind(),o.setVertexAttribPointers(u,e,i)),s&&(s.bind(),s.setVertexAttribPointers(u,e,i)),c.currentNumAttributes=l}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function ot(e){const t=[];for(let r=0;r<e.length;r++){if(null===e[r])continue;const n=e[r].split(" ");t.push(n.pop())}return t}class st{constructor(t,r,n,i,A,o,s){const a=t.gl;this.program=a.createProgram();const l=ot(n.staticAttributes),c=i?i.getBinderAttributes():[],u=l.concat(c),h=nt.prelude.staticUniforms?ot(nt.prelude.staticUniforms):[],d=n.staticUniforms?ot(n.staticUniforms):[],p=i?i.getBinderUniforms():[],f=h.concat(d).concat(p),m=[];for(const e of f)m.indexOf(e)<0&&m.push(e);const g=i?i.defines():[];o&&g.push("#define OVERDRAW_INSPECTOR;"),s&&g.push("#define TERRAIN3D;");const y=g.concat(nt.prelude.fragmentSource,n.fragmentSource).join("\n"),_=g.concat(nt.prelude.vertexSource,n.vertexSource).join("\n"),w=a.createShader(a.FRAGMENT_SHADER);if(a.isContextLost())return void(this.failedToCreate=!0);a.shaderSource(w,y),a.compileShader(w),a.attachShader(this.program,w);const x=a.createShader(a.VERTEX_SHADER);if(a.isContextLost())return void(this.failedToCreate=!0);a.shaderSource(x,_),a.compileShader(x),a.attachShader(this.program,x),this.attributes={};const B={};this.numAttributes=u.length;for(let e=0;e<this.numAttributes;e++)u[e]&&(a.bindAttribLocation(this.program,e,u[e]),this.attributes[u[e]]=e);a.linkProgram(this.program),a.deleteShader(x),a.deleteShader(w);for(let e=0;e<m.length;e++){const t=m[e];if(t&&!B[t]){const e=a.getUniformLocation(this.program,t);e&&(B[t]=e)}}this.fixedUniforms=A(t,B),this.terrainUniforms=((t,r)=>({u_depth:new e.Uniform1i(t,r.u_depth),u_terrain:new e.Uniform1i(t,r.u_terrain),u_terrain_dim:new e.Uniform1f(t,r.u_terrain_dim),u_terrain_matrix:new e.UniformMatrix4f(t,r.u_terrain_matrix),u_terrain_unpack:new e.Uniform4f(t,r.u_terrain_unpack),u_terrain_offset:new e.Uniform1f(t,r.u_terrain_offset),u_terrain_exaggeration:new e.Uniform1f(t,r.u_terrain_exaggeration)}))(t,B),this.binderUniforms=i?i.getUniforms(t,B):[]}draw(e,t,r,n,i,A,o,s,a,l,c,u,h,d,p,f,m,g){const y=e.gl;if(this.failedToCreate)return;if(e.program.set(this.program),e.setDepthMode(r),e.setStencilMode(n),e.setColorMode(i),e.setCullFace(A),s){e.activeTexture.set(y.TEXTURE2),y.bindTexture(y.TEXTURE_2D,s.depthTexture),e.activeTexture.set(y.TEXTURE3),y.bindTexture(y.TEXTURE_2D,s.texture);for(const e in this.terrainUniforms)this.terrainUniforms[e].set(s[e])}for(const e in this.fixedUniforms)this.fixedUniforms[e].set(o[e]);p&&p.setUniforms(e,this.binderUniforms,h,{zoom:d});let _=0;switch(t){case y.LINES:_=2;break;case y.TRIANGLES:_=3;break;case y.LINE_STRIP:_=1}for(const r of u.get()){const n=r.vaos||(r.vaos={});(n[a]||(n[a]=new At)).bind(e,this,l,p?p.getPaintVertexBuffers():[],c,r.vertexOffset,f,m,g),y.drawElements(t,r.primitiveLength*_,y.UNSIGNED_SHORT,r.primitiveOffset*_*2)}}}function at(e,t,r){const n=1/xe(r,1,t.transform.tileZoom),i=Math.pow(2,r.tileID.overscaledZ),A=r.tileSize*Math.pow(2,t.transform.tileZoom)/i,o=A*(r.tileID.canonical.x+r.tileID.wrap*i),s=A*r.tileID.canonical.y;return{u_image:0,u_texsize:r.imageAtlasTexture.size,u_scale:[n,e.fromScale,e.toScale],u_fade:e.t,u_pixel_coord_upper:[o>>16,s>>16],u_pixel_coord_lower:[65535&o,65535&s]}}const lt=(t,r,n,i)=>{const A=r.style.light,o=A.properties.get("position"),s=[o.x,o.y,o.z],a=e.create$1();"viewport"===A.properties.get("anchor")&&e.fromRotation(a,-r.transform.angle),e.transformMat3(s,s,a);const l=A.properties.get("color");return{u_matrix:t,u_lightpos:s,u_lightintensity:A.properties.get("intensity"),u_lightcolor:[l.r,l.g,l.b],u_vertical_gradient:+n,u_opacity:i}},ct=(t,r,n,i,A,o,s)=>e.extend(lt(t,r,n,i),at(o,r,s),{u_height_factor:-Math.pow(2,A.overscaledZ)/s.tileSize/8}),ut=e=>({u_matrix:e}),ht=(t,r,n,i)=>e.extend(ut(t),at(n,r,i)),dt=(e,t)=>({u_matrix:e,u_world:t}),pt=(t,r,n,i,A)=>e.extend(ht(t,r,n,i),{u_world:A}),ft=(e,t,r,n)=>{const i=e.transform;let A,o;if("map"===n.paint.get("circle-pitch-alignment")){const e=xe(r,1,i.zoom);A=!0,o=[e,e]}else A=!1,o=i.pixelsToGLUnits;return{u_camera_to_center_distance:i.cameraToCenterDistance,u_scale_with_map:+("map"===n.paint.get("circle-pitch-scale")),u_matrix:e.translatePosMatrix(t.posMatrix,r,n.paint.get("circle-translate"),n.paint.get("circle-translate-anchor")),u_pitch_with_map:+A,u_device_pixel_ratio:e.pixelRatio,u_extrude_scale:o}},mt=(e,t,r)=>{const n=xe(r,1,t.zoom),i=Math.pow(2,t.zoom-r.tileID.overscaledZ),A=r.tileID.overscaleFactor();return{u_matrix:e,u_camera_to_center_distance:t.cameraToCenterDistance,u_pixels_to_tile_units:n,u_extrude_scale:[t.pixelsToGLUnits[0]/(n*i),t.pixelsToGLUnits[1]/(n*i)],u_overscale_factor:A}},gt=(e,t,r=1)=>({u_matrix:e,u_color:t,u_overlay:0,u_overlay_scale:r}),yt=e=>({u_matrix:e}),_t=(e,t,r,n)=>({u_matrix:e,u_extrude_scale:xe(t,1,r),u_intensity:n});function wt(t,r){const n=Math.pow(2,r.canonical.z),i=r.canonical.y;return[new e.MercatorCoordinate(0,i/n).toLngLat().lat,new e.MercatorCoordinate(0,(i+1)/n).toLngLat().lat]}const xt=(e,t,r,n)=>{const i=e.transform;return{u_matrix:Ft(e,t,r,n),u_ratio:1/xe(t,1,i.zoom),u_device_pixel_ratio:e.pixelRatio,u_units_to_pixels:[1/i.pixelsToGLUnits[0],1/i.pixelsToGLUnits[1]]}},Bt=(t,r,n,i,A)=>e.extend(xt(t,r,n,A),{u_image:0,u_image_height:i}),vt=(e,t,r,n,i)=>{const A=e.transform,o=Ct(t,A);return{u_matrix:Ft(e,t,r,i),u_texsize:t.imageAtlasTexture.size,u_ratio:1/xe(t,1,A.zoom),u_device_pixel_ratio:e.pixelRatio,u_image:0,u_scale:[o,n.fromScale,n.toScale],u_fade:n.t,u_units_to_pixels:[1/A.pixelsToGLUnits[0],1/A.pixelsToGLUnits[1]]}},bt=(t,r,n,i,A,o)=>{const s=t.lineAtlas,a=Ct(r,t.transform),l="round"===n.layout.get("line-cap"),c=s.getDash(i.from,l),u=s.getDash(i.to,l),h=c.width*A.fromScale,d=u.width*A.toScale;return e.extend(xt(t,r,n,o),{u_patternscale_a:[a/h,-c.height/2],u_patternscale_b:[a/d,-u.height/2],u_sdfgamma:s.width/(256*Math.min(h,d)*t.pixelRatio)/2,u_image:0,u_tex_y_a:c.y,u_tex_y_b:u.y,u_mix:A.t})};function Ct(e,t){return 1/xe(e,1,t.tileZoom)}function Ft(e,t,r,n){return e.translatePosMatrix(n?n.posMatrix:t.tileID.posMatrix,t,r.paint.get("line-translate"),r.paint.get("line-translate-anchor"))}const Et=(e,t,r,n,i)=>{return{u_matrix:e,u_tl_parent:t,u_scale_parent:r,u_buffer_scale:1,u_fade_t:n.mix,u_opacity:n.opacity*i.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:i.paint.get("raster-brightness-min"),u_brightness_high:i.paint.get("raster-brightness-max"),u_saturation_factor:(o=i.paint.get("raster-saturation"),o>0?1-1/(1.001-o):-o),u_contrast_factor:(A=i.paint.get("raster-contrast"),A>0?1/(1-A):1+A),u_spin_weights:Ut(i.paint.get("raster-hue-rotate"))};var A,o};function Ut(e){e*=Math.PI/180;const t=Math.sin(e),r=Math.cos(e);return[(2*r+1)/3,(-Math.sqrt(3)*t-r+1)/3,(Math.sqrt(3)*t-r+1)/3]}const Qt=(e,t,r,n,i,A,o,s,a,l)=>{const c=i.transform;return{u_is_size_zoom_constant:+("constant"===e||"source"===e),u_is_size_feature_constant:+("constant"===e||"camera"===e),u_size_t:t?t.uSizeT:0,u_size:t?t.uSize:0,u_camera_to_center_distance:c.cameraToCenterDistance,u_pitch:c.pitch/360*2*Math.PI,u_rotate_symbol:+r,u_aspect_ratio:c.width/c.height,u_fade_change:i.options.fadeDuration?i.symbolFadeChange:1,u_matrix:A,u_label_plane_matrix:o,u_coord_matrix:s,u_is_text:+a,u_pitch_with_map:+n,u_texsize:l,u_texture:0}},It=(t,r,n,i,A,o,s,a,l,c,u)=>{const h=A.transform;return e.extend(Qt(t,r,n,i,A,o,s,a,l,c),{u_gamma_scale:i?Math.cos(h._pitch)*h.cameraToCenterDistance:1,u_device_pixel_ratio:A.pixelRatio,u_is_halo:+u})},Tt=(t,r,n,i,A,o,s,a,l,c)=>e.extend(It(t,r,n,i,A,o,s,a,!0,l,!0),{u_texsize_icon:c,u_texture_icon:1}),St=(e,t,r)=>({u_matrix:e,u_opacity:t,u_color:r}),Mt=(t,r,n,i,A,o)=>e.extend(function(e,t,r,n){const i=r.imageManager.getPattern(e.from.toString()),A=r.imageManager.getPattern(e.to.toString()),{width:o,height:s}=r.imageManager.getPixelSize(),a=Math.pow(2,n.tileID.overscaledZ),l=n.tileSize*Math.pow(2,r.transform.tileZoom)/a,c=l*(n.tileID.canonical.x+n.tileID.wrap*a),u=l*n.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:i.tl,u_pattern_br_a:i.br,u_pattern_tl_b:A.tl,u_pattern_br_b:A.br,u_texsize:[o,s],u_mix:t.t,u_pattern_size_a:i.displaySize,u_pattern_size_b:A.displaySize,u_scale_a:t.fromScale,u_scale_b:t.toScale,u_tile_units_to_pixels:1/xe(n,1,r.transform.tileZoom),u_pixel_coord_upper:[c>>16,u>>16],u_pixel_coord_lower:[65535&c,65535&u]}}(i,o,n,A),{u_matrix:t,u_opacity:r}),kt={fillExtrusion:(t,r)=>({u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_lightpos:new e.Uniform3f(t,r.u_lightpos),u_lightintensity:new e.Uniform1f(t,r.u_lightintensity),u_lightcolor:new e.Uniform3f(t,r.u_lightcolor),u_vertical_gradient:new e.Uniform1f(t,r.u_vertical_gradient),u_opacity:new e.Uniform1f(t,r.u_opacity)}),fillExtrusionPattern:(t,r)=>({u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_lightpos:new e.Uniform3f(t,r.u_lightpos),u_lightintensity:new e.Uniform1f(t,r.u_lightintensity),u_lightcolor:new e.Uniform3f(t,r.u_lightcolor),u_vertical_gradient:new e.Uniform1f(t,r.u_vertical_gradient),u_height_factor:new e.Uniform1f(t,r.u_height_factor),u_image:new e.Uniform1i(t,r.u_image),u_texsize:new e.Uniform2f(t,r.u_texsize),u_pixel_coord_upper:new e.Uniform2f(t,r.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(t,r.u_pixel_coord_lower),u_scale:new e.Uniform3f(t,r.u_scale),u_fade:new e.Uniform1f(t,r.u_fade),u_opacity:new e.Uniform1f(t,r.u_opacity)}),fill:(t,r)=>({u_matrix:new e.UniformMatrix4f(t,r.u_matrix)}),fillPattern:(t,r)=>({u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_image:new e.Uniform1i(t,r.u_image),u_texsize:new e.Uniform2f(t,r.u_texsize),u_pixel_coord_upper:new e.Uniform2f(t,r.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(t,r.u_pixel_coord_lower),u_scale:new e.Uniform3f(t,r.u_scale),u_fade:new e.Uniform1f(t,r.u_fade)}),fillOutline:(t,r)=>({u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_world:new e.Uniform2f(t,r.u_world)}),fillOutlinePattern:(t,r)=>({u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_world:new e.Uniform2f(t,r.u_world),u_image:new e.Uniform1i(t,r.u_image),u_texsize:new e.Uniform2f(t,r.u_texsize),u_pixel_coord_upper:new e.Uniform2f(t,r.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(t,r.u_pixel_coord_lower),u_scale:new e.Uniform3f(t,r.u_scale),u_fade:new e.Uniform1f(t,r.u_fade)}),circle:(t,r)=>({u_camera_to_center_distance:new e.Uniform1f(t,r.u_camera_to_center_distance),u_scale_with_map:new e.Uniform1i(t,r.u_scale_with_map),u_pitch_with_map:new e.Uniform1i(t,r.u_pitch_with_map),u_extrude_scale:new e.Uniform2f(t,r.u_extrude_scale),u_device_pixel_ratio:new e.Uniform1f(t,r.u_device_pixel_ratio),u_matrix:new e.UniformMatrix4f(t,r.u_matrix)}),collisionBox:(t,r)=>({u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_camera_to_center_distance:new e.Uniform1f(t,r.u_camera_to_center_distance),u_pixels_to_tile_units:new e.Uniform1f(t,r.u_pixels_to_tile_units),u_extrude_scale:new e.Uniform2f(t,r.u_extrude_scale),u_overscale_factor:new e.Uniform1f(t,r.u_overscale_factor)}),collisionCircle:(t,r)=>({u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_inv_matrix:new e.UniformMatrix4f(t,r.u_inv_matrix),u_camera_to_center_distance:new e.Uniform1f(t,r.u_camera_to_center_distance),u_viewport_size:new e.Uniform2f(t,r.u_viewport_size)}),debug:(t,r)=>({u_color:new e.UniformColor(t,r.u_color),u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_overlay:new e.Uniform1i(t,r.u_overlay),u_overlay_scale:new e.Uniform1f(t,r.u_overlay_scale)}),clippingMask:(t,r)=>({u_matrix:new e.UniformMatrix4f(t,r.u_matrix)}),heatmap:(t,r)=>({u_extrude_scale:new e.Uniform1f(t,r.u_extrude_scale),u_intensity:new e.Uniform1f(t,r.u_intensity),u_matrix:new e.UniformMatrix4f(t,r.u_matrix)}),heatmapTexture:(t,r)=>({u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_world:new e.Uniform2f(t,r.u_world),u_image:new e.Uniform1i(t,r.u_image),u_color_ramp:new e.Uniform1i(t,r.u_color_ramp),u_opacity:new e.Uniform1f(t,r.u_opacity)}),hillshade:(t,r)=>({u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_image:new e.Uniform1i(t,r.u_image),u_latrange:new e.Uniform2f(t,r.u_latrange),u_light:new e.Uniform2f(t,r.u_light),u_shadow:new e.UniformColor(t,r.u_shadow),u_highlight:new e.UniformColor(t,r.u_highlight),u_accent:new e.UniformColor(t,r.u_accent)}),hillshadePrepare:(t,r)=>({u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_image:new e.Uniform1i(t,r.u_image),u_dimension:new e.Uniform2f(t,r.u_dimension),u_zoom:new e.Uniform1f(t,r.u_zoom),u_unpack:new e.Uniform4f(t,r.u_unpack)}),line:(t,r)=>({u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_ratio:new e.Uniform1f(t,r.u_ratio),u_device_pixel_ratio:new e.Uniform1f(t,r.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(t,r.u_units_to_pixels)}),lineGradient:(t,r)=>({u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_ratio:new e.Uniform1f(t,r.u_ratio),u_device_pixel_ratio:new e.Uniform1f(t,r.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(t,r.u_units_to_pixels),u_image:new e.Uniform1i(t,r.u_image),u_image_height:new e.Uniform1f(t,r.u_image_height)}),linePattern:(t,r)=>({u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_texsize:new e.Uniform2f(t,r.u_texsize),u_ratio:new e.Uniform1f(t,r.u_ratio),u_device_pixel_ratio:new e.Uniform1f(t,r.u_device_pixel_ratio),u_image:new e.Uniform1i(t,r.u_image),u_units_to_pixels:new e.Uniform2f(t,r.u_units_to_pixels),u_scale:new e.Uniform3f(t,r.u_scale),u_fade:new e.Uniform1f(t,r.u_fade)}),lineSDF:(t,r)=>({u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_ratio:new e.Uniform1f(t,r.u_ratio),u_device_pixel_ratio:new e.Uniform1f(t,r.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(t,r.u_units_to_pixels),u_patternscale_a:new e.Uniform2f(t,r.u_patternscale_a),u_patternscale_b:new e.Uniform2f(t,r.u_patternscale_b),u_sdfgamma:new e.Uniform1f(t,r.u_sdfgamma),u_image:new e.Uniform1i(t,r.u_image),u_tex_y_a:new e.Uniform1f(t,r.u_tex_y_a),u_tex_y_b:new e.Uniform1f(t,r.u_tex_y_b),u_mix:new e.Uniform1f(t,r.u_mix)}),raster:(t,r)=>({u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_tl_parent:new e.Uniform2f(t,r.u_tl_parent),u_scale_parent:new e.Uniform1f(t,r.u_scale_parent),u_buffer_scale:new e.Uniform1f(t,r.u_buffer_scale),u_fade_t:new e.Uniform1f(t,r.u_fade_t),u_opacity:new e.Uniform1f(t,r.u_opacity),u_image0:new e.Uniform1i(t,r.u_image0),u_image1:new e.Uniform1i(t,r.u_image1),u_brightness_low:new e.Uniform1f(t,r.u_brightness_low),u_brightness_high:new e.Uniform1f(t,r.u_brightness_high),u_saturation_factor:new e.Uniform1f(t,r.u_saturation_factor),u_contrast_factor:new e.Uniform1f(t,r.u_contrast_factor),u_spin_weights:new e.Uniform3f(t,r.u_spin_weights)}),symbolIcon:(t,r)=>({u_is_size_zoom_constant:new e.Uniform1i(t,r.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(t,r.u_is_size_feature_constant),u_size_t:new e.Uniform1f(t,r.u_size_t),u_size:new e.Uniform1f(t,r.u_size),u_camera_to_center_distance:new e.Uniform1f(t,r.u_camera_to_center_distance),u_pitch:new e.Uniform1f(t,r.u_pitch),u_rotate_symbol:new e.Uniform1i(t,r.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(t,r.u_aspect_ratio),u_fade_change:new e.Uniform1f(t,r.u_fade_change),u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(t,r.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(t,r.u_coord_matrix),u_is_text:new e.Uniform1i(t,r.u_is_text),u_pitch_with_map:new e.Uniform1i(t,r.u_pitch_with_map),u_texsize:new e.Uniform2f(t,r.u_texsize),u_texture:new e.Uniform1i(t,r.u_texture)}),symbolSDF:(t,r)=>({u_is_size_zoom_constant:new e.Uniform1i(t,r.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(t,r.u_is_size_feature_constant),u_size_t:new e.Uniform1f(t,r.u_size_t),u_size:new e.Uniform1f(t,r.u_size),u_camera_to_center_distance:new e.Uniform1f(t,r.u_camera_to_center_distance),u_pitch:new e.Uniform1f(t,r.u_pitch),u_rotate_symbol:new e.Uniform1i(t,r.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(t,r.u_aspect_ratio),u_fade_change:new e.Uniform1f(t,r.u_fade_change),u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(t,r.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(t,r.u_coord_matrix),u_is_text:new e.Uniform1i(t,r.u_is_text),u_pitch_with_map:new e.Uniform1i(t,r.u_pitch_with_map),u_texsize:new e.Uniform2f(t,r.u_texsize),u_texture:new e.Uniform1i(t,r.u_texture),u_gamma_scale:new e.Uniform1f(t,r.u_gamma_scale),u_device_pixel_ratio:new e.Uniform1f(t,r.u_device_pixel_ratio),u_is_halo:new e.Uniform1i(t,r.u_is_halo)}),symbolTextAndIcon:(t,r)=>({u_is_size_zoom_constant:new e.Uniform1i(t,r.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(t,r.u_is_size_feature_constant),u_size_t:new e.Uniform1f(t,r.u_size_t),u_size:new e.Uniform1f(t,r.u_size),u_camera_to_center_distance:new e.Uniform1f(t,r.u_camera_to_center_distance),u_pitch:new e.Uniform1f(t,r.u_pitch),u_rotate_symbol:new e.Uniform1i(t,r.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(t,r.u_aspect_ratio),u_fade_change:new e.Uniform1f(t,r.u_fade_change),u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(t,r.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(t,r.u_coord_matrix),u_is_text:new e.Uniform1i(t,r.u_is_text),u_pitch_with_map:new e.Uniform1i(t,r.u_pitch_with_map),u_texsize:new e.Uniform2f(t,r.u_texsize),u_texsize_icon:new e.Uniform2f(t,r.u_texsize_icon),u_texture:new e.Uniform1i(t,r.u_texture),u_texture_icon:new e.Uniform1i(t,r.u_texture_icon),u_gamma_scale:new e.Uniform1f(t,r.u_gamma_scale),u_device_pixel_ratio:new e.Uniform1f(t,r.u_device_pixel_ratio),u_is_halo:new e.Uniform1i(t,r.u_is_halo)}),background:(t,r)=>({u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_opacity:new e.Uniform1f(t,r.u_opacity),u_color:new e.UniformColor(t,r.u_color)}),backgroundPattern:(t,r)=>({u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_opacity:new e.Uniform1f(t,r.u_opacity),u_image:new e.Uniform1i(t,r.u_image),u_pattern_tl_a:new e.Uniform2f(t,r.u_pattern_tl_a),u_pattern_br_a:new e.Uniform2f(t,r.u_pattern_br_a),u_pattern_tl_b:new e.Uniform2f(t,r.u_pattern_tl_b),u_pattern_br_b:new e.Uniform2f(t,r.u_pattern_br_b),u_texsize:new e.Uniform2f(t,r.u_texsize),u_mix:new e.Uniform1f(t,r.u_mix),u_pattern_size_a:new e.Uniform2f(t,r.u_pattern_size_a),u_pattern_size_b:new e.Uniform2f(t,r.u_pattern_size_b),u_scale_a:new e.Uniform1f(t,r.u_scale_a),u_scale_b:new e.Uniform1f(t,r.u_scale_b),u_pixel_coord_upper:new e.Uniform2f(t,r.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(t,r.u_pixel_coord_lower),u_tile_units_to_pixels:new e.Uniform1f(t,r.u_tile_units_to_pixels)}),terrain:(t,r)=>({u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_texture:new e.Uniform1i(t,r.u_texture)}),terrainDepth:(t,r)=>({u_matrix:new e.UniformMatrix4f(t,r.u_matrix)}),terrainCoords:(t,r)=>({u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_texture:new e.Uniform1i(t,r.u_texture),u_terrain_coords_id:new e.Uniform1f(t,r.u_terrain_coords_id)})};class Dt{constructor(e,t,r){this.context=e;const n=e.gl;this.buffer=n.createBuffer(),this.dynamicDraw=Boolean(r),this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),n.bufferData(n.ELEMENT_ARRAY_BUFFER,t.arrayBuffer,this.dynamicDraw?n.DYNAMIC_DRAW:n.STATIC_DRAW),this.dynamicDraw||delete t.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(e){const t=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),t.bufferSubData(t.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Lt={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Pt{constructor(e,t,r,n){this.length=t.length,this.attributes=r,this.itemSize=t.bytesPerElement,this.dynamicDraw=n,this.context=e;const i=e.gl;this.buffer=i.createBuffer(),e.bindVertexBuffer.set(this.buffer),i.bufferData(i.ARRAY_BUFFER,t.arrayBuffer,this.dynamicDraw?i.DYNAMIC_DRAW:i.STATIC_DRAW),this.dynamicDraw||delete t.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(e){if(e.length!==this.length)throw new Error(`Length of new data is ${e.length}, which doesn't match current length of ${this.length}`);const t=this.context.gl;this.bind(),t.bufferSubData(t.ARRAY_BUFFER,0,e.arrayBuffer)}enableAttributes(e,t){for(let r=0;r<this.attributes.length;r++){const n=t.attributes[this.attributes[r].name];void 0!==n&&e.enableVertexAttribArray(n)}}setVertexAttribPointers(e,t,r){for(let n=0;n<this.attributes.length;n++){const i=this.attributes[n],A=t.attributes[i.name];void 0!==A&&e.vertexAttribPointer(A,i.components,e[Lt[i.type]],!1,this.itemSize,i.offset+this.itemSize*(r||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Ht{constructor(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(e){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class zt extends Ht{getDefault(){return e.Color.transparent}set(e){const t=this.current;(e.r!==t.r||e.g!==t.g||e.b!==t.b||e.a!==t.a||this.dirty)&&(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class Rt extends Ht{getDefault(){return 1}set(e){(e!==this.current||this.dirty)&&(this.gl.clearDepth(e),this.current=e,this.dirty=!1)}}class Ot extends Ht{getDefault(){return 0}set(e){(e!==this.current||this.dirty)&&(this.gl.clearStencil(e),this.current=e,this.dirty=!1)}}class Kt extends Ht{getDefault(){return[!0,!0,!0,!0]}set(e){const t=this.current;(e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||e[3]!==t[3]||this.dirty)&&(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class Vt extends Ht{getDefault(){return!0}set(e){(e!==this.current||this.dirty)&&(this.gl.depthMask(e),this.current=e,this.dirty=!1)}}class $t extends Ht{getDefault(){return 255}set(e){(e!==this.current||this.dirty)&&(this.gl.stencilMask(e),this.current=e,this.dirty=!1)}}class Nt extends Ht{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(e){const t=this.current;(e.func!==t.func||e.ref!==t.ref||e.mask!==t.mask||this.dirty)&&(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)}}class Gt extends Ht{getDefault(){const e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]}set(e){const t=this.current;(e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||this.dirty)&&(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)}}class qt extends Ht{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;e?t.enable(t.STENCIL_TEST):t.disable(t.STENCIL_TEST),this.current=e,this.dirty=!1}}class Xt extends Ht{getDefault(){return[0,1]}set(e){const t=this.current;(e[0]!==t[0]||e[1]!==t[1]||this.dirty)&&(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)}}class jt extends Ht{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;e?t.enable(t.DEPTH_TEST):t.disable(t.DEPTH_TEST),this.current=e,this.dirty=!1}}class Zt extends Ht{getDefault(){return this.gl.LESS}set(e){(e!==this.current||this.dirty)&&(this.gl.depthFunc(e),this.current=e,this.dirty=!1)}}class Jt extends Ht{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;e?t.enable(t.BLEND):t.disable(t.BLEND),this.current=e,this.dirty=!1}}class Wt extends Ht{getDefault(){const e=this.gl;return[e.ONE,e.ZERO]}set(e){const t=this.current;(e[0]!==t[0]||e[1]!==t[1]||this.dirty)&&(this.gl.blendFunc(e[0],e[1]),this.current=e,this.dirty=!1)}}class Yt extends Ht{getDefault(){return e.Color.transparent}set(e){const t=this.current;(e.r!==t.r||e.g!==t.g||e.b!==t.b||e.a!==t.a||this.dirty)&&(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class er extends Ht{getDefault(){return this.gl.FUNC_ADD}set(e){(e!==this.current||this.dirty)&&(this.gl.blendEquation(e),this.current=e,this.dirty=!1)}}class tr extends Ht{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;e?t.enable(t.CULL_FACE):t.disable(t.CULL_FACE),this.current=e,this.dirty=!1}}class rr extends Ht{getDefault(){return this.gl.BACK}set(e){(e!==this.current||this.dirty)&&(this.gl.cullFace(e),this.current=e,this.dirty=!1)}}class nr extends Ht{getDefault(){return this.gl.CCW}set(e){(e!==this.current||this.dirty)&&(this.gl.frontFace(e),this.current=e,this.dirty=!1)}}class ir extends Ht{getDefault(){return null}set(e){(e!==this.current||this.dirty)&&(this.gl.useProgram(e),this.current=e,this.dirty=!1)}}class Ar extends Ht{getDefault(){return this.gl.TEXTURE0}set(e){(e!==this.current||this.dirty)&&(this.gl.activeTexture(e),this.current=e,this.dirty=!1)}}class or extends Ht{getDefault(){const e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}set(e){const t=this.current;(e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||e[3]!==t[3]||this.dirty)&&(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class sr extends Ht{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,e),this.current=e,this.dirty=!1}}class ar extends Ht{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.bindRenderbuffer(t.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class lr extends Ht{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.bindTexture(t.TEXTURE_2D,e),this.current=e,this.dirty=!1}}class cr extends Ht{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.bindBuffer(t.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class ur extends Ht{getDefault(){return null}set(e){const t=this.gl;t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class hr extends Ht{constructor(e){super(e),this.vao=e.extVertexArrayObject}getDefault(){return null}set(e){this.vao&&(e!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(e),this.current=e,this.dirty=!1)}}class dr extends Ht{getDefault(){return 4}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.pixelStorei(t.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}}class pr extends Ht{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}}class fr extends Ht{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}}class mr extends Ht{constructor(e,t){super(e),this.context=e,this.parent=t}getDefault(){return null}}class gr extends mr{setDirty(){this.dirty=!0}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const t=this.gl;t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}}class yr extends mr{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const t=this.gl;t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class _r{constructor(e,t,r,n){this.context=e,this.width=t,this.height=r;const i=e.gl,A=this.framebuffer=i.createFramebuffer();if(this.colorAttachment=new gr(e,A),n&&(this.depthAttachment=new yr(e,A)),i.checkFramebufferStatus(i.FRAMEBUFFER)!==i.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const e=this.context.gl,t=this.colorAttachment.get();if(t&&e.deleteTexture(t),this.depthAttachment){const t=this.depthAttachment.get();t&&e.deleteRenderbuffer(t)}e.deleteFramebuffer(this.framebuffer)}}class wr{constructor(e,t,r){this.blendFunction=e,this.blendColor=t,this.mask=r}}wr.Replace=[1,0],wr.disabled=new wr(wr.Replace,e.Color.transparent,[!1,!1,!1,!1]),wr.unblended=new wr(wr.Replace,e.Color.transparent,[!0,!0,!0,!0]),wr.alphaBlended=new wr([1,771],e.Color.transparent,[!0,!0,!0,!0]);class xr{constructor(e){this.gl=e,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new zt(this),this.clearDepth=new Rt(this),this.clearStencil=new Ot(this),this.colorMask=new Kt(this),this.depthMask=new Vt(this),this.stencilMask=new $t(this),this.stencilFunc=new Nt(this),this.stencilOp=new Gt(this),this.stencilTest=new qt(this),this.depthRange=new Xt(this),this.depthTest=new jt(this),this.depthFunc=new Zt(this),this.blend=new Jt(this),this.blendFunc=new Wt(this),this.blendColor=new Yt(this),this.blendEquation=new er(this),this.cullFace=new tr(this),this.cullFaceSide=new rr(this),this.frontFace=new nr(this),this.program=new ir(this),this.activeTexture=new Ar(this),this.viewport=new or(this),this.bindFramebuffer=new sr(this),this.bindRenderbuffer=new ar(this),this.bindTexture=new lr(this),this.bindVertexBuffer=new cr(this),this.bindElementBuffer=new ur(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new hr(this),this.pixelStoreUnpack=new dr(this),this.pixelStoreUnpackPremultiplyAlpha=new pr(this),this.pixelStoreUnpackFlipY=new fr(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=e.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(e.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=e.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=e.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(e,t){return new Dt(this,e,t)}createVertexBuffer(e,t,r){return new Pt(this,e,t,r)}createRenderbuffer(e,t,r){const n=this.gl,i=n.createRenderbuffer();return this.bindRenderbuffer.set(i),n.renderbufferStorage(n.RENDERBUFFER,e,t,r),this.bindRenderbuffer.set(null),i}createFramebuffer(e,t,r){return new _r(this,e,t,r)}clear({color:e,depth:t}){const r=this.gl;let n=0;e&&(n|=r.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),void 0!==t&&(n|=r.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(t),this.depthMask.set(!0)),r.clear(n)}setCullFace(e){!1===e.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))}setDepthMode(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)}setStencilMode(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)}setColorMode(e){i(e.blendFunction,wr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class Br{constructor(e,t,r){this.func=e,this.mask=t,this.range=r}}Br.ReadOnly=!1,Br.ReadWrite=!0,Br.disabled=new Br(519,Br.ReadOnly,[0,1]);const vr=7680;class br{constructor(e,t,r,n,i,A){this.test=e,this.ref=t,this.mask=r,this.fail=n,this.depthFail=i,this.pass=A}}br.disabled=new br({func:519,mask:0},0,0,vr,vr,vr);class Cr{constructor(e,t,r){this.enable=e,this.mode=t,this.frontFace=r}}let Fr;function Er(t,r,n,i,A,o,s){const a=t.context,l=a.gl,c=t.useProgram("collisionBox"),u=[];let h=0,d=0;for(let p=0;p<i.length;p++){const f=i[p],m=r.getTile(f),g=m.getBucket(n);if(!g)continue;let y=f.posMatrix;0===A[0]&&0===A[1]||(y=t.translatePosMatrix(f.posMatrix,m,A,o));const _=s?g.textCollisionBox:g.iconCollisionBox,w=g.collisionCircleArray;if(w.length>0){const r=e.create(),n=y;e.mul(r,g.placementInvProjMatrix,t.transform.glCoordMatrix),e.mul(r,r,g.placementViewportMatrix),u.push({circleArray:w,circleOffset:d,transform:n,invTransform:r,coord:f}),h+=w.length/4,d=h}_&&c.draw(a,l.LINES,Br.disabled,br.disabled,t.colorModeForRenderPass(),Cr.disabled,mt(y,t.transform,m),t.style.terrain&&t.style.terrain.getTerrainData(f),n.id,_.layoutVertexBuffer,_.indexBuffer,_.segments,null,t.transform.zoom,null,null,_.collisionVertexBuffer)}if(!s||!u.length)return;const p=t.useProgram("collisionCircle"),f=new e.CollisionCircleLayoutArray;f.resize(4*h),f._trim();let m=0;for(const e of u)for(let t=0;t<e.circleArray.length/4;t++){const r=4*t,n=e.circleArray[r+0],i=e.circleArray[r+1],A=e.circleArray[r+2],o=e.circleArray[r+3];f.emplace(m++,n,i,A,o,0),f.emplace(m++,n,i,A,o,1),f.emplace(m++,n,i,A,o,2),f.emplace(m++,n,i,A,o,3)}(!Fr||Fr.length<2*h)&&(Fr=function(t){const r=2*t,n=new e.QuadTriangleArray;n.resize(r),n._trim();for(let e=0;e<r;e++){const t=6*e;n.uint16[t+0]=4*e+0,n.uint16[t+1]=4*e+1,n.uint16[t+2]=4*e+2,n.uint16[t+3]=4*e+2,n.uint16[t+4]=4*e+3,n.uint16[t+5]=4*e+0}return n}(h));const g=a.createIndexBuffer(Fr,!0),y=a.createVertexBuffer(f,e.collisionCircleLayout.members,!0);for(const r of u){const i={u_matrix:r.transform,u_inv_matrix:r.invTransform,u_camera_to_center_distance:(_=t.transform).cameraToCenterDistance,u_viewport_size:[_.width,_.height]};p.draw(a,l.TRIANGLES,Br.disabled,br.disabled,t.colorModeForRenderPass(),Cr.disabled,i,t.style.terrain&&t.style.terrain.getTerrainData(r.coord),n.id,y,g,e.SegmentVector.simpleSegment(0,2*r.circleOffset,r.circleArray.length,r.circleArray.length/2),null,t.transform.zoom,null,null,null)}var _;y.destroy(),g.destroy()}Cr.disabled=new Cr(!1,1029,2305),Cr.backCCW=new Cr(!0,1029,2305);const Ur=e.identity(new Float32Array(16));function Qr(t,r,n,i,A,o){const{horizontalAlign:s,verticalAlign:a}=e.getAnchorAlignment(t),l=-(s-.5)*r,c=-(a-.5)*n,u=e.evaluateVariableOffset(t,i);return new e.pointGeometry((l/A+u[0])*o,(c/A+u[1])*o)}function Ir(t,r,n,i,A,o,s,a,l,c,u){const h=t.text.placedSymbolArray,d=t.text.dynamicLayoutVertexArray,p=t.icon.dynamicLayoutVertexArray,f={};d.clear();for(let p=0;p<h.length;p++){const m=h.get(p),g=t.allowVerticalPlacement&&!m.placedOrientation,y=m.hidden||!m.crossTileID||g?null:i[m.crossTileID];if(y){const i=new e.pointGeometry(m.anchorX,m.anchorY),h=se(i,n?s:o,u),p=ae(A.cameraToCenterDistance,h.signedDistanceFromCamera);let g=e.evaluateSizeForFeature(t.textSizeData,l,m)*p/e.ONE_EM;n&&(g*=t.tilePixelRatio/a);const{width:_,height:w,anchor:x,textOffset:B,textBoxScale:v}=y,b=Qr(x,_,w,B,v,g),C=n?se(i.add(b),o,u).point:h.point.add(r?b.rotate(-A.angle):b),F=t.allowVerticalPlacement&&m.placedOrientation===e.WritingMode.vertical?Math.PI/2:0;for(let t=0;t<m.numGlyphs;t++)e.addDynamicAttributes(d,C,F);c&&m.associatedIconIndex>=0&&(f[m.associatedIconIndex]={shiftedAnchor:C,angle:F})}else ge(m.numGlyphs,d)}if(c){p.clear();const r=t.icon.placedSymbolArray;for(let t=0;t<r.length;t++){const n=r.get(t);if(n.hidden)ge(n.numGlyphs,p);else{const r=f[t];if(r)for(let t=0;t<n.numGlyphs;t++)e.addDynamicAttributes(p,r.shiftedAnchor,r.angle);else ge(n.numGlyphs,p)}}t.icon.dynamicLayoutVertexBuffer.updateData(p)}t.text.dynamicLayoutVertexBuffer.updateData(d)}function Tr(e,t,r){return r.iconsInText&&t?"symbolTextAndIcon":e?"symbolSDF":"symbolIcon"}function Sr(t,r,n,i,A,o,s,a,l,c,u,h){const d=t.context,p=d.gl,f=t.transform,m="map"===a,g="map"===l,y="viewport"!==a&&"point"!==n.layout.get("symbol-placement"),_=m&&!g&&!y,w=!n.layout.get("symbol-sort-key").isConstant();let x=!1;const B=t.depthModeForSublayer(0,Br.ReadOnly),v=n.layout.get("text-variable-anchor"),b=[];for(const a of i){const i=r.getTile(a),l=i.getBucket(n);if(!l)continue;const u=A?l.text:l.icon;if(!u||!u.segments.get().length)continue;const h=u.programConfigurations.get(n.id),d=A||l.sdfIcons,B=A?l.textSizeData:l.iconSizeData,C=g||0!==f.pitch,F=t.useProgram(Tr(d,A,l),h),E=e.evaluateSizeForZoom(B,f.zoom),U=t.style.terrain&&t.style.terrain.getTerrainData(a);let Q,I,T,S,M=[0,0],k=null;if(A){if(I=i.glyphAtlasTexture,T=p.LINEAR,Q=i.glyphAtlasTexture.size,l.iconsInText){M=i.imageAtlasTexture.size,k=i.imageAtlasTexture;const e="composite"===B.kind||"camera"===B.kind;S=C||t.options.rotating||t.options.zooming||e?p.LINEAR:p.NEAREST}}else{const e=1!==n.layout.get("icon-size").constantOr(0)||l.iconsNeedLinear;I=i.imageAtlasTexture,T=d||t.options.rotating||t.options.zooming||e||C?p.LINEAR:p.NEAREST,Q=i.imageAtlasTexture.size}const D=xe(i,1,t.transform.zoom),L=Ae(a.posMatrix,g,m,t.transform,D),P=oe(a.posMatrix,g,m,t.transform,D),H=v&&l.hasTextData(),z="none"!==n.layout.get("icon-text-fit")&&H&&l.hasIconData();if(y){const e=t.style.terrain?(e,r)=>t.style.terrain.getElevation(a,e,r):null,r="map"===n.layout.get("text-rotation-alignment");ce(l,a.posMatrix,t,A,L,P,g,c,r,e)}const R=t.translatePosMatrix(a.posMatrix,i,o,s),O=y||A&&v||z?Ur:L,K=t.translatePosMatrix(P,i,o,s,!0),V=d&&0!==n.paint.get(A?"text-halo-width":"icon-halo-width").constantOr(1);let $;$=d?l.iconsInText?Tt(B.kind,E,_,g,t,R,O,K,Q,M):It(B.kind,E,_,g,t,R,O,K,A,Q,!0):Qt(B.kind,E,_,g,t,R,O,K,A,Q);const N={program:F,buffers:u,uniformValues:$,atlasTexture:I,atlasTextureIcon:k,atlasInterpolation:T,atlasInterpolationIcon:S,isSDF:d,hasHalo:V};if(w&&l.canOverlap){x=!0;const t=u.segments.get();for(const r of t)b.push({segments:new e.SegmentVector([r]),sortKey:r.sortKey,state:N,terrainData:U})}else b.push({segments:u.segments,sortKey:0,state:N,terrainData:U})}x&&b.sort(((e,t)=>e.sortKey-t.sortKey));for(const e of b){const r=e.state;if(d.activeTexture.set(p.TEXTURE0),r.atlasTexture.bind(r.atlasInterpolation,p.CLAMP_TO_EDGE),r.atlasTextureIcon&&(d.activeTexture.set(p.TEXTURE1),r.atlasTextureIcon&&r.atlasTextureIcon.bind(r.atlasInterpolationIcon,p.CLAMP_TO_EDGE)),r.isSDF){const i=r.uniformValues;r.hasHalo&&(i.u_is_halo=1,Mr(r.buffers,e.segments,n,t,r.program,B,u,h,i,e.terrainData)),i.u_is_halo=0}Mr(r.buffers,e.segments,n,t,r.program,B,u,h,r.uniformValues,e.terrainData)}}function Mr(e,t,r,n,i,A,o,s,a,l){const c=n.context;i.draw(c,c.gl.TRIANGLES,A,o,s,Cr.disabled,a,l,r.id,e.layoutVertexBuffer,e.indexBuffer,t,r.paint,n.transform.zoom,e.programConfigurations.get(r.id),e.dynamicLayoutVertexBuffer,e.opacityVertexBuffer)}function kr(e,t,r,n,i,A,o){const s=e.context.gl,a=r.paint.get("fill-pattern"),l=a&&a.constantOr(1),c=r.getCrossfadeParameters();let u,h,d,p,f;o?(h=l&&!r.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",u=s.LINES):(h=l?"fillPattern":"fill",u=s.TRIANGLES);for(const m of n){const n=t.getTile(m);if(l&&!n.patternsLoaded())continue;const g=n.getBucket(r);if(!g)continue;const y=g.programConfigurations.get(r.id),_=e.useProgram(h,y),w=e.style.terrain&&e.style.terrain.getTerrainData(m);l&&(e.context.activeTexture.set(s.TEXTURE0),n.imageAtlasTexture.bind(s.LINEAR,s.CLAMP_TO_EDGE),y.updatePaintBuffers(c));const x=a.constantOr(null);if(x&&n.imageAtlas){const e=n.imageAtlas,t=e.patternPositions[x.to.toString()],r=e.patternPositions[x.from.toString()];t&&r&&y.setConstantPatternPositions(t,r)}const B=w?m:null,v=e.translatePosMatrix(B?B.posMatrix:m.posMatrix,n,r.paint.get("fill-translate"),r.paint.get("fill-translate-anchor"));if(o){p=g.indexBuffer2,f=g.segments2;const t=[s.drawingBufferWidth,s.drawingBufferHeight];d="fillOutlinePattern"===h&&l?pt(v,e,c,n,t):dt(v,t)}else p=g.indexBuffer,f=g.segments,d=l?ht(v,e,c,n):ut(v);_.draw(e.context,u,i,e.stencilModeForClipping(m),A,Cr.disabled,d,w,r.id,g.layoutVertexBuffer,p,f,r.paint,e.transform.zoom,y)}}function Dr(e,t,r,n,i,A,o){const s=e.context,a=s.gl,l=r.paint.get("fill-extrusion-pattern"),c=l.constantOr(1),u=r.getCrossfadeParameters(),h=r.paint.get("fill-extrusion-opacity");for(const d of n){const n=t.getTile(d),p=n.getBucket(r);if(!p)continue;const f=e.style.terrain&&e.style.terrain.getTerrainData(d),m=p.programConfigurations.get(r.id),g=e.useProgram(c?"fillExtrusionPattern":"fillExtrusion",m);c&&(e.context.activeTexture.set(a.TEXTURE0),n.imageAtlasTexture.bind(a.LINEAR,a.CLAMP_TO_EDGE),m.updatePaintBuffers(u));const y=l.constantOr(null);if(y&&n.imageAtlas){const e=n.imageAtlas,t=e.patternPositions[y.to.toString()],r=e.patternPositions[y.from.toString()];t&&r&&m.setConstantPatternPositions(t,r)}const _=e.translatePosMatrix(d.posMatrix,n,r.paint.get("fill-extrusion-translate"),r.paint.get("fill-extrusion-translate-anchor")),w=r.paint.get("fill-extrusion-vertical-gradient"),x=c?ct(_,e,w,h,d,u,n):lt(_,e,w,h);g.draw(s,s.gl.TRIANGLES,i,A,o,Cr.backCCW,x,f,r.id,p.layoutVertexBuffer,p.indexBuffer,p.segments,r.paint,e.transform.zoom,m,e.style.terrain&&p.centroidVertexBuffer)}}function Lr(e,t,r,n,i,A,o){const s=e.context,a=s.gl,l=r.fbo;if(!l)return;const c=e.useProgram("hillshade"),u=e.style.terrain&&e.style.terrain.getTerrainData(t);s.activeTexture.set(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,l.colorAttachment.get()),c.draw(s,a.TRIANGLES,i,A,o,Cr.disabled,((e,t,r,n)=>{const i=r.paint.get("hillshade-shadow-color"),A=r.paint.get("hillshade-highlight-color"),o=r.paint.get("hillshade-accent-color");let s=r.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===r.paint.get("hillshade-illumination-anchor")&&(s-=e.transform.angle);const a=!e.options.moving;return{u_matrix:n?n.posMatrix:e.transform.calculatePosMatrix(t.tileID.toUnwrapped(),a),u_image:0,u_latrange:wt(0,t.tileID),u_light:[r.paint.get("hillshade-exaggeration"),s],u_shadow:i,u_highlight:A,u_accent:o}})(e,r,n,u?t:null),u,n.id,e.rasterBoundsBuffer,e.quadTriangleIndexBuffer,e.rasterBoundsSegments)}function Pr(t,r,n,i,A,o){const s=t.context,l=s.gl,c=r.dem;if(c&&c.data){const u=c.dim,h=c.stride,d=c.getPixels();if(s.activeTexture.set(l.TEXTURE1),s.pixelStoreUnpackPremultiplyAlpha.set(!1),r.demTexture=r.demTexture||t.getTileTexture(h),r.demTexture){const e=r.demTexture;e.update(d,{premultiply:!1}),e.bind(l.NEAREST,l.CLAMP_TO_EDGE)}else r.demTexture=new a(s,d,l.RGBA,{premultiply:!1}),r.demTexture.bind(l.NEAREST,l.CLAMP_TO_EDGE);s.activeTexture.set(l.TEXTURE0);let p=r.fbo;if(!p){const e=new a(s,{width:u,height:u,data:null},l.RGBA);e.bind(l.LINEAR,l.CLAMP_TO_EDGE),p=r.fbo=s.createFramebuffer(u,u,!0),p.colorAttachment.set(e.texture)}s.bindFramebuffer.set(p.framebuffer),s.viewport.set([0,0,u,u]),t.useProgram("hillshadePrepare").draw(s,l.TRIANGLES,i,A,o,Cr.disabled,((t,r)=>{const n=r.stride,i=e.create();return e.ortho(i,0,e.EXTENT,-e.EXTENT,0,0,1),e.translate(i,i,[0,-e.EXTENT,0]),{u_matrix:i,u_image:1,u_dimension:[n,n],u_zoom:t.overscaledZ,u_unpack:r.getUnpackVector()}})(r.tileID,c),null,n.id,t.rasterBoundsBuffer,t.quadTriangleIndexBuffer,t.rasterBoundsSegments),r.needsHillshadePrepare=!1}}function Hr(t,r,n,i,A,o){const s=i.paint.get("raster-fade-duration");if(!o&&s>0){const i=e.exported.now(),o=(i-t.timeAdded)/s,a=r?(i-r.timeAdded)/s:-1,l=n.getSource(),c=A.coveringZoomLevel({tileSize:l.tileSize,roundZoom:l.roundZoom}),u=!r||Math.abs(r.tileID.overscaledZ-c)>Math.abs(t.tileID.overscaledZ-c),h=u&&t.refreshedUponExpiration?1:e.clamp(u?o:1-a,0,1);return t.refreshedUponExpiration&&o>=1&&(t.refreshedUponExpiration=!1),r?{opacity:1,mix:1-h}:{opacity:h,mix:0}}return{opacity:1,mix:0}}const zr=new e.Color(1,0,0,1),Rr=new e.Color(0,1,0,1),Or=new e.Color(0,0,1,1),Kr=new e.Color(1,0,1,1),Vr=new e.Color(0,1,1,1);function $r(e,t,r,n){Gr(e,0,t+r/2,e.transform.width,r,n)}function Nr(e,t,r,n){Gr(e,t-r/2,0,r,e.transform.height,n)}function Gr(e,t,r,n,i,A){const o=e.context,s=o.gl;s.enable(s.SCISSOR_TEST),s.scissor(t*e.pixelRatio,r*e.pixelRatio,n*e.pixelRatio,i*e.pixelRatio),o.clear({color:A}),s.disable(s.SCISSOR_TEST)}function qr(t,r,n){const i=t.context,A=i.gl,o=n.posMatrix,s=t.useProgram("debug"),a=Br.disabled,l=br.disabled,c=t.colorModeForRenderPass(),u="$debug",h=t.style.terrain&&t.style.terrain.getTerrainData(n);i.activeTexture.set(A.TEXTURE0),t.emptyTexture.bind(A.LINEAR,A.CLAMP_TO_EDGE);const d=r.getTileByID(n.key).latestRawTileData,p=Math.floor((d&&d.byteLength||0)/1024),f=r.getTile(n).tileSize,m=512/Math.min(f,512)*(n.overscaledZ/t.transform.zoom)*.5;let g=n.canonical.toString();n.overscaledZ!==n.canonical.z&&(g+=` => ${n.overscaledZ}`),function(e,t){e.initDebugOverlayCanvas();const r=e.debugOverlayCanvas,n=e.context.gl,i=e.debugOverlayCanvas.getContext("2d");i.clearRect(0,0,r.width,r.height),i.shadowColor="white",i.shadowBlur=2,i.lineWidth=1.5,i.strokeStyle="white",i.textBaseline="top",i.font="bold 36px Open Sans, sans-serif",i.fillText(t,5,5),i.strokeText(t,5,5),e.debugOverlayTexture.update(r),e.debugOverlayTexture.bind(n.LINEAR,n.CLAMP_TO_EDGE)}(t,`${g} ${p}kB`),s.draw(i,A.TRIANGLES,a,l,wr.alphaBlended,Cr.disabled,gt(o,e.Color.transparent,m),null,u,t.debugBuffer,t.quadTriangleIndexBuffer,t.debugSegments),s.draw(i,A.LINE_STRIP,a,l,c,Cr.disabled,gt(o,e.Color.red),h,u,t.debugBuffer,t.tileBorderIndexBuffer,t.debugSegments)}function Xr(e,t,r){const n=e.context,i=n.gl,A=e.colorModeForRenderPass(),o=new Br(i.LEQUAL,Br.ReadWrite,e.depthRangeFor3D),s=e.useProgram("terrain"),a=t.getTerrainMesh(),l=t.getTerrainData(r.tileID);n.bindFramebuffer.set(null),n.viewport.set([0,0,e.width,e.height]),n.activeTexture.set(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,t.getRTTFramebuffer().colorAttachment.get());const c=e.transform.calculatePosMatrix(r.tileID.toUnwrapped());s.draw(n,i.TRIANGLES,o,br.disabled,A,Cr.backCCW,{u_matrix:c,u_texture:0},l,"terrain",a.vertexBuffer,a.indexBuffer,a.segments)}function jr(e,t,r,n){const i=e.context,A=r.tileSize*t.qualityFactor;r.textures[n]||(r.textures[n]=e.getTileTexture(A)||new a(i,{width:A,height:A,data:null},i.gl.RGBA),r.textures[n].bind(i.gl.LINEAR,i.gl.CLAMP_TO_EDGE),0===n&&t.sourceCache.renderHistory.unshift(r.tileID.key));const o=t.getRTTFramebuffer();o.colorAttachment.set(r.textures[n].texture),i.bindFramebuffer.set(o.framebuffer),i.viewport.set([0,0,A,A])}class Zr{constructor(e){this._coordsDescendingInv={},this._coordsDescendingInvStr={},this.painter=e,this._renderToTexture={background:!0,fill:!0,line:!0,raster:!0},this._coordsDescendingInv={},this._coordsDescendingInvStr={},this._stacks=[],this._prevType=null,this._rerender={},this._renderableTiles=e.style.terrain.sourceCache.getRenderableTiles(),this._init()}_init(){const e=this.painter.style,t=e.terrain;for(const r in e.sourceCaches){this._coordsDescendingInv[r]={};const n=e.sourceCaches[r].getVisibleCoordinates();for(const e of n){const n=t.sourceCache.getTerrainCoords(e);for(const e in n)this._coordsDescendingInv[r][e]||(this._coordsDescendingInv[r][e]=[]),this._coordsDescendingInv[r][e].push(n[e])}}for(const t of e._order){const r=e._layers[t],n=r.source;if(this._renderToTexture[r.type]&&!this._coordsDescendingInvStr[n]){this._coordsDescendingInvStr[n]={};for(const e in this._coordsDescendingInv[n])this._coordsDescendingInvStr[n][e]=this._coordsDescendingInv[n][e].map((e=>e.key)).sort().join()}}return this._renderableTiles.forEach((e=>{for(const r in this._coordsDescendingInvStr){const n=this._coordsDescendingInvStr[r][e.tileID.key];n&&n!==e.textureCoords[r]&&e.clearTextures(this.painter),t.needsRerender(r,e.tileID)&&e.clearTextures(this.painter)}this._rerender[e.tileID.key]=!e.textures.length})),t.clearRerenderCache(),t.sourceCache.removeOutdated(this.painter),this}renderLayer(t){const r=t.type,n=this.painter,i=n.style._order,A=n.currentLayer,o=A+1===i.length;if(this._renderToTexture[r]&&(this._prevType&&this._renderToTexture[this._prevType]||this._stacks.push([]),this._prevType=r,this._stacks[this._stacks.length-1].push(i[A]),!o))return!0;if(this._renderToTexture[this._prevType]||"hillshade"===r||this._renderToTexture[r]&&o){this._prevType=r;const o=this._stacks.length-1,s=this._stacks[o]||[];for(const t of this._renderableTiles){if(jr(n,n.style.terrain,t,o),this._rerender[t.tileID.key]){n.context.clear({color:e.Color.transparent});for(let e=0;e<s.length;e++){const r=n.style._layers[s[e]],i=r.source?this._coordsDescendingInv[r.source][t.tileID.key]:[t.tileID];n._renderTileClippingMasks(r,i),n.renderLayer(n,n.style.sourceCaches[r.source],r,i),r.source&&(t.textureCoords[r.source]=this._coordsDescendingInvStr[r.source][t.tileID.key])}}Xr(n,n.style.terrain,t)}if("hillshade"===r){this._stacks.push([i[A]]);for(const r of this._renderableTiles){const i=this._coordsDescendingInv[t.source][r.tileID.key];jr(n,n.style.terrain,r,this._stacks.length-1),n.context.clear({color:e.Color.transparent}),n._renderTileClippingMasks(t,i),n.renderLayer(n,n.style.sourceCaches[t.source],t,i),Xr(n,n.style.terrain,r)}return!0}return this._renderToTexture[r]}return!1}}const Jr={symbol:function(t,r,n,i,A){if("translucent"!==t.renderPass)return;const o=br.disabled,s=t.colorModeForRenderPass();n.layout.get("text-variable-anchor")&&function(t,r,n,i,A,o,s){const a=r.transform,l="map"===A,c="map"===o;for(const A of t){const t=i.getTile(A),o=t.getBucket(n);if(!o||!o.text||!o.text.segments.get().length)continue;const u=e.evaluateSizeForZoom(o.textSizeData,a.zoom),h=xe(t,1,r.transform.zoom),d=Ae(A.posMatrix,c,l,r.transform,h),p="none"!==n.layout.get("icon-text-fit")&&o.hasIconData();if(u){const e=Math.pow(2,a.zoom-t.tileID.overscaledZ);Ir(o,l,c,s,a,d,A.posMatrix,e,u,p,r.style.terrain?(e,t)=>r.style.terrain.getElevation(A,e,t):null)}}}(i,t,n,r,n.layout.get("text-rotation-alignment"),n.layout.get("text-pitch-alignment"),A),0!==n.paint.get("icon-opacity").constantOr(1)&&Sr(t,r,n,i,!1,n.paint.get("icon-translate"),n.paint.get("icon-translate-anchor"),n.layout.get("icon-rotation-alignment"),n.layout.get("icon-pitch-alignment"),n.layout.get("icon-keep-upright"),o,s),0!==n.paint.get("text-opacity").constantOr(1)&&Sr(t,r,n,i,!0,n.paint.get("text-translate"),n.paint.get("text-translate-anchor"),n.layout.get("text-rotation-alignment"),n.layout.get("text-pitch-alignment"),n.layout.get("text-keep-upright"),o,s),r.map.showCollisionBoxes&&(Er(t,r,n,i,n.paint.get("text-translate"),n.paint.get("text-translate-anchor"),!0),Er(t,r,n,i,n.paint.get("icon-translate"),n.paint.get("icon-translate-anchor"),!1))},circle:function(t,r,n,i){if("translucent"!==t.renderPass)return;const A=n.paint.get("circle-opacity"),o=n.paint.get("circle-stroke-width"),s=n.paint.get("circle-stroke-opacity"),a=!n.layout.get("circle-sort-key").isConstant();if(0===A.constantOr(1)&&(0===o.constantOr(1)||0===s.constantOr(1)))return;const l=t.context,c=l.gl,u=t.depthModeForSublayer(0,Br.ReadOnly),h=br.disabled,d=t.colorModeForRenderPass(),p=[];for(let A=0;A<i.length;A++){const o=i[A],s=r.getTile(o),l=s.getBucket(n);if(!l)continue;const c=l.programConfigurations.get(n.id),u=t.useProgram("circle",c),h=l.layoutVertexBuffer,d=l.indexBuffer,f=t.style.terrain&&t.style.terrain.getTerrainData(o),m={programConfiguration:c,program:u,layoutVertexBuffer:h,indexBuffer:d,uniformValues:ft(t,o,s,n),terrainData:f};if(a){const t=l.segments.get();for(const r of t)p.push({segments:new e.SegmentVector([r]),sortKey:r.sortKey,state:m})}else p.push({segments:l.segments,sortKey:0,state:m})}a&&p.sort(((e,t)=>e.sortKey-t.sortKey));for(const e of p){const{programConfiguration:r,program:i,layoutVertexBuffer:A,indexBuffer:o,uniformValues:s,terrainData:a}=e.state;i.draw(l,c.TRIANGLES,u,h,d,Cr.disabled,s,a,n.id,A,o,e.segments,n.paint,t.transform.zoom,r)}},heatmap:function(t,r,n,i){if(0!==n.paint.get("heatmap-opacity"))if("offscreen"===t.renderPass){const A=t.context,o=A.gl,s=br.disabled,a=new wr([o.ONE,o.ONE],e.Color.transparent,[!0,!0,!0,!0]);!function(e,t,r){const n=e.gl;e.activeTexture.set(n.TEXTURE1),e.viewport.set([0,0,t.width/4,t.height/4]);let i=r.heatmapFbo;if(i)n.bindTexture(n.TEXTURE_2D,i.colorAttachment.get()),e.bindFramebuffer.set(i.framebuffer);else{const A=n.createTexture();n.bindTexture(n.TEXTURE_2D,A),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),i=r.heatmapFbo=e.createFramebuffer(t.width/4,t.height/4,!1),function(e,t,r,n){const i=e.gl;i.texImage2D(i.TEXTURE_2D,0,i.RGBA,t.width/4,t.height/4,0,i.RGBA,e.extRenderToTextureHalfFloat?e.extTextureHalfFloat.HALF_FLOAT_OES:i.UNSIGNED_BYTE,null),n.colorAttachment.set(r)}(e,t,A,i)}}(A,t,n),A.clear({color:e.Color.transparent});for(let e=0;e<i.length;e++){const l=i[e];if(r.hasRenderableParent(l))continue;const c=r.getTile(l),u=c.getBucket(n);if(!u)continue;const h=u.programConfigurations.get(n.id),d=t.useProgram("heatmap",h),{zoom:p}=t.transform;d.draw(A,o.TRIANGLES,Br.disabled,s,a,Cr.disabled,_t(l.posMatrix,c,p,n.paint.get("heatmap-intensity")),null,n.id,u.layoutVertexBuffer,u.indexBuffer,u.segments,n.paint,t.transform.zoom,h)}A.viewport.set([0,0,t.width,t.height])}else"translucent"===t.renderPass&&(t.context.setColorMode(t.colorModeForRenderPass()),function(t,r){const n=t.context,i=n.gl,A=r.heatmapFbo;if(!A)return;n.activeTexture.set(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,A.colorAttachment.get()),n.activeTexture.set(i.TEXTURE1);let o=r.colorRampTexture;o||(o=r.colorRampTexture=new a(n,r.colorRamp,i.RGBA)),o.bind(i.LINEAR,i.CLAMP_TO_EDGE),t.useProgram("heatmapTexture").draw(n,i.TRIANGLES,Br.disabled,br.disabled,t.colorModeForRenderPass(),Cr.disabled,((t,r,n,i)=>{const A=e.create();e.ortho(A,0,t.width,t.height,0,0,1);const o=t.context.gl;return{u_matrix:A,u_world:[o.drawingBufferWidth,o.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:r.paint.get("heatmap-opacity")}})(t,r),null,r.id,t.viewportBuffer,t.quadTriangleIndexBuffer,t.viewportSegments,r.paint,t.transform.zoom)}(t,n))},line:function(t,r,n,i){if("translucent"!==t.renderPass)return;const A=n.paint.get("line-opacity"),o=n.paint.get("line-width");if(0===A.constantOr(1)||0===o.constantOr(1))return;const s=t.depthModeForSublayer(0,Br.ReadOnly),l=t.colorModeForRenderPass(),c=n.paint.get("line-dasharray"),u=n.paint.get("line-pattern"),h=u.constantOr(1),d=n.paint.get("line-gradient"),p=n.getCrossfadeParameters(),f=h?"linePattern":c?"lineSDF":d?"lineGradient":"line",m=t.context,g=m.gl;let y=!0;for(const A of i){const i=r.getTile(A);if(h&&!i.patternsLoaded())continue;const o=i.getBucket(n);if(!o)continue;const _=o.programConfigurations.get(n.id),w=t.context.program.get(),x=t.useProgram(f,_),B=y||x.program!==w,v=t.style.terrain&&t.style.terrain.getTerrainData(A),b=u.constantOr(null);if(b&&i.imageAtlas){const e=i.imageAtlas,t=e.patternPositions[b.to.toString()],r=e.patternPositions[b.from.toString()];t&&r&&_.setConstantPatternPositions(t,r)}const C=v?A:null,F=h?vt(t,i,n,p,C):c?bt(t,i,n,c,p,C):d?Bt(t,i,n,o.lineClipsArray.length,C):xt(t,i,n,C);if(h)m.activeTexture.set(g.TEXTURE0),i.imageAtlasTexture.bind(g.LINEAR,g.CLAMP_TO_EDGE),_.updatePaintBuffers(p);else if(c&&(B||t.lineAtlas.dirty))m.activeTexture.set(g.TEXTURE0),t.lineAtlas.bind(m);else if(d){const i=o.gradients[n.id];let s=i.texture;if(n.gradientVersion!==i.version){let l=256;if(n.stepInterpolant){const n=r.getSource().maxzoom,i=A.canonical.z===n?Math.ceil(1<<t.transform.maxZoom-A.canonical.z):1;l=e.clamp(e.nextPowerOfTwo(o.maxLineLength/e.EXTENT*1024*i),256,m.maxTextureSize)}i.gradient=e.renderColorRamp({expression:n.gradientExpression(),evaluationKey:"lineProgress",resolution:l,image:i.gradient||void 0,clips:o.lineClipsArray}),i.texture?i.texture.update(i.gradient):i.texture=new a(m,i.gradient,g.RGBA),i.version=n.gradientVersion,s=i.texture}m.activeTexture.set(g.TEXTURE0),s.bind(n.stepInterpolant?g.NEAREST:g.LINEAR,g.CLAMP_TO_EDGE)}x.draw(m,g.TRIANGLES,s,t.stencilModeForClipping(A),l,Cr.disabled,F,v,n.id,o.layoutVertexBuffer,o.indexBuffer,o.segments,n.paint,t.transform.zoom,_,o.layoutVertexBuffer2),y=!1}},fill:function(t,r,n,i){const A=n.paint.get("fill-color"),o=n.paint.get("fill-opacity");if(0===o.constantOr(1))return;const s=t.colorModeForRenderPass(),a=n.paint.get("fill-pattern"),l=t.opaquePassEnabledForLayer()&&!a.constantOr(1)&&1===A.constantOr(e.Color.transparent).a&&1===o.constantOr(0)?"opaque":"translucent";if(t.renderPass===l){const e=t.depthModeForSublayer(1,"opaque"===t.renderPass?Br.ReadWrite:Br.ReadOnly);kr(t,r,n,i,e,s,!1)}if("translucent"===t.renderPass&&n.paint.get("fill-antialias")){const e=t.depthModeForSublayer(n.getPaintProperty("fill-outline-color")?2:0,Br.ReadOnly);kr(t,r,n,i,e,s,!0)}},"fill-extrusion":function(e,t,r,n){const i=r.paint.get("fill-extrusion-opacity");if(0!==i&&"translucent"===e.renderPass){const A=new Br(e.context.gl.LEQUAL,Br.ReadWrite,e.depthRangeFor3D);if(1!==i||r.paint.get("fill-extrusion-pattern").constantOr(1))Dr(e,t,r,n,A,br.disabled,wr.disabled),Dr(e,t,r,n,A,e.stencilModeFor3D(),e.colorModeForRenderPass());else{const i=e.colorModeForRenderPass();Dr(e,t,r,n,A,br.disabled,i)}}},hillshade:function(e,t,r,n){if("offscreen"!==e.renderPass&&"translucent"!==e.renderPass)return;const i=e.context,A=e.depthModeForSublayer(0,Br.ReadOnly),o=e.colorModeForRenderPass(),[s,a]="translucent"===e.renderPass?e.stencilConfigForOverlap(n):[{},n];for(const n of a){const i=t.getTile(n);void 0!==i.needsHillshadePrepare&&i.needsHillshadePrepare&&"offscreen"===e.renderPass?Pr(e,i,r,A,br.disabled,o):"translucent"===e.renderPass&&Lr(e,n,i,r,A,s[n.overscaledZ],o)}i.viewport.set([0,0,e.width,e.height])},raster:function(e,t,r,n){if("translucent"!==e.renderPass)return;if(0===r.paint.get("raster-opacity"))return;if(!n.length)return;const i=e.context,A=i.gl,o=t.getSource(),s=e.useProgram("raster"),a=e.colorModeForRenderPass(),[l,c]=o instanceof U?[{},n]:e.stencilConfigForOverlap(n),u=c[c.length-1].overscaledZ,h=!e.options.moving;for(const n of c){const c=e.depthModeForSublayer(n.overscaledZ-u,1===r.paint.get("raster-opacity")?Br.ReadWrite:Br.ReadOnly,A.LESS),d=t.getTile(n);d.registerFadeDuration(r.paint.get("raster-fade-duration"));const p=t.findLoadedParent(n,0),f=Hr(d,p,t,r,e.transform,e.style.terrain);let m,g;const y="nearest"===r.paint.get("raster-resampling")?A.NEAREST:A.LINEAR;i.activeTexture.set(A.TEXTURE0),d.texture.bind(y,A.CLAMP_TO_EDGE,A.LINEAR_MIPMAP_NEAREST),i.activeTexture.set(A.TEXTURE1),p?(p.texture.bind(y,A.CLAMP_TO_EDGE,A.LINEAR_MIPMAP_NEAREST),m=Math.pow(2,p.tileID.overscaledZ-d.tileID.overscaledZ),g=[d.tileID.canonical.x*m%1,d.tileID.canonical.y*m%1]):d.texture.bind(y,A.CLAMP_TO_EDGE,A.LINEAR_MIPMAP_NEAREST);const _=e.style.terrain&&e.style.terrain.getTerrainData(n),w=_?n:null,x=w?w.posMatrix:e.transform.calculatePosMatrix(n.toUnwrapped(),h),B=Et(x,g||[0,0],m||1,f,r);o instanceof U?s.draw(i,A.TRIANGLES,c,br.disabled,a,Cr.disabled,B,_,r.id,o.boundsBuffer,e.quadTriangleIndexBuffer,o.boundsSegments):s.draw(i,A.TRIANGLES,c,l[n.overscaledZ],a,Cr.disabled,B,_,r.id,e.rasterBoundsBuffer,e.quadTriangleIndexBuffer,e.rasterBoundsSegments)}},background:function(e,t,r,n){const i=r.paint.get("background-color"),A=r.paint.get("background-opacity");if(0===A)return;const o=e.context,s=o.gl,a=e.transform,l=a.tileSize,c=r.paint.get("background-pattern");if(e.isPatternMissing(c))return;const u=!c&&1===i.a&&1===A&&e.opaquePassEnabledForLayer()?"opaque":"translucent";if(e.renderPass!==u)return;const h=br.disabled,d=e.depthModeForSublayer(0,"opaque"===u?Br.ReadWrite:Br.ReadOnly),p=e.colorModeForRenderPass(),f=e.useProgram(c?"backgroundPattern":"background"),m=n||a.coveringTiles({tileSize:l,terrain:e.style.terrain});c&&(o.activeTexture.set(s.TEXTURE0),e.imageManager.bind(e.context));const g=r.getCrossfadeParameters();for(const t of m){const a=n?t.posMatrix:e.transform.calculatePosMatrix(t.toUnwrapped()),u=c?Mt(a,A,e,c,{tileID:t,tileSize:l},g):St(a,A,i),m=e.style.terrain&&e.style.terrain.getTerrainData(t);f.draw(o,s.TRIANGLES,d,h,p,Cr.disabled,u,m,r.id,e.tileExtentBuffer,e.quadTriangleIndexBuffer,e.tileExtentSegments)}},debug:function(e,t,r){for(let n=0;n<r.length;n++)qr(e,t,r[n])},custom:function(e,t,r){const n=e.context,i=r.implementation;if("offscreen"===e.renderPass){const t=i.prerender;t&&(e.setCustomLayerDefaults(),n.setColorMode(e.colorModeForRenderPass()),t.call(i,n.gl,e.transform.customLayerMatrix()),n.setDirty(),e.setBaseState())}else if("translucent"===e.renderPass){e.setCustomLayerDefaults(),n.setColorMode(e.colorModeForRenderPass()),n.setStencilMode(br.disabled);const t="3d"===i.renderingMode?new Br(e.context.gl.LEQUAL,Br.ReadWrite,e.depthRangeFor3D):e.depthModeForSublayer(0,Br.ReadOnly);n.setDepthMode(t),i.render(n.gl,e.transform.customLayerMatrix()),n.setDirty(),e.setBaseState(),n.bindFramebuffer.set(null)}}};class Wr{constructor(t,r){this.context=new xr(t),this.transform=r,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:e.create(),renderTime:0},this.setup(),this.numSublayers=H.maxUnderzooming+H.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new qe,this.gpuTimers={}}resize(e,t,r){if(this.width=e*r,this.height=t*r,this.pixelRatio=r,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const e of this.style._order)this.style._layers[e].resize()}setup(){const t=this.context,r=new e.PosArray;r.emplaceBack(0,0),r.emplaceBack(e.EXTENT,0),r.emplaceBack(0,e.EXTENT),r.emplaceBack(e.EXTENT,e.EXTENT),this.tileExtentBuffer=t.createVertexBuffer(r,Xe.members),this.tileExtentSegments=e.SegmentVector.simpleSegment(0,0,4,2);const n=new e.PosArray;n.emplaceBack(0,0),n.emplaceBack(e.EXTENT,0),n.emplaceBack(0,e.EXTENT),n.emplaceBack(e.EXTENT,e.EXTENT),this.debugBuffer=t.createVertexBuffer(n,Xe.members),this.debugSegments=e.SegmentVector.simpleSegment(0,0,4,5);const i=new e.RasterBoundsArray;i.emplaceBack(0,0,0,0),i.emplaceBack(e.EXTENT,0,e.EXTENT,0),i.emplaceBack(0,e.EXTENT,0,e.EXTENT),i.emplaceBack(e.EXTENT,e.EXTENT,e.EXTENT,e.EXTENT),this.rasterBoundsBuffer=t.createVertexBuffer(i,E.members),this.rasterBoundsSegments=e.SegmentVector.simpleSegment(0,0,4,2);const A=new e.PosArray;A.emplaceBack(0,0),A.emplaceBack(1,0),A.emplaceBack(0,1),A.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(A,Xe.members),this.viewportSegments=e.SegmentVector.simpleSegment(0,0,4,2);const o=new e.LineStripIndexArray;o.emplaceBack(0),o.emplaceBack(1),o.emplaceBack(3),o.emplaceBack(2),o.emplaceBack(0),this.tileBorderIndexBuffer=t.createIndexBuffer(o);const s=new e.TriangleIndexArray;s.emplaceBack(0,1,2),s.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(s),this.emptyTexture=new a(t,{width:1,height:1,data:new Uint8Array([0,0,0,0])},t.gl.RGBA);const l=this.context.gl;this.stencilClearMode=new br({func:l.ALWAYS,mask:0},0,255,l.ZERO,l.ZERO,l.ZERO)}clearStencil(){const t=this.context,r=t.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const n=e.create();e.ortho(n,0,this.width,this.height,0,0,1),e.scale(n,n,[r.drawingBufferWidth,r.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(t,r.TRIANGLES,Br.disabled,this.stencilClearMode,wr.disabled,Cr.disabled,yt(n),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(e,t){if(this.currentStencilSource===e.source||!e.isTileClipped()||!t||!t.length)return;this.currentStencilSource=e.source;const r=this.context,n=r.gl;this.nextStencilID+t.length>256&&this.clearStencil(),r.setColorMode(wr.disabled),r.setDepthMode(Br.disabled);const i=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const e of t){const t=this._tileClippingMaskIDs[e.key]=this.nextStencilID++,A=this.style.terrain&&this.style.terrain.getTerrainData(e);i.draw(r,n.TRIANGLES,Br.disabled,new br({func:n.ALWAYS,mask:0},t,255,n.KEEP,n.KEEP,n.REPLACE),wr.disabled,Cr.disabled,yt(e.posMatrix),A,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const e=this.nextStencilID++,t=this.context.gl;return new br({func:t.NOTEQUAL,mask:255},e,255,t.KEEP,t.KEEP,t.REPLACE)}stencilModeForClipping(e){const t=this.context.gl;return new br({func:t.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,t.KEEP,t.KEEP,t.REPLACE)}stencilConfigForOverlap(e){const t=this.context.gl,r=e.sort(((e,t)=>t.overscaledZ-e.overscaledZ)),n=r[r.length-1].overscaledZ,i=r[0].overscaledZ-n+1;if(i>1){this.currentStencilSource=void 0,this.nextStencilID+i>256&&this.clearStencil();const e={};for(let r=0;r<i;r++)e[r+n]=new br({func:t.GEQUAL,mask:255},r+this.nextStencilID,255,t.KEEP,t.KEEP,t.REPLACE);return this.nextStencilID+=i,[e,r]}return[{[n]:br.disabled},r]}colorModeForRenderPass(){const t=this.context.gl;if(this._showOverdrawInspector){const r=1/8;return new wr([t.CONSTANT_COLOR,t.ONE],new e.Color(r,r,r,0),[!0,!0,!0,!0])}return"opaque"===this.renderPass?wr.unblended:wr.alphaBlended}depthModeForSublayer(e,t,r){if(!this.opaquePassEnabledForLayer())return Br.disabled;const n=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new Br(r||this.context.gl.LEQUAL,t,[n,n])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(t,r){this.style=t,this.options=r,this.lineAtlas=t.lineAtlas,this.imageManager=t.imageManager,this.glyphManager=t.glyphManager,this.symbolFadeChange=t.placement.symbolFadeChange(e.exported.now()),this.imageManager.beginFrame();const n=this.style._order,i=this.style.sourceCaches,A=this.style.terrain&&new Zr(this);for(const e in i){const t=i[e];t.used&&t.prepare(this.context)}const o={},s={},a={};for(const e in i){const t=i[e];o[e]=t.getVisibleCoordinates(),s[e]=o[e].slice().reverse(),a[e]=t.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let e=0;e<n.length;e++)if(this.style._layers[n[e]].is3D()){this.opaquePassCutoff=e;break}if(A){this.opaquePassCutoff=0;const t=this.style.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!e.equals(this.terrainFacilitator.matrix,this.transform.projMatrix)||t.length)&&(e.copy(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(t,r){const n=t.context,i=n.gl,A=wr.unblended,o=new Br(i.LEQUAL,Br.ReadWrite,[0,1]),s=r.getTerrainMesh(),a=r.sourceCache.getRenderableTiles(),l=t.useProgram("terrainDepth");n.bindFramebuffer.set(r.getFramebuffer("depth").framebuffer),n.viewport.set([0,0,t.width/devicePixelRatio,t.height/devicePixelRatio]),n.clear({color:e.Color.transparent,depth:1});for(const e of a){const a=r.getTerrainData(e.tileID),c=t.transform.calculatePosMatrix(e.tileID.toUnwrapped());l.draw(n,i.TRIANGLES,o,br.disabled,A,Cr.backCCW,{u_matrix:c},a,"terrain",s.vertexBuffer,s.indexBuffer,s.segments)}n.bindFramebuffer.set(null),n.viewport.set([0,0,t.width,t.height])}(this,this.style.terrain),function(t,r){const n=t.context,i=n.gl,A=wr.unblended,o=new Br(i.LEQUAL,Br.ReadWrite,[0,1]),s=r.getTerrainMesh(),a=r.getCoordsTexture(),l=r.sourceCache.getRenderableTiles(),c=t.useProgram("terrainCoords");n.bindFramebuffer.set(r.getFramebuffer("coords").framebuffer),n.viewport.set([0,0,t.width/devicePixelRatio,t.height/devicePixelRatio]),n.clear({color:e.Color.transparent,depth:1}),r.coordsIndex=[];for(const e of l){const l=r.getTerrainData(e.tileID);n.activeTexture.set(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,a.texture);const u=t.transform.calculatePosMatrix(e.tileID.toUnwrapped());c.draw(n,i.TRIANGLES,o,br.disabled,A,Cr.backCCW,{u_matrix:u,u_terrain_coords_id:(255-r.coordsIndex.length)/255,u_texture:0},l,"terrain",s.vertexBuffer,s.indexBuffer,s.segments),r.coordsIndex.push(e.tileID.key)}n.bindFramebuffer.set(null),n.viewport.set([0,0,t.width,t.height])}(this,this.style.terrain))}this.renderPass="offscreen";for(const e of n){const t=this.style._layers[e];if(!t.hasOffscreenPass()||t.isHidden(this.transform.zoom))continue;const r=s[t.source];("custom"===t.type||r.length)&&this.renderLayer(this,i[t.source],t,r)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:r.showOverdrawInspector?e.Color.black:e.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=r.showOverdrawInspector,this.depthRangeFor3D=[0,1-(t._order.length+2)*this.numSublayers*this.depthEpsilon],!A)for(this.renderPass="opaque",this.currentLayer=n.length-1;this.currentLayer>=0;this.currentLayer--){const e=this.style._layers[n[this.currentLayer]],t=i[e.source],r=o[e.source];this._renderTileClippingMasks(e,r),this.renderLayer(this,t,e,r)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<n.length;this.currentLayer++){const e=this.style._layers[n[this.currentLayer]],t=i[e.source];if(A&&A.renderLayer(e))continue;const r=("symbol"===e.type?a:s)[e.source];this._renderTileClippingMasks(e,o[e.source]),this.renderLayer(this,t,e,r)}if(this.options.showTileBoundaries){let e,t;Object.values(this.style._layers).forEach((r=>{r.source&&!r.isHidden(this.transform.zoom)&&(r.source!==(t&&t.id)&&(t=this.style.sourceCaches[r.source]),(!e||e.getSource().maxzoom<t.getSource().maxzoom)&&(e=t))})),e&&Jr.debug(this,e,e.getVisibleCoordinates())}this.options.showPadding&&function(e){const t=e.transform.padding;$r(e,e.transform.height-(t.top||0),3,zr),$r(e,t.bottom||0,3,Rr),Nr(e,t.left||0,3,Or),Nr(e,e.transform.width-(t.right||0),3,Kr);const r=e.transform.centerPoint;!function(e,t,r,n){Gr(e,t-1,r-10,2,20,n),Gr(e,t-10,r-1,20,2,n)}(e,r.x,e.transform.height-r.y,Vr)}(this),this.context.setDefault()}renderLayer(e,t,r,n){r.isHidden(this.transform.zoom)||("background"===r.type||"custom"===r.type||(n||[]).length)&&(this.id=r.id,this.gpuTimingStart(r),Jr[r.type](e,t,r,n,this.style.placement.variableOffsets),this.gpuTimingEnd())}gpuTimingStart(e){if(!this.options.gpuTiming)return;const t=this.context.extTimerQuery;let r=this.gpuTimers[e.id];r||(r=this.gpuTimers[e.id]={calls:0,cpuTime:0,query:t.createQueryEXT()}),r.calls++,t.beginQueryEXT(t.TIME_ELAPSED_EXT,r.query)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const e=this.context.extTimerQuery;e.endQueryEXT(e.TIME_ELAPSED_EXT)}collectGpuTimers(){const e=this.gpuTimers;return this.gpuTimers={},e}queryGpuTimers(e){const t={};for(const r in e){const n=e[r],i=this.context.extTimerQuery,A=i.getQueryObjectEXT(n.query,i.QUERY_RESULT_EXT)/1e6;i.deleteQueryEXT(n.query),t[r]=A}return t}translatePosMatrix(t,r,n,i,A){if(!n[0]&&!n[1])return t;const o=A?"map"===i?this.transform.angle:0:"viewport"===i?-this.transform.angle:0;if(o){const e=Math.sin(o),t=Math.cos(o);n=[n[0]*t-n[1]*e,n[0]*e+n[1]*t]}const s=[A?n[0]:xe(r,n[0],this.transform.zoom),A?n[1]:xe(r,n[1],this.transform.zoom),0],a=new Float32Array(16);return e.translate(a,t,s),a}saveTileTexture(e){const t=this._tileTextures[e.size[0]];t?t.push(e):this._tileTextures[e.size[0]]=[e]}getTileTexture(e){const t=this._tileTextures[e];return t&&t.length>0?t.pop():null}isPatternMissing(e){if(!e)return!1;if(!e.from||!e.to)return!0;const t=this.imageManager.getPattern(e.from.toString()),r=this.imageManager.getPattern(e.to.toString());return!t||!r}useProgram(e,t){this.cache=this.cache||{};const r=e+(t?t.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.terrain?"/terrain":"");return this.cache[r]||(this.cache[r]=new st(this.context,e,nt[e],t,kt[e],this._showOverdrawInspector,this.style.terrain)),this.cache[r]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new a(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}}class Yr{constructor(e,t){this.points=e,this.planes=t}static fromInvProjectionMatrix(t,r,n){const i=Math.pow(2,n),A=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((n=>{const A=1/(n=e.transformMat4([],n,t))[3]/r*i;return e.mul$1(n,n,[A,A,1/n[3],A])})),o=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map((t=>{const r=e.sub([],A[t[0]],A[t[1]]),n=e.sub([],A[t[2]],A[t[1]]),i=e.normalize([],e.cross([],r,n)),o=-e.dot(i,A[t[1]]);return i.concat(o)}));return new Yr(A,o)}}class en{constructor(t,r){this.min=t,this.max=r,this.center=e.scale$1([],e.add([],this.min,this.max),.5)}quadrant(t){const r=[t%2==0,t<2],n=e.clone$2(this.min),i=e.clone$2(this.max);for(let e=0;e<r.length;e++)n[e]=r[e]?this.min[e]:this.center[e],i[e]=r[e]?this.center[e]:this.max[e];return i[2]=this.max[2],new en(n,i)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}intersects(t){const r=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let n=!0;for(let i=0;i<t.planes.length;i++){const A=t.planes[i];let o=0;for(let t=0;t<r.length;t++)e.dot$1(A,r[t])>=0&&o++;if(0===o)return 0;o!==r.length&&(n=!1)}if(n)return 2;for(let e=0;e<3;e++){let r=Number.MAX_VALUE,n=-Number.MAX_VALUE;for(let i=0;i<t.points.length;i++){const A=t.points[i][e]-this.min[e];r=Math.min(r,A),n=Math.max(n,A)}if(n<0||r>this.max[e]-this.min[e])return 0}return 1}}class tn{constructor(e=0,t=0,r=0,n=0){if(isNaN(e)||e<0||isNaN(t)||t<0||isNaN(r)||r<0||isNaN(n)||n<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=t,this.left=r,this.right=n}interpolate(t,r,n){return null!=r.top&&null!=t.top&&(this.top=e.number(t.top,r.top,n)),null!=r.bottom&&null!=t.bottom&&(this.bottom=e.number(t.bottom,r.bottom,n)),null!=r.left&&null!=t.left&&(this.left=e.number(t.left,r.left,n)),null!=r.right&&null!=t.right&&(this.right=e.number(t.right,r.right,n)),this}getCenter(t,r){const n=e.clamp((this.left+t-this.right)/2,0,t),i=e.clamp((this.top+r-this.bottom)/2,0,r);return new e.pointGeometry(n,i)}equals(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right}clone(){return new tn(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class rn{constructor(t,r,n,i,A){this.tileSize=512,this.maxValidLatitude=85.051129,this.freezeElevation=!1,this._renderWorldCopies=void 0===A||!!A,this._minZoom=t||0,this._maxZoom=r||22,this._minPitch=null==n?0:n,this._maxPitch=null==i?60:i,this.setMaxBounds(),this.width=0,this.height=0,this._center=new e.LngLat(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new tn,this._posMatrixCache={},this._alignedPosMatrixCache={}}clone(){const e=new rn(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return e.tileSize=this.tileSize,e.latRange=this.latRange,e.width=this.width,e.height=this.height,e._center=this._center,e._elevation=this._elevation,e.zoom=this.zoom,e.angle=this.angle,e._fov=this._fov,e._pitch=this._pitch,e._unmodified=this._unmodified,e._edgeInsets=this._edgeInsets.clone(),e._calcMatrices(),e}get minZoom(){return this._minZoom}set minZoom(e){this._minZoom!==e&&(this._minZoom=e,this.zoom=Math.max(this.zoom,e))}get maxZoom(){return this._maxZoom}set maxZoom(e){this._maxZoom!==e&&(this._maxZoom=e,this.zoom=Math.min(this.zoom,e))}get minPitch(){return this._minPitch}set minPitch(e){this._minPitch!==e&&(this._minPitch=e,this.pitch=Math.max(this.pitch,e))}get maxPitch(){return this._maxPitch}set maxPitch(e){this._maxPitch!==e&&(this._maxPitch=e,this.pitch=Math.min(this.pitch,e))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(e){void 0===e?e=!0:null===e&&(e=!1),this._renderWorldCopies=e}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new e.pointGeometry(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(t){const r=-e.wrap(t,-180,180)*Math.PI/180;var n;this.angle!==r&&(this._unmodified=!1,this.angle=r,this._calcMatrices(),this.rotationMatrix=(n=new e.ARRAY_TYPE(4),e.ARRAY_TYPE!=Float32Array&&(n[1]=0,n[2]=0),n[0]=1,n[3]=1,n),function(e,t,r){var n=t[0],i=t[1],A=t[2],o=t[3],s=Math.sin(r),a=Math.cos(r);e[0]=n*a+A*s,e[1]=i*a+o*s,e[2]=n*-s+A*a,e[3]=i*-s+o*a}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(t){const r=e.clamp(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==r&&(this._unmodified=!1,this._pitch=r,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(e){e=Math.max(.01,Math.min(60,e)),this._fov!==e&&(this._unmodified=!1,this._fov=e/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(e){const t=Math.min(Math.max(e,this.minZoom),this.maxZoom);this._zoom!==t&&(this._unmodified=!1,this._zoom=t,this.scale=this.zoomScale(t),this.tileZoom=Math.floor(t),this.zoomFraction=t-this.tileZoom,this._constrain(),this._calcMatrices())}get center(){return this._center}set center(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(e){e!==this._elevation&&(this._elevation=e,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(e){return this._edgeInsets.equals(e)}interpolatePadding(e,t,r){this._unmodified=!1,this._edgeInsets.interpolate(e,t,r),this._constrain(),this._calcMatrices()}coveringZoomLevel(e){const t=(e.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/e.tileSize));return Math.max(0,t)}getVisibleUnwrappedCoordinates(t){const r=[new e.UnwrappedTileID(0,t)];if(this._renderWorldCopies){const n=this.pointCoordinate(new e.pointGeometry(0,0)),i=this.pointCoordinate(new e.pointGeometry(this.width,0)),A=this.pointCoordinate(new e.pointGeometry(this.width,this.height)),o=this.pointCoordinate(new e.pointGeometry(0,this.height)),s=Math.floor(Math.min(n.x,i.x,A.x,o.x)),a=Math.floor(Math.max(n.x,i.x,A.x,o.x)),l=1;for(let n=s-l;n<=a+l;n++)0!==n&&r.push(new e.UnwrappedTileID(n,t))}return r}coveringTiles(t){var r,n;let i=this.coveringZoomLevel(t);const A=i;if(void 0!==t.minzoom&&i<t.minzoom)return[];void 0!==t.maxzoom&&i>t.maxzoom&&(i=t.maxzoom);const o=this.pointCoordinate(this.getCameraPoint()),s=e.MercatorCoordinate.fromLngLat(this.center),a=Math.pow(2,i),l=[a*o.x,a*o.y,0],c=[a*s.x,a*s.y,0],u=Yr.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,i);let h=t.minzoom||0;!t.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(h=i);const d=t.terrain?2/Math.min(this.tileSize,t.tileSize)*this.tileSize:3,p=e=>({aabb:new en([e*a,0,0],[(e+1)*a,a,0]),zoom:0,x:0,y:0,wrap:e,fullyVisible:!1}),f=[],m=[],g=i,y=t.reparseOverscaled?A:i;if(this._renderWorldCopies)for(let e=1;e<=3;e++)f.push(p(-e)),f.push(p(e));for(f.push(p(0));f.length>0;){const i=f.pop(),A=i.x,o=i.y;let s=i.fullyVisible;if(!s){const e=i.aabb.intersects(u);if(0===e)continue;s=2===e}const a=t.terrain?l:c,p=i.aabb.distanceX(a),_=i.aabb.distanceY(a),w=Math.max(Math.abs(p),Math.abs(_)),x=d+(1<<g-i.zoom)-2;if(i.zoom===g||w>x&&i.zoom>=h){const t=g-i.zoom,r=l[0]-.5-(A<<t),n=l[1]-.5-(o<<t);m.push({tileID:new e.OverscaledTileID(i.zoom===g?y:i.zoom,i.wrap,i.zoom,A,o),distanceSq:e.sqrLen([c[0]-.5-A,c[1]-.5-o]),tileDistanceToCamera:Math.sqrt(r*r+n*n)})}else for(let a=0;a<4;a++){const l=(A<<1)+a%2,c=(o<<1)+(a>>1),u=i.zoom+1;let h=i.aabb.quadrant(a);if(t.terrain){const A=new e.OverscaledTileID(u,i.wrap,u,l,c),o=t.terrain.getMinMaxElevation(A),s=null!==(r=o.minElevation)&&void 0!==r?r:this.elevation,a=null!==(n=o.maxElevation)&&void 0!==n?n:this.elevation;h=new en([h.min[0],h.min[1],s],[h.max[0],h.max[1],a])}f.push({aabb:h,zoom:u,x:l,y:c,wrap:i.wrap,fullyVisible:s})}}return m.sort(((e,t)=>e.distanceSq-t.distanceSq)).map((e=>e.tileID))}resize(e,t){this.width=e,this.height=t,this.pixelsToGLUnits=[2/e,-2/t],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(e){return Math.pow(2,e)}scaleZoom(e){return Math.log(e)/Math.LN2}project(t){const r=e.clamp(t.lat,-this.maxValidLatitude,this.maxValidLatitude);return new e.pointGeometry(e.mercatorXfromLng(t.lng)*this.worldSize,e.mercatorYfromLat(r)*this.worldSize)}unproject(t){return new e.MercatorCoordinate(t.x/this.worldSize,t.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}updateElevation(e){this.freezeElevation||(this.elevation=e?this.getElevation(this._center,e):0)}getElevation(t,r){const n=e.MercatorCoordinate.fromLngLat(t),i=(1<<this.tileZoom)*e.EXTENT,A=n.x*i,o=n.y*i,s=Math.floor(A/e.EXTENT),a=Math.floor(o/e.EXTENT),l=new e.OverscaledTileID(this.tileZoom,0,this.tileZoom,s,a);return r.getElevation(l,A%e.EXTENT,o%e.EXTENT,e.EXTENT)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(t){const r=this.pointLocation(this.centerPoint,t),n=this.getElevation(r,t);if(!(this.elevation-n))return;const i=this.getCameraPosition(),A=e.MercatorCoordinate.fromLngLat(i.lngLat,i.altitude),o=e.MercatorCoordinate.fromLngLat(r,n),s=A.x-o.x,a=A.y-o.y,l=A.z-o.z,c=Math.sqrt(s*s+a*a+l*l),u=this.scaleZoom(this.cameraToCenterDistance/c/this.tileSize);this._elevation=n,this._center=r,this.zoom=u}setLocationAtPoint(t,r){const n=this.pointCoordinate(r),i=this.pointCoordinate(this.centerPoint),A=this.locationCoordinate(t),o=new e.MercatorCoordinate(A.x-(n.x-i.x),A.y-(n.y-i.y));this.center=this.coordinateLocation(o),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(e,t){return t?this.coordinatePoint(this.locationCoordinate(e),this.getElevation(e,t),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(e))}pointLocation(e,t){return this.coordinateLocation(this.pointCoordinate(e,t))}locationCoordinate(t){return e.MercatorCoordinate.fromLngLat(t)}coordinateLocation(e){return e&&e.toLngLat()}pointCoordinate(t,r){if(r){const e=r.pointCoordinate(t);if(null!=e)return e}const n=[t.x,t.y,0,1],i=[t.x,t.y,1,1];e.transformMat4(n,n,this.pixelMatrixInverse),e.transformMat4(i,i,this.pixelMatrixInverse);const A=n[3],o=i[3],s=n[1]/A,a=i[1]/o,l=n[2]/A,c=i[2]/o,u=l===c?0:(0-l)/(c-l);return new e.MercatorCoordinate(e.number(n[0]/A,i[0]/o,u)/this.worldSize,e.number(s,a,u)/this.worldSize)}coordinatePoint(t,r=0,n=this.pixelMatrix){const i=[t.x*this.worldSize,t.y*this.worldSize,r,1];return e.transformMat4(i,i,n),new e.pointGeometry(i[0]/i[3],i[1]/i[3])}getBounds(){const t=Math.max(0,this.height/2-this.getHorizon());return(new e.LngLatBounds).extend(this.pointLocation(new e.pointGeometry(0,t))).extend(this.pointLocation(new e.pointGeometry(this.width,t))).extend(this.pointLocation(new e.pointGeometry(this.width,this.height))).extend(this.pointLocation(new e.pointGeometry(0,this.height)))}getMaxBounds(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new e.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(e){e?(this.lngRange=[e.getWest(),e.getEast()],this.latRange=[e.getSouth(),e.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(t,r=!1){const n=t.key,i=r?this._alignedPosMatrixCache:this._posMatrixCache;if(i[n])return i[n];const A=t.canonical,o=this.worldSize/this.zoomScale(A.z),s=A.x+Math.pow(2,A.z)*t.wrap,a=e.identity(new Float64Array(16));return e.translate(a,a,[s*o,A.y*o,0]),e.scale(a,a,[o/e.EXTENT,o/e.EXTENT,1]),e.multiply(a,r?this.alignedProjMatrix:this.projMatrix,a),i[n]=new Float32Array(a),i[n]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let t,r,n,i,A=-90,o=90,s=-180,a=180;const l=this.size,c=this._unmodified;if(this.latRange){const r=this.latRange;A=e.mercatorYfromLat(r[1])*this.worldSize,o=e.mercatorYfromLat(r[0])*this.worldSize,t=o-A<l.y?l.y/(o-A):0}if(this.lngRange){const t=this.lngRange;s=e.wrap(e.mercatorXfromLng(t[0])*this.worldSize,0,this.worldSize),a=e.wrap(e.mercatorXfromLng(t[1])*this.worldSize,0,this.worldSize),a<s&&(a+=this.worldSize),r=a-s<l.x?l.x/(a-s):0}const u=this.point,h=Math.max(r||0,t||0);if(h)return this.center=this.unproject(new e.pointGeometry(r?(a+s)/2:u.x,t?(o+A)/2:u.y)),this.zoom+=this.scaleZoom(h),this._unmodified=c,void(this._constraining=!1);if(this.latRange){const e=u.y,t=l.y/2;e-t<A&&(i=A+t),e+t>o&&(i=o-t)}if(this.lngRange){const t=(s+a)/2,r=e.wrap(u.x,t-this.worldSize/2,t+this.worldSize/2),i=l.x/2;r-i<s&&(n=s+i),r+i>a&&(n=a-i)}void 0===n&&void 0===i||(this.center=this.unproject(new e.pointGeometry(void 0!==n?n:u.x,void 0!==i?i:u.y)).wrap()),this._unmodified=c,this._constraining=!1}_calcMatrices(){if(!this.height)return;const t=this.centerOffset,r=this.point.x,n=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=e.mercatorZfromAltitude(1,this.center.lat)*this.worldSize;let i=e.identity(new Float64Array(16));e.scale(i,i,[this.width/2,-this.height/2,1]),e.translate(i,i,[1,-1,0]),this.labelPlaneMatrix=i,i=e.identity(new Float64Array(16)),e.scale(i,i,[1,-1,1]),e.translate(i,i,[-1,-1,0]),e.scale(i,i,[2/this.width,2/this.height,1]),this.glCoordMatrix=i,this.cameraToSeaLevelDistance=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch);const A=Math.PI/2+this._pitch,o=this._fov*(.5+t.y/this.height),s=Math.sin(o)*this.cameraToSeaLevelDistance/Math.sin(e.clamp(Math.PI-A-o,.01,Math.PI-.01)),a=this.getHorizon(),l=2*Math.atan(a/this.cameraToCenterDistance)*(.5+t.y/(2*a)),c=Math.sin(l)*this.cameraToSeaLevelDistance/Math.sin(e.clamp(Math.PI-A-l,.01,Math.PI-.01)),u=Math.cos(Math.PI/2-this._pitch)*s+this.cameraToSeaLevelDistance,h=Math.cos(Math.PI/2-this._pitch)*c+this.cameraToSeaLevelDistance,d=1.01*Math.min(u,h),p=this.height/50;i=new Float64Array(16),e.perspective(i,this._fov,this.width/this.height,p,d),i[8]=2*-t.x/this.width,i[9]=2*t.y/this.height,e.scale(i,i,[1,-1,1]),e.translate(i,i,[0,0,-this.cameraToCenterDistance]),e.rotateX(i,i,this._pitch),e.rotateZ(i,i,this.angle),e.translate(i,i,[-r,-n,0]),this.mercatorMatrix=e.scale([],i,[this.worldSize,this.worldSize,this.worldSize]),e.scale(i,i,[1,1,this._pixelPerMeter]),this.pixelMatrix=e.multiply(new Float64Array(16),this.labelPlaneMatrix,i),e.translate(i,i,[0,0,-this.elevation]),this.projMatrix=i,this.invProjMatrix=e.invert([],i),this.pixelMatrix3D=e.multiply(new Float64Array(16),this.labelPlaneMatrix,i);const f=this.width%2/2,m=this.height%2/2,g=Math.cos(this.angle),y=Math.sin(this.angle),_=r-Math.round(r)+g*f+y*m,w=n-Math.round(n)+g*m+y*f,x=new Float64Array(i);if(e.translate(x,x,[_>.5?_-1:_,w>.5?w-1:w,0]),this.alignedProjMatrix=x,i=e.invert(new Float64Array(16),this.pixelMatrix),!i)throw new Error("failed to invert matrix");this.pixelMatrixInverse=i,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const t=this.pointCoordinate(new e.pointGeometry(0,0)),r=[t.x*this.worldSize,t.y*this.worldSize,0,1];return e.transformMat4(r,r,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const t=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new e.pointGeometry(0,t))}getCameraQueryGeometry(t){const r=this.getCameraPoint();if(1===t.length)return[t[0],r];{let n=r.x,i=r.y,A=r.x,o=r.y;for(const e of t)n=Math.min(n,e.x),i=Math.min(i,e.y),A=Math.max(A,e.x),o=Math.max(o,e.y);return[new e.pointGeometry(n,i),new e.pointGeometry(A,i),new e.pointGeometry(A,o),new e.pointGeometry(n,o),new e.pointGeometry(n,i)]}}}class nn{constructor(t){this._hashName=t&&encodeURIComponent(t),e.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=function(e,t){let r=!1,n=null;const i=()=>{n=null,r&&(e(),n=setTimeout(i,300),r=!1)};return()=>(r=!0,n||i(),n)}(this._updateHashUnthrottled.bind(this))}addTo(e){return this._map=e,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(e){const t=this._map.getCenter(),r=Math.round(100*this._map.getZoom())/100,n=Math.ceil((r*Math.LN2+Math.log(512/360/.5))/Math.LN10),i=Math.pow(10,n),A=Math.round(t.lng*i)/i,o=Math.round(t.lat*i)/i,s=this._map.getBearing(),a=this._map.getPitch();let l="";if(l+=e?`/${A}/${o}/${r}`:`${r}/${o}/${A}`,(s||a)&&(l+="/"+Math.round(10*s)/10),a&&(l+=`/${Math.round(a)}`),this._hashName){const e=this._hashName;let t=!1;const r=window.location.hash.slice(1).split("&").map((r=>{const n=r.split("=")[0];return n===e?(t=!0,`${n}=${l}`):r})).filter((e=>e));return t||r.push(`${e}=${l}`),`#${r.join("&")}`}return`#${l}`}_getCurrentHash(){const e=window.location.hash.replace("#","");if(this._hashName){let t;return e.split("&").map((e=>e.split("="))).forEach((e=>{e[0]===this._hashName&&(t=e)})),(t&&t[1]||"").split("/")}return e.split("/")}_onHashChange(){const e=this._getCurrentHash();if(e.length>=3&&!e.some((e=>isNaN(e)))){const t=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(e[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+e[2],+e[1]],zoom:+e[0],bearing:t,pitch:+(e[4]||0)}),!0}return!1}_updateHashUnthrottled(){const e=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,e)}catch(e){}}}const An={linearity:.3,easing:e.bezier(0,0,.3,1)},on=e.extend({deceleration:2500,maxSpeed:1400},An),sn=e.extend({deceleration:20,maxSpeed:1400},An),an=e.extend({deceleration:1e3,maxSpeed:360},An),ln=e.extend({deceleration:1e3,maxSpeed:90},An);class cn{constructor(e){this._map=e,this.clear()}clear(){this._inertiaBuffer=[]}record(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:e.exported.now(),settings:t})}_drainInertiaBuffer(){const t=this._inertiaBuffer,r=e.exported.now();for(;t.length>0&&r-t[0].time>160;)t.shift()}_onMoveEnd(t){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const r={zoom:0,bearing:0,pitch:0,pan:new e.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:e}of this._inertiaBuffer)r.zoom+=e.zoomDelta||0,r.bearing+=e.bearingDelta||0,r.pitch+=e.pitchDelta||0,e.panDelta&&r.pan._add(e.panDelta),e.around&&(r.around=e.around),e.pinchAround&&(r.pinchAround=e.pinchAround);const n=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,i={};if(r.pan.mag()){const A=hn(r.pan.mag(),n,e.extend({},on,t||{}));i.offset=r.pan.mult(A.amount/r.pan.mag()),i.center=this._map.transform.center,un(i,A)}if(r.zoom){const e=hn(r.zoom,n,sn);i.zoom=this._map.transform.zoom+e.amount,un(i,e)}if(r.bearing){const t=hn(r.bearing,n,an);i.bearing=this._map.transform.bearing+e.clamp(t.amount,-179,179),un(i,t)}if(r.pitch){const e=hn(r.pitch,n,ln);i.pitch=this._map.transform.pitch+e.amount,un(i,e)}if(i.zoom||i.bearing){const e=void 0===r.pinchAround?r.around:r.pinchAround;i.around=e?this._map.unproject(e):this._map.getCenter()}return this.clear(),e.extend(i,{noMoveStart:!0})}}function un(e,t){(!e.duration||e.duration<t.duration)&&(e.duration=t.duration,e.easing=t.easing)}function hn(t,r,n){const{maxSpeed:i,linearity:A,deceleration:o}=n,s=e.clamp(t*A/(r/1e3),-i,i),a=Math.abs(s)/(o*A);return{easing:n.easing,duration:1e3*a,amount:s*(a/2)}}class dn extends e.Event{constructor(t,r,n,i={}){const o=A.mousePos(r.getCanvasContainer(),n),s=r.unproject(o);super(t,e.extend({point:o,lngLat:s,originalEvent:n},i)),this._defaultPrevented=!1,this.target=r}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class pn extends e.Event{constructor(t,r,n){const i="touchend"===t?n.changedTouches:n.touches,o=A.touchPos(r.getCanvasContainer(),i),s=o.map((e=>r.unproject(e))),a=o.reduce(((e,t,r,n)=>e.add(t.div(n.length))),new e.pointGeometry(0,0));super(t,{points:o,point:a,lngLats:s,lngLat:r.unproject(a),originalEvent:n}),this._defaultPrevented=!1}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class fn extends e.Event{constructor(e,t,r){super(e,{originalEvent:r}),this._defaultPrevented=!1}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class mn{constructor(e,t){this._map=e,this._clickTolerance=t.clickTolerance}reset(){delete this._mousedownPos}wheel(e){return this._firePreventable(new fn(e.type,this._map,e))}mousedown(e,t){return this._mousedownPos=t,this._firePreventable(new dn(e.type,this._map,e))}mouseup(e){this._map.fire(new dn(e.type,this._map,e))}click(e,t){this._mousedownPos&&this._mousedownPos.dist(t)>=this._clickTolerance||this._map.fire(new dn(e.type,this._map,e))}dblclick(e){return this._firePreventable(new dn(e.type,this._map,e))}mouseover(e){this._map.fire(new dn(e.type,this._map,e))}mouseout(e){this._map.fire(new dn(e.type,this._map,e))}touchstart(e){return this._firePreventable(new pn(e.type,this._map,e))}touchmove(e){this._map.fire(new pn(e.type,this._map,e))}touchend(e){this._map.fire(new pn(e.type,this._map,e))}touchcancel(e){this._map.fire(new pn(e.type,this._map,e))}_firePreventable(e){if(this._map.fire(e),e.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class gn{constructor(e){this._map=e}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(e){this._map.fire(new dn(e.type,this._map,e))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new dn("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(e){this._delayContextMenu?this._contextMenuEvent=e:this._ignoreContextMenu||this._map.fire(new dn(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class yn{constructor(e,t){this._map=e,this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=t.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(e,t){this.isEnabled()&&e.shiftKey&&0===e.button&&(A.disableDrag(),this._startPos=this._lastPos=t,this._active=!0)}mousemoveWindow(e,t){if(!this._active)return;const r=t;if(this._lastPos.equals(r)||!this._box&&r.dist(this._startPos)<this._clickTolerance)return;const n=this._startPos;this._lastPos=r,this._box||(this._box=A.create("div","maplibregl-boxzoom mapboxgl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair","mapboxgl-crosshair"),this._fireEvent("boxzoomstart",e));const i=Math.min(n.x,r.x),o=Math.max(n.x,r.x),s=Math.min(n.y,r.y),a=Math.max(n.y,r.y);A.setTransform(this._box,`translate(${i}px,${s}px)`),this._box.style.width=o-i+"px",this._box.style.height=a-s+"px"}mouseupWindow(t,r){if(!this._active)return;if(0!==t.button)return;const n=this._startPos,i=r;if(this.reset(),A.suppressClick(),n.x!==i.x||n.y!==i.y)return this._map.fire(new e.Event("boxzoomend",{originalEvent:t})),{cameraAnimation:e=>e.fitScreenCoordinates(n,i,this._map.getBearing(),{linear:!0})};this._fireEvent("boxzoomcancel",t)}keydown(e){this._active&&27===e.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",e))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair","mapboxgl-crosshair"),this._box&&(A.remove(this._box),this._box=null),A.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(t,r){return this._map.fire(new e.Event(t,{originalEvent:r}))}}function _n(e,t){if(e.length!==t.length)throw new Error(`The number of touches and points are not equal - touches ${e.length}, points ${t.length}`);const r={};for(let n=0;n<e.length;n++)r[e[n].identifier]=t[n];return r}class wn{constructor(e){this.reset(),this.numTouches=e.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(t,r,n){(this.centroid||n.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=t.timeStamp),n.length===this.numTouches&&(this.centroid=function(t){const r=new e.pointGeometry(0,0);for(const e of t)r._add(e);return r.div(t.length)}(r),this.touches=_n(n,r)))}touchmove(e,t,r){if(this.aborted||!this.centroid)return;const n=_n(r,t);for(const e in this.touches){const t=this.touches[e],r=n[e];(!r||r.dist(t)>30)&&(this.aborted=!0)}}touchend(e,t,r){if((!this.centroid||e.timeStamp-this.startTime>500)&&(this.aborted=!0),0===r.length){const e=!this.aborted&&this.centroid;if(this.reset(),e)return e}}}class xn{constructor(e){this.singleTap=new wn(e),this.numTaps=e.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(e,t,r){this.singleTap.touchstart(e,t,r)}touchmove(e,t,r){this.singleTap.touchmove(e,t,r)}touchend(e,t,r){const n=this.singleTap.touchend(e,t,r);if(n){const t=e.timeStamp-this.lastTime<500,r=!this.lastTap||this.lastTap.dist(n)<30;if(t&&r||this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=n,this.count===this.numTaps)return this.reset(),n}}}class Bn{constructor(){this._zoomIn=new xn({numTouches:1,numTaps:2}),this._zoomOut=new xn({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(e,t,r){this._zoomIn.touchstart(e,t,r),this._zoomOut.touchstart(e,t,r)}touchmove(e,t,r){this._zoomIn.touchmove(e,t,r),this._zoomOut.touchmove(e,t,r)}touchend(e,t,r){const n=this._zoomIn.touchend(e,t,r),i=this._zoomOut.touchend(e,t,r);return n?(this._active=!0,e.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:t=>t.easeTo({duration:300,zoom:t.getZoom()+1,around:t.unproject(n)},{originalEvent:e})}):i?(this._active=!0,e.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:t=>t.easeTo({duration:300,zoom:t.getZoom()-1,around:t.unproject(i)},{originalEvent:e})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const vn={0:1,2:2};class bn{constructor(e){this.reset(),this._clickTolerance=e.clickTolerance||1}reset(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton}_correctButton(e,t){return!1}_move(e,t){return{}}mousedown(e,t){if(this._lastPoint)return;const r=A.mouseButton(e);this._correctButton(e,r)&&(this._lastPoint=t,this._eventButton=r)}mousemoveWindow(e,t){const r=this._lastPoint;if(r)if(e.preventDefault(),function(e,t){const r=vn[t];return void 0===e.buttons||(e.buttons&r)!==r}(e,this._eventButton))this.reset();else if(this._moved||!(t.dist(r)<this._clickTolerance))return this._moved=!0,this._lastPoint=t,this._move(r,t)}mouseupWindow(e){this._lastPoint&&A.mouseButton(e)===this._eventButton&&(this._moved&&A.suppressClick(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Cn extends bn{mousedown(e,t){super.mousedown(e,t),this._lastPoint&&(this._active=!0)}_correctButton(e,t){return 0===t&&!e.ctrlKey}_move(e,t){return{around:t,panDelta:t.sub(e)}}}class Fn extends bn{_correctButton(e,t){return 0===t&&e.ctrlKey||2===t}_move(e,t){const r=.8*(t.x-e.x);if(r)return this._active=!0,{bearingDelta:r}}contextmenu(e){e.preventDefault()}}class En extends bn{_correctButton(e,t){return 0===t&&e.ctrlKey||2===t}_move(e,t){const r=-.5*(t.y-e.y);if(r)return this._active=!0,{pitchDelta:r}}contextmenu(e){e.preventDefault()}}class Un{constructor(e,t){this._minTouches=e.cooperativeGestures?2:1,this._clickTolerance=e.clickTolerance||1,this._map=t,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new e.pointGeometry(0,0),setTimeout((()=>{this._cancelCooperativeMessage=!1}),200)}touchstart(e,t,r){return this._calculateTransform(e,t,r)}touchmove(e,t,r){if(this._map._cooperativeGestures&&(2===this._minTouches&&r.length<2&&!this._cancelCooperativeMessage?this._map._onCooperativeGesture(e,!1,r.length):this._cancelCooperativeMessage||(this._cancelCooperativeMessage=!0)),this._active&&!(r.length<this._minTouches))return e.preventDefault(),this._calculateTransform(e,t,r)}touchend(e,t,r){this._calculateTransform(e,t,r),this._active&&r.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(t,r,n){n.length>0&&(this._active=!0);const i=_n(n,r),A=new e.pointGeometry(0,0),o=new e.pointGeometry(0,0);let s=0;for(const e in i){const t=i[e],r=this._touches[e];r&&(A._add(t),o._add(t.sub(r)),s++,i[e]=t)}if(this._touches=i,s<this._minTouches||!o.mag())return;const a=o.div(s);return this._sum._add(a),this._sum.mag()<this._clickTolerance?void 0:{around:A.div(s),panDelta:a}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Qn{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}_start(e){}_move(e,t,r){return{}}touchstart(e,t,r){this._firstTwoTouches||r.length<2||(this._firstTwoTouches=[r[0].identifier,r[1].identifier],this._start([t[0],t[1]]))}touchmove(e,t,r){if(!this._firstTwoTouches)return;e.preventDefault();const[n,i]=this._firstTwoTouches,A=In(r,t,n),o=In(r,t,i);if(!A||!o)return;const s=this._aroundCenter?null:A.add(o).div(2);return this._move([A,o],s,e)}touchend(e,t,r){if(!this._firstTwoTouches)return;const[n,i]=this._firstTwoTouches,o=In(r,t,n),s=In(r,t,i);o&&s||(this._active&&A.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(e){this._enabled=!0,this._aroundCenter=!!e&&"center"===e.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function In(e,t,r){for(let n=0;n<e.length;n++)if(e[n].identifier===r)return t[n]}function Tn(e,t){return Math.log(e/t)/Math.LN2}class Sn extends Qn{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(e){this._startDistance=this._distance=e[0].dist(e[1])}_move(e,t){const r=this._distance;if(this._distance=e[0].dist(e[1]),this._active||!(Math.abs(Tn(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Tn(this._distance,r),pinchAround:t}}}function Mn(e,t){return 180*e.angleWith(t)/Math.PI}class kn extends Qn{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])}_move(e,t){const r=this._vector;if(this._vector=e[0].sub(e[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Mn(this._vector,r),pinchAround:t}}_isBelowThreshold(e){this._minDiameter=Math.min(this._minDiameter,e.mag());const t=25/(Math.PI*this._minDiameter)*360,r=Mn(e,this._startVector);return Math.abs(r)<t}}function Dn(e){return Math.abs(e.y)>Math.abs(e.x)}class Ln extends Qn{constructor(e){super(),this._map=e}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(e,t,r){super.touchstart(e,t,r),this._currentTouchCount=r.length}_start(e){this._lastPoints=e,Dn(e[0].sub(e[1]))&&(this._valid=!1)}_move(e,t,r){if(this._map._cooperativeGestures&&this._currentTouchCount<3)return;const n=e[0].sub(this._lastPoints[0]),i=e[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(n,i,r.timeStamp),this._valid?(this._lastPoints=e,this._active=!0,{pitchDelta:(n.y+i.y)/2*-.5}):void 0}gestureBeginsVertically(e,t,r){if(void 0!==this._valid)return this._valid;const n=e.mag()>=2,i=t.mag()>=2;if(!n&&!i)return;if(!n||!i)return void 0===this._firstMove&&(this._firstMove=r),r-this._firstMove<100&&void 0;const A=e.y>0==t.y>0;return Dn(e)&&Dn(t)&&A}}const Pn={panStep:100,bearingStep:15,pitchStep:10};class Hn{constructor(){const e=Pn;this._panStep=e.panStep,this._bearingStep=e.bearingStep,this._pitchStep=e.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(e){if(e.altKey||e.ctrlKey||e.metaKey)return;let t=0,r=0,n=0,i=0,A=0;switch(e.keyCode){case 61:case 107:case 171:case 187:t=1;break;case 189:case 109:case 173:t=-1;break;case 37:e.shiftKey?r=-1:(e.preventDefault(),i=-1);break;case 39:e.shiftKey?r=1:(e.preventDefault(),i=1);break;case 38:e.shiftKey?n=1:(e.preventDefault(),A=-1);break;case 40:e.shiftKey?n=-1:(e.preventDefault(),A=1);break;default:return}return this._rotationDisabled&&(r=0,n=0),{cameraAnimation:o=>{const s=o.getZoom();o.easeTo({duration:300,easeId:"keyboardHandler",easing:zn,zoom:t?Math.round(s)+t*(e.shiftKey?2:1):s,bearing:o.getBearing()+r*this._bearingStep,pitch:o.getPitch()+n*this._pitchStep,offset:[-i*this._panStep,-A*this._panStep],center:o.getCenter()},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function zn(e){return e*(2-e)}const Rn=4.000244140625;class On{constructor(t,r){this._map=t,this._el=t.getCanvasContainer(),this._handler=r,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,e.bindAll(["_onTimeout"],this)}setZoomRate(e){this._defaultZoomRate=e}setWheelZoomRate(e){this._wheelZoomRate=e}isEnabled(){return!!this._enabled}isActive(){return!!this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=e&&"center"===e.around)}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(t){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!this._map._metaPress)return;t.preventDefault()}let r=t.deltaMode===WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY;const n=e.exported.now(),i=n-(this._lastWheelEventTime||0);this._lastWheelEventTime=n,0!==r&&r%Rn==0?this._type="wheel":0!==r&&Math.abs(r)<4?this._type="trackpad":i>400?(this._type=null,this._lastValue=r,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(i*r)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,r+=this._lastValue)),t.shiftKey&&r&&(r/=4),this._type&&(this._lastWheelEvent=t,this._delta-=r,this._active||this._start(t)),t.preventDefault()}_onTimeout(e){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(e)}_start(t){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const r=A.mousePos(this._el,t);this._around=e.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(r)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId)return;if(this._frameId=null,!this.isActive())return;const t=this._map.transform;if(0!==this._delta){const e="wheel"===this._type&&Math.abs(this._delta)>Rn?this._wheelZoomRate:this._defaultZoomRate;let r=2/(1+Math.exp(-Math.abs(this._delta*e)));this._delta<0&&0!==r&&(r=1/r);const n="number"==typeof this._targetZoom?t.zoomScale(this._targetZoom):t.scale;this._targetZoom=Math.min(t.maxZoom,Math.max(t.minZoom,t.scaleZoom(n*r))),"wheel"===this._type&&(this._startZoom=t.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const r="number"==typeof this._targetZoom?this._targetZoom:t.zoom,n=this._startZoom,i=this._easing;let A,o=!1;if("wheel"===this._type&&n&&i){const t=Math.min((e.exported.now()-this._lastWheelEventTime)/200,1),s=i(t);A=e.number(n,r,s),t<1?this._frameId||(this._frameId=!0):o=!0}else A=r,o=!0;return this._active=!0,o&&(this._active=!1,this._finishTimeout=setTimeout((()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout}),200)),{noInertia:!0,needsRenderFrame:!o,zoomDelta:A-t.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(t){let r=e.ease;if(this._prevEase){const t=this._prevEase,n=(e.exported.now()-t.start)/t.duration,i=t.easing(n+.01)-t.easing(n),A=.27/Math.sqrt(i*i+1e-4)*.01,o=Math.sqrt(.0729-A*A);r=e.bezier(A,o,.25,1)}return this._prevEase={start:e.exported.now(),duration:t,easing:r},r}reset(){this._active=!1}}class Kn{constructor(e,t){this._clickZoom=e,this._tapZoom=t}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Vn{constructor(){this.reset()}reset(){this._active=!1}dblclick(e,t){return e.preventDefault(),{cameraAnimation:r=>{r.easeTo({duration:300,zoom:r.getZoom()+(e.shiftKey?-1:1),around:r.unproject(t)},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class $n{constructor(){this._tap=new xn({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()}touchstart(e,t,r){this._swipePoint||(this._tapTime&&e.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?r.length>0&&(this._swipePoint=t[0],this._swipeTouch=r[0].identifier):this._tap.touchstart(e,t,r))}touchmove(e,t,r){if(this._tapTime){if(this._swipePoint){if(r[0].identifier!==this._swipeTouch)return;const n=t[0],i=n.y-this._swipePoint.y;return this._swipePoint=n,e.preventDefault(),this._active=!0,{zoomDelta:i/128}}}else this._tap.touchmove(e,t,r)}touchend(e,t,r){this._tapTime?this._swipePoint&&0===r.length&&this.reset():this._tap.touchend(e,t,r)&&(this._tapTime=e.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Nn{constructor(e,t,r){this._el=e,this._mousePan=t,this._touchPan=r}enable(e){this._inertiaOptions=e||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Gn{constructor(e,t,r){this._pitchWithRotate=e.pitchWithRotate,this._mouseRotate=t,this._mousePitch=r}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class qn{constructor(e,t,r,n){this._el=e,this._touchZoom=t,this._touchRotate=r,this._tapDragZoom=n,this._rotationDisabled=!1,this._enabled=!0}enable(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Xn=e=>e.zoom||e.drag||e.pitch||e.rotate;class jn extends e.Event{}function Zn(e){return e.panDelta&&e.panDelta.mag()||e.zoomDelta||e.bearingDelta||e.pitchDelta}class Jn{constructor(t,r){this._map=t,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new cn(t),this._bearingSnap=r.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(r),e.bindAll(["handleEvent","handleWindowEvent"],this);const n=this._el;this._listeners=[[n,"touchstart",{passive:!0}],[n,"touchmove",{passive:!1}],[n,"touchend",void 0],[n,"touchcancel",void 0],[n,"mousedown",void 0],[n,"mousemove",void 0],[n,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[n,"mouseover",void 0],[n,"mouseout",void 0],[n,"dblclick",void 0],[n,"click",void 0],[n,"keydown",{capture:!1}],[n,"keyup",void 0],[n,"wheel",{passive:!1}],[n,"contextmenu",void 0],[window,"blur",void 0]];for(const[e,t,r]of this._listeners)A.addEventListener(e,t,e===document?this.handleWindowEvent:this.handleEvent,r)}destroy(){for(const[e,t,r]of this._listeners)A.removeEventListener(e,t,e===document?this.handleWindowEvent:this.handleEvent,r)}_addDefaultHandlers(e){const t=this._map,r=t.getCanvasContainer();this._add("mapEvent",new mn(t,e));const n=t.boxZoom=new yn(t,e);this._add("boxZoom",n);const i=new Bn,A=new Vn;t.doubleClickZoom=new Kn(A,i),this._add("tapZoom",i),this._add("clickZoom",A);const o=new $n;this._add("tapDragZoom",o);const s=t.touchPitch=new Ln(t);this._add("touchPitch",s);const a=new Fn(e),l=new En(e);t.dragRotate=new Gn(e,a,l),this._add("mouseRotate",a,["mousePitch"]),this._add("mousePitch",l,["mouseRotate"]);const c=new Cn(e),u=new Un(e,t);t.dragPan=new Nn(r,c,u),this._add("mousePan",c),this._add("touchPan",u,["touchZoom","touchRotate"]);const h=new kn,d=new Sn;t.touchZoomRotate=new qn(r,d,h,o),this._add("touchRotate",h,["touchPan","touchZoom"]),this._add("touchZoom",d,["touchPan","touchRotate"]);const p=t.scrollZoom=new On(t,this);this._add("scrollZoom",p,["mousePan"]);const f=t.keyboard=new Hn;this._add("keyboard",f),this._add("blockableMapEvent",new gn(t));for(const r of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])e.interactive&&e[r]&&t[r].enable(e[r])}_add(e,t,r){this._handlers.push({handlerName:e,handler:t,allowed:r}),this._handlersById[e]=t}stop(e){if(!this._updatingCamera){for(const{handler:e}of this._handlers)e.reset();this._inertia.clear(),this._fireEvents({},{},e),this._changes=[]}}isActive(){for(const{handler:e}of this._handlers)if(e.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return Boolean(Xn(this._eventsInProgress))||this.isZooming()}_blockedByActive(e,t,r){for(const n in e)if(n!==r&&(!t||t.indexOf(n)<0))return!0;return!1}handleWindowEvent(e){this.handleEvent(e,`${e.type}Window`)}_getMapTouches(e){const t=[];for(const r of e)this._el.contains(r.target)&&t.push(r);return t}handleEvent(e,t){if("blur"===e.type)return void this.stop(!0);this._updatingCamera=!0;const r="renderFrame"===e.type?void 0:e,n={needsRenderFrame:!1},i={},o={},s=e.touches,a=s?this._getMapTouches(s):void 0,l=a?A.touchPos(this._el,a):A.mousePos(this._el,e);for(const{handlerName:A,handler:s,allowed:c}of this._handlers){if(!s.isEnabled())continue;let u;this._blockedByActive(o,c,A)?s.reset():s[t||e.type]&&(u=s[t||e.type](e,l,a),this.mergeHandlerResult(n,i,u,A,r),u&&u.needsRenderFrame&&this._triggerRenderFrame()),(u||s.isActive())&&(o[A]=s)}const c={};for(const e in this._previousActiveHandlers)o[e]||(c[e]=r);this._previousActiveHandlers=o,(Object.keys(c).length||Zn(n))&&(this._changes.push([n,i,c]),this._triggerRenderFrame()),(Object.keys(o).length||Zn(n))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:u}=n;u&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],u(this._map))}mergeHandlerResult(t,r,n,i,A){if(!n)return;e.extend(t,n);const o={handlerName:i,originalEvent:n.originalEvent||A};void 0!==n.zoomDelta&&(r.zoom=o),void 0!==n.panDelta&&(r.drag=o),void 0!==n.pitchDelta&&(r.pitch=o),void 0!==n.bearingDelta&&(r.rotate=o)}_applyChanges(){const t={},r={},n={};for(const[i,A,o]of this._changes)i.panDelta&&(t.panDelta=(t.panDelta||new e.pointGeometry(0,0))._add(i.panDelta)),i.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+i.zoomDelta),i.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+i.bearingDelta),i.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+i.pitchDelta),void 0!==i.around&&(t.around=i.around),void 0!==i.pinchAround&&(t.pinchAround=i.pinchAround),i.noInertia&&(t.noInertia=i.noInertia),e.extend(r,A),e.extend(n,o);this._updateMapTransform(t,r,n),this._changes=[]}_updateMapTransform(t,r,n){const i=this._map,A=i.transform,o=i.style&&i.style.terrain;if(!(Zn(t)||o&&this._drag))return this._fireEvents(r,n,!0);let{panDelta:s,zoomDelta:a,bearingDelta:l,pitchDelta:c,around:u,pinchAround:h}=t;void 0!==h&&(u=h),i._stop(!0),u=u||i.transform.centerPoint;const d=A.pointLocation(s?u.sub(s):u);l&&(A.bearing+=l),c&&(A.pitch+=c),a&&(A.zoom+=a),o?r.drag&&!this._drag?(this._drag={center:A.centerPoint,lngLat:A.pointLocation(u),point:u,handlerName:r.drag.handlerName},i.fire(new e.Event("freezeElevation",{freeze:!0}))):this._drag&&n[this._drag.handlerName]?(i.fire(new e.Event("freezeElevation",{freeze:!1})),this._drag=null):r.drag&&this._drag&&(A.center=A.pointLocation(A.centerPoint.sub(s))):A.setLocationAtPoint(d,u),this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(r,n,!0)}_fireEvents(t,r,n){const i=Xn(this._eventsInProgress),A=Xn(t),o={};for(const e in t){const{originalEvent:r}=t[e];this._eventsInProgress[e]||(o[`${e}start`]=r),this._eventsInProgress[e]=t[e]}!i&&A&&this._fireEvent("movestart",A.originalEvent);for(const e in o)this._fireEvent(e,o[e]);A&&this._fireEvent("move",A.originalEvent);for(const e in t){const{originalEvent:r}=t[e];this._fireEvent(e,r)}const s={};let a;for(const e in this._eventsInProgress){const{handlerName:t,originalEvent:n}=this._eventsInProgress[e];this._handlersById[t].isActive()||(delete this._eventsInProgress[e],a=r[t]||n,s[`${e}end`]=a)}for(const e in s)this._fireEvent(e,s[e]);const l=Xn(this._eventsInProgress);if(n&&(i||A)&&!l){this._updatingCamera=!0;const t=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),r=e=>0!==e&&-this._bearingSnap<e&&e<this._bearingSnap;t?(r(t.bearing||this._map.getBearing())&&(t.bearing=0),this._map.easeTo(t,{originalEvent:a})):(this._map.fire(new e.Event("moveend",{originalEvent:a})),r(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(t,r){this._map.fire(new e.Event(t,r?{originalEvent:r}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add((e=>{delete this._frameId,this.handleEvent(new jn("renderFrame",{timeStamp:e})),this._applyChanges()}))}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}const Wn={extend:(t,...r)=>e.extend(t,...r),run(e){e()},logToElement(e,t=!1,r="log"){const n=window.document.getElementById(r);n&&(t&&(n.innerHTML=""),n.innerHTML+=`<br>${e}`)}};class Yn extends e.Evented{constructor(t,r){super(),this._moving=!1,this._zooming=!1,this.transform=t,this._bearingSnap=r.bearingSnap,e.bindAll(["_renderFrameCallback"],this)}getCenter(){return new e.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(e,t){return this.jumpTo({center:e},t)}panBy(t,r,n){return t=e.pointGeometry.convert(t).mult(-1),this.panTo(this.transform.center,e.extend({offset:t},r),n)}panTo(t,r,n){return this.easeTo(e.extend({center:t},r),n)}getZoom(){return this.transform.zoom}setZoom(e,t){return this.jumpTo({zoom:e},t),this}zoomTo(t,r,n){return this.easeTo(e.extend({zoom:t},r),n)}zoomIn(e,t){return this.zoomTo(this.getZoom()+1,e,t),this}zoomOut(e,t){return this.zoomTo(this.getZoom()-1,e,t),this}getBearing(){return this.transform.bearing}setBearing(e,t){return this.jumpTo({bearing:e},t),this}getPadding(){return this.transform.padding}setPadding(e,t){return this.jumpTo({padding:e},t),this}rotateTo(t,r,n){return this.easeTo(e.extend({bearing:t},r),n)}resetNorth(t,r){return this.rotateTo(0,e.extend({duration:1e3},t),r),this}resetNorthPitch(t,r){return this.easeTo(e.extend({bearing:0,pitch:0,duration:1e3},t),r),this}snapToNorth(e,t){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,t):this}getPitch(){return this.transform.pitch}setPitch(e,t){return this.jumpTo({pitch:e},t),this}cameraForBounds(t,r){t=e.LngLatBounds.convert(t);const n=r&&r.bearing||0;return this._cameraForBoxAndBearing(t.getNorthWest(),t.getSouthEast(),n,r)}_cameraForBoxAndBearing(t,r,n,i){const A={top:0,bottom:0,right:0,left:0};if("number"==typeof(i=e.extend({padding:A,offset:[0,0],maxZoom:this.transform.maxZoom},i)).padding){const e=i.padding;i.padding={top:e,bottom:e,right:e,left:e}}i.padding=e.extend(A,i.padding);const o=this.transform,s=o.padding,a=o.project(e.LngLat.convert(t)),l=o.project(e.LngLat.convert(r)),c=a.rotate(-n*Math.PI/180),u=l.rotate(-n*Math.PI/180),h=new e.pointGeometry(Math.max(c.x,u.x),Math.max(c.y,u.y)),d=new e.pointGeometry(Math.min(c.x,u.x),Math.min(c.y,u.y)),p=h.sub(d),f=(o.width-(s.left+s.right+i.padding.left+i.padding.right))/p.x,m=(o.height-(s.top+s.bottom+i.padding.top+i.padding.bottom))/p.y;if(m<0||f<0)return void e.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const g=Math.min(o.scaleZoom(o.scale*Math.min(f,m)),i.maxZoom),y=e.pointGeometry.convert(i.offset),_=new e.pointGeometry((i.padding.left-i.padding.right)/2,(i.padding.top-i.padding.bottom)/2).rotate(n*Math.PI/180),w=y.add(_).mult(o.scale/o.zoomScale(g));return{center:o.unproject(a.add(l).div(2).sub(w)),zoom:g,bearing:n}}fitBounds(e,t,r){return this._fitInternal(this.cameraForBounds(e,t),t,r)}fitScreenCoordinates(t,r,n,i,A){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(e.pointGeometry.convert(t)),this.transform.pointLocation(e.pointGeometry.convert(r)),n,i),i,A)}_fitInternal(t,r,n){return t?(delete(r=e.extend(t,r)).padding,r.linear?this.easeTo(r,n):this.flyTo(r,n)):this}jumpTo(t,r){this.stop();const n=this.transform;let i=!1,A=!1,o=!1;return"zoom"in t&&n.zoom!==+t.zoom&&(i=!0,n.zoom=+t.zoom),void 0!==t.center&&(n.center=e.LngLat.convert(t.center)),"bearing"in t&&n.bearing!==+t.bearing&&(A=!0,n.bearing=+t.bearing),"pitch"in t&&n.pitch!==+t.pitch&&(o=!0,n.pitch=+t.pitch),null==t.padding||n.isPaddingEqual(t.padding)||(n.padding=t.padding),this.fire(new e.Event("movestart",r)).fire(new e.Event("move",r)),i&&this.fire(new e.Event("zoomstart",r)).fire(new e.Event("zoom",r)).fire(new e.Event("zoomend",r)),A&&this.fire(new e.Event("rotatestart",r)).fire(new e.Event("rotate",r)).fire(new e.Event("rotateend",r)),o&&this.fire(new e.Event("pitchstart",r)).fire(new e.Event("pitch",r)).fire(new e.Event("pitchend",r)),this.fire(new e.Event("moveend",r))}calculateCameraOptionsFromTo(t,r,n,i=0){const A=e.MercatorCoordinate.fromLngLat(t,r),o=e.MercatorCoordinate.fromLngLat(n,i),s=o.x-A.x,a=o.y-A.y,l=o.z-A.z,c=Math.hypot(s,a,l);if(0===c)throw new Error("Can't calculate camera options with same From and To");const u=Math.hypot(s,a),h=this.transform.scaleZoom(this.transform.cameraToCenterDistance/c/this.transform.tileSize),d=180*Math.atan2(s,-a)/Math.PI;let p=180*Math.acos(u/c)/Math.PI;return p=l<0?90-p:90+p,{center:o.toLngLat(),zoom:h,pitch:p,bearing:d}}easeTo(t,r){this._stop(!1,t.easeId),(!1===(t=e.extend({offset:[0,0],duration:500,easing:e.ease},t)).animate||!t.essential&&e.exported.prefersReducedMotion)&&(t.duration=0);const n=this.transform,i=this.getZoom(),A=this.getBearing(),o=this.getPitch(),s=this.getPadding(),a="zoom"in t?+t.zoom:i,l="bearing"in t?this._normalizeBearing(t.bearing,A):A,c="pitch"in t?+t.pitch:o,u="padding"in t?t.padding:n.padding,h=e.pointGeometry.convert(t.offset);let d=n.centerPoint.add(h);const p=n.pointLocation(d),f=e.LngLat.convert(t.center||p);this._normalizeCenter(f);const m=n.project(p),g=n.project(f).sub(m),y=n.zoomScale(a-i);let _,w;t.around&&(_=e.LngLat.convert(t.around),w=n.locationPoint(_));const x={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||a!==i,this._rotating=this._rotating||A!==l,this._pitching=this._pitching||c!==o,this._padding=!n.isPaddingEqual(u),this._easeId=t.easeId,this._prepareEase(r,t.noMoveStart,x),this._ease((t=>{if(this._zooming&&(n.zoom=e.number(i,a,t)),this._rotating&&(n.bearing=e.number(A,l,t)),this._pitching&&(n.pitch=e.number(o,c,t)),this._padding&&(n.interpolatePadding(s,u,t),d=n.centerPoint.add(h)),_)n.setLocationAtPoint(_,w);else{const e=n.zoomScale(n.zoom-i),r=a>i?Math.min(2,y):Math.max(.5,y),A=Math.pow(r,1-t),o=n.unproject(m.add(g.mult(t*A)).mult(e));n.setLocationAtPoint(n.renderWorldCopies?o.wrap():o,d)}this._fireMoveEvents(r)}),(e=>{this._afterEase(r,e)}),t),this}_prepareEase(t,r,n={}){this._moving=!0,this.fire(new e.Event("freezeElevation",{freeze:!0})),r||n.moving||this.fire(new e.Event("movestart",t)),this._zooming&&!n.zooming&&this.fire(new e.Event("zoomstart",t)),this._rotating&&!n.rotating&&this.fire(new e.Event("rotatestart",t)),this._pitching&&!n.pitching&&this.fire(new e.Event("pitchstart",t))}_fireMoveEvents(t){this.fire(new e.Event("move",t)),this._zooming&&this.fire(new e.Event("zoom",t)),this._rotating&&this.fire(new e.Event("rotate",t)),this._pitching&&this.fire(new e.Event("pitch",t))}_afterEase(t,r){if(this._easeId&&r&&this._easeId===r)return;delete this._easeId,this.fire(new e.Event("freezeElevation",{freeze:!1}));const n=this._zooming,i=this._rotating,A=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,n&&this.fire(new e.Event("zoomend",t)),i&&this.fire(new e.Event("rotateend",t)),A&&this.fire(new e.Event("pitchend",t)),this.fire(new e.Event("moveend",t))}flyTo(t,r){if(!t.essential&&e.exported.prefersReducedMotion){const n=e.pick(t,["center","zoom","bearing","pitch","around"]);return this.jumpTo(n,r)}this.stop(),t=e.extend({offset:[0,0],speed:1.2,curve:1.42,easing:e.ease},t);const n=this.transform,i=this.getZoom(),A=this.getBearing(),o=this.getPitch(),s=this.getPadding(),a="zoom"in t?e.clamp(+t.zoom,n.minZoom,n.maxZoom):i,l="bearing"in t?this._normalizeBearing(t.bearing,A):A,c="pitch"in t?+t.pitch:o,u="padding"in t?t.padding:n.padding,h=n.zoomScale(a-i),d=e.pointGeometry.convert(t.offset);let p=n.centerPoint.add(d);const f=n.pointLocation(p),m=e.LngLat.convert(t.center||f);this._normalizeCenter(m);const g=n.project(f),y=n.project(m).sub(g);let _=t.curve;const w=Math.max(n.width,n.height),x=w/h,B=y.mag();if("minZoom"in t){const r=e.clamp(Math.min(t.minZoom,i,a),n.minZoom,n.maxZoom),A=w/n.zoomScale(r-i);_=Math.sqrt(A/B*2)}const v=_*_;function b(e){const t=(x*x-w*w+(e?-1:1)*v*v*B*B)/(2*(e?x:w)*v*B);return Math.log(Math.sqrt(t*t+1)-t)}function C(e){return(Math.exp(e)-Math.exp(-e))/2}function F(e){return(Math.exp(e)+Math.exp(-e))/2}const E=b(0);let U=function(e){return F(E)/F(E+_*e)},Q=function(e){return w*((F(E)*(C(t=E+_*e)/F(t))-C(E))/v)/B;var t},I=(b(1)-E)/_;if(Math.abs(B)<1e-6||!isFinite(I)){if(Math.abs(w-x)<1e-6)return this.easeTo(t,r);const e=x<w?-1:1;I=Math.abs(Math.log(x/w))/_,Q=function(){return 0},U=function(t){return Math.exp(e*_*t)}}return t.duration="duration"in t?+t.duration:1e3*I/("screenSpeed"in t?+t.screenSpeed/_:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0),this._zooming=!0,this._rotating=A!==l,this._pitching=c!==o,this._padding=!n.isPaddingEqual(u),this._prepareEase(r,!1),this._ease((t=>{const h=t*I,f=1/U(h);n.zoom=1===t?a:i+n.scaleZoom(f),this._rotating&&(n.bearing=e.number(A,l,t)),this._pitching&&(n.pitch=e.number(o,c,t)),this._padding&&(n.interpolatePadding(s,u,t),p=n.centerPoint.add(d));const _=1===t?m:n.unproject(g.add(y.mult(Q(h))).mult(f));n.setLocationAtPoint(n.renderWorldCopies?_.wrap():_,p),this._fireMoveEvents(r)}),(()=>this._afterEase(r)),t),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(e,t){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const e=this._onEaseEnd;delete this._onEaseEnd,e.call(this,t)}if(!e){const e=this.handlers;e&&e.stop(!1)}return this}_ease(t,r,n){!1===n.animate||0===n.duration?(t(1),r()):(this._easeStart=e.exported.now(),this._easeOptions=n,this._onEaseFrame=t,this._onEaseEnd=r,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const t=Math.min((e.exported.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(t)),t<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(t,r){t=e.wrap(t,-180,180);const n=Math.abs(t-r);return Math.abs(t-360-r)<n&&(t-=360),Math.abs(t+360-r)<n&&(t+=360),t}_normalizeCenter(e){const t=this.transform;if(!t.renderWorldCopies||t.lngRange)return;const r=e.lng-t.center.lng;e.lng+=r>180?-360:r<-180?360:0}}class ei{constructor(t={}){this.options=t,e.bindAll(["_toggleAttribution","_updateData","_updateCompact","_updateCompactMinimize"],this)}getDefaultPosition(){return"bottom-right"}onAdd(e){return this._map=e,this._compact=this.options&&this.options.compact,this._container=A.create("details","maplibregl-ctrl maplibregl-ctrl-attrib mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=A.create("summary","maplibregl-ctrl-attrib-button mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=A.create("div","maplibregl-ctrl-attrib-inner mapboxgl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){A.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(e,t){const r=this._map._getUIString(`AttributionControl.${t}`);e.title=r,e.setAttribute("aria-label",r)}_toggleAttribution(){this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show")):(this._container.classList.add("maplibregl-compact-show","mapboxgl-compact-show"),this._container.removeAttribute("open")))}_updateData(e){!e||"metadata"!==e.sourceDataType&&"visibility"!==e.sourceDataType&&"style"!==e.dataType&&"terrain"!==e.type||this._updateAttributions()}_updateAttributions(){if(!this._map.style)return;let e=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=e.concat(this.options.customAttribution.map((e=>"string"!=typeof e?"":e))):"string"==typeof this.options.customAttribution&&e.push(this.options.customAttribution)),this._map.style.stylesheet){const e=this._map.style.stylesheet;this.styleOwner=e.owner,this.styleId=e.id}const t=this._map.style.sourceCaches;for(const r in t){const n=t[r];if(n.used||n.usedForTerrain){const t=n.getSource();t.attribution&&e.indexOf(t.attribution)<0&&e.push(t.attribution)}}e=e.filter((e=>String(e).trim())),e.sort(((e,t)=>e.length-t.length)),e=e.filter(((t,r)=>{for(let n=r+1;n<e.length;n++)if(e[n].indexOf(t)>=0)return!1;return!0}));const r=e.join(" | ");r!==this._attribHTML&&(this._attribHTML=r,e.length?(this._innerContainer.innerHTML=r,this._container.classList.remove("maplibregl-attrib-empty","mapboxgl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty","mapboxgl-attrib-empty"),this._updateCompact(),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640||this._compact?!1===this._compact?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","mapboxgl-compact","maplibregl-compact-show","mapboxgl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show","mapboxgl-compact","mapboxgl-compact-show"))}_updateCompactMinimize(){this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show")}}class ti{constructor(t={}){this.options=t,e.bindAll(["_updateCompact"],this)}getDefaultPosition(){return"bottom-left"}onAdd(e){this._map=e,this._compact=this.options&&this.options.compact,this._container=A.create("div","maplibregl-ctrl mapboxgl-ctrl");const t=A.create("a","maplibregl-ctrl-logo mapboxgl-ctrl-logo");return t.target="_blank",t.rel="noopener nofollow",t.href="https://maplibre.org/",t.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),t.setAttribute("rel","noopener nofollow"),this._container.appendChild(t),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){A.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}_updateCompact(){const e=this._container.children;if(e.length){const t=e[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?!1!==this._compact&&t.classList.add("maplibregl-compact","mapboxgl-compact"):t.classList.remove("maplibregl-compact","mapboxgl-compact")}}}class ri{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(e){const t=++this._id;return this._queue.push({callback:e,id:t,cancelled:!1}),t}remove(e){const t=this._currentlyRunning,r=t?this._queue.concat(t):this._queue;for(const t of r)if(t.id===e)return void(t.cancelled=!0)}run(e=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const t=this._currentlyRunning=this._queue;this._queue=[];for(const r of t)if(!r.cancelled&&(r.callback(e),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}const ni={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.enableTerrain":"Enable terrain","TerrainControl.disableTerrain":"Disable terrain"},ii={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:void 0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,fadeDuration:300,crossSourceCollisions:!0},Ai={showCompass:!0,showZoom:!0,visualizePitch:!1};class oi{constructor(t,r,n=!1){this._clickTolerance=10,this.element=r,this.mouseRotate=new Fn({clickTolerance:t.dragRotate._mouseRotate._clickTolerance}),this.map=t,n&&(this.mousePitch=new En({clickTolerance:t.dragRotate._mousePitch._clickTolerance})),e.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),A.addEventListener(r,"mousedown",this.mousedown),A.addEventListener(r,"touchstart",this.touchstart,{passive:!1}),A.addEventListener(r,"touchmove",this.touchmove),A.addEventListener(r,"touchend",this.touchend),A.addEventListener(r,"touchcancel",this.reset)}down(e,t){this.mouseRotate.mousedown(e,t),this.mousePitch&&this.mousePitch.mousedown(e,t),A.disableDrag()}move(e,t){const r=this.map,n=this.mouseRotate.mousemoveWindow(e,t);if(n&&n.bearingDelta&&r.setBearing(r.getBearing()+n.bearingDelta),this.mousePitch){const n=this.mousePitch.mousemoveWindow(e,t);n&&n.pitchDelta&&r.setPitch(r.getPitch()+n.pitchDelta)}}off(){const e=this.element;A.removeEventListener(e,"mousedown",this.mousedown),A.removeEventListener(e,"touchstart",this.touchstart,{passive:!1}),A.removeEventListener(e,"touchmove",this.touchmove),A.removeEventListener(e,"touchend",this.touchend),A.removeEventListener(e,"touchcancel",this.reset),this.offTemp()}offTemp(){A.enableDrag(),A.removeEventListener(window,"mousemove",this.mousemove),A.removeEventListener(window,"mouseup",this.mouseup)}mousedown(t){this.down(e.extend({},t,{ctrlKey:!0,preventDefault:()=>t.preventDefault()}),A.mousePos(this.element,t)),A.addEventListener(window,"mousemove",this.mousemove),A.addEventListener(window,"mouseup",this.mouseup)}mousemove(e){this.move(e,A.mousePos(this.element,e))}mouseup(e){this.mouseRotate.mouseupWindow(e),this.mousePitch&&this.mousePitch.mouseupWindow(e),this.offTemp()}touchstart(e){1!==e.targetTouches.length?this.reset():(this._startPos=this._lastPos=A.touchPos(this.element,e.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>e.preventDefault()},this._startPos))}touchmove(e){1!==e.targetTouches.length?this.reset():(this._lastPos=A.touchPos(this.element,e.targetTouches)[0],this.move({preventDefault:()=>e.preventDefault()},this._lastPos))}touchend(e){0===e.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function si(t,r,n){if(t=new e.LngLat(t.lng,t.lat),r){const i=new e.LngLat(t.lng-360,t.lat),A=new e.LngLat(t.lng+360,t.lat),o=n.locationPoint(t).distSqr(r);n.locationPoint(i).distSqr(r)<o?t=i:n.locationPoint(A).distSqr(r)<o&&(t=A)}for(;Math.abs(t.lng-n.center.lng)>180;){const e=n.locationPoint(t);if(e.x>=0&&e.y>=0&&e.x<=n.width&&e.y<=n.height)break;t.lng>n.center.lng?t.lng-=360:t.lng+=360}return t}const ai={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function li(e,t,r){const n=e.classList;for(const e in ai)n.remove(`maplibregl-${r}-anchor-${e}`,`mapboxgl-${r}-anchor-${e}`);n.add(`maplibregl-${r}-anchor-${t}`,`mapboxgl-${r}-anchor-${t}`)}class ci extends e.Evented{constructor(t,r){if(super(),(t instanceof HTMLElement||r)&&(t=e.extend({element:t},r)),e.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=t&&t.anchor||"center",this._color=t&&t.color||"#3FB1CE",this._scale=t&&t.scale||1,this._draggable=t&&t.draggable||!1,this._clickTolerance=t&&t.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=t&&t.rotation||0,this._rotationAlignment=t&&t.rotationAlignment||"auto",this._pitchAlignment=t&&t.pitchAlignment&&"auto"!==t.pitchAlignment?t.pitchAlignment:this._rotationAlignment,t&&t.element)this._element=t.element,this._offset=e.pointGeometry.convert(t&&t.offset||[0,0]);else{this._defaultMarker=!0,this._element=A.create("div"),this._element.setAttribute("aria-label","Map marker");const r=A.createNS("http://www.w3.org/2000/svg","svg"),n=41,i=27;r.setAttributeNS(null,"display","block"),r.setAttributeNS(null,"height",`${n}px`),r.setAttributeNS(null,"width",`${i}px`),r.setAttributeNS(null,"viewBox",`0 0 ${i} ${n}`);const o=A.createNS("http://www.w3.org/2000/svg","g");o.setAttributeNS(null,"stroke","none"),o.setAttributeNS(null,"stroke-width","1"),o.setAttributeNS(null,"fill","none"),o.setAttributeNS(null,"fill-rule","evenodd");const s=A.createNS("http://www.w3.org/2000/svg","g");s.setAttributeNS(null,"fill-rule","nonzero");const a=A.createNS("http://www.w3.org/2000/svg","g");a.setAttributeNS(null,"transform","translate(3.0, 29.0)"),a.setAttributeNS(null,"fill","#000000");const l=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const e of l){const t=A.createNS("http://www.w3.org/2000/svg","ellipse");t.setAttributeNS(null,"opacity","0.04"),t.setAttributeNS(null,"cx","10.5"),t.setAttributeNS(null,"cy","5.80029008"),t.setAttributeNS(null,"rx",e.rx),t.setAttributeNS(null,"ry",e.ry),a.appendChild(t)}const c=A.createNS("http://www.w3.org/2000/svg","g");c.setAttributeNS(null,"fill",this._color);const u=A.createNS("http://www.w3.org/2000/svg","path");u.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),c.appendChild(u);const h=A.createNS("http://www.w3.org/2000/svg","g");h.setAttributeNS(null,"opacity","0.25"),h.setAttributeNS(null,"fill","#000000");const d=A.createNS("http://www.w3.org/2000/svg","path");d.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),h.appendChild(d);const p=A.createNS("http://www.w3.org/2000/svg","g");p.setAttributeNS(null,"transform","translate(6.0, 7.0)"),p.setAttributeNS(null,"fill","#FFFFFF");const f=A.createNS("http://www.w3.org/2000/svg","g");f.setAttributeNS(null,"transform","translate(8.0, 8.0)");const m=A.createNS("http://www.w3.org/2000/svg","circle");m.setAttributeNS(null,"fill","#000000"),m.setAttributeNS(null,"opacity","0.25"),m.setAttributeNS(null,"cx","5.5"),m.setAttributeNS(null,"cy","5.5"),m.setAttributeNS(null,"r","5.4999962");const g=A.createNS("http://www.w3.org/2000/svg","circle");g.setAttributeNS(null,"fill","#FFFFFF"),g.setAttributeNS(null,"cx","5.5"),g.setAttributeNS(null,"cy","5.5"),g.setAttributeNS(null,"r","5.4999962"),f.appendChild(m),f.appendChild(g),s.appendChild(a),s.appendChild(c),s.appendChild(h),s.appendChild(p),s.appendChild(f),r.appendChild(s),r.setAttributeNS(null,"height",n*this._scale+"px"),r.setAttributeNS(null,"width",i*this._scale+"px"),this._element.appendChild(r),this._offset=e.pointGeometry.convert(t&&t.offset||[0,-14])}this._element.classList.add("maplibregl-marker","mapboxgl-marker"),this._element.addEventListener("dragstart",(e=>{e.preventDefault()})),this._element.addEventListener("mousedown",(e=>{e.preventDefault()})),li(this._element,this._anchor,"marker"),this._popup=null}addTo(e){return this.remove(),this._map=e,e.getCanvasContainer().appendChild(this._element),e.on("move",this._update),e.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),A.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=e.LngLat.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){const t=38.1,r=13.5,n=Math.sqrt(Math.pow(r,2)/2);e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-t],"bottom-left":[n,-1*(t-r+n)],"bottom-right":[-n,-1*(t-r+n)],left:[r,-1*(t-r)],right:[-r,-1*(t-r)]}:this._offset}this._popup=e,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}_onKeyPress(e){const t=e.code,r=e.charCode||e.keyCode;"Space"!==t&&"Enter"!==t&&32!==r&&13!==r||this.togglePopup()}_onMapClick(e){const t=e.originalEvent.target,r=this._element;this._popup&&(t===r||r.contains(t))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const e=this._popup;return e?(e.isOpen()?e.remove():e.addTo(this._map),this):this}_update(e){if(!this._map)return;this._map.transform.renderWorldCopies&&(this._lngLat=si(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let t="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?t=`rotateZ(${this._rotation}deg)`:"map"===this._rotationAlignment&&(t=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let r="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?r="rotateX(0deg)":"map"===this._pitchAlignment&&(r=`rotateX(${this._map.getPitch()}deg)`),e&&"moveend"!==e.type||(this._pos=this._pos.round()),A.setTransform(this._element,`${ai[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${r} ${t}`),this._map.style&&this._map.style.terrain&&!this._opacityTimeout&&(this._opacityTimeout=setTimeout((()=>{const e=this._map.unproject(this._pos),t=40075016.686*Math.abs(Math.cos(this._lngLat.lat*Math.PI/180))/Math.pow(2,this._map.transform.tileZoom+8);this._element.style.opacity=e.distanceTo(this._lngLat)>20*t?"0.2":"1.0",this._opacityTimeout=null}),100))}getOffset(){return this._offset}setOffset(t){return this._offset=e.pointGeometry.convert(t),this._update(),this}_onMove(t){if(!this._isDragging){const e=this._clickTolerance||this._map._clickTolerance;this._isDragging=t.point.dist(this._pointerdownPos)>=e}this._isDragging&&(this._pos=t.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new e.Event("dragstart"))),this.fire(new e.Event("drag")))}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new e.Event("dragend")),this._state="inactive"}_addDragHandler(e){this._element.contains(e.originalEvent.target)&&(e.preventDefault(),this._positionDelta=e.point.sub(this._pos).add(this._offset),this._pointerdownPos=e.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))}setDraggable(e){return this._draggable=!!e,this._map&&(e?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(e){return this._rotation=e||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(e){return this._rotationAlignment=e||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(e){return this._pitchAlignment=e&&"auto"!==e?e:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}const ui={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let hi,di=0,pi=!1;const fi={maxWidth:100,unit:"metric"};function mi(e,t,r){const n=r&&r.maxWidth||100,i=e._container.clientHeight/2,A=e.unproject([0,i]),o=e.unproject([n,i]),s=A.distanceTo(o);if(r&&"imperial"===r.unit){const r=3.2808*s;r>5280?gi(t,n,r/5280,e._getUIString("ScaleControl.Miles")):gi(t,n,r,e._getUIString("ScaleControl.Feet"))}else r&&"nautical"===r.unit?gi(t,n,s/1852,e._getUIString("ScaleControl.NauticalMiles")):s>=1e3?gi(t,n,s/1e3,e._getUIString("ScaleControl.Kilometers")):gi(t,n,s,e._getUIString("ScaleControl.Meters"))}function gi(e,t,r,n){const i=function(e){const t=Math.pow(10,`${Math.floor(e)}`.length-1);let r=e/t;return r=r>=10?10:r>=5?5:r>=3?3:r>=2?2:r>=1?1:function(e){const t=Math.pow(10,Math.ceil(-Math.log(e)/Math.LN10));return Math.round(e*t)/t}(r),t*r}(r);e.style.width=t*(i/r)+"px",e.innerHTML=`${i}&nbsp;${n}`}const yi={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},_i=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function wi(t){if(t){if("number"==typeof t){const r=Math.round(Math.sqrt(.5*Math.pow(t,2)));return{center:new e.pointGeometry(0,0),top:new e.pointGeometry(0,t),"top-left":new e.pointGeometry(r,r),"top-right":new e.pointGeometry(-r,r),bottom:new e.pointGeometry(0,-t),"bottom-left":new e.pointGeometry(r,-r),"bottom-right":new e.pointGeometry(-r,-r),left:new e.pointGeometry(t,0),right:new e.pointGeometry(-t,0)}}if(t instanceof e.pointGeometry||Array.isArray(t)){const r=e.pointGeometry.convert(t);return{center:r,top:r,"top-left":r,"top-right":r,bottom:r,"bottom-left":r,"bottom-right":r,left:r,right:r}}return{center:e.pointGeometry.convert(t.center||[0,0]),top:e.pointGeometry.convert(t.top||[0,0]),"top-left":e.pointGeometry.convert(t["top-left"]||[0,0]),"top-right":e.pointGeometry.convert(t["top-right"]||[0,0]),bottom:e.pointGeometry.convert(t.bottom||[0,0]),"bottom-left":e.pointGeometry.convert(t["bottom-left"]||[0,0]),"bottom-right":e.pointGeometry.convert(t["bottom-right"]||[0,0]),left:e.pointGeometry.convert(t.left||[0,0]),right:e.pointGeometry.convert(t.right||[0,0])}}return wi(new e.pointGeometry(0,0))}const xi={supported:t,setRTLTextPlugin:e.setRTLTextPlugin,getRTLTextPluginStatus:e.getRTLTextPluginStatus,Map:class extends Yn{constructor(t){var r;if(e.PerformanceUtils.mark(e.PerformanceMarkers.create),null!=(t=e.extend({},ii,t)).minZoom&&null!=t.maxZoom&&t.minZoom>t.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=t.minPitch&&null!=t.maxPitch&&t.minPitch>t.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=t.minPitch&&t.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=t.maxPitch&&t.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new rn(t.minZoom,t.maxZoom,t.minPitch,t.maxPitch,t.renderWorldCopies),{bearingSnap:t.bearingSnap}),this._interactive=t.interactive,this._cooperativeGestures=t.cooperativeGestures,this._maxTileCacheSize=t.maxTileCacheSize,this._failIfMajorPerformanceCaveat=t.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=t.preserveDrawingBuffer,this._antialias=t.antialias,this._trackResize=t.trackResize,this._bearingSnap=t.bearingSnap,this._refreshExpiredTiles=t.refreshExpiredTiles,this._fadeDuration=t.fadeDuration,this._crossSourceCollisions=t.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=t.collectResourceTiming,this._renderTaskQueue=new ri,this._controls=[],this._mapId=e.uniqueId(),this._locale=e.extend({},ni,t.locale),this._clickTolerance=t.clickTolerance,this._pixelRatio=null!==(r=t.pixelRatio)&&void 0!==r?r:devicePixelRatio,this._requestManager=new o(t.transformRequest),"string"==typeof t.container){if(this._container=document.getElementById(t.container),!this._container)throw new Error(`Container '${t.container}' not found.`)}else{if(!(t.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=t.container}if(t.maxBounds&&this.setMaxBounds(t.maxBounds),e.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",(()=>this._update(!1))),this.on("moveend",(()=>this._update(!1))),this.on("zoom",(()=>this._update(!0))),this.on("terrain",(()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)})),"undefined"!=typeof window&&(addEventListener("online",this._onWindowOnline,!1),addEventListener("resize",this._onWindowResize,!1),addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new Jn(this,t),this._cooperativeGestures&&this._setupCooperativeGestures(),this._hash=t.hash&&new nn("string"==typeof t.hash&&t.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:t.center,zoom:t.zoom,bearing:t.bearing,pitch:t.pitch}),t.bounds&&(this.resize(),this.fitBounds(t.bounds,e.extend({},t.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=t.localIdeographFontFamily,t.style&&this.setStyle(t.style,{localIdeographFontFamily:t.localIdeographFontFamily}),t.attributionControl&&this.addControl(new ei({customAttribution:t.customAttribution})),t.maplibreLogo&&this.addControl(new ti,t.logoPosition),this.on("style.load",(()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)})),this.on("data",(t=>{this._update("style"===t.dataType),this.fire(new e.Event(`${t.dataType}data`,t))})),this.on("dataloading",(t=>{this.fire(new e.Event(`${t.dataType}dataloading`,t))})),this.on("dataabort",(t=>{this.fire(new e.Event("sourcedataabort",t))}))}_getMapId(){return this._mapId}addControl(t,r){if(void 0===r&&(r=t.getDefaultPosition?t.getDefaultPosition():"top-right"),!t||!t.onAdd)return this.fire(new e.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const n=t.onAdd(this);this._controls.push(t);const i=this._controlPositions[r];return-1!==r.indexOf("bottom")?i.insertBefore(n,i.firstChild):i.appendChild(n),this}removeControl(t){if(!t||!t.onRemove)return this.fire(new e.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const r=this._controls.indexOf(t);return r>-1&&this._controls.splice(r,1),t.onRemove(this),this}hasControl(e){return this._controls.indexOf(e)>-1}calculateCameraOptionsFromTo(e,t,r,n){return null==n&&this.style.terrain&&(n=this.transform.getElevation(r,this.style.terrain)),super.calculateCameraOptionsFromTo(e,t,r,n)}resize(t){const r=this._containerDimensions(),n=r[0],i=r[1];this._resizeCanvas(n,i,this.getPixelRatio()),this.transform.resize(n,i),this.painter.resize(n,i,this.getPixelRatio());const A=!this._moving;return A&&(this.stop(),this.fire(new e.Event("movestart",t)).fire(new e.Event("move",t))),this.fire(new e.Event("resize",t)),A&&this.fire(new e.Event("moveend",t)),this}getPixelRatio(){return this._pixelRatio}setPixelRatio(e){const[t,r]=this._containerDimensions();this._pixelRatio=e,this._resizeCanvas(t,r,e),this.painter.resize(t,r,e)}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(t){return this.transform.setMaxBounds(e.LngLatBounds.convert(t)),this._update()}setMinZoom(e){if((e=null==e?-2:e)>=-2&&e<=this.transform.maxZoom)return this.transform.minZoom=e,this._update(),this.getZoom()<e&&this.setZoom(e),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(e){if((e=null==e?22:e)>=this.transform.minZoom)return this.transform.maxZoom=e,this._update(),this.getZoom()>e&&this.setZoom(e),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(e){if((e=null==e?0:e)<0)throw new Error("minPitch must be greater than or equal to 0");if(e>=0&&e<=this.transform.maxPitch)return this.transform.minPitch=e,this._update(),this.getPitch()<e&&this.setPitch(e),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(e){if((e=null==e?60:e)>85)throw new Error("maxPitch must be less than or equal to 85");if(e>=this.transform.minPitch)return this.transform.maxPitch=e,this._update(),this.getPitch()>e&&this.setPitch(e),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(e){return this.transform.renderWorldCopies=e,this._update()}project(t){return this.transform.locationPoint(e.LngLat.convert(t),this.style&&this.style.terrain)}unproject(t){return this.transform.pointLocation(e.pointGeometry.convert(t),this.style&&this.style.terrain)}isMoving(){return this._moving||this.handlers.isMoving()}isZooming(){return this._zooming||this.handlers.isZooming()}isRotating(){return this._rotating||this.handlers.isRotating()}_createDelegatedListener(e,t,r){if("mouseenter"===e||"mouseover"===e){let n=!1;const i=i=>{const A=this.getLayer(t)?this.queryRenderedFeatures(i.point,{layers:[t]}):[];A.length?n||(n=!0,r.call(this,new dn(e,this,i.originalEvent,{features:A}))):n=!1};return{layer:t,listener:r,delegates:{mousemove:i,mouseout:()=>{n=!1}}}}if("mouseleave"===e||"mouseout"===e){let n=!1;const i=i=>{(this.getLayer(t)?this.queryRenderedFeatures(i.point,{layers:[t]}):[]).length?n=!0:n&&(n=!1,r.call(this,new dn(e,this,i.originalEvent)))},A=t=>{n&&(n=!1,r.call(this,new dn(e,this,t.originalEvent)))};return{layer:t,listener:r,delegates:{mousemove:i,mouseout:A}}}{const n=e=>{const n=this.getLayer(t)?this.queryRenderedFeatures(e.point,{layers:[t]}):[];n.length&&(e.features=n,r.call(this,e),delete e.features)};return{layer:t,listener:r,delegates:{[e]:n}}}}on(e,t,r){if(void 0===r)return super.on(e,t);const n=this._createDelegatedListener(e,t,r);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[e]=this._delegatedListeners[e]||[],this._delegatedListeners[e].push(n);for(const e in n.delegates)this.on(e,n.delegates[e]);return this}once(e,t,r){if(void 0===r)return super.once(e,t);const n=this._createDelegatedListener(e,t,r);for(const e in n.delegates)this.once(e,n.delegates[e]);return this}off(e,t,r){return void 0===r?super.off(e,t):(this._delegatedListeners&&this._delegatedListeners[e]&&(n=>{const i=this._delegatedListeners[e];for(let e=0;e<i.length;e++){const n=i[e];if(n.layer===t&&n.listener===r){for(const e in n.delegates)this.off(e,n.delegates[e]);return i.splice(e,1),this}}})(),this)}queryRenderedFeatures(t,r){if(!this.style)return[];let n;if(void 0!==r||void 0===t||t instanceof e.pointGeometry||Array.isArray(t)||(r=t,t=void 0),r=r||{},(t=t||[[0,0],[this.transform.width,this.transform.height]])instanceof e.pointGeometry||"number"==typeof t[0])n=[e.pointGeometry.convert(t)];else{const r=e.pointGeometry.convert(t[0]),i=e.pointGeometry.convert(t[1]);n=[r,new e.pointGeometry(i.x,r.y),i,new e.pointGeometry(r.x,i.y),r]}return this.style.queryRenderedFeatures(n,r,this.transform)}querySourceFeatures(e,t){return this.style.querySourceFeatures(e,t)}setStyle(t,r){return!1!==(r=e.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},r)).diff&&r.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&t?(this._diffStyle(t,r),this):(this._localIdeographFontFamily=r.localIdeographFontFamily,this._updateStyle(t,r))}setTransformRequest(e){return this._requestManager.setTransformRequest(e),this}_getUIString(e){const t=this._locale[e];if(null==t)throw new Error(`Missing UI string '${e}'`);return t}_updateStyle(e,t){return this.style&&(this.style.setEventedParent(null),this.style._remove()),e?(this.style=new tt(this,t||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof e?this.style.loadURL(e):this.style.loadJSON(e),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new tt(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(t,r){if("string"==typeof t){const n=this._requestManager.transformRequest(t,e.ResourceType.Style);e.getJSON(n,((t,n)=>{t?this.fire(new e.ErrorEvent(t)):n&&this._updateDiff(n,r)}))}else"object"==typeof t&&this._updateDiff(t,r)}_updateDiff(t,r){try{this.style.setState(t)&&this._update(!0)}catch(n){e.warnOnce(`Unable to perform style diff: ${n.message||n.error||n}.  Rebuilding the style from scratch.`),this._updateStyle(t,r)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():e.warnOnce("There is no style added to the map.")}addSource(e,t){return this._lazyInitEmptyStyle(),this.style.addSource(e,t),this._update(!0)}isSourceLoaded(t){const r=this.style&&this.style.sourceCaches[t];if(void 0!==r)return r.loaded();this.fire(new e.ErrorEvent(new Error(`There is no source with ID '${t}'`)))}setTerrain(e){return this.style.setTerrain(e),this}getTerrain(){return this.style.terrain&&this.style.terrain.options}areTilesLoaded(){const e=this.style&&this.style.sourceCaches;for(const t in e){const r=e[t]._tiles;for(const e in r){const t=r[e];if("loaded"!==t.state&&"errored"!==t.state)return!1}}return!0}addSourceType(e,t,r){return this._lazyInitEmptyStyle(),this.style.addSourceType(e,t,r)}removeSource(e){return this.style.removeSource(e),this._update(!0)}getSource(e){return this.style.getSource(e)}addImage(t,r,{pixelRatio:n=1,sdf:i=!1,stretchX:A,stretchY:o,content:s}={}){if(this._lazyInitEmptyStyle(),r instanceof HTMLImageElement||e.isImageBitmap(r)){const{width:a,height:l,data:c}=e.exported.getImageData(r);this.style.addImage(t,{data:new e.RGBAImage({width:a,height:l},c),pixelRatio:n,stretchX:A,stretchY:o,content:s,sdf:i,version:0})}else{if(void 0===r.width||void 0===r.height)return this.fire(new e.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:a,height:l,data:c}=r,u=r;this.style.addImage(t,{data:new e.RGBAImage({width:a,height:l},new Uint8Array(c)),pixelRatio:n,stretchX:A,stretchY:o,content:s,sdf:i,version:0,userImage:u}),u.onAdd&&u.onAdd(this,t)}}}updateImage(t,r){const n=this.style.getImage(t);if(!n)return this.fire(new e.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const i=r instanceof HTMLImageElement||e.isImageBitmap(r)?e.exported.getImageData(r):r,{width:A,height:o,data:s}=i;if(void 0===A||void 0===o)return this.fire(new e.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(A!==n.data.width||o!==n.data.height)return this.fire(new e.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image")));const a=!(r instanceof HTMLImageElement||e.isImageBitmap(r));n.data.replace(s,a),this.style.updateImage(t,n)}hasImage(t){return t?!!this.style.getImage(t):(this.fire(new e.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(e){this.style.removeImage(e)}loadImage(t,r){e.getImage(this._requestManager.transformRequest(t,e.ResourceType.Image),r)}listImages(){return this.style.listImages()}addLayer(e,t){return this._lazyInitEmptyStyle(),this.style.addLayer(e,t),this._update(!0)}moveLayer(e,t){return this.style.moveLayer(e,t),this._update(!0)}removeLayer(e){return this.style.removeLayer(e),this._update(!0)}getLayer(e){return this.style.getLayer(e)}setLayerZoomRange(e,t,r){return this.style.setLayerZoomRange(e,t,r),this._update(!0)}setFilter(e,t,r={}){return this.style.setFilter(e,t,r),this._update(!0)}getFilter(e){return this.style.getFilter(e)}setPaintProperty(e,t,r,n={}){return this.style.setPaintProperty(e,t,r,n),this._update(!0)}getPaintProperty(e,t){return this.style.getPaintProperty(e,t)}setLayoutProperty(e,t,r,n={}){return this.style.setLayoutProperty(e,t,r,n),this._update(!0)}getLayoutProperty(e,t){return this.style.getLayoutProperty(e,t)}setLight(e,t={}){return this._lazyInitEmptyStyle(),this.style.setLight(e,t),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(e,t){return this.style.setFeatureState(e,t),this._update()}removeFeatureState(e,t){return this.style.removeFeatureState(e,t),this._update()}getFeatureState(e){return this.style.getFeatureState(e)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let e=0,t=0;return this._container&&(e=this._container.clientWidth||400,t=this._container.clientHeight||300),[e,t]}_setupContainer(){const e=this._container;e.classList.add("maplibregl-map","mapboxgl-map");const t=this._canvasContainer=A.create("div","maplibregl-canvas-container mapboxgl-canvas-container",e);this._interactive&&t.classList.add("maplibregl-interactive","mapboxgl-interactive"),this._canvas=A.create("canvas","maplibregl-canvas mapboxgl-canvas",t),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const r=this._containerDimensions();this._resizeCanvas(r[0],r[1],this.getPixelRatio());const n=this._controlContainer=A.create("div","maplibregl-control-container mapboxgl-control-container",e),i=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((e=>{i[e]=A.create("div",`maplibregl-ctrl-${e} mapboxgl-ctrl-${e}`,n)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}_setupCooperativeGestures(){const e=this._container;this._metaPress=!1,this._cooperativeGesturesScreen=A.create("div","maplibregl-cooperative-gesture-screen",e);let t="Control",r="boolean"!=typeof this._cooperativeGestures&&this._cooperativeGestures.windowsHelpText?this._cooperativeGestures.windowsHelpText:"Use Ctrl + scroll to zoom the map";0===navigator.platform.indexOf("Mac")&&(r="boolean"!=typeof this._cooperativeGestures&&this._cooperativeGestures.macHelpText?this._cooperativeGestures.macHelpText:"Use ⌘ + scroll to zoom the map",t="Meta"),this._cooperativeGesturesScreen.innerHTML=`\n            <div class="maplibregl-desktop-message">${r}</div>\n            <div class="maplibregl-mobile-message">${"boolean"!=typeof this._cooperativeGestures&&this._cooperativeGestures.mobileHelpText?this._cooperativeGestures.mobileHelpText:"Use two fingers to move the map"}</div>\n        `,document.addEventListener("keydown",(e=>{e.key===t&&(this._metaPress=!0)})),document.addEventListener("keyup",(e=>{e.key===t&&(this._metaPress=!1)})),this._canvasContainer.addEventListener("wheel",(e=>{this._onCooperativeGesture(e,this._metaPress,1)}),!1),this._canvasContainer.classList.remove("mapboxgl-touch-drag-pan","maplibregl-touch-drag-pan")}_resizeCanvas(e,t,r){this._canvas.width=r*e,this._canvas.height=r*t,this._canvas.style.width=`${e}px`,this._canvas.style.height=`${t}px`}_setupPainter(){const r=e.extend({},t.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),n=this._canvas.getContext("webgl",r)||this._canvas.getContext("experimental-webgl",r);n?(this.painter=new Wr(n,this.transform),e.exported$1.testSupport(n)):this.fire(new e.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(t){t.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new e.Event("webglcontextlost",{originalEvent:t}))}_contextRestored(t){this._setupPainter(),this.resize(),this._update(),this.fire(new e.Event("webglcontextrestored",{originalEvent:t}))}_onMapScroll(e){if(e.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}_onCooperativeGesture(e,t,r){return!t&&r<2&&(this._cooperativeGesturesScreen.classList.add("maplibregl-show"),setTimeout((()=>{this._cooperativeGesturesScreen.classList.remove("maplibregl-show")}),100)),!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(e){return this.style?(this._styleDirty=this._styleDirty||e,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(e){return this._update(),this._renderTaskQueue.add(e)}_cancelRenderFrame(e){this._renderTaskQueue.remove(e)}_render(t){let r,n=0;const i=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(r=i.createQueryEXT(),i.beginQueryEXT(i.TIME_ELAPSED_EXT,r),n=e.exported.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(t),this._removed)return;let A=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const t=this.transform.zoom,r=e.exported.now();this.style.zoomHistory.update(t,r);const n=new e.EvaluationParameters(t,{now:r,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),i=n.crossFadingFactor();1===i&&i===this._crossFadingFactor||(A=!0,this._crossFadingFactor=i),this.style.update(n)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.style.terrain&&this.style.terrain.sourceCache.update(this.transform,this.style.terrain),this.transform.updateElevation(this.style.terrain),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new e.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,e.PerformanceUtils.mark(e.PerformanceMarkers.load),this.fire(new e.Event("load"))),this.style&&(this.style.hasTransitions()||A)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){const t=e.exported.now()-n;i.endQueryEXT(i.TIME_ELAPSED_EXT,r),setTimeout((()=>{const n=i.getQueryObjectEXT(r,i.QUERY_RESULT_EXT)/1e6;i.deleteQueryEXT(r),this.fire(new e.Event("gpu-timing-frame",{cpuTime:t,gpuTime:n}))}),50)}if(this.listens("gpu-timing-layer")){const t=this.painter.collectGpuTimers();setTimeout((()=>{const r=this.painter.queryGpuTimers(t);this.fire(new e.Event("gpu-timing-layer",{layerTimes:r}))}),50)}const o=this._sourcesDirty||this._styleDirty||this._placementDirty;return o||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new e.Event("idle")),!this._loaded||this._fullyLoaded||o||(this._fullyLoaded=!0,e.PerformanceUtils.mark(e.PerformanceMarkers.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){this._hash&&this._hash.remove();for(const e of this._controls)e.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),"undefined"!=typeof window&&(removeEventListener("resize",this._onWindowResize,!1),removeEventListener("orientationchange",this._onWindowResize,!1),removeEventListener("online",this._onWindowOnline,!1));const t=this.painter.context.gl.getExtension("WEBGL_lose_context");t&&t.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),A.remove(this._canvasContainer),A.remove(this._controlContainer),this._cooperativeGestures&&A.remove(this._cooperativeGesturesScreen),this._container.classList.remove("maplibregl-map","mapboxgl-map"),e.PerformanceUtils.clearMetrics(),this._removed=!0,this.fire(new e.Event("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=e.exported.frame((t=>{e.PerformanceUtils.frame(t),this._frame=null,this._render(t)})))}_onWindowOnline(){this._update()}_onWindowResize(e){this._trackResize&&this.resize({originalEvent:e})._update()}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(e){this._showTileBoundaries!==e&&(this._showTileBoundaries=e,this._update())}get showPadding(){return!!this._showPadding}set showPadding(e){this._showPadding!==e&&(this._showPadding=e,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(e){this._showCollisionBoxes!==e&&(this._showCollisionBoxes=e,e?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(e){this._showOverdrawInspector!==e&&(this._showOverdrawInspector=e,this._update())}get repaint(){return!!this._repaint}set repaint(e){this._repaint!==e&&(this._repaint=e,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(e){this._vertices=e,this._update()}_setCacheLimits(t,r){e.setCacheLimits(t,r)}get version(){return"2.4.0"}},NavigationControl:class{constructor(t){this.options=e.extend({},Ai,t),this._container=A.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",(e=>e.preventDefault())),this.options.showZoom&&(e.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in mapboxgl-ctrl-zoom-in",(e=>this._map.zoomIn({},{originalEvent:e}))),A.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out mapboxgl-ctrl-zoom-out",(e=>this._map.zoomOut({},{originalEvent:e}))),A.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(e.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("maplibregl-ctrl-compass mapboxgl-ctrl-compass",(e=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:e}):this._map.resetNorth({},{originalEvent:e})})),this._compassIcon=A.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const e=this._map.getZoom(),t=e===this._map.getMaxZoom(),r=e===this._map.getMinZoom();this._zoomInButton.disabled=t,this._zoomOutButton.disabled=r,this._zoomInButton.setAttribute("aria-disabled",t.toString()),this._zoomOutButton.setAttribute("aria-disabled",r.toString())}_rotateCompassArrow(){const e=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=e}onAdd(e){return this._map=e,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new oi(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){A.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(e,t){const r=A.create("button",e,this._container);return r.type="button",r.addEventListener("click",t),r}_setButtonTitle(e,t){const r=this._map._getUIString(`NavigationControl.${t}`);e.title=r,e.setAttribute("aria-label",r)}},GeolocateControl:class extends e.Evented{constructor(t){super(),this.options=e.extend({},ui,t),e.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}onAdd(e){var t;return this._map=e,this._container=A.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),t=this._setupUI,void 0!==hi?t(hi):void 0!==window.navigator.permissions?window.navigator.permissions.query({name:"geolocation"}).then((e=>{hi="denied"!==e.state,t(hi)})):(hi=!!window.navigator.geolocation,t(hi)),this._container}onRemove(){void 0!==this._geolocationWatchID&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),A.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,di=0,pi=!1}_isOutOfMapMaxBounds(e){const t=this._map.getMaxBounds(),r=e.coords;return t&&(r.longitude<t.getWest()||r.longitude>t.getEast()||r.latitude<t.getSouth()||r.latitude>t.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_onSuccess(t){if(this._map){if(this._isOutOfMapMaxBounds(t))return this._setErrorState(),this.fire(new e.Event("outofmaxbounds",t)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=t,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(t),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(t),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new e.Event("geolocate",t)),this._finish()}}_updateCamera(t){const r=new e.LngLat(t.coords.longitude,t.coords.latitude),n=t.coords.accuracy,i=this._map.getBearing(),A=e.extend({bearing:i},this.options.fitBoundsOptions);this._map.fitBounds(r.toBounds(n),A,{geolocateSource:!0})}_updateMarker(t){if(t){const r=new e.LngLat(t.coords.longitude,t.coords.latitude);this._accuracyCircleMarker.setLngLat(r).addTo(this._map),this._userLocationDotMarker.setLngLat(r).addTo(this._map),this._accuracy=t.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const e=this._map._container.clientHeight/2,t=this._map.unproject([0,e]),r=this._map.unproject([1,e]),n=t.distanceTo(r),i=Math.ceil(2*this._accuracy/n);this._circleElement.style.width=`${i}px`,this._circleElement.style.height=`${i}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_onError(t){if(this._map){if(this.options.trackUserLocation)if(1===t.code){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const e=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=e,this._geolocateButton.setAttribute("aria-label",e),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===t.code&&pi)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new e.Event("error",t)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(t){if(this._container.addEventListener("contextmenu",(e=>e.preventDefault())),this._geolocateButton=A.create("button","maplibregl-ctrl-geolocate mapboxgl-ctrl-geolocate",this._container),A.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===t){e.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=t,this._geolocateButton.setAttribute("aria-label",t)}else{const e=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=e,this._geolocateButton.setAttribute("aria-label",e)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=A.create("div","maplibregl-user-location-dot mapboxgl-user-location-dot"),this._userLocationDotMarker=new ci(this._dotElement),this._circleElement=A.create("div","maplibregl-user-location-accuracy-circle mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new ci({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(t=>{t.geolocateSource||"ACTIVE_LOCK"!==this._watchState||t.originalEvent&&"resize"===t.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this.fire(new e.Event("trackuserlocationend")))}))}trigger(){if(!this._setup)return e.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new e.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":di--,pi=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this.fire(new e.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new e.Event("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let e;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),di++,di>1?(e={maximumAge:6e5,timeout:0},pi=!0):(e=this.options.positionOptions,pi=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,e)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:ei,LogoControl:ti,ScaleControl:class{constructor(t){this.options=e.extend({},fi,t),e.bindAll(["_onMove","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_onMove(){mi(this._map,this._container,this.options)}onAdd(e){return this._map=e,this._container=A.create("div","maplibregl-ctrl maplibregl-ctrl-scale mapboxgl-ctrl mapboxgl-ctrl-scale",e.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){A.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}setUnit(e){this.options.unit=e,mi(this._map,this._container,this.options)}},FullscreenControl:class{constructor(t){this._fullscreen=!1,t&&t.container&&(t.container instanceof HTMLElement?this._container=t.container:e.warnOnce("Full screen control 'container' must be a DOM element.")),e.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(t){return this._map=t,this._container||(this._container=this._map.getContainer()),this._controlContainer=A.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",e.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){A.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!!(document.fullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitFullscreenEnabled)}_setupUI(){const e=this._fullscreenButton=A.create("button","maplibregl-ctrl-fullscreen mapboxgl-ctrl-fullscreen",this._controlContainer);A.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",e).setAttribute("aria-hidden","true"),e.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const e=this._getTitle();this._fullscreenButton.setAttribute("aria-label",e),this._fullscreenButton.title=e}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen&&window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},TerrainControl:class{constructor(t){this.options=t,e.bindAll(["_toggleTerrain","_updateTerrainIcon"],this)}onAdd(e){return this._map=e,this._container=A.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._terrainButton=A.create("button","maplibregl-ctrl-terrain mapboxgl-ctrl-terrain",this._container),A.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){A.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}_toggleTerrain(){this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()}_updateTerrainIcon(){this._terrainButton.classList.remove("maplibregl-ctrl-terrain","mapboxgl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled","mapboxgl-ctrl-terrain-enabled"),this._map.style.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled","mapboxgl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain","mapboxgl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))}},Popup:class extends e.Evented{constructor(t){super(),this.options=e.extend(Object.create(yi),t),e.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}addTo(t){return this._map&&this.remove(),this._map=t,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new e.Event("open")),this}isOpen(){return!!this._map}remove(){return this._content&&A.remove(this._content),this._container&&(A.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new e.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=e.LngLat.convert(t),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer","mapboxgl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")),this}getElement(){return this._container}setText(e){return this.setDOMContent(document.createTextNode(e))}setHTML(e){const t=document.createDocumentFragment(),r=document.createElement("body");let n;for(r.innerHTML=e;n=r.firstChild,n;)t.appendChild(n);return this.setDOMContent(t)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(e){return this.options.maxWidth=e,this._update(),this}setDOMContent(e){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=A.create("div","maplibregl-popup-content mapboxgl-popup-content",this._container);return this._content.appendChild(e),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(e){this._container&&this._container.classList.add(e)}removeClassName(e){this._container&&this._container.classList.remove(e)}setOffset(e){return this.options.offset=e,this._update(),this}toggleClassName(e){if(this._container)return this._container.classList.toggle(e)}_createCloseButton(){this.options.closeButton&&(this._closeButton=A.create("button","maplibregl-popup-close-button mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_onMouseUp(e){this._update(e.point)}_onMouseMove(e){this._update(e.point)}_onDrag(e){this._update(e.point)}_update(e){if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(this._container||(this._container=A.create("div","maplibregl-popup mapboxgl-popup",this._map.getContainer()),this._tip=A.create("div","maplibregl-popup-tip mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach((e=>this._container.classList.add(e))),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=si(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!e)return;const t=this._pos=this._trackPointer&&e?e:this._map.project(this._lngLat);let r=this.options.anchor;const n=wi(this.options.offset);if(!r){const e=this._container.offsetWidth,i=this._container.offsetHeight;let A;A=t.y+n.bottom.y<i?["top"]:t.y>this._map.transform.height-i?["bottom"]:[],t.x<e/2?A.push("left"):t.x>this._map.transform.width-e/2&&A.push("right"),r=0===A.length?"bottom":A.join("-")}const i=t.add(n[r]).round();A.setTransform(this._container,`${ai[r]} translate(${i.x}px,${i.y}px)`),li(this._container,r,"popup")}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const e=this._container.querySelector(_i);e&&e.focus()}_onClose(){this.remove()}},Marker:ci,Style:tt,LngLat:e.LngLat,LngLatBounds:e.LngLatBounds,Point:e.pointGeometry,MercatorCoordinate:e.MercatorCoordinate,Evented:e.Evented,AJAXError:e.AJAXError,config:e.config,CanvasSource:I,GeoJSONSource:F,ImageSource:U,RasterDEMTileSource:C,RasterTileSource:v,VectorTileSource:B,VideoSource:Q,prewarm:function(){N().acquire(O)},clearPrewarmedResources:function(){const e=$;e&&(e.isPreloaded()&&1===e.numActive()?(e.release(O),$=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get version(){return"2.4.0"},get workerCount(){return K.workerCount},set workerCount(e){K.workerCount=e},get maxParallelImageRequests(){return e.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(t){e.config.MAX_PARALLEL_IMAGE_REQUESTS=t},clearStorage(t){e.clearTileCache(t)},workerUrl:"",addProtocol(t,r){e.config.REGISTERED_PROTOCOLS[t]=r},removeProtocol(t){delete e.config.REGISTERED_PROTOCOLS[t]}};return Wn.extend(xi,{isSafari:e.isSafari,getPerformanceMetrics:e.PerformanceUtils.getPerformanceMetrics}),xi})),r}()})),ta=(e,t,r)=>new Promise(((n,i)=>{var A=e=>{try{s(r.next(e))}catch(e){i(e)}},o=e=>{try{s(r.throw(e))}catch(e){i(e)}},s=e=>e.done?n(e.value):Promise.resolve(e.value).then(A,o);s((r=r.apply(e,t)).next())})),ra={},na=Uint8Array,ia=Uint16Array,Aa=Uint32Array,oa=new na([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),sa=new na([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),aa=new na([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),la=function(e,t){for(var r=new ia(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];var i=new Aa(r[30]);for(n=1;n<30;++n)for(var A=r[n];A<r[n+1];++A)i[A]=A-r[n]<<5|n;return[r,i]},ca=la(oa,2),ua=ca[0],ha=ca[1];ua[28]=258,ha[258]=28;var da=la(sa,0)[0],pa=new ia(32768);for(dl=0;dl<32768;++dl)al=(61680&(al=(52428&(al=(43690&dl)>>>1|(21845&dl)<<1))>>>2|(13107&al)<<2))>>>4|(3855&al)<<4,pa[dl]=((65280&al)>>>8|(255&al)<<8)>>>1;var fa=function(e,t,r){for(var n=e.length,i=0,A=new ia(t);i<n;++i)e[i]&&++A[e[i]-1];var o,s=new ia(t);for(i=0;i<t;++i)s[i]=s[i-1]+A[i-1]<<1;if(r){o=new ia(1<<t);var a=15-t;for(i=0;i<n;++i)if(e[i])for(var l=i<<4|e[i],c=t-e[i],u=s[e[i]-1]++<<c,h=u|(1<<c)-1;u<=h;++u)o[pa[u]>>>a]=l}else for(o=new ia(n),i=0;i<n;++i)e[i]&&(o[i]=pa[s[e[i]-1]++]>>>15-e[i]);return o},ma=new na(288);for(dl=0;dl<144;++dl)ma[dl]=8;for(dl=144;dl<256;++dl)ma[dl]=9;for(dl=256;dl<280;++dl)ma[dl]=7;for(dl=280;dl<288;++dl)ma[dl]=8;var ga=new na(32);for(dl=0;dl<32;++dl)ga[dl]=5;var ya=fa(ma,9,1),_a=fa(ga,5,1),wa=function(e){for(var t=e[0],r=1;r<e.length;++r)e[r]>t&&(t=e[r]);return t},xa=function(e,t,r){var n=t/8|0;return(e[n]|e[n+1]<<8)>>(7&t)&r},Ba=function(e,t){var r=t/8|0;return(e[r]|e[r+1]<<8|e[r+2]<<16)>>(7&t)},va=function(e){return(e+7)/8|0},ba=function(e,t,r){(null==t||t<0)&&(t=0),(null==r||r>e.length)&&(r=e.length);var n=new(2==e.BYTES_PER_ELEMENT?ia:4==e.BYTES_PER_ELEMENT?Aa:na)(r-t);return n.set(e.subarray(t,r)),n},Ca=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Fa=function(e,t,r){var n=new Error(t||Ca[e]);if(n.code=e,Error.captureStackTrace&&Error.captureStackTrace(n,Fa),!r)throw n;return n},Ea=function(e,t,r){var n=e.length;if(!n||r&&r.f&&!r.l)return t||new na(0);var i=!t||r,A=!r||r.i;r||(r={}),t||(t=new na(3*n));var o=function(e){var r=t.length;if(e>r){var n=new na(Math.max(2*r,e));n.set(t),t=n}},s=r.f||0,a=r.p||0,l=r.b||0,c=r.l,u=r.d,h=r.m,d=r.n,p=8*n;do{if(!c){s=xa(e,a,1);var f=xa(e,a+1,3);if(a+=3,!f){var m=e[(E=va(a)+4)-4]|e[E-3]<<8,g=E+m;if(g>n){A&&Fa(0);break}i&&o(l+m),t.set(e.subarray(E,g),l),r.b=l+=m,r.p=a=8*g,r.f=s;continue}if(1==f)c=ya,u=_a,h=9,d=5;else if(2==f){var y=xa(e,a,31)+257,_=xa(e,a+10,15)+4,w=y+xa(e,a+5,31)+1;a+=14;for(var x=new na(w),B=new na(19),v=0;v<_;++v)B[aa[v]]=xa(e,a+3*v,7);a+=3*_;var b=wa(B),C=(1<<b)-1,F=fa(B,b,1);for(v=0;v<w;){var E,U=F[xa(e,a,C)];if(a+=15&U,(E=U>>>4)<16)x[v++]=E;else{var Q=0,I=0;for(16==E?(I=3+xa(e,a,3),a+=2,Q=x[v-1]):17==E?(I=3+xa(e,a,7),a+=3):18==E&&(I=11+xa(e,a,127),a+=7);I--;)x[v++]=Q}}var T=x.subarray(0,y),S=x.subarray(y);h=wa(T),d=wa(S),c=fa(T,h,1),u=fa(S,d,1)}else Fa(1);if(a>p){A&&Fa(0);break}}i&&o(l+131072);for(var M=(1<<h)-1,k=(1<<d)-1,D=a;;D=a){var L=(Q=c[Ba(e,a)&M])>>>4;if((a+=15&Q)>p){A&&Fa(0);break}if(Q||Fa(2),L<256)t[l++]=L;else{if(256==L){D=a,c=null;break}var P=L-254;if(L>264){var H=oa[v=L-257];P=xa(e,a,(1<<H)-1)+ua[v],a+=H}var z=u[Ba(e,a)&k],R=z>>>4;z||Fa(3),a+=15&z;S=da[R];if(R>3){H=sa[R];S+=Ba(e,a)&(1<<H)-1,a+=H}if(a>p){A&&Fa(0);break}i&&o(l+131072);for(var O=l+P;l<O;l+=4)t[l]=t[l-S],t[l+1]=t[l+1-S],t[l+2]=t[l+2-S],t[l+3]=t[l+3-S];l=O}}r.l=c,r.p=D,r.b=l,r.f=s,c&&(s=1,r.m=h,r.d=u,r.n=d)}while(!s);return l==t.length?t:ba(t,0,l)},Ua=new na(0),Qa=function(e,t,r){for(var n=e(),i=e.toString(),A=i.slice(i.indexOf("[")+1,i.lastIndexOf("]")).replace(/\s+/g,"").split(","),o=0;o<n.length;++o){var s=n[o],a=A[o];if("function"==typeof s){t+=";"+a+"=";var l=s.toString();if(s.prototype)if(-1!=l.indexOf("[native code]")){var c=l.indexOf(" ",8)+1;t+=l.slice(c,l.indexOf("(",c))}else for(var u in t+=l,s.prototype)t+=";"+a+".prototype."+u+"="+s.prototype[u].toString();else t+=l}else r[a]=s}return[t,r]},Ia=[],Ta=function(e,t,r,n){var i;if(!Ia[r]){for(var A="",o={},s=e.length-1,a=0;a<s;++a)A=(i=Qa(e[a],A,o))[0],o=i[1];Ia[r]=Qa(e[s],A,o)}var l=function(e,t){var r={};for(var n in e)r[n]=e[n];for(var n in t)r[n]=t[n];return r}({},Ia[r][1]);return function(e,t,r,n,i){var A=new Worker(ra[t]||(ra[t]=URL.createObjectURL(new Blob([e+';addEventListener("error",function(e){e=e.error;postMessage({$e$:[e.message,e.code,e.stack]})})'],{type:"text/javascript"}))));return A.onmessage=function(e){var t=e.data,r=t.$e$;if(r){var n=new Error(r[0]);n.code=r[1],n.stack=r[2],i(n,null)}else i(null,t)},A.postMessage(r,n),A}(Ia[r][0]+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+t.toString()+"}",r,l,function(e){var t=[];for(var r in e)e[r].buffer&&t.push((e[r]=new e[r].constructor(e[r])).buffer);return t}(l),n)},Sa=function(){return[na,ia,Aa,oa,sa,aa,ua,da,ya,_a,pa,Ca,fa,wa,xa,Ba,va,ba,Fa,Ea,$a,Da,La]},Ma=function(){return[za,Ra]},ka=function(){return[Oa]},Da=function(e){return postMessage(e,[e.buffer])},La=function(e){return e&&e.size&&new na(e.size)},Pa=function(e){return e.ondata=function(e,t){return postMessage([e,t],[e.buffer])},function(t){return e.push(t.data[0],t.data[1])}},Ha=function(e,t,r,n,i){var A,o=Ta(e,n,i,(function(e,r){e?(o.terminate(),t.ondata.call(t,e)):(r[1]&&o.terminate(),t.ondata.call(t,e,r[0],r[1]))}));o.postMessage(r),t.push=function(e,r){t.ondata||Fa(5),A&&t.ondata(Fa(4,0,1),null,!!r),o.postMessage([e,A=r],[e.buffer])},t.terminate=function(){o.terminate()}},za=function(e){31==e[0]&&139==e[1]&&8==e[2]||Fa(6,"invalid gzip data");var t=e[3],r=10;4&t&&(r+=e[10]|2+(e[11]<<8));for(var n=(t>>3&1)+(t>>4&1);n>0;n-=!e[r++]);return r+(2&t)},Ra=function(e){var t=e.length;return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0},Oa=function(e){(8!=(15&e[0])||e[0]>>>4>7||(e[0]<<8|e[1])%31)&&Fa(6,"invalid zlib data"),32&e[1]&&Fa(6,"invalid zlib data: preset dictionaries not supported")},Ka=function(){function e(e){this.s={},this.p=new na(0),this.ondata=e}return e.prototype.e=function(e){this.ondata||Fa(5),this.d&&Fa(4);var t=this.p.length,r=new na(t+e.length);r.set(this.p),r.set(e,t),this.p=r},e.prototype.c=function(e){this.d=this.s.i=e||!1;var t=this.s.b,r=Ea(this.p,this.o,this.s);this.ondata(ba(r,t,this.s.b),this.d),this.o=ba(r,this.s.b-32768),this.s.b=this.o.length,this.p=ba(this.p,this.s.p/8|0),this.s.p&=7},e.prototype.push=function(e,t){this.e(e),this.c(t)},e}(),Va=function(){return function(e){this.ondata=e,Ha([Sa,function(){return[Pa,Ka]}],this,0,(function(){var e=new Ka;onmessage=Pa(e)}),7)}}();function $a(e,t){return Ea(e,t)}var Na=function(){function e(e){this.v=1,Ka.call(this,e)}return e.prototype.push=function(e,t){if(Ka.prototype.e.call(this,e),this.v){var r=this.p.length>3?za(this.p):4;if(r>=this.p.length&&!t)return;this.p=this.p.subarray(r),this.v=0}t&&(this.p.length<8&&Fa(6,"invalid gzip data"),this.p=this.p.subarray(0,-8)),Ka.prototype.c.call(this,t)},e}(),Ga=function(){return function(e){this.ondata=e,Ha([Sa,Ma,function(){return[Pa,Ka,Na]}],this,0,(function(){var e=new Na;onmessage=Pa(e)}),9)}}(),qa=function(){function e(e){this.v=1,Ka.call(this,e)}return e.prototype.push=function(e,t){if(Ka.prototype.e.call(this,e),this.v){if(this.p.length<2&&!t)return;this.p=this.p.subarray(2),this.v=0}t&&(this.p.length<4&&Fa(6,"invalid zlib data"),this.p=this.p.subarray(0,-4)),Ka.prototype.c.call(this,t)},e}(),Xa=function(){return function(e){this.ondata=e,Ha([Sa,ka,function(){return[Pa,Ka,qa]}],this,0,(function(){var e=new qa;onmessage=Pa(e)}),11)}}(),ja="undefined"!=typeof TextDecoder&&new TextDecoder;try{ja.decode(Ua,{stream:!0}),1}catch(e){}var Za={gzip:Ga,deflate:Xa,"deflate-raw":Va},Ja=(e,t,r)=>class extends e{constructor(e){if(!arguments.length)throw new TypeError(`Failed to construct '${r}': 1 argument required, but only 0 present.`);const n=t[e];if(!n)throw new TypeError(`Failed to construct '${r}': Unsupported compression format: '${e}'`);let i,A=new n;super({start:e=>{A.ondata=(t,r,n)=>{t?e.error(t):r&&(e.enqueue(r),n&&e.terminate()),i()}},transform:e=>new Promise((t=>{if(i=t,e instanceof ArrayBuffer)e=new Uint8Array(e);else{if(!ArrayBuffer.isView(e))throw new TypeError("The provided value is not of type '(ArrayBuffer or ArrayBufferView)'");e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}A.push(e)})),flush:()=>new Promise((e=>{i=e,A.push(new Uint8Array(0),!0)}))},{size:e=>0|e.byteLength,highWaterMark:65536})}};var Wa=Uint8Array,Ya=Uint16Array,el=Int32Array,tl=new Wa([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),rl=new Wa([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),nl=new Wa([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),il=function(e,t){for(var r=new Ya(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];var i=new el(r[30]);for(n=1;n<30;++n)for(var A=r[n];A<r[n+1];++A)i[A]=A-r[n]<<5|n;return{b:r,r:i}},Al=il(tl,2),ol=Al.b,sl=Al.r;ol[28]=258,sl[258]=28;var al,ll=il(rl,0).b,cl=new Ya(32768);for(dl=0;dl<32768;++dl)al=(61680&(al=(52428&(al=(43690&dl)>>1|(21845&dl)<<1))>>2|(13107&al)<<2))>>4|(3855&al)<<4,cl[dl]=((65280&al)>>8|(255&al)<<8)>>1;var ul=function(e,t,r){for(var n=e.length,i=0,A=new Ya(t);i<n;++i)e[i]&&++A[e[i]-1];var o,s=new Ya(t);for(i=1;i<t;++i)s[i]=s[i-1]+A[i-1]<<1;if(r){o=new Ya(1<<t);var a=15-t;for(i=0;i<n;++i)if(e[i])for(var l=i<<4|e[i],c=t-e[i],u=s[e[i]-1]++<<c,h=u|(1<<c)-1;u<=h;++u)o[cl[u]>>a]=l}else for(o=new Ya(n),i=0;i<n;++i)e[i]&&(o[i]=cl[s[e[i]-1]++]>>15-e[i]);return o},hl=new Wa(288);for(dl=0;dl<144;++dl)hl[dl]=8;for(dl=144;dl<256;++dl)hl[dl]=9;for(dl=256;dl<280;++dl)hl[dl]=7;for(dl=280;dl<288;++dl)hl[dl]=8;var dl,pl=new Wa(32);for(dl=0;dl<32;++dl)pl[dl]=5;var fl=ul(hl,9,1),ml=ul(pl,5,1),gl=function(e){for(var t=e[0],r=1;r<e.length;++r)e[r]>t&&(t=e[r]);return t},yl=function(e,t,r){var n=t/8|0;return(e[n]|e[n+1]<<8)>>(7&t)&r},_l=function(e,t){var r=t/8|0;return(e[r]|e[r+1]<<8|e[r+2]<<16)>>(7&t)},wl=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],xl=function(e,t,r){var n=new Error(t||wl[e]);if(n.code=e,Error.captureStackTrace&&Error.captureStackTrace(n,xl),!r)throw n;return n},Bl=function(e,t,r,n){var i=e.length,A=n?n.length:0;if(!i||t.f&&!t.l)return r||new Wa(0);var o=!r||2!=t.i,s=t.i;r||(r=new Wa(3*i));var a=function(e){var t=r.length;if(e>t){var n=new Wa(Math.max(2*t,e));n.set(r),r=n}},l=t.f||0,c=t.p||0,u=t.b||0,h=t.l,d=t.d,p=t.m,f=t.n,m=8*i;do{if(!h){l=yl(e,c,1);var g=yl(e,c+1,3);if(c+=3,!g){var y=e[(Q=4+((c+7)/8|0))-4]|e[Q-3]<<8,_=Q+y;if(_>i){s&&xl(0);break}o&&a(u+y),r.set(e.subarray(Q,_),u),t.b=u+=y,t.p=c=8*_,t.f=l;continue}if(1==g)h=fl,d=ml,p=9,f=5;else if(2==g){var w=yl(e,c,31)+257,x=yl(e,c+10,15)+4,B=w+yl(e,c+5,31)+1;c+=14;for(var v=new Wa(B),b=new Wa(19),C=0;C<x;++C)b[nl[C]]=yl(e,c+3*C,7);c+=3*x;var F=gl(b),E=(1<<F)-1,U=ul(b,F,1);for(C=0;C<B;){var Q,I=U[yl(e,c,E)];if(c+=15&I,(Q=I>>4)<16)v[C++]=Q;else{var T=0,S=0;for(16==Q?(S=3+yl(e,c,3),c+=2,T=v[C-1]):17==Q?(S=3+yl(e,c,7),c+=3):18==Q&&(S=11+yl(e,c,127),c+=7);S--;)v[C++]=T}}var M=v.subarray(0,w),k=v.subarray(w);p=gl(M),f=gl(k),h=ul(M,p,1),d=ul(k,f,1)}else xl(1);if(c>m){s&&xl(0);break}}o&&a(u+131072);for(var D=(1<<p)-1,L=(1<<f)-1,P=c;;P=c){var H=(T=h[_l(e,c)&D])>>4;if((c+=15&T)>m){s&&xl(0);break}if(T||xl(2),H<256)r[u++]=H;else{if(256==H){P=c,h=null;break}var z=H-254;if(H>264){var R=tl[C=H-257];z=yl(e,c,(1<<R)-1)+ol[C],c+=R}var O=d[_l(e,c)&L],K=O>>4;O||xl(3),c+=15&O;k=ll[K];if(K>3){R=rl[K];k+=_l(e,c)&(1<<R)-1,c+=R}if(c>m){s&&xl(0);break}o&&a(u+131072);var V=u+z;if(u<k){var $=A-k,N=Math.min(k,V);for($+u<0&&xl(3);u<N;++u)r[u]=n[$+u]}for(;u<V;u+=4)r[u]=r[u-k],r[u+1]=r[u+1-k],r[u+2]=r[u+2-k],r[u+3]=r[u+3-k];u=V}}t.l=h,t.p=P,t.b=u,t.f=l,h&&(l=1,t.m=p,t.d=d,t.n=f)}while(!l);return u==r.length?r:function(e,t,r){(null==t||t<0)&&(t=0),(null==r||r>e.length)&&(r=e.length);var n=new Wa(r-t);return n.set(e.subarray(t,r)),n}(r,0,u)},vl=new Wa(0),bl=function(e){31==e[0]&&139==e[1]&&8==e[2]||xl(6,"invalid gzip data");var t=e[3],r=10;4&t&&(r+=2+(e[10]|e[11]<<8));for(var n=(t>>3&1)+(t>>4&1);n>0;n-=!e[r++]);return r+(2&t)},Cl=function(e){var t=e.length;return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0},Fl=function(e,t){return(8!=(15&e[0])||e[0]>>4>7||(e[0]<<8|e[1])%31)&&xl(6,"invalid zlib data"),(e[1]>>5&1)==+!t&&xl(6,"invalid zlib data: "+(32&e[1]?"need":"unexpected")+" dictionary"),2+(e[1]>>3&4)};function El(e,t){return 31==e[0]&&139==e[1]&&8==e[2]?function(e,t){var r=bl(e);return r+8>e.length&&xl(6,"invalid gzip data"),Bl(e.subarray(r,-8),{i:2},t&&t.out||new Wa(Cl(e)),t&&t.dictionary)}(e,t):8!=(15&e[0])||e[0]>>4>7||(e[0]<<8|e[1])%31?function(e,t){return Bl(e,{i:2},t&&t.out,t&&t.dictionary)}(e,t):function(e,t){return Bl(e.subarray(Fl(e,t&&t.dictionary),-4),{i:2},t&&t.out,t&&t.dictionary)}(e,t)}var Ul="undefined"!=typeof TextDecoder&&new TextDecoder;try{Ul.decode(vl,{stream:!0}),1}catch(e){}var Ql=(e,t)=>e*Math.pow(2,t),Il=(e,t)=>Math.floor(e/Math.pow(2,t)),Tl=(e,t)=>Ql(e.getUint16(t+1,!0),8)+e.getUint8(t),Sl=(e,t)=>Ql(e.getUint32(t+2,!0),16)+e.getUint16(t,!0),Ml=(e,t,r,n,i)=>{if(e!=n.getUint8(i))return e-n.getUint8(i);const A=Tl(n,i+1);if(t!=A)return t-A;const o=Tl(n,i+4);return r!=o?r-o:0},kl=(e,t,r,n)=>{const i=Dl(e,t,r,n);return i?{z:t,x:r,y:n,offset:i[0],length:i[1],is_dir:!1}:null},Dl=(e,t,r,n)=>{let i=0,A=e.byteLength/17-1;for(;i<=A;){const o=A+i>>1,s=Ml(t,r,n,e,17*o);if(s>0)i=o+1;else{if(!(s<0))return[Sl(e,17*o+7),e.getUint32(17*o+13,!0)];A=o-1}}return null},Ll=(e,t)=>e.is_dir&&!t.is_dir?1:!e.is_dir&&t.is_dir?-1:e.z!==t.z?e.z-t.z:e.x!==t.x?e.x-t.x:e.y-t.y,Pl=(e,t)=>{const r=e.getUint8(17*t);return{z:127&r,x:Tl(e,17*t+1),y:Tl(e,17*t+4),offset:Sl(e,17*t+7),length:e.getUint32(17*t+13,!0),is_dir:r>>7==1}},Hl=e=>{const t=[],r=new DataView(e);for(let e=0;e<r.byteLength/17;e++)t.push(Pl(r,e));return zl(t)},zl=e=>{e.sort(Ll);const t=new ArrayBuffer(17*e.length),r=new Uint8Array(t);for(let t=0;t<e.length;t++){const n=e[t];let i=n.z;n.is_dir&&(i|=128),r[17*t]=i,r[17*t+1]=255&n.x,r[17*t+2]=n.x>>8&255,r[17*t+3]=n.x>>16&255,r[17*t+4]=255&n.y,r[17*t+5]=n.y>>8&255,r[17*t+6]=n.y>>16&255,r[17*t+7]=255&n.offset,r[17*t+8]=255&Il(n.offset,8),r[17*t+9]=255&Il(n.offset,16),r[17*t+10]=255&Il(n.offset,24),r[17*t+11]=255&Il(n.offset,32),r[17*t+12]=255&Il(n.offset,48),r[17*t+13]=255&n.length,r[17*t+14]=n.length>>8&255,r[17*t+15]=n.length>>16&255,r[17*t+16]=n.length>>24&255}return t};var Rl={getHeader:function(e){return ta(this,null,(function*(){const t=yield e.getBytes(0,512e3),r=new DataView(t.data),n=r.getUint32(4,!0),i=r.getUint16(8,!0),A=new TextDecoder("utf-8"),o=JSON.parse(A.decode(new DataView(t.data,10,n)));let s=0;"gzip"===o.compression&&(s=2);let a=0;"minzoom"in o&&(a=+o.minzoom);let l=0;"maxzoom"in o&&(l=+o.maxzoom);let c=0,u=0,h=0,d=-180,p=-85,f=180,m=85;if(o.bounds){const e=o.bounds.split(",");d=+e[0],p=+e[1],f=+e[2],m=+e[3]}if(o.center){const e=o.center.split(",");c=+e[0],u=+e[1],h=+e[2]}return{specVersion:r.getUint16(2,!0),rootDirectoryOffset:10+n,rootDirectoryLength:17*i,jsonMetadataOffset:10,jsonMetadataLength:n,leafDirectoryOffset:0,leafDirectoryLength:void 0,tileDataOffset:0,tileDataLength:void 0,numAddressedTiles:0,numTileEntries:0,numTileContents:0,clustered:!1,internalCompression:1,tileCompression:s,tileType:1,minZoom:a,maxZoom:l,minLon:d,minLat:p,maxLon:f,maxLat:m,centerZoom:h,centerLon:c,centerLat:u,etag:t.etag}}))},getZxy:function(e,t,r,n,i,A,o){return ta(this,null,(function*(){let s=yield r.getArrayBuffer(t,e.rootDirectoryOffset,e.rootDirectoryLength,e);1===e.specVersion&&(s=Hl(s));const a=kl(new DataView(s),n,i,A);if(a){let e=(yield t.getBytes(a.offset,a.length,o)).data;const r=new DataView(e);return 31==r.getUint8(0)&&139==r.getUint8(1)&&(e=El(new Uint8Array(e))),{data:e}}const l=((e,t)=>{if(e.byteLength<17)return null;const r=e.byteLength/17,n=Pl(e,r-1);if(n.is_dir){const e=n.z,r=t.z-e;return{z:e,x:Math.trunc(t.x/(1<<r)),y:Math.trunc(t.y/(1<<r))}}return null})(new DataView(s),{z:n,x:i,y:A});if(l){const a=((e,t,r,n)=>{const i=Dl(e,128|t,r,n);return i?{z:t,x:r,y:n,offset:i[0],length:i[1],is_dir:!0}:null})(new DataView(s),l.z,l.x,l.y);if(a){let s=yield r.getArrayBuffer(t,a.offset,a.length,e);1===e.specVersion&&(s=Hl(s));const l=kl(new DataView(s),n,i,A);if(l){let e=(yield t.getBytes(l.offset,l.length,o)).data;const r=new DataView(e);return 31==r.getUint8(0)&&139==r.getUint8(1)&&(e=El(new Uint8Array(e))),{data:e}}}}}))}};function Ol(e,t){return 4294967296*(t>>>0)+(e>>>0)}function Kl(e){const t=e.buf;let r,n;return n=t[e.pos++],r=127&n,n<128?r:(n=t[e.pos++],r|=(127&n)<<7,n<128?r:(n=t[e.pos++],r|=(127&n)<<14,n<128?r:(n=t[e.pos++],r|=(127&n)<<21,n<128?r:(n=t[e.pos],r|=(15&n)<<28,function(e,t){const r=t.buf;let n,i;if(i=r[t.pos++],n=(112&i)>>4,i<128)return Ol(e,n);if(i=r[t.pos++],n|=(127&i)<<3,i<128)return Ol(e,n);if(i=r[t.pos++],n|=(127&i)<<10,i<128)return Ol(e,n);if(i=r[t.pos++],n|=(127&i)<<17,i<128)return Ol(e,n);if(i=r[t.pos++],n|=(127&i)<<24,i<128)return Ol(e,n);if(i=r[t.pos++],n|=(1&i)<<31,i<128)return Ol(e,n);throw new Error("Expected varint not more than 10 bytes")}(r,e)))))}function Vl(e,t,r,n){if(0==n){1==r&&(t[0]=e-1-t[0],t[1]=e-1-t[1]);const n=t[0];t[0]=t[1],t[1]=n}}var $l=[0,1,5,21,85,341,1365,5461,21845,87381,349525,1398101,5592405,22369621,89478485,357913941,1431655765,5726623061,22906492245,91625968981,366503875925,1466015503701,5864062014805,23456248059221,93824992236885,375299968947541,0x5555555555555];function Nl(e,t){return ta(this,null,(function*(){if(1===t||0===t)return e;if(2===t){let t=new Response(e).body;const r=function(e){class t extends(Ja(e,Za,"DecompressionStream")){}return t}(TransformStream);let n=t.pipeThrough(new r("gzip"));return new Response(n).arrayBuffer()}throw Error("Compression method not supported")}))}function Gl(e,t){let r=0,n=e.length-1;for(;r<=n;){const i=n+r>>1,A=t-e[i].tileId;if(A>0)r=i+1;else{if(!(A<0))return e[i];n=i-1}}if(n>=0){if(0===e[n].runLength)return e[n];if(t-e[n].tileId<e[n].runLength)return e[n]}return null}function ql(e,t){const r=e.getUint32(t+4,!0),n=e.getUint32(t+0,!0);return r*Math.pow(2,32)+n}function Xl(e){const t={buf:new Uint8Array(e),pos:0},r=Kl(t),n=[];let i=0;for(let e=0;e<r;e++){const e=Kl(t);n.push({tileId:i+e,offset:0,length:0,runLength:1}),i+=e}for(let e=0;e<r;e++)n[e].runLength=Kl(t);for(let e=0;e<r;e++)n[e].length=Kl(t);for(let e=0;e<r;e++){const r=Kl(t);n[e].offset=0===r&&e>0?n[e-1].offset+n[e-1].length:r-1}return n}var jl=class extends Error{};function Zl(e,t,r,n){return ta(this,null,(function*(){const i=yield e.getBytes(0,16384);if(19792!==new DataView(i.data).getUint16(0,!0))throw new Error("Wrong magic number for PMTiles archive");if(function(e){const t=new DataView(e);return 2===t.getUint16(2,!0)?(console.warn("PMTiles spec version 2 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),2):1===t.getUint16(2,!0)?(console.warn("PMTiles spec version 1 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),1):3}(i.data)<3)return[yield Rl.getHeader(e)];const A=i.data.slice(0,127);let o=i.etag;n&&i.etag!=n&&(console.warn("ETag conflict detected; your HTTP server might not support content-based ETag headers. ETags disabled for "+e.getKey()),o=void 0);const s=function(e,t){const r=new DataView(e),n=r.getUint8(7);if(n>3)throw Error(`Archive is spec version ${n} but this library supports up to spec version 3`);return{specVersion:n,rootDirectoryOffset:ql(r,8),rootDirectoryLength:ql(r,16),jsonMetadataOffset:ql(r,24),jsonMetadataLength:ql(r,32),leafDirectoryOffset:ql(r,40),leafDirectoryLength:ql(r,48),tileDataOffset:ql(r,56),tileDataLength:ql(r,64),numAddressedTiles:ql(r,72),numTileEntries:ql(r,80),numTileContents:ql(r,88),clustered:1===r.getUint8(96),internalCompression:r.getUint8(97),tileCompression:r.getUint8(98),tileType:r.getUint8(99),minZoom:r.getUint8(100),maxZoom:r.getUint8(101),minLon:r.getInt32(102,!0)/1e7,minLat:r.getInt32(106,!0)/1e7,maxLon:r.getInt32(110,!0)/1e7,maxLat:r.getInt32(114,!0)/1e7,centerZoom:r.getUint8(118),centerLon:r.getInt32(119,!0)/1e7,centerLat:r.getInt32(123,!0)/1e7,etag:t}}(A,o);if(r){const r=i.data.slice(s.rootDirectoryOffset,s.rootDirectoryOffset+s.rootDirectoryLength),n=e.getKey()+"|"+(s.etag||"")+"|"+s.rootDirectoryOffset+"|"+s.rootDirectoryLength,A=Xl(yield t(r,s.internalCompression));return[s,[n,A.length,A]]}return[s,void 0]}))}var Jl=class{constructor(e,t,r){this.source="string"==typeof e?new class{constructor(e){this.url=e}getKey(){return this.url}getBytes(e,t,r){return ta(this,null,(function*(){let n;r||(n=new AbortController,r=n.signal);let i=yield fetch(this.url,{signal:r,headers:{Range:"bytes="+e+"-"+(e+t-1)}});if(416===i.status&&0===e){const e=i.headers.get("Content-Range");if(!e||!e.startsWith("bytes */"))throw Error("Missing content-length on 416 response");const t=+e.substr(8);i=yield fetch(this.url,{signal:r,headers:{Range:"bytes=0-"+(t-1)}})}if(i.status>=300)throw Error("Bad response code: "+i.status);const A=i.headers.get("Content-Length");if(200===i.status&&(!A||+A>t))throw n&&n.abort(),Error("Server returned no content-length header or content-length exceeding request. Check that your storage backend supports HTTP Byte Serving.");return{data:yield i.arrayBuffer(),etag:i.headers.get("ETag")||void 0,cacheControl:i.headers.get("Cache-Control")||void 0,expires:i.headers.get("Expires")||void 0}}))}}(e):e,this.decompress=r||Nl,this.cache=t||new class{constructor(e=100,t=!0,r=Nl){this.cache=new Map,this.maxCacheEntries=e,this.counter=1,this.prefetch=t,this.decompress=r}getHeader(e,t){return ta(this,null,(function*(){const r=e.getKey();if(this.cache.has(r))return this.cache.get(r).lastUsed=this.counter++,yield this.cache.get(r).data;const n=new Promise(((r,n)=>{Zl(e,this.decompress,this.prefetch,t).then((e=>{e[1]&&this.cache.set(e[1][0],{lastUsed:this.counter++,data:Promise.resolve(e[1][2])}),r(e[0]),this.prune()})).catch((e=>{n(e)}))}));return this.cache.set(r,{lastUsed:this.counter++,data:n}),n}))}getDirectory(e,t,r,n){return ta(this,null,(function*(){const i=e.getKey()+"|"+(n.etag||"")+"|"+t+"|"+r;if(this.cache.has(i))return this.cache.get(i).lastUsed=this.counter++,yield this.cache.get(i).data;const A=new Promise(((i,A)=>{(function(e,t,r,n,i){return ta(this,null,(function*(){const A=yield e.getBytes(r,n);if(i.etag&&i.etag!==A.etag)throw new jl(A.etag);const o=Xl(yield t(A.data,i.internalCompression));if(0===o.length)throw new Error("Empty directory is invalid");return o}))})(e,this.decompress,t,r,n).then((e=>{i(e),this.prune()})).catch((e=>{A(e)}))}));return this.cache.set(i,{lastUsed:this.counter++,data:A}),A}))}getArrayBuffer(e,t,r,n){return ta(this,null,(function*(){const i=e.getKey()+"|"+(n.etag||"")+"|"+t+"|"+r;if(this.cache.has(i))return this.cache.get(i).lastUsed=this.counter++,yield this.cache.get(i).data;const A=new Promise(((A,o)=>{e.getBytes(t,r).then((e=>{if(n.etag&&n.etag!==e.etag)throw new jl(e.etag);A(e.data),this.cache.has(i),this.prune()})).catch((e=>{o(e)}))}));return this.cache.set(i,{lastUsed:this.counter++,data:A}),A}))}prune(){if(this.cache.size>=this.maxCacheEntries){let e,t=1/0;this.cache.forEach(((r,n)=>{r.lastUsed<t&&(t=r.lastUsed,e=n)})),e&&this.cache.delete(e)}}invalidate(e,t){return ta(this,null,(function*(){this.cache.delete(e.getKey()),yield this.getHeader(e,t)}))}}}getHeader(){return ta(this,null,(function*(){return yield this.cache.getHeader(this.source)}))}getZxyAttempt(e,t,r,n){return ta(this,null,(function*(){const i=function(e,t,r){if(e>26)throw Error("Tile zoom level exceeds max safe number limit (26)");if(t>Math.pow(2,e)-1||r>Math.pow(2,e)-1)throw Error("tile x/y outside zoom level bounds");const n=$l[e];let i=0,A=0,o=0;const s=[t,r];let a=Math.pow(2,e)/2;for(;a>0;)i=(s[0]&a)>0?1:0,A=(s[1]&a)>0?1:0,o+=a*a*(3*i^A),Vl(a,s,i,A),a/=2;return n+o}(e,t,r),A=yield this.cache.getHeader(this.source);if(A.specVersion<3)return Rl.getZxy(A,this.source,this.cache,e,t,r,n);if(e<A.minZoom||e>A.maxZoom)return;let o=A.rootDirectoryOffset,s=A.rootDirectoryLength;for(let e=0;e<=3;e++){const e=Gl(yield this.cache.getDirectory(this.source,o,s,A),i);if(!e)return;if(e.runLength>0){const t=yield this.source.getBytes(A.tileDataOffset+e.offset,e.length,n);if(A.etag&&A.etag!==t.etag)throw new jl(t.etag);return{data:yield this.decompress(t.data,A.tileCompression),cacheControl:t.cacheControl,expires:t.expires}}o=A.leafDirectoryOffset+e.offset,s=e.length}throw Error("Maximum directory depth exceeded")}))}getZxy(e,t,r,n){return ta(this,null,(function*(){try{return yield this.getZxyAttempt(e,t,r,n)}catch(i){if(i instanceof jl)return this.cache.invalidate(this.source,i.message),yield this.getZxyAttempt(e,t,r,n);throw i}}))}getMetadataAttempt(){return ta(this,null,(function*(){const e=yield this.cache.getHeader(this.source),t=yield this.source.getBytes(e.jsonMetadataOffset,e.jsonMetadataLength);if(e.etag&&e.etag!==t.etag)throw new jl(t.etag);const r=yield this.decompress(t.data,e.internalCompression),n=new TextDecoder("utf-8");return JSON.parse(n.decode(r))}))}getMetadata(){return ta(this,null,(function*(){try{return yield this.getMetadataAttempt()}catch(e){if(e instanceof jl)return this.cache.invalidate(this.source,e.message),yield this.getMetadataAttempt();throw e}}))}};const{document:Wl}=f;function Yl(e){let t;const r=e[20].default,n=c(r,e,e[19],null);return{c(){n&&n.c()},m(e,r){n&&n.m(e,r),t=!0},p(e,i){n&&n.p&&(!t||524288&i)&&d(n,r,e,e[19],t?h(r,e[19],i,null):p(e[19]),null)},i(e){t||(ne(n,e),t=!0)},o(e){ie(n,e),t=!1},d(e){n&&n.d(e)}}}function ec(e){let t,r,n,i,A,o=e[3]&&Yl(e);return{c(){t=w("link"),n=B(),i=w("div"),o&&o.c(),F(t,"rel","stylesheet"),F(t,"href",r=e[1]?e[1]:"https://unpkg.com/maplibre-gl@2.4.0/dist/maplibre-gl.css"),F(i,"id",e[0]),F(i,"class","map svelte-1tna482")},m(r,s){m(Wl.head,t),y(r,n,s),y(r,i,s),o&&o.m(i,null),e[21](i),A=!0},p(e,[n]){(!A||2&n&&r!==(r=e[1]?e[1]:"https://unpkg.com/maplibre-gl@2.4.0/dist/maplibre-gl.css"))&&F(t,"href",r),e[3]?o?(o.p(e,n),8&n&&ne(o,1)):(o=Yl(e),o.c(),ne(o,1),o.m(i,null)):o&&(te(),ie(o,1,1,(()=>{o=null})),re()),(!A||1&n)&&F(i,"id",e[0])},i(e){A||(ne(o),A=!0)},o(e){ie(o),A=!1},d(r){_(t),r&&_(n),r&&_(i),o&&o.d(),e[21](null)}}}function tc(e,t,r){let{$$slots:n={},$$scope:i}=t;const A=H();let o,{map:s}=t,{id:a="map"}=t,{location:l={lng:15,lat:45,zoom:1}}=t,{style:c={version:8,sources:{},layers:[{id:"background",type:"background",paint:{"background-color":"lightgrey"}}]}}=t,{css:u=null}=t,{pmtiles:h=!1}=t,{options:d={}}=t,{minzoom:p=0}=t,{maxzoom:f=14}=t,{controls:m=!1}=t,{tabbable:g=!1}=t,{zoom:y=null}=t,{center:_=null}=t,{pitch:w=null}=t,{bearing:x=null}=t,{interactive:B=!0}=t,{attribution:v=!0}=t,b={},C=!1;return z("map",{getMap:()=>s}),l.bounds?b.bounds=l.bounds:l.lng&&l.lat&&(b.center=[+l.lng,+l.lat],l.zoom&&(b.zoom=+l.zoom),l.pitch&&(b.pitch=+l.pitch),l.bearing&&(b.bearing=+l.bearing)),v||(b.attributionControl=!1),b={...b,...d},L((()=>{if(h){let e=new class{constructor(){this.tile=(e,t)=>{if("json"==e.type){const r=e.url.substr(10);let n=this.tiles.get(r);return n||(n=new Jl(r),this.tiles.set(r,n)),n.getHeader().then((r=>{const n={tiles:[e.url+"/{z}/{x}/{y}"],minzoom:r.minZoom,maxzoom:r.maxZoom,bounds:[r.minLon,r.minLat,r.maxLon,r.maxLat]};t(null,n,null,null)})).catch((e=>{t(e,null,null,null)})),{cancel:()=>{}}}{const r=new RegExp(/pmtiles:\/\/(.+)\/(\d+)\/(\d+)\/(\d+)/),n=e.url.match(r);if(!n)throw new Error("Invalid PMTiles protocol URL");const i=n[1];let A=this.tiles.get(i);A||(A=new Jl(i),this.tiles.set(i,A));const o=n[2],s=n[3],a=n[4],l=new AbortController,c=l.signal;let u=()=>{l.abort()};return A.getHeader().then((e=>{A.getZxy(+o,+s,+a,c).then((r=>{r?t(null,new Uint8Array(r.data),r.cacheControl,r.expires):1==e.tileType?t(null,new Uint8Array,null,null):t(null,null,null,null)})).catch((e=>{"AbortError"!==e.name&&t(e,null,null,null)}))})),{cancel:u}}},this.tiles=new Map}add(e){this.tiles.set(e.source.getKey(),e)}get(e){return this.tiles.get(e)}};ea.addProtocol("pmtiles",e.tile)}r(4,s=new ea.Map({container:o,style:c,minZoom:p,maxZoom:f,interactive:B,...b})),m&&!Array.isArray(m)?s.addControl(new ea.NavigationControl({showCompass:!1})):Array.isArray(m)&&m!=["locate"]&&s.addControl(new ea.NavigationControl({showCompass:m.includes("compass"),visualizePitch:m.includes("pitch")})),Array.isArray(m)&&m.includes("locate")&&s.addControl(new ea.GeolocateControl),s.on("load",(e=>{r(5,y=s.getZoom()),r(6,_=s.getCenter()),r(7,w=s.getPitch()),r(8,x=s.getBearing()),r(3,C=!0),!g&&document.querySelector(`#${a} canvas`)&&(document.querySelector(`#${a} canvas`).tabIndex="-1"),A("load",{event:e})})),s.on("moveend",(()=>{r(5,y=s.getZoom()),r(6,_=s.getCenter()),r(7,w=s.getPitch()),r(8,x=s.getBearing())}))})),P((async()=>{await function(e=1e3){return new Promise((t=>setTimeout(t,e)))}(250),s&&s.remove(),r(4,s=null)})),e.$$set=e=>{"map"in e&&r(4,s=e.map),"id"in e&&r(0,a=e.id),"location"in e&&r(9,l=e.location),"style"in e&&r(10,c=e.style),"css"in e&&r(1,u=e.css),"pmtiles"in e&&r(11,h=e.pmtiles),"options"in e&&r(12,d=e.options),"minzoom"in e&&r(13,p=e.minzoom),"maxzoom"in e&&r(14,f=e.maxzoom),"controls"in e&&r(15,m=e.controls),"tabbable"in e&&r(16,g=e.tabbable),"zoom"in e&&r(5,y=e.zoom),"center"in e&&r(6,_=e.center),"pitch"in e&&r(7,w=e.pitch),"bearing"in e&&r(8,x=e.bearing),"interactive"in e&&r(17,B=e.interactive),"attribution"in e&&r(18,v=e.attribution),"$$scope"in e&&r(19,i=e.$$scope)},e.$$.update=()=>{1024&e.$$.dirty&&function(e){s&&s.setStyle(e),A("style",{style:e})}(c)},[a,u,o,C,s,y,_,w,x,l,c,h,d,p,f,m,g,B,v,i,n,function(e){K[e?"unshift":"push"]((()=>{o=e,r(2,o)}))}]}class rc extends ue{constructor(e){super(),ce(this,e,tc,ec,o,{map:4,id:0,location:9,style:10,css:1,pmtiles:11,options:12,minzoom:13,maxzoom:14,controls:15,tabbable:16,zoom:5,center:6,pitch:7,bearing:8,interactive:17,attribution:18})}}function nc(e){let t;const r=e[12].default,n=c(r,e,e[11],null);return{c(){n&&n.c()},m(e,r){n&&n.m(e,r),t=!0},p(e,i){n&&n.p&&(!t||2048&i)&&d(n,r,e,e[11],t?h(r,e[11],i,null):p(e[11]),null)},i(e){t||(ne(n,e),t=!0)},o(e){ie(n,e),t=!1},d(e){n&&n.d(e)}}}function ic(e){let t,r,n=e[0]&&nc(e);return{c(){n&&n.c(),t=v()},m(e,i){n&&n.m(e,i),y(e,t,i),r=!0},p(e,[r]){e[0]?n?(n.p(e,r),1&r&&ne(n,1)):(n=nc(e),n.c(),ne(n,1),n.m(t.parentNode,t)):n&&(te(),ie(n,1,1,(()=>{n=null})),re())},i(e){r||(ne(n),r=!0)},o(e){ie(n),r=!1},d(e){n&&n.d(e),e&&_(t)}}}function Ac(e,t,r){let{$$slots:n={},$$scope:i}=t,{id:A}=t,{type:o}=t,{url:s=null}=t,{props:a={}}=t,{data:l=null}=t,{layer:c=null}=t,{promoteId:u=null}=t,{minzoom:h=null}=t,{maxzoom:d=null}=t,{tilesize:p=256}=t,f=!1,m=s;const{getMap:g}=R("map"),y=g();async function _(){await function(e=1e3){return new Promise((t=>setTimeout(t,e)))}(100),y.isSourceLoaded(A)?(r(0,f=!0),console.log(A+" map source loaded!")):(console.log("..."),_())}return z("source",{source:A,layer:c,promoteId:u}),y.getSource(A)&&y.removeSource(A),h&&(a.minzoom=h),d&&(a.maxzoom=d),c&&u?(a.promoteId={},a.promoteId[c]=u):u&&(a.promoteId=u),L((function(){let e;console.log(A+" map source loading..."),"geojson"==o?l?e={type:o,data:l,...a}:s&&(e={type:o,data:s,...a}):"vector"==o?(e={type:o,...a},"pmtiles"===s.slice(0,7)?e.url=s:e.tiles=[s]):("raster"==o||"raster-dem"==o)&&(e={type:o,tiles:[s],tileSize:p,...a}),e&&(console.log(e),y.addSource(A,e),_())})),P((async()=>{if(y&&y.getSource(A)){y.getStyle().layers.filter((e=>e.source==A)).forEach((e=>{y.removeLayer(e.id)})),y.removeSource(A)}})),e.$$set=e=>{"id"in e&&r(2,A=e.id),"type"in e&&r(3,o=e.type),"url"in e&&r(4,s=e.url),"props"in e&&r(1,a=e.props),"data"in e&&r(5,l=e.data),"layer"in e&&r(6,c=e.layer),"promoteId"in e&&r(7,u=e.promoteId),"minzoom"in e&&r(8,h=e.minzoom),"maxzoom"in e&&r(9,d=e.maxzoom),"tilesize"in e&&r(10,p=e.tilesize),"$$scope"in e&&r(11,i=e.$$scope)},e.$$.update=()=>{41&e.$$.dirty&&"geojson"==o&&f&&function(e){let t=y.getSource(A);t&&t.setData(e)}(l),25&e.$$.dirty&&"vector"==o&&f&&function(e){if(e!==m){let t=y.getSource(A);t&&("pmtiles"===e.slice(0,7)?t.setUrl(e):t.setTiles([e])),m=e}}(s),25&e.$$.dirty&&"raster"==o&&f&&function(e){e!==m&&(y.getSource(A).tiles=[e],y.style.sourceCaches[A].clearTiles(),y.style.sourceCaches[A].update(y.transform),y.triggerRepaint(),m=e)}(s)},[f,a,A,o,s,l,c,u,h,d,p,i,n]}class oc extends ue{constructor(e){super(),ce(this,e,Ac,ic,o,{id:2,type:3,url:4,props:1,data:5,layer:6,promoteId:7,minzoom:8,maxzoom:9,tilesize:10})}}const sc=e=>({hovered:1&e[0]}),ac=e=>({hovered:e[0]});function lc(e){let t;const r=e[30].default,n=c(r,e,e[29],ac);return{c(){n&&n.c()},m(e,r){n&&n.m(e,r),t=!0},p(e,i){n&&n.p&&(!t||536870913&i[0])&&d(n,r,e,e[29],t?h(r,e[29],i,sc):p(e[29]),ac)},i(e){t||(ne(n,e),t=!0)},o(e){ie(n,e),t=!1},d(e){n&&n.d(e)}}}function cc(t,r,n){let i,{$$slots:A={},$$scope:s}=r;const a=H();let{id:c}=r,{type:u}=r,{filter:h=null}=r,{layout:d={}}=r,{paint:p={}}=r,{data:f=null}=r,{colorKey:m="color"}=r,{nameKey:g=null}=r,{valueKey:y=null}=r,{idKey:_=null}=r,{select:w=!1}=r,{clickIgnore:x=!1}=r,{clickCenter:B=!1}=r,{selected:v=null}=r,{hover:b=!1}=r,{hovered:C=null}=r,{highlight:F=!1}=r,{highlightKey:E="highlighted"}=r,{highlighted:U=[]}=r,{order:Q=null}=r,{maxzoom:I=null}=r,{minzoom:T=null}=r,{sourceLayer:S=null}=r,{visible:M=!0}=r;const{source:k,layer:D,promoteId:O}=R("source"),{getMap:K}=R("map"),V=K();z("layer",{layer:c});const $=function(t,r=e){let n;const i=new Set;function A(e){if(o(t,e)&&(t=e,n)){const e=!er.length;for(const e of i)e[1](),er.push(e,t);if(e){for(let e=0;e<er.length;e+=2)er[e][0](er[e+1]);er.length=0}}}return{set:A,update:function(e){A(e(t))},subscribe:function(o,s=e){const a=[o,s];return i.add(a),1===i.size&&(n=r(A)||e),o(t),()=>{i.delete(a),0===i.size&&n&&(n(),n=null)}}}}({id:null,feature:null,event:null});l(t,$,(e=>n(32,i=e))),z("hover",$),_=_||O,S=S||D;let N=null,G=null,q=[];d.visibility=M?"visible":"none";let X={id:c,type:u,source:k,paint:p,layout:d};function j(e,t=m){if(console.log("updating colors..."),g||y)for(const r of e)V.setFeatureState({source:k,sourceLayer:S,id:r[_]},{color:t?r[t]:null,name:g?r[g]:null,value:y?r[y]:null});else for(const r of e)V.setFeatureState({source:k,sourceLayer:S,id:r[_]},{color:r[t]})}return h&&(X.filter=h),S&&(X["source-layer"]=S),I&&(X.maxzoom=I),T&&(X.minzoom=T),L((()=>{V.getLayer(c)&&V.removeLayer(c),V.addLayer(X,Q)})),w&&V.on("click",c,(e=>{if(e.features.length>0&&!x){let t=e.features[0];if(n(2,v=t.id),a("select",{id:v,feature:t,event:e}),N&&V.setFeatureState({source:k,sourceLayer:S,id:N},{selected:!1}),V.setFeatureState({source:k,sourceLayer:S,id:v},{selected:!0}),B){let t=centroid(e.features[0].toJSON().geometry);V.flyTo({center:t.geometry.coordinates})}n(26,N=v)}})),b&&(V.on("mousemove",c,(e=>{if(e.features.length>0){C&&V.setFeatureState({source:k,sourceLayer:S,id:C},{hovered:!1});let t=e.features[0];n(0,C=n(27,G=t.id)),$.set({id:C,feature:t,event:e}),a("hover",i),V.setFeatureState({source:k,sourceLayer:S,id:C},{hovered:!0}),V.getCanvas().style.cursor="pointer"}})),V.on("mouseleave",c,(e=>{C&&V.setFeatureState({source:k,sourceLayer:S,id:C},{hovered:!1}),n(0,C=n(27,G=null)),$.set({id:null,feature:null,event:e}),a("hover",i),V.getCanvas().style.cursor=""}))),P((async()=>{V&&V.getLayer(c)&&V.removeLayer(c)})),t.$$set=e=>{"id"in e&&n(6,c=e.id),"type"in e&&n(7,u=e.type),"filter"in e&&n(8,h=e.filter),"layout"in e&&n(4,d=e.layout),"paint"in e&&n(9,p=e.paint),"data"in e&&n(10,f=e.data),"colorKey"in e&&n(11,m=e.colorKey),"nameKey"in e&&n(12,g=e.nameKey),"valueKey"in e&&n(13,y=e.valueKey),"idKey"in e&&n(5,_=e.idKey),"select"in e&&n(14,w=e.select),"clickIgnore"in e&&n(15,x=e.clickIgnore),"clickCenter"in e&&n(16,B=e.clickCenter),"selected"in e&&n(2,v=e.selected),"hover"in e&&n(17,b=e.hover),"hovered"in e&&n(0,C=e.hovered),"highlight"in e&&n(18,F=e.highlight),"highlightKey"in e&&n(19,E=e.highlightKey),"highlighted"in e&&n(20,U=e.highlighted),"order"in e&&n(21,Q=e.order),"maxzoom"in e&&n(22,I=e.maxzoom),"minzoom"in e&&n(23,T=e.minzoom),"sourceLayer"in e&&n(3,S=e.sourceLayer),"visible"in e&&n(24,M=e.visible),"$$scope"in e&&n(29,s=e.$$scope)},t.$$.update=()=>{if(3072&t.$$.dirty[0]&&f&&j(f,m),256&t.$$.dirty[0]&&function(e){V.getLayer(c)&&V.setFilter(c,e)}(h),512&t.$$.dirty[0]&&function(e){if(V.getLayer(c))for(const t in e)V.setPaintProperty(c,t,e[t])}(p),16777216&t.$$.dirty[0]&&function(e){V.getLayer(c)&&V.setLayoutProperty(c,"visibility",e?"visible":"none")}(M),270270472&t.$$.dirty[0]&&F&&U!=q){if(q[0])for(const e of q){let t={};t[E]=!1,V.setFeatureState({source:k,sourceLayer:S,id:e},t)}if(n(28,q=U),U[0])for(const e of U){let t={};t[E]=!0,V.setFeatureState({source:k,sourceLayer:S,id:e},t)}}67125260&t.$$.dirty[0]&&w&&v!=N&&(N&&V.setFeatureState({source:k,sourceLayer:S,id:N},{selected:!1}),v&&V.setFeatureState({source:k,sourceLayer:S,id:v},{selected:!0}),n(26,N=v)),134348809&t.$$.dirty[0]&&b&&C!=G&&(G&&V.setFeatureState({source:k,sourceLayer:S,id:G},{hovered:!1}),C&&V.setFeatureState({source:k,sourceLayer:S,id:C},{hovered:!0}),n(27,G=C))},[C,$,v,S,d,_,c,u,h,p,f,m,g,y,w,x,B,b,F,E,U,Q,I,T,M,j,N,G,q,s,A]}class uc extends ue{constructor(e){super(),ce(this,e,cc,lc,o,{id:6,type:7,filter:8,layout:4,paint:9,data:10,colorKey:11,nameKey:12,valueKey:13,idKey:5,select:14,clickIgnore:15,clickCenter:16,selected:2,hover:17,hovered:0,highlight:18,highlightKey:19,highlighted:20,order:21,maxzoom:22,minzoom:23,sourceLayer:3,visible:24,updateColors:25},null,[-1,-1])}get updateColors(){return this.$$.ctx[25]}}function hc(e,t,r){let n,{content:i}=t;const A=new ea.Popup({closeButton:!1,closeOnClick:!1}),{getMap:o}=R("map"),s=o(),a=R("hover");return l(e,a,(e=>r(2,n=e))),P((()=>A.remove())),e.$$set=e=>{"content"in e&&r(1,i=e.content)},e.$$.update=()=>{6&e.$$.dirty&&function(e,t){e.id?A.setLngLat(e.event.lngLat).setHTML(t||e.code).addTo(s):A.remove()}(n,i)},[a,i,n]}class dc extends ue{constructor(e){super(),ce(this,e,hc,null,o,{content:1})}}function pc(e,t,r){const n=e.slice();return n[40]=t[r],n[42]=r,n}function fc(t){let r,n,i;return{c(){r=x("Les jeunes et l’immobilier :"),n=w("br"),i=x(" quand le rêve tourne au mirage")},m(e,t){y(e,r,t),y(e,n,t),y(e,i,t)},p:e,d(e){e&&_(r),e&&_(n),e&&_(i)}}}function mc(t){let r,n,i,A,o;return{c(){r=x("Face à un marché de plus en plus austère,"),n=w("br"),i=x("\r\n      la jeunesse voit son rêve de propriété  s'effriter"),A=w("br"),o=x("\r\n     et un écart se creuser entre les générations.")},m(e,t){y(e,r,t),y(e,n,t),y(e,i,t),y(e,A,t),y(e,o,t)},p:e,d(e){e&&_(r),e&&_(n),e&&_(i),e&&_(A),e&&_(o)}}}function gc(e){let t;return{c(){t=x("16/08/2023")},m(e,r){y(e,t,r)},d(e){e&&_(t)}}}function yc(e){let t,r,n;function i(t){e[18](t)}let A={label:"Animation "+(e[5]?"on":"off"),mono:!0};return void 0!==e[5]&&(A.checked=e[5]),t=new Ni({props:A}),K.push((()=>Ae(t,"checked",i))),{c(){oe(t.$$.fragment)},m(e,r){se(t,e,r),n=!0},p(e,n){const i={};32&n[0]&&(i.label="Animation "+(e[5]?"on":"off")),!r&&32&n[0]&&(r=!0,i.checked=e[5],X((()=>r=!1))),t.$set(i)},i(e){n||(ne(t.$$.fragment,e),n=!0)},o(e){ie(t.$$.fragment,e),n=!1},d(e){ae(t,e)}}}function _c(e){let t,r,n,i,A,o,s,a,l,c,u,h,d,p,f;return r=new UA({props:{color:"white",$$slots:{default:[fc]},$$scope:{ctx:e}}}),A=new UA({props:{color:"white",$$slots:{default:[mc]},$$scope:{ctx:e}}}),a=new UA({props:{color:"white",$$slots:{default:[gc]},$$scope:{ctx:e}}}),u=new UA({props:{color:"white",$$slots:{default:[yc]},$$scope:{ctx:e}}}),p=new Zi({props:{color:"white",animation:e[5]}}),{c(){t=w("h1"),oe(r.$$.fragment),n=B(),i=w("p"),oe(A.$$.fragment),o=B(),s=w("p"),oe(a.$$.fragment),l=B(),c=w("p"),oe(u.$$.fragment),h=B(),d=w("div"),oe(p.$$.fragment),F(i,"class","text-big"),I(i,"margin-top","25px"),I(s,"margin-top","20px"),I(d,"text-align","center")},m(e,m){y(e,t,m),se(r,t,null),y(e,n,m),y(e,i,m),se(A,i,null),y(e,o,m),y(e,s,m),se(a,s,null),y(e,l,m),y(e,c,m),se(u,c,null),y(e,h,m),y(e,d,m),se(p,d,null),f=!0},p(e,t){const n={};4096&t[1]&&(n.$$scope={dirty:t,ctx:e}),r.$set(n);const i={};4096&t[1]&&(i.$$scope={dirty:t,ctx:e}),A.$set(i);const o={};4096&t[1]&&(o.$$scope={dirty:t,ctx:e}),a.$set(o);const s={};32&t[0]|4096&t[1]&&(s.$$scope={dirty:t,ctx:e}),u.$set(s);const l={};32&t[0]&&(l.animation=e[5]),p.$set(l)},i(e){f||(ne(r.$$.fragment,e),ne(A.$$.fragment,e),ne(a.$$.fragment,e),ne(u.$$.fragment,e),ne(p.$$.fragment,e),f=!0)},o(e){ie(r.$$.fragment,e),ie(A.$$.fragment,e),ie(a.$$.fragment,e),ie(u.$$.fragment,e),ie(p.$$.fragment,e),f=!1},d(e){e&&_(t),ae(r),e&&_(n),e&&_(i),ae(A),e&&_(o),e&&_(s),ae(a),e&&_(l),e&&_(c),ae(u),e&&_(h),e&&_(d),ae(p)}}}function wc(e){let t;return{c(){t=x("les acheteurs de moins de 30 ans")},m(e,r){y(e,t,r)},d(e){e&&_(t)}}}function xc(e){let t,r,n,i,A,o,s,a,l,c,u;return n=new UA({props:{color:"black",$$slots:{default:[wc]},$$scope:{ctx:e}}}),{c(){t=w("p"),r=x("Devenir propriétaire de son logement : certains jeunes en rêvent, les autres ne se font plus d’illusion.  Et ce n’est pas le nouveau baromètre de la Fédération du Notariat (Fednot) qui devrait les rassurer. En 2023 "),oe(n.$$.fragment),i=x(" ne représentaient que 27% des transactions, contre 30% en 2018. Selon la Banque nationale de Belgique (BNB), l'âge moyen de l'achat d’un premier logement est lui en constante augmentation depuis plusieurs années. Il est passé de 30 à 36 ans depuis la fin des années 1990."),A=B(),o=w("p"),o.textContent="La baisse du nombre d'acheteurs jeunes et la hausse de l'âge du premier achat touchent toutes les régions et illustrent la réalité du marché immobilier belge, celle d’un accès à la propriété qui se déteriore pour les moins de 30 ans.",s=B(),a=w("p"),a.textContent="Aujourd'hui plus qu'hier, l'accès au marché immobilier connait, en plus des inégalités sociales, l'importance grandissante des inégalités intergénérationelles. Car on ne choisit pas plus sa famille que la période économique qui nous accueille.",l=B(),c=w("p"),c.textContent="Pour observer cette disparité et comprendre son évolution, nous allons devoir mesurer cette accessibilité au logement. L'approche classique, utilisée notamment par la Banque nationale de Belgique (BNB), consiste à comparer l’évolution des revenus des ménages à celle des prix des logements.",F(t,"class","mb"),F(o,"class","mb"),F(a,"class","mb"),F(c,"class","mb")},m(e,h){y(e,t,h),m(t,r),se(n,t,null),m(t,i),y(e,A,h),y(e,o,h),y(e,s,h),y(e,a,h),y(e,l,h),y(e,c,h),u=!0},p(e,t){const r={};4096&t[1]&&(r.$$scope={dirty:t,ctx:e}),n.$set(r)},i(e){u||(ne(n.$$.fragment,e),u=!0)},o(e){ie(n.$$.fragment,e),u=!1},d(e){e&&_(t),ae(n),e&&_(A),e&&_(o),e&&_(s),e&&_(a),e&&_(l),e&&_(c)}}}function Bc(t){let r,n,i,A=t[40]+"";return{c(){r=w("option"),n=x(A),r.__value=i=t[42],r.value=r.__value},m(e,t){y(e,r,t),m(r,n)},p:e,d(e){e&&_(r)}}}function vc(e){let t,r,n,A,o,s,a,l,c,u,h,d=e[11],p=[];for(let t=0;t<d.length;t+=1)p[t]=Bc(pc(e,d,t));return l=new UA({props:{color:"black"}}),{c(){t=w("p"),t.textContent="Pour mieux comprendre la situation, sélectionnez votre catégorie d’âge.\r\n    Cela va nous permettre de visualiser les différences entre les générations et les conséquences sur leur accès au logement.",r=B(),n=w("h2"),n.textContent="Quel âge avez-vous?",A=B(),o=w("p"),s=w("select");for(let e=0;e<p.length;e+=1)p[e].c();a=v(),oe(l.$$.fragment),F(t,"class","text-big"),F(s,"class","tooltipdecodeurs svelte-1w87fjh"),void 0===e[7]&&q((()=>e[19].call(s)))},m(i,d){y(i,t,d),y(i,r,d),y(i,n,d),y(i,A,d),y(i,o,d),m(o,s);for(let e=0;e<p.length;e+=1)p[e]&&p[e].m(s,null);m(s,a),se(l,s,null),T(s,e[7],!0),c=!0,u||(h=[C(s,"change",e[19]),C(s,"change",e[16])],u=!0)},p(e,t){if(2048&t[0]){let r;for(d=e[11],r=0;r<d.length;r+=1){const n=pc(e,d,r);p[r]?p[r].p(n,t):(p[r]=Bc(n),p[r].c(),p[r].m(s,a))}for(;r<p.length;r+=1)p[r].d(1);p.length=d.length}128&t[0]&&T(s,e[7])},i(e){c||(ne(l.$$.fragment,e),c=!0)},o(e){ie(l.$$.fragment,e),c=!1},d(e){e&&_(t),e&&_(r),e&&_(n),e&&_(A),e&&_(o),function(e,t){for(let r=0;r<e.length;r+=1)e[r]&&e[r].d(t)}(p,e),ae(l),u=!1,i(h)}}}function bc(e){let t,r=e[17][e[7]]+"";return{c(){t=x(r)},m(e,r){y(e,t,r)},p(e,n){128&n[0]&&r!==(r=e[17][e[7]]+"")&&U(t,r)},d(e){e&&_(t)}}}function Cc(e){let t,r,n=(e[8][e[7]]?e[8][e[7]].annualIncome:"")+"";return{c(){t=x(n),r=x(" €")},m(e,n){y(e,t,n),y(e,r,n)},p(e,r){384&r[0]&&n!==(n=(e[8][e[7]]?e[8][e[7]].annualIncome:"")+"")&&U(t,n)},d(e){e&&_(t),e&&_(r)}}}function Fc(e){let t,r,n,i,A,o,s;return n=new UA({props:{color:"black",$$slots:{default:[bc]},$$scope:{ctx:e}}}),A=new UA({props:{color:"black",$$slots:{default:[Cc]},$$scope:{ctx:e}}}),{c(){t=w("p"),r=x("Vous avez "),oe(n.$$.fragment),i=x("? En 2020, les Belges de cette tranche d'âge avaient un revenu annuel moyen de "),oe(A.$$.fragment),o=x(".\r\n    Cette somme va nous servir de référence pour observer l'influence de l'âge sur l'accès à la propriété dans notre pays."),F(t,"class","mb")},m(e,a){y(e,t,a),m(t,r),se(n,t,null),m(t,i),se(A,t,null),m(t,o),s=!0},p(e,t){const r={};128&t[0]|4096&t[1]&&(r.$$scope={dirty:t,ctx:e}),n.$set(r);const i={};384&t[0]|4096&t[1]&&(i.$$scope={dirty:t,ctx:e}),A.$set(i)},i(e){s||(ne(n.$$.fragment,e),ne(A.$$.fragment,e),s=!0)},o(e){ie(n.$$.fragment,e),ie(A.$$.fragment,e),s=!1},d(e){e&&_(t),ae(n),ae(A)}}}function Ec(e){let t,r,n;function i(t){e[22](t)}let A={threshold:Jc,$$slots:{foreground:[Rc],background:[Tc]},$$scope:{ctx:e}};return void 0!==e[0].map&&(A.id=e[0].map),t=new ki({props:A}),K.push((()=>Ae(t,"id",i))),{c(){oe(t.$$.fragment)},m(e,r){se(t,e,r),n=!0},p(e,n){const i={};478&n[0]|4096&n[1]&&(i.$$scope={dirty:n,ctx:e}),!r&&1&n[0]&&(r=!0,i.id=e[0].map,X((()=>r=!1))),t.$set(i)},i(e){n||(ne(t.$$.fragment,e),n=!0)},o(e){ie(t.$$.fragment,e),n=!1},d(e){ae(t,e)}}}function Uc(e){let t,r;return t=new dc({props:{content:e[6]&&e[1].lookup[e[6]]?`<div class="tooltipdecodeurs">\n                          <div class="titre_tt">${e[1].lookup[e[6]].name}</div>\n                          <div class="hr" style="\n                          border-top: 1px solid #e8eaee;"></div>\n                          ${e[1].lookup[e[6]].ageData["prix médian pour une maison"]&&"nan€"!==e[1].lookup[e[6]].ageData["prix médian pour une maison"]?"<div>Prix médian pour une maison: "+e[1].lookup[e[6]].ageData["prix médian pour une maison"]+"</div>":""}\n                          ${e[1].lookup[e[6]].ageData["prix médian pour un appartement"]&&"nan€"!==e[1].lookup[e[6]].ageData["prix médian pour un appartement"]?"<div>Prix médian pour un appartement: "+e[1].lookup[e[6]].ageData["prix médian pour un appartement"]+"</div>":""}\n                         </div>`:""}}),{c(){oe(t.$$.fragment)},m(e,n){se(t,e,n),r=!0},p(e,r){const n={};66&r[0]&&(n.content=e[6]&&e[1].lookup[e[6]]?`<div class="tooltipdecodeurs">\n                          <div class="titre_tt">${e[1].lookup[e[6]].name}</div>\n                          <div class="hr" style="\n                          border-top: 1px solid #e8eaee;"></div>\n                          ${e[1].lookup[e[6]].ageData["prix médian pour une maison"]&&"nan€"!==e[1].lookup[e[6]].ageData["prix médian pour une maison"]?"<div>Prix médian pour une maison: "+e[1].lookup[e[6]].ageData["prix médian pour une maison"]+"</div>":""}\n                          ${e[1].lookup[e[6]].ageData["prix médian pour un appartement"]&&"nan€"!==e[1].lookup[e[6]].ageData["prix médian pour un appartement"]?"<div>Prix médian pour un appartement: "+e[1].lookup[e[6]].ageData["prix médian pour un appartement"]+"</div>":""}\n                         </div>`:""),t.$set(n)},i(e){r||(ne(t.$$.fragment,e),r=!0)},o(e){ie(t.$$.fragment,e),r=!1},d(e){ae(t,e)}}}function Qc(e){let t,r,n,i;return t=new uc({props:{id:"commune-fill",idKey:"ID_4",data:e[2].features,type:"fill",select:!0,selected:e[4],hover:!0,hovered:e[6],highlight:!0,highlighted:e[9],paint:{"fill-color":["case",["!=",["feature-state","color"],null],["feature-state","color"],"rgba(0, 0, 0, 0.1)"],"fill-opacity":.8},$$slots:{default:[Uc]},$$scope:{ctx:e}}}),t.$on("select",e[12]),t.$on("hover",e[13]),n=new uc({props:{id:"commune-line",type:"line",paint:{"line-color":["case",["==",["feature-state","hovered"],!0],"orange",["==",["feature-state","selected"],!0],"black",["==",["feature-state","highlighted"],!0],"black","rgba(255,255,255,0)"],"line-width":2}}}),{c(){oe(t.$$.fragment),r=B(),oe(n.$$.fragment)},m(e,A){se(t,e,A),y(e,r,A),se(n,e,A),i=!0},p(e,r){const n={};4&r[0]&&(n.data=e[2].features),16&r[0]&&(n.selected=e[4]),64&r[0]&&(n.hovered=e[6]),66&r[0]|4096&r[1]&&(n.$$scope={dirty:r,ctx:e}),t.$set(n)},i(e){i||(ne(t.$$.fragment,e),ne(n.$$.fragment,e),i=!0)},o(e){ie(t.$$.fragment,e),ie(n.$$.fragment,e),i=!1},d(e){ae(t,e),e&&_(r),ae(n,e)}}}function Ic(e){let t,r,n,i,A,o,s,a,l,c,u,h,d;return t=new oc({props:{id:"commune",type:"geojson",data:e[2],promoteId:"ID_4",maxzoom:13,$$slots:{default:[Qc]},$$scope:{ctx:e}}}),c=new Js({}),{c(){oe(t.$$.fragment),r=B(),n=w("div"),i=w("button"),i.textContent="Dézoomer",A=B(),o=w("div"),s=B(),a=w("div"),a.innerHTML='<span style="font-size: 1rem; color: #000;">Plus abordable</span> \n                <span style="font-size: 1rem; color: #000;">Moins abordable</span>',l=B(),oe(c.$$.fragment),F(i,"class","dezoomer-button svelte-1w87fjh"),I(o,"height","1px"),I(o,"background-color","grey"),I(o,"width","80%"),I(o,"margin","5px 0"),F(a,"class","titre_tt"),I(a,"display","flex"),I(a,"justify-content","space-between"),I(a,"margin-top","10px"),I(a,"width","100%"),F(n,"id","controls-container"),I(n,"position","absolute"),I(n,"bottom","10px"),I(n,"left","10px"),I(n,"background-color","white"),I(n,"padding","10px"),I(n,"border-radius","5px"),I(n,"display","flex"),I(n,"flex-direction","column"),I(n,"align-items","center")},m(p,f){se(t,p,f),y(p,r,f),y(p,n,f),m(n,i),m(n,A),m(n,o),m(n,s),m(n,a),m(n,l),se(c,n,null),u=!0,h||(d=C(i,"click",e[14]),h=!0)},p(e,r){const n={};4&r[0]&&(n.data=e[2]),86&r[0]|4096&r[1]&&(n.$$scope={dirty:r,ctx:e}),t.$set(n)},i(e){u||(ne(t.$$.fragment,e),ne(c.$$.fragment,e),u=!0)},o(e){ie(t.$$.fragment,e),ie(c.$$.fragment,e),u=!1},d(e){ae(t,e),e&&_(r),e&&_(n),ae(c),h=!1,d()}}}function Tc(e){let t,r,n,i,A,o;function s(t){e[21](t)}let a={style:Wc,interactive:!1,location:{bounds:e[10].belgium},$$slots:{default:[Ic]},$$scope:{ctx:e}};return void 0!==e[3]&&(a.map=e[3]),i=new rc({props:a}),K.push((()=>Ae(i,"map",s))),i.$on("load",e[15]),{c(){t=w("div"),r=w("figure"),n=w("div"),oe(i.$$.fragment),F(n,"class","col-full height-full"),F(t,"slot","background")},m(e,A){y(e,t,A),m(t,r),m(r,n),se(i,n,null),o=!0},p(e,t){const r={};86&t[0]|4096&t[1]&&(r.$$scope={dirty:t,ctx:e}),!A&&8&t[0]&&(A=!0,r.map=e[3],X((()=>A=!1))),i.$set(r)},i(e){o||(ne(i.$$.fragment,e),o=!0)},o(e){ie(i.$$.fragment,e),o=!1},d(e){e&&_(t),ae(i)}}}function Sc(e){let t;return{c(){t=x("bleues")},m(e,r){y(e,t,r)},d(e){e&&_(t)}}}function Mc(e){let t;return{c(){t=x("roses")},m(e,r){y(e,t,r)},d(e){e&&_(t)}}}function kc(e){let t,r=e[17][e[7]]+"";return{c(){t=x(r)},m(e,r){y(e,t,r)},p(e,n){128&n[0]&&r!==(r=e[17][e[7]]+"")&&U(t,r)},d(e){e&&_(t)}}}function Dc(e){let t;return{c(){t=x("Tranche d'âge")},m(e,r){y(e,t,r)},d(e){e&&_(t)}}}function Lc(e){let t;return{c(){t=x("Revenu annuel")},m(e,r){y(e,t,r)},d(e){e&&_(t)}}}function Pc(e){let t;return{c(){t=x("20,2%")},m(e,r){y(e,t,r)},d(e){e&&_(t)}}}function Hc(e){let t;return{c(){t=x("16,2%")},m(e,r){y(e,t,r)},d(e){e&&_(t)}}}function zc(e){let t;return{c(){t=x("le prix")},m(e,r){y(e,t,r)},d(e){e&&_(t)}}}function Rc(e){let t,r,n,A,o,s,a,l,c,u,h,d,p,f,g,v,b,E,T,S,M,k,D,L,P,H,z,R,O,K,V,$,N,G,q,X,j,Z,J,W,Y,ee,te,re,Ae,le,ce,ue,he,de,pe,fe,me,ge,ye,_e,we,xe,Be,ve,be,Ce,Fe,Ee,Ue,Qe=e[11][e[7]]+"",Ie=(e[8][e[7]]?e[8][e[7]].annualIncome:"")+"";return s=new UA({props:{color:"blue",$$slots:{default:[Sc]},$$scope:{ctx:e}}}),l=new UA({props:{color:"pink",$$slots:{default:[Mc]},$$scope:{ctx:e}}}),u=new UA({props:{color:"elegant",$$slots:{default:[kc]},$$scope:{ctx:e}}}),R=new UA({props:{color:"black",$$slots:{default:[Dc]},$$scope:{ctx:e}}}),q=new UA({props:{color:"black",$$slots:{default:[Lc]},$$scope:{ctx:e}}}),ce=new UA({props:{color:"black",$$slots:{default:[Pc]},$$scope:{ctx:e}}}),he=new UA({props:{$$slots:{default:[Hc]},$$scope:{ctx:e}}}),ve=new UA({props:{color:"black",$$slots:{default:[zc]},$$scope:{ctx:e}}}),{c(){t=w("div"),r=w("section"),n=w("div"),A=w("p"),o=x("Voici une carte qui représente les communes selon leur accessibilité. Les communes "),oe(s.$$.fragment),a=x(" sont les plus accessibles, à l'inverse les communes "),oe(l.$$.fragment),c=x(" sont trop chères pour la moyenne des Belge ayant "),oe(u.$$.fragment),h=x("."),d=B(),p=w("section"),p.innerHTML='<div class="col-medium"><p>Survolez la carte pour découvrir combien coûte une maison et/ou un appartement dans votre commune en 2023.</p></div>',f=B(),g=w("section"),g.innerHTML='<div class="col-medium"><p>En utilisant le revenu moyen de chaque tranche d&#39;âge, nous pouvons estimer la somme que vous pourriez emprunter selon les critères actuels de prêts actuellement appliqués par les banques belges. Ce montant est ensuite comparé aux prix de l’immobilier dans chaque commune.</p></div>',v=B(),b=w("section"),E=w("div"),T=w("p"),T.textContent="En déplacant ce slider vous pourrez constater les différences entre les générations:",S=B(),M=w("div"),k=w("input"),L=B(),P=w("div"),H=w("div"),z=w("label"),oe(R.$$.fragment),O=B(),K=w("div"),V=x(Qe),$=B(),N=w("div"),G=w("label"),oe(q.$$.fragment),X=B(),j=w("div"),Z=x(Ie),J=x(" €"),W=B(),Y=w("section"),Y.innerHTML='<div class="col-medium"><p>On le remarque assez vite, au sein de la population active, ce sont les Belges âgés de 25 à 29 ans qui sont les moins bien lotis. Voici à quoi ressemble leur carte.</p></div>',ee=B(),te=w("section"),re=w("div"),Ae=w("p"),le=x("C’est dans le Brabant Wallon que les acheteurs de moins de 30 ans sont les plus rares. Ils sont passés de "),oe(ce.$$.fragment),ue=x(" en 2018 à "),oe(he.$$.fragment),de=x(" en 2023, estime Fednot. La faute au confinement de 2020 et à la flambée des prix des maisons avec jardins se situant proches de la capitale."),pe=B(),fe=w("section"),fe.innerHTML='<div class="col-medium"><p>A l’inverse, le porte-parole de Fednot Renaud Grégoire, indique que certaines communes comme Courcelles, Sambreville, La Louvière ou Binche connaissent un taux de pénétrations plus élevé.</p></div>',me=B(),ge=w("section"),ye=w("div"),_e=w("p"),we=x("« "),xe=w("cite"),Be=x("Si les plus jeunes sont encore présents sur le marché immobilier, c'est parce qu'ils vont dans les communes les moins chères. Les moins de 30 ans posent "),oe(ve.$$.fragment),be=x(" comme critère principal. Ils iront donc chercher des biens moins accessibles à des tarifs plus avantageux"),Ce=x(" », analyse Renaud Grégoire."),F(n,"class","col-medium"),F(r,"data-id","map01"),F(p,"data-id","map01"),F(g,"data-id","map01"),F(k,"type","range"),I(k,"width","657px"),F(k,"min","0"),F(k,"max",D=e[11].length-1),F(k,"class","custom-slider svelte-1w87fjh"),F(M,"class","custom-slider-container svelte-1w87fjh"),F(z,"for","ageRangeBox"),F(K,"id","ageRangeBox"),F(K,"class","data-box svelte-1w87fjh"),F(H,"class","info-box svelte-1w87fjh"),F(G,"for","annualIncomeBox"),F(j,"id","annualIncomeBox"),F(j,"class","data-box svelte-1w87fjh"),F(N,"class","info-box svelte-1w87fjh"),F(P,"class","info-container svelte-1w87fjh"),I(P,"display","flex"),I(P,"justify-content","space-between"),I(P,"max-width","80%"),I(P,"margin-left","auto"),I(P,"margin-right","auto"),F(E,"class","col-medium"),F(b,"data-id","map01"),F(Y,"data-id","map03"),F(re,"class","col-medium"),F(te,"data-id","map02"),F(fe,"data-id","map04"),F(xe,"class","svelte-1w87fjh"),F(ye,"class","col-medium"),F(ge,"data-id","map04"),F(t,"slot","foreground")},m(i,_){y(i,t,_),m(t,r),m(r,n),m(n,A),m(A,o),se(s,A,null),m(A,a),se(l,A,null),m(A,c),se(u,A,null),m(A,h),m(t,d),m(t,p),m(t,f),m(t,g),m(t,v),m(t,b),m(b,E),m(E,T),m(E,S),m(E,M),m(M,k),Q(k,e[7]),m(E,L),m(E,P),m(P,H),m(H,z),se(R,z,null),m(H,O),m(H,K),m(K,V),m(P,$),m(P,N),m(N,G),se(q,G,null),m(N,X),m(N,j),m(j,Z),m(j,J),m(t,W),m(t,Y),m(t,ee),m(t,te),m(te,re),m(re,Ae),m(Ae,le),se(ce,Ae,null),m(Ae,ue),se(he,Ae,null),m(Ae,de),m(t,pe),m(t,fe),m(t,me),m(t,ge),m(ge,ye),m(ye,_e),m(_e,we),m(_e,xe),m(xe,Be),se(ve,xe,null),m(xe,be),m(_e,Ce),Fe=!0,Ee||(Ue=[C(k,"change",e[20]),C(k,"input",e[20]),C(k,"change",e[16])],Ee=!0)},p(e,t){const r={};4096&t[1]&&(r.$$scope={dirty:t,ctx:e}),s.$set(r);const n={};4096&t[1]&&(n.$$scope={dirty:t,ctx:e}),l.$set(n);const i={};128&t[0]|4096&t[1]&&(i.$$scope={dirty:t,ctx:e}),u.$set(i),128&t[0]&&Q(k,e[7]);const A={};4096&t[1]&&(A.$$scope={dirty:t,ctx:e}),R.$set(A),(!Fe||128&t[0])&&Qe!==(Qe=e[11][e[7]]+"")&&U(V,Qe);const o={};4096&t[1]&&(o.$$scope={dirty:t,ctx:e}),q.$set(o),(!Fe||384&t[0])&&Ie!==(Ie=(e[8][e[7]]?e[8][e[7]].annualIncome:"")+"")&&U(Z,Ie);const a={};4096&t[1]&&(a.$$scope={dirty:t,ctx:e}),ce.$set(a);const c={};4096&t[1]&&(c.$$scope={dirty:t,ctx:e}),he.$set(c);const h={};4096&t[1]&&(h.$$scope={dirty:t,ctx:e}),ve.$set(h)},i(e){Fe||(ne(s.$$.fragment,e),ne(l.$$.fragment,e),ne(u.$$.fragment,e),ne(R.$$.fragment,e),ne(q.$$.fragment,e),ne(ce.$$.fragment,e),ne(he.$$.fragment,e),ne(ve.$$.fragment,e),Fe=!0)},o(e){ie(s.$$.fragment,e),ie(l.$$.fragment,e),ie(u.$$.fragment,e),ie(R.$$.fragment,e),ie(q.$$.fragment,e),ie(ce.$$.fragment,e),ie(he.$$.fragment,e),ie(ve.$$.fragment,e),Fe=!1},d(e){e&&_(t),ae(s),ae(l),ae(u),ae(R),ae(q),ae(ce),ae(he),ae(ve),Ee=!1,i(Ue)}}}function Oc(e){let t;return{c(){t=x("le prix de l'immobilier")},m(e,r){y(e,t,r)},d(e){e&&_(t)}}}function Kc(e){let t;return{c(){t=x("un emprunt hypothécaire")},m(e,r){y(e,t,r)},d(e){e&&_(t)}}}function Vc(e){let t,r,n,i,A,o,s,a,l,c,u,h,d,p,f,g,v,b,C,E,U,Q,I;return n=new UA({props:{color:"blue",$$slots:{default:[Oc]},$$scope:{ctx:e}}}),A=new UA({props:{color:"green",$$slots:{default:[Kc]},$$scope:{ctx:e}}}),{c(){t=w("p"),r=x("Le revenu plus faible des moins de 30 ans joue donc un rôle majeur dans ces inégalités mais il n'explique pas, à lui seul, ce recul de l'accès à la propriété chez les jeunes. Si les écarts de revenus entre les classes d'âge ne sont pas neufs, deux éléments ont, eux, radicalement empiré la situation : "),oe(n.$$.fragment),i=x(" et les critères requis pour "),oe(A.$$.fragment),o=x("."),s=B(),a=w("p"),a.textContent="Dans une étude publiée en juillet 2022, la BNB posait en titre d'un rapport, la question suivante: «La propriété est-elle à la portée de tous en Belgique ?» La réponse de l'institution financière était pessimiste et désignait comme première responsable, la hausse continue du prix des logements ces 50 dernières années.",l=B(),c=w("div"),c.innerHTML='<script src="https://public.flourish.studio/resources/embed.js"><\/script>',u=B(),h=w("p"),h.innerHTML='La BNB qui dispose de données fiables depuis près de 50 ans pose un constat clair: «<cite class="svelte-1w87fjh">Depuis 1973, les prix des logements en Belgique ont été multipliés par un facteur 15. En prenant en compte l’inflation, <strong>les prix réels ont triplé</strong></cite>» , révèle l&#39;instution financière. Les prix réels sont ceux qui prennent en compte le revenu disponible pour acquérir un bien. Alors que depuis 1990, les prix des logements ont augmenté entre 120 et 180% selon le type de biens, les salaires n’ont augmenté que de 27 % sur la même période.',d=B(),p=w("p"),p.innerHTML='Une augmentation sur le long terme donc, mais qui jusqu&#39;à récemment, s&#39;équilibrait avec des taux d&#39;intérêts historiquement bas sur les emprunts hypothécaires. Ce sont ces faibles taux qui ont permis pendant longtemps à des ménages de s&#39;endetter et d&#39;accéder à la propriété. La BNB le rappelle : « <cite class="svelte-1w87fjh">une diminution des taux hypothécaires entraîne un allégement de la charge de remboursement des ménages pour un montant emprunté donné. Corollairement, pour une même charge de remboursement, le montant qui peut être emprunté augmente.</cite>» Mais depuis quelques mois, la machine s&#39;est grippée.',f=B(),g=w("h2"),g.textContent="La fin des taux attractifs?",v=B(),b=w("p"),b.textContent="Pour ceux qui suivent le sujet, même les moins attentifs, la nouvelle n’en est pas vraiment une. La pandémie de Covid-19 puis la guerre en Ukraine ont causé une forte inflation. Les banques centrales ont relevés leurs taux directeurs et ont fait flamber les taux hypothécaires par la même occasion. Chaque mois les chiffres battent de nouveaux records, atteignant des seuils que l’on avait pas vus depuis parfois 12 ans.",C=B(),E=w("div"),E.innerHTML='<script src="https://public.flourish.studio/resources/embed.js"><\/script>',U=B(),Q=w("p"),Q.textContent="Les nombres de nouveaux crédits ont nettement diminué en un an, de l’ordre de 30% pour les crédits à la construction et jusqu’à 45% pour les crédits de rénovation. Les particuliers sont contraints de repousser, voire de tirer un trait sur leurs projets immobiliers. Ceux qui décident toutefois de s’y risquer voient leur demande d’apport augmenter de façon conséquente.",F(t,"class","mb"),F(a,"class","mb"),F(c,"class","flourish-embed flourish-chart"),F(c,"data-src","visualisation/14705524"),F(g,"class","section-title"),F(E,"class","flourish-embed flourish-chart"),F(E,"data-src","visualisation/13615522")},m(e,_){y(e,t,_),m(t,r),se(n,t,null),m(t,i),se(A,t,null),m(t,o),y(e,s,_),y(e,a,_),y(e,l,_),y(e,c,_),y(e,u,_),y(e,h,_),y(e,d,_),y(e,p,_),y(e,f,_),y(e,g,_),y(e,v,_),y(e,b,_),y(e,C,_),y(e,E,_),y(e,U,_),y(e,Q,_),I=!0},p(e,t){const r={};4096&t[1]&&(r.$$scope={dirty:t,ctx:e}),n.$set(r);const i={};4096&t[1]&&(i.$$scope={dirty:t,ctx:e}),A.$set(i)},i(e){I||(ne(n.$$.fragment,e),ne(A.$$.fragment,e),I=!0)},o(e){ie(n.$$.fragment,e),ie(A.$$.fragment,e),I=!1},d(e){e&&_(t),ae(n),ae(A),e&&_(s),e&&_(a),e&&_(l),e&&_(c),e&&_(u),e&&_(h),e&&_(d),e&&_(p),e&&_(f),e&&_(g),e&&_(v),e&&_(b),e&&_(C),e&&_(E),e&&_(U),e&&_(Q)}}}function $c(t){let r;return{c(){r=w("div"),r.innerHTML='<figure style="background-image: url(&#39;./img/sara.jpg&#39;); background-position: 15% center; background-repeat: no-repeat; background-size: 50% auto;"><div class="col-wide height-full"></div></figure>',F(r,"slot","background"),F(r,"class","col-wide height-full")},m(e,t){y(e,r,t)},p:e,d(e){e&&_(r)}}}function Nc(t){let r;return{c(){r=w("div"),r.innerHTML='<section><div class="col-medium left-centered-text svelte-1w87fjh"><blockquote class="citation-emphase svelte-1w87fjh">«Un appartement à ce prix-là, ça n&#39;existe pas!»\n          <div class="attribution svelte-1w87fjh">- Sara, 27 ans</div></blockquote></div></section> \n  \n    <section><div class="col-medium left-centered-text svelte-1w87fjh"><p>«<cite class="svelte-1w87fjh">Les sommes exigées pour un prêt sont énormes, cela m’a choquée</cite>», confirme Sara, directrice des ventes dans une agence digitale à Waterloo. A 27 ans, elle et son conjoint viennent d’acquérir un appartement à 460 000 € après des semaines de démarches.</p> \n        <p>« <cite class="svelte-1w87fjh">Depuis quelques années, je souhaitais devenir propriétaire. Je touche un salaire plus que correct et mon conjoint est patron de sa propre entreprise de jardinage. Avec l’arrivée de ma fille en 2022, il fallait que nous quittions notre location. Je ne pensais pas que cela serait si compliqué d’acheter un bien</cite>», confie la jeune maman. En cause : les taux élevés et la frilosité des banques à l’octroi de prêts.</p></div></section> \n\n    <section><div class="col-medium left-centered-text svelte-1w87fjh"><p>Prenons l’exemple de Sara et son conjoint.  Leur apport comprend d’une part,  46 000 € pour un prêt à taux fixe sur 25 ans avec une quotité de 90%. D’autre part, les frais de notaires et d’enregistrements portent l’apport total à environs 140 000 euros. Une somme difficile à sortir de la poche des jeunes parents.</p> \n        <p>«<cite class="svelte-1w87fjh"> J’avais commencé à économiser dès mon premier salaire et je disposais déjà de 40 000€. C’était largement insuffisant et nous avons dû compter sur les donations de la famille de mon conjoint pour couvrir le reste de la somme. Mes parents sont loin d’être en difficulté mais ils n’auraient pas pu me prêter cet argent. »</cite></p></div></section> \n\n    <section><div class="col-medium left-centered-text svelte-1w87fjh"><p>En effet, un tel soutien, nombreuses sont les familles à ne pas pouvoir l’offrir. Sara le confirme : « <cite class="svelte-1w87fjh">Dans la même période, une amie s’est renseignée sur l’achat d’un appartement pour elle et son bébé. En tant que mère célibataire et sans aucun apport extérieur,  la banque lui a proposé 160 000 € de prêt maximum. Un appartement avec deux chambres à ce prix-là, ça n’existe pas.</cite> » Pas un neuf, du moins.</p></div></section>',F(r,"slot","foreground")},m(e,t){y(e,r,t)},p:e,d(e){e&&_(r)}}}function Gc(t){let r,n,i,A,o,s,a;return{c(){r=w("h2"),r.textContent="Existe-t-il un «facteur jeunesse» ?",n=B(),i=w("p"),i.innerHTML='Il est vrai que les banques se montrent de plus en plus frileuse à accorder des prêts aux jeunes ménages. Fanny Bugeja-Bloch, Maitresse de conférence à l’Université Paris-Nanterre et sociolgue des inégalités analyse cette tendance: «<cite class="svelte-1w87fjh">Les moins de 30 ans sont une population fragile. Ils présentent des signaux qui rendent difficile l’accès à un logement abordable. La précarisation sur le marché, la proportion forte de chômeurs et d’inactifs ou encore les salaires irréguliers sont autant d’éléments qui freinent les banques avant d’accorder un crédit.</cite>»',A=B(),o=w("div"),o.innerHTML='<img src="./img/fanny.png" alt="Fanny"/>',s=B(),a=w("p"),a.innerHTML='Tous ces facteurs réunis finissent par plomber le capital dont dipose la jeunesse. Alors qu’en 1985, les moins de 25 ans consacraient au logement un budget deux fois plus élevés qu’un ménage de 75 ans, ce rapport était de 3 en 2015. Des efforts plus importants qui influencent le parcours de vie de ceux qui n’ont pas les ressources suffisantes, souvent héritées de leur famille. Et c&#39;est en fin de vie que les inégalités se font alors ressentir, confirme Fanny Bugeja-Bloch: «<cite class="svelte-1w87fjh">Arrivés à l’âge de la retraite, les locataires ont une plus grande chance de connaitre la précarité car ils n’auront souvent disposé  d’aucun autre moyen de capitalisation pendant leurs années actives.</cite>»',F(r,"class","section-title"),F(i,"class","mb"),F(o,"class","conteneur svelte-1w87fjh"),F(a,"class","mb")},m(e,t){y(e,r,t),y(e,n,t),y(e,i,t),y(e,A,t),y(e,o,t),y(e,s,t),y(e,a,t)},p:e,d(e){e&&_(r),e&&_(n),e&&_(i),e&&_(A),e&&_(o),e&&_(s),e&&_(a)}}}function qc(t){let r,n,i,A,o,s,a;return{c(){r=w("h2"),r.textContent="Les fonds publics sous pression",n=B(),i=w("p"),i.innerHTML='Sans le soutien des banques et sans famille pour financer leur projet immobilier, les jeunes acheteurs se tournent alors vers les pouvoirs publics. Mais face à l’augmentation du nombre de demandes, leur capacité d&#39;action est de plus en plus limitée. Exemple récent: le Fonds du Logement bruxellois a annoncé ce 2 mai <a href="https://fonds.brussels/fr/a-propos/communiques-de-presse/le-fonds-met-en-place-de-nouvelles-conditions-dacces-pour-son-credit" target="_blank">la restriction des conditions d’accès à ses crédits hypothécaires</a>, désormais réservés aux ménages dont les revenus correspondent aux barèmes du logement social, et ce jusqu’au 31 décembre 2023.',A=B(),o=w("p"),o.textContent="Mis en place par la région bruxelloise, le Fonds propose notamment des crédits aux conditions avantageuses pour les foyers qui ne disposent pas d’assez de ressources pour contracter un prêt chez une banque. Fort de son succès , le Fonds du logement avait élargi cette possibilité à des foyers de la classe moyenne en 2015. L’institution vient donc de faire marche arrière, pour un temps du moins.",s=B(),a=w("p"),a.textContent="les perspectives d'une amélioration sont minces. Rien n'indique que les prix de l'immobilier devraient se maintenir à moyen termes. De leur côté, les taux devraient continuer leur ascension. La Banque centrale européenne vient de relever ses taux de 0,25 points et a annoncé poursuivre sa stratégie de lutte contre l'inflation pour quelques mois encore, entrainant avec elle l'ensemble des banques et éloignant toujours plus de jeunes foyers d’un accès à la propriété.",F(r,"class","section-title"),F(i,"class","mb"),F(o,"class","mb")},m(e,t){y(e,r,t),y(e,n,t),y(e,i,t),y(e,A,t),y(e,o,t),y(e,s,t),y(e,a,t)},p:e,d(e){e&&_(r),e&&_(n),e&&_(i),e&&_(A),e&&_(o),e&&_(s),e&&_(a)}}}function Xc(t){let r;return{c(){r=w("h3"),r.textContent="Etienne Daman"},m(e,t){y(e,r,t)},p:e,d(e){e&&_(r)}}}function jc(e){let t,r,n,i,A,o,s,a,l,c,u,h,d,p,f,m,g,w,x,v,b,C,F,E,U;t=new di({props:{filled:!0,center:!1}}),n=new xi({props:{bgimage:"./img/Projet.jpg",bgfixed:!0,theme:"light",short:!0,center:!1,$$slots:{default:[_c]},$$scope:{ctx:e}}}),A=new Ki({}),s=new bi({props:{theme:"light",$$slots:{default:[xc]},$$scope:{ctx:e}}}),l=new Pi({props:{theme:"lightblue",short:!0,wide:!0,center:!1,$$slots:{default:[vc]},$$scope:{ctx:e}}}),u=new Pi({props:{theme:"light",short:!0,wide:!0,center:!1,$$slots:{default:[Fc]},$$scope:{ctx:e}}});let Q=e[2]&&Ec(e);return p=new bi({props:{$$slots:{default:[Vc]},$$scope:{ctx:e}}}),m=new ki({props:{$$slots:{foreground:[Nc],background:[$c]},$$scope:{ctx:e}}}),w=new bi({props:{$$slots:{default:[Gc]},$$scope:{ctx:e}}}),v=new bi({props:{$$slots:{default:[qc]},$$scope:{ctx:e}}}),C=new bi({props:{$$slots:{default:[Xc]},$$scope:{ctx:e}}}),E=new yi({}),{c(){oe(t.$$.fragment),r=B(),oe(n.$$.fragment),i=B(),oe(A.$$.fragment),o=B(),oe(s.$$.fragment),a=B(),oe(l.$$.fragment),c=B(),oe(u.$$.fragment),h=B(),Q&&Q.c(),d=B(),oe(p.$$.fragment),f=B(),oe(m.$$.fragment),g=B(),oe(w.$$.fragment),x=B(),oe(v.$$.fragment),b=B(),oe(C.$$.fragment),F=B(),oe(E.$$.fragment)},m(e,_){se(t,e,_),y(e,r,_),se(n,e,_),y(e,i,_),se(A,e,_),y(e,o,_),se(s,e,_),y(e,a,_),se(l,e,_),y(e,c,_),se(u,e,_),y(e,h,_),Q&&Q.m(e,_),y(e,d,_),se(p,e,_),y(e,f,_),se(m,e,_),y(e,g,_),se(w,e,_),y(e,x,_),se(v,e,_),y(e,b,_),se(C,e,_),y(e,F,_),se(E,e,_),U=!0},p(e,t){const r={};32&t[0]|4096&t[1]&&(r.$$scope={dirty:t,ctx:e}),n.$set(r);const i={};4096&t[1]&&(i.$$scope={dirty:t,ctx:e}),s.$set(i);const A={};128&t[0]|4096&t[1]&&(A.$$scope={dirty:t,ctx:e}),l.$set(A);const o={};384&t[0]|4096&t[1]&&(o.$$scope={dirty:t,ctx:e}),u.$set(o),e[2]?Q?(Q.p(e,t),4&t[0]&&ne(Q,1)):(Q=Ec(e),Q.c(),ne(Q,1),Q.m(d.parentNode,d)):Q&&(te(),ie(Q,1,1,(()=>{Q=null})),re());const a={};4096&t[1]&&(a.$$scope={dirty:t,ctx:e}),p.$set(a);const c={};4096&t[1]&&(c.$$scope={dirty:t,ctx:e}),m.$set(c);const h={};4096&t[1]&&(h.$$scope={dirty:t,ctx:e}),w.$set(h);const f={};4096&t[1]&&(f.$$scope={dirty:t,ctx:e}),v.$set(f);const g={};4096&t[1]&&(g.$$scope={dirty:t,ctx:e}),C.$set(g)},i(e){U||(ne(t.$$.fragment,e),ne(n.$$.fragment,e),ne(A.$$.fragment,e),ne(s.$$.fragment,e),ne(l.$$.fragment,e),ne(u.$$.fragment,e),ne(Q),ne(p.$$.fragment,e),ne(m.$$.fragment,e),ne(w.$$.fragment,e),ne(v.$$.fragment,e),ne(C.$$.fragment,e),ne(E.$$.fragment,e),U=!0)},o(e){ie(t.$$.fragment,e),ie(n.$$.fragment,e),ie(A.$$.fragment,e),ie(s.$$.fragment,e),ie(l.$$.fragment,e),ie(u.$$.fragment,e),ie(Q),ie(p.$$.fragment,e),ie(m.$$.fragment,e),ie(w.$$.fragment,e),ie(v.$$.fragment,e),ie(C.$$.fragment,e),ie(E.$$.fragment,e),U=!1},d(e){ae(t,e),e&&_(r),ae(n,e),e&&_(i),ae(A,e),e&&_(o),ae(s,e),e&&_(a),ae(l,e),e&&_(c),ae(u,e),e&&_(h),Q&&Q.d(e),e&&_(d),ae(p,e),e&&_(f),ae(m,e),e&&_(g),ae(w,e),e&&_(x),ae(v,e),e&&_(b),ae(C,e),e&&_(F),ae(E,e)}}}let Zc="light";const Jc=.65,Wc="https://api.maptiler.com/maps/7a398d58-c7b0-4b18-86df-50b59985bef1/style.json?key=KxWuaRoNgdIOk76i21Fs";function Yc(e){return e.startsWith("De")?"entre"+e.slice(2).replace("à","et"):e.startsWith("Moins")?e.charAt(0).toLowerCase()+e.slice(1):"85 ans et plus"===e?"plus de 85 ans":e}function eu(e,t,r){z("theme",Zc),function(e,t){for(let r in e[t])document.documentElement.style.setProperty("--"+r,e[t][r])}(Yt,Zc);let n,i,A,o={},s=null,a=function(){let e=window.matchMedia("(prefers-reduced-motion: reduce)");return!(!e||e.matches)}(),l={},c={};L((()=>{c={...l}}));let u,h=[4.5,50.5],d=["Moins de 24 ans","De 25 à 29 ans","De 30 à 34 ans","De 35 à 39 ans","De 40 à 44 ans","De 45 à 49 ans","De 50 à 54 ans","De 55 à 59 ans","De 60 à 64 ans","De 65 à 69 ans","De 70 à 74 ans","De 75 à 79 ans","De 80 à 84 ans","85 ans et plus"],p=d.indexOf("De 50 à 54 ans"),f="De 50 à 54 ans",m=[];function g(){s.flyTo({center:h,zoom:7})}function y(e){if(n&&e){let t=n.features.find((t=>t.properties.ID_4==e));if(t){!function(e){s&&s.fitBounds(e,{animate:a,padding:30})}(Ys(t.geometry))}}}const _={map:{map01:()=>{g()},map02:()=>{var e,t;e=[4.485,50.73],t=8,s&&s.flyTo({center:e,zoom:t})},map03:()=>{r(7,p=d.indexOf("De 25 à 29 ans")),g(),B()},map04:()=>{g(),y(365),B()}}};function w(e){s.getSource("commune")?e():s.once("sourcedata",(()=>{s.isSourceLoaded("commune")?e():w(e)}))}function x(){s&&o&&w((()=>{o.array.forEach((e=>{if(e.ageData[f]){let t=Number(e.ageData[f]),r=u(t);s.setFeatureState({source:"commune",id:e.code},{color:r})}}))}))}function B(){f=d[p],x();const e=m.find((e=>e.age===f));e&&console.log(`Revenus par an pour ${f}: ${e.annualIncome}`)}let v=d.map(Yc);return L((async()=>{let e=await Jt("./data/communes-belges0 copy.json","Communes");r(2,n=e),e.features.sort(((e,t)=>e.properties.NAME_4.localeCompare(t.properties.NAME_4)));let t=e.features.map((e=>{let t={};for(let r in e.properties)(r.startsWith("De")||r.startsWith("Moins")||r.startsWith("85 ans et plus")||"prix médian pour une maison"===r||"prix médian pour un appartement"===r)&&(t[r]=e.properties[r]);return{code:e.properties.ID_4,name:e.properties.NAME_4,parent:e.properties.ID_3?e.properties.ID_3:null,ageData:t}}));const i=await Rt.get("./data/Revenus moyens par age.csv"),A=Xt(i.data);r(8,m=A.map((e=>({age:e["âge"],annualIncome:parseFloat(e["revenus par an"].replace(/,/g,".")),monthlyIncome:parseFloat(e["revenus par mois"].replace(/,/g,".").replace(/ /g,"")),loanLowEnd:parseFloat(e["emprunt sur trente ans (bas)"].replace(/ /g,"").replace(/€/g,"").replace(/,/g,".").trim()),loanHighEnd:parseFloat(e["emprunt sur trente ans (haut)"].replace(/ /g,"").replace(/€/g,"").replace(/,/g,".").trim())}))));let s={};t.forEach((e=>{s[e.code]=e})),r(1,o.array=t,o),r(1,o.lookup=s,o);u=oi().domain([.05,.2,.3,.4,.5,.6,.7,.8,.9,1,1.1,1.2,1.3,1.4,1.5,1.6,1.7,1.8,2,3]).range(["#fef8f8","#fad7e5","#f1b6d3","#e597c1","#d479b0","#c05ca1","#a84192","#8d2783","#6e1076","#49006a","#49006a","#4e267b","#543f8b","#5b569a","#636ca9","#6d82b7","#7997c5","#88add2","#98c3de","#abd9e9"])})),B(),e.$$.update=()=>{1&e.$$.dirty[0]&&l&&function(e=[]){e.forEach((e=>{l[e]!=c[e]&&(_[e][l[e]]&&_[e][l[e]](),c[e]=l[e])}))}(Object.keys(_))},[l,o,n,s,i,a,A,p,m,[],{belgium:[[2.5,49.5],[6.4,51.5]]},d,function(e){console.log(e),r(4,i=e.detail.id),e.detail.feature&&y(i)},function(e){r(6,A=e.detail.id);let t="";A&&o.lookup[A]&&(t=`${o.lookup[A].name} \n      - Prix médian pour un appartement: ${o.lookup[A].ageData["prix médian pour un appartement"]} \n      - Prix médian pour une maison: ${o.lookup[A].ageData["prix médian pour une maison"]}`)},g,x,B,v,function(e){a=e,r(5,a)},function(){p=function(e){const t=e.querySelector(":checked");return t&&t.__value}(this),r(7,p)},function(){var e;e=this.value,p=""===e?null:+e,r(7,p)},function(e){s=e,r(3,s)},function(t){e.$$.not_equal(l.map,t)&&(l.map=t,r(0,l))}]}return new class extends ue{constructor(e){super(),ce(this,e,eu,jc,o,{},null,[-1,-1])}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
